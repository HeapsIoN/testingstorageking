//%attributes = {"lang":"en"} comment added and reserved by 4D.
vYTD:=0
QUERY([Contacts];[Contacts]Facility=[Facility]FacilityCode;*)
QUERY([Contacts]; & ;[Contacts]CallDate>=[Facility]YearStartDate;*)
QUERY([Contacts]; & ;[Contacts]CallDate<=vDateFor)
vYTD:=vYTD+Records in selection([Contacts])
vMTD:=0
$emonth:=GetDate (31;Month of(vDateFor);Year of(vDateFor))
$smonth:=Date("1/"+String(Month of(vDateFor))+"/"+String(Year of(vDateFor)))
QUERY([Contacts];[Contacts]Facility=[Facility]FacilityCode;*)
QUERY([Contacts]; & ;[Contacts]CallDate>=$smonth;*)
QUERY([Contacts]; & ;[Contacts]CallDate<=vDateFor)
vMTD:=vMTD+Records in selection([Contacts])
vWTD:=0
$startweek:=[Facility]WeekEndDay-Abs(6)
$day:=Day number(vDateFor)
$diff:=$day-$startweek
$startweekdate:=vDateFor-$diff
QUERY([Contacts];[Contacts]Facility=[Facility]FacilityCode;*)
QUERY([Contacts]; & ;[Contacts]CallDate>=$startweekdate;*)
QUERY([Contacts]; & ;[Contacts]CallDate<=vDateFor)
vWTD:=vWTD+Records in selection([Contacts])
vToday:=0
QUERY([Contacts];[Contacts]Facility=[Facility]FacilityCode;*)
QUERY([Contacts]; & ;[Contacts]Facility=[Facility]FacilityCode;*)
QUERY([Contacts]; & ;[Contacts]CallDate=vDateFor)
vToday:=vToday+Records in selection([Contacts])
//Sales Enq Declined
vYDeclined:=0
QUERY([Contacts];[Contacts]Facility=[Facility]FacilityCode;*)
QUERY([Contacts]; & ;[Contacts]OutComeDate>=[Facility]YearStartDate;*)
QUERY([Contacts]; & ;[Contacts]OutComeDate<=vDateFor;*)
QUERY([Contacts]; & ;[Contacts]CallDate>=[Facility]YearStartDate;*)
QUERY([Contacts]; & ;[Contacts]Outcome="Declined")
vYDeclined:=vYDeclined+Records in selection([Contacts])
vMDeclined:=0
$emonth:=GetDate (31;Month of(vDateFor);Year of(vDateFor))
$smonth:=Date("1/"+String(Month of(vDateFor))+"/"+String(Year of(vDateFor)))
QUERY([Contacts];[Contacts]Facility=[Facility]FacilityCode;*)
QUERY([Contacts]; & ;[Contacts]OutComeDate>=$smonth;*)
QUERY([Contacts]; & ;[Contacts]OutComeDate<=vDateFor;*)
QUERY([Contacts]; & ;[Contacts]CallDate>=[Facility]YearStartDate;*)
QUERY([Contacts]; & ;[Contacts]Outcome="Declined")
vMDeclined:=vMDeclined+Records in selection([Contacts])
vWDeclined:=0
$startweek:=[Facility]WeekEndDay-Abs(6)
$day:=Day number(vDateFor)
$diff:=$day-$startweek
$startweekdate:=vDateFor-$diff
QUERY([Contacts];[Contacts]Facility=[Facility]FacilityCode;*)
QUERY([Contacts]; & ;[Contacts]OutComeDate>=$startweekdate;*)
QUERY([Contacts]; & ;[Contacts]OutComeDate<=vDateFor;*)
QUERY([Contacts]; & ;[Contacts]CallDate>=[Facility]YearStartDate;*)
QUERY([Contacts]; & ;[Contacts]Outcome="Declined")
vWDeclined:=vWDeclined+Records in selection([Contacts])
vTDeclined:=0
QUERY([Contacts];[Contacts]Facility=[Facility]FacilityCode;*)
QUERY([Contacts]; & ;[Contacts]CallDate=vDateFor;*)
QUERY([Contacts]; & ;[Contacts]CallDate>=[Facility]YearStartDate;*)
QUERY([Contacts]; & ;[Contacts]Outcome="Declined")
vTDeclined:=vTDeclined+Records in selection([Contacts])
//YTD
vYPending:=0
QUERY([Contacts];[Contacts]Facility=[Facility]FacilityCode;*)
QUERY([Contacts]; & ;[Contacts]CallDate>=[Facility]YearStartDate;*)
QUERY([Contacts]; & ;[Contacts]CallDate<=vDateFor;*)
QUERY([Contacts]; & ;[Contacts]Outcome="")
vYPending:=vYPending+Records in selection([Contacts])
vMPending:=0
$emonth:=GetDate (31;Month of(vDateFor);Year of(vDateFor))
$smonth:=Date("1/"+String(Month of(vDateFor))+"/"+String(Year of(vDateFor)))
QUERY([Contacts];[Contacts]Facility=[Facility]FacilityCode;*)
QUERY([Contacts]; & ;[Contacts]CallDate>=$smonth;*)
QUERY([Contacts]; & ;[Contacts]CallDate<=vDateFor;*)
QUERY([Contacts]; & ;[Contacts]Outcome="")
vMPending:=vMPending+Records in selection([Contacts])
vWPending:=0
$startweek:=[Facility]WeekEndDay-Abs(6)
$day:=Day number(vDateFor)
$diff:=$day-$startweek
$startweekdate:=vDateFor-$diff
QUERY([Contacts];[Contacts]Facility=[Facility]FacilityCode;*)
QUERY([Contacts]; & ;[Contacts]CallDate>=$startweekdate;*)
QUERY([Contacts]; & ;[Contacts]CallDate<=vDateFor;*)
QUERY([Contacts]; & ;[Contacts]Outcome="")
vWPending:=vWPending+Records in selection([Contacts])
vTPending:=0
QUERY([Contacts];[Contacts]Facility=[Facility]FacilityCode;*)
QUERY([Contacts]; & ;[Contacts]CallDate=vDateFor;*)
QUERY([Contacts]; & ;[Contacts]Outcome="")
vTPending:=vTPending+Records in selection([Contacts])
//YTD
vYRes:=0
QUERY([Contacts];[Contacts]Facility=[Facility]FacilityCode;*)
QUERY([Contacts]; & ;[Contacts]OutComeDate>=[Facility]YearStartDate;*)
QUERY([Contacts]; & ;[Contacts]OutComeDate<=vDateFor;*)
QUERY([Contacts]; & ;[Contacts]CallDate>=[Facility]YearStartDate;*)
QUERY([Contacts]; & ;[Contacts]Outcome="Reserved")
vYRes:=vYRes+Records in selection([Contacts])
vMRes:=0
$emonth:=GetDate (31;Month of(vDateFor);Year of(vDateFor))
$smonth:=Date("1/"+String(Month of(vDateFor))+"/"+String(Year of(vDateFor)))
QUERY([Contacts];[Contacts]Facility=[Facility]FacilityCode;*)
QUERY([Contacts]; & ;[Contacts]OutComeDate>=$smonth;*)
QUERY([Contacts]; & ;[Contacts]OutComeDate<=vDateFor;*)
QUERY([Contacts]; & ;[Contacts]CallDate>=[Facility]YearStartDate;*)
QUERY([Contacts]; & ;[Contacts]Outcome="Reserved")
vMRes:=vMRes+Records in selection([Contacts])
vWRes:=0
$startweek:=[Facility]WeekEndDay-Abs(6)
$day:=Day number(vDateFor)
$diff:=$day-$startweek
$startweekdate:=vDateFor-$diff
QUERY([Contacts];[Contacts]Facility=[Facility]FacilityCode;*)
QUERY([Contacts]; & ;[Contacts]OutComeDate>=$startweekdate;*)
QUERY([Contacts]; & ;[Contacts]OutComeDate<=vDateFor;*)
QUERY([Contacts]; & ;[Contacts]CallDate>=[Facility]YearStartDate;*)
QUERY([Contacts]; & ;[Contacts]Outcome="Reserved")
vWRes:=vWRes+Records in selection([Contacts])
vTRes:=0
QUERY([Contacts];[Contacts]Facility=[Facility]FacilityCode;*)
QUERY([Contacts]; & ;[Contacts]OutComeDate=vDateFor;*)
QUERY([Contacts]; & ;[Contacts]CallDate>=[Facility]YearStartDate;*)
QUERY([Contacts]; & ;[Contacts]Outcome="Reserved")
vTRes:=vTRes+Records in selection([Contacts])
//Agreements
//YTD
vYAg:=0
QUERY([Contacts];[Contacts]Facility=[Facility]FacilityCode;*)
QUERY([Contacts]; & ;[Contacts]OutComeDate>=[Facility]YearStartDate;*)
QUERY([Contacts]; & ;[Contacts]OutComeDate<=vDateFor;*)
QUERY([Contacts]; & ;[Contacts]CallDate>=[Facility]YearStartDate;*)
QUERY([Contacts]; & ;[Contacts]Outcome="Rented")
vYAg:=vYAg+Records in selection([Contacts])
vMAg:=0
$emonth:=GetDate (31;Month of(vDateFor);Year of(vDateFor))
$smonth:=Date("1/"+String(Month of(vDateFor))+"/"+String(Year of(vDateFor)))
QUERY([Contacts];[Contacts]Facility=[Facility]FacilityCode;*)
QUERY([Contacts]; & ;[Contacts]OutComeDate>=$smonth;*)
QUERY([Contacts]; & ;[Contacts]CallDate<=vDateFor;*)
QUERY([Contacts]; & ;[Contacts]CallDate>=[Facility]YearStartDate;*)
QUERY([Contacts]; & ;[Contacts]Outcome="Rented")
vMAg:=vMAg+Records in selection([Contacts])
vWAg:=0
$startweek:=[Facility]WeekEndDay-Abs(6)
$day:=Day number(vDateFor)
$diff:=$day-$startweek
$startweekdate:=vDateFor-$diff
QUERY([Contacts];[Contacts]Facility=[Facility]FacilityCode;*)
QUERY([Contacts]; & ;[Contacts]OutComeDate>=$startweekdate;*)
QUERY([Contacts]; & ;[Contacts]OutComeDate<=vDateFor;*)
QUERY([Contacts]; & ;[Contacts]CallDate>=[Facility]YearStartDate;*)
QUERY([Contacts]; & ;[Contacts]Outcome="Rented")
vWAg:=vWAg+Records in selection([Contacts])
vTAg:=0
QUERY([Contacts];[Contacts]Facility=[Facility]FacilityCode;*)
QUERY([Contacts]; & ;[Contacts]OutComeDate=vDateFor;*)
QUERY([Contacts]; & ;[Contacts]CallDate>=[Facility]YearStartDate;*)
QUERY([Contacts]; & ;[Contacts]Outcome="Rented")
vTAg:=vTAg+Records in selection([Contacts])