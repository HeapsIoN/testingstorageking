//%attributes = {"lang":"en"} comment added and reserved by 4D.
//Changes in 10.0.42 - 00/00/00
//1. DM Updated the following methods: AU_Unzip, AU_Unzip2, AU_UnzipServer, AU_UpdateInstallerServer to fix FAST - CGI problem
//2. JCW added a method AU_CheckAfterUpdate to login, which notifies users and open release notes after storman has been automatically updated overnight
//3. JCW Changed AU_Backup to cold copy document of datafile instead of Backup. Which could interupt incremental backup settings
//4. JCW Modified CalcRentedValues and Activity - so the open windows had references and the progress boxes show "X of XX"
//5. JCW Commented AlertMessage (Get localized string("Income Received Report2")) in checkmatchmisc
//6. JCW Added CallBack to WSC_CheckForUpdates to login to send back build and build date
//7. JCW & DEK added 4D Winzip plugin
//8. JCW Updated AU_DownloadInstallServer, AU_Unzip, AU_UpdateInstallerServer to use Unzip component instead of PHP
//9. JCW Commented WSC_CheckForUpdates callback on login - will need to re add this after deploying SU build


//Changes in 10.0.41 - 00/00/00
//1. DM Updated the following methods: AU_Unzip, AU_Unzip2, AU_UnzipServer, AU_UpdateInstallerServer to fix FAST - CGI problem
//2. JCW added a method AU_CheckAfterUpdate to login, which notifies users and open release notes after storman has been automatically updated overnight


//Changes in 10.0.40 - 31/03/2017
//1. JCW & DEK Added line feed to daily autopay for KSS Advam export 
//2. JCW Modified WS_ConvertReservation2 to send back correct facility code and agreement number after conversion
//3. JCW modifed checkversion - DemoCreateMarketingTypes to not run for MV
//4. JCW modifed CheckVersion_AutoUpdatePath to not run for MV
//5. JCW added method CheckVersion_RevertCustPW to put customer passwords and phrases into notes, as we are reverting the password being masekd
//6. JCW modified logmonloop to not check for updates overnight, if not compiled mode
//7. JCW Disabled CheckVersion_CustWebPassword from CheckVersion
//8. JCW Added CheckVersion_RevertCustPW to create notes for password and passphrase
//9. DISABLED JCW Added 3 save records to Initialise because it was not saving the correct pdf printer
//10. JCW Added a method Overnight_CalculateCharts to create records overnight for storman reporting dashboards - (DISABLED)
//11. DEK fixed printing ref during daily, //sk letters ref//, notices.emailedit and daily print after WR BLOB TO AREA calling
//12. DEK changed AutoPayRentAmts to fix "Previously processed" for reopen daily summary report, fb10648
//13. JCW Added Overnight_CalculateCharts to logmongloopcode for overnight - (DISABLED)
//14. DEK changed DailyPrint to fix fb11273
//15. DEK fixed half month free issue for billing, DoBillNext ln 1173 
//16. DM Updated Incremental backup to work from Logmonloopcode instead from logmonServer method
//17. DM Added a check for number of records with photoid type before creating new records in checkversion
//18. DM Modified the incremental backup to trigger based on the last backup time.
//19. DM Updated CheckVersion_RevertCustPW to loop through the customers where password#passphrase
//20. DM Reversed back changes in SendMail for PHP
//21. DM Added ability to delete journal files after backup is completed
//22. DM Added extra logs into DeleteLogFiles method
//23. DM commented save records as causing problems with opening client on server without PDF creator (change number 9)


//Changes in 10.0.39 - 16/03/2017
//1.


//Changes in 10.0.38 - 15/03/2017
//1. DEK modified InvRecCode, [Facility]InvSetup to add std fotters NZ,AU,UK
//    also added svg footers to next forms:
//    [Trxs];"InvReceipt"
//    [Trxs];"InvReceiptNew"
//    [Trxs];"InvReceiptTwo"
//    [Trxs];"InvReceiptNewCash"
//    [Trxs];"InvReceiptTwoCash"
//    [Trxs];"InvReceiptFooter"
//    [Trxs];"InvReceiptFooterNew"
//    [Trxs];"InvReceiptUS"
//    [Trxs];"InvReceiptUSNew"
//    [Trxs];"InvReceiptUSTwo"
//2. DM Commented the confirm message for check status Ezidebit transactions
//3. JCW Modified Storman standalone to be able to update manually overnight
//4. JCW Modified text box on Agreement MoveIn form in moveout tab
//5. JCW Modified MoveOutCal line 32 alertmessage
//6. JCW added method ExportCreditClear for Supercheap, and added a check to TransactionExport if being run for supercheap
//7. JCW Added two new photo id types to DemoCreateMarketingTypes and 
//8. JCW modified DemoCreateMarketingTypes to work for both demo and facility passed to it
//9. DM Removed check for AC facilitycode part when you add/modify [AnalysisCode}Code
//10. DM Added a check for CCNo for WS_CustomerEdit
//11. DM Added a second tab for login into the Hub. [Facility]login
//12. DM Added extra logic to check facility code for hub users on Login button
//13. JCW Modified banking report dialog to display the date running the report for, instead of 'today'
//14. JCW Disabled check for updates on login
//15. JCW Modified auto updates to check, download and install overnight
//16. JCW Added new method GetDateName to return string of day or month
//17. JCW Added 'SACTY' to logmonloopcode for CheckDemoDates, this is going to be Auckland DemoCorp
//18. JCW & DEK Added line feed to daily autopay for KSS Advam export 


//Changes in 10.0.37 - 01/03/2017
//1. DM Removed logs for output parameters for WS_GetUnitsStatuses1 and WS_GetUnitsStatuses2
//2. DM Added a condition to DailyPreparenotices to speed up Daily processing
//3. DM Commented the code for retriving Letter contant and check for invalid references during daily 
//4. DM Speed up opening System Setup 
//5. DM Commented Evetnlog records deletion during Daily
//6. DEK added code to LogMonLoopCode to renew Demo data for <>sFacility="SDCTY"
//7. DM Added ability to generate prorate trx for WS_ConvertReservation1 and 2 for MI after NBD
//8. DM Commented AC query for surcharges during Daily Autopay as it is not required for CC and for all DD providers
//9. DM Added query for facility code for Advam DD
//10. DM Fixed Advam DD file date format


//Changes in 10.0.36 - 22/02/2017
//1. DM Updated KSSLog to show quotes and reservations
//2. DM Fixed Advam export file for DD to be the format DR,123-244,0022816000,10.00,KVSI Main Acc,KEZME000051288
//3. DEK modified customer.advamdetails, fb11260
//4. DM Added 2 new fields to [Unit] table stDigiAgmt and inDigiAgmt
//5. DM Updated WS contaning stDigiAgmt and inDigiAgmt
//6. DM added method on check version to set [Unit] stDigiAgmt and inDigiAgmt to [UnitHistory] if not ""
//7. DM Added new field for agreement table apDigiAgmtID for KSS
//8. DM Added WS_AddAgreement4, WS_ConvertReservation3 and WS_EditAgreement2 new input parameter WS_apDigAgmtID
//9. DEK fixed case with reservation, DailyA, fb10295
//10. DM Added new fields to Trxs table CreatedDate, CreatedTime, UpdatedDate, UpdatedTime
//11. DEK changed InvRecCode to fix 6&12mnths bug for multi pages Invoice report


//Changes in 10.0.35 - 15/02/17
//1. DEK created method MoveOutUnits and changed MoveOutCalc to fix fb11246
//2. DM Increased [Group]GroupID length from 5 to 10 characters


//Changes in 10.0.34 - 10/02/2017
//1. DM Fixed CardSave not able to upload CC profile
//2. DM Fixed Inventory Valuation Report for batch reporting
//3. DEK added ExportXeroInvoices2, made changes in ExportXeroAccounts &  ExportXeroInvoices for GB
//4. JCW modified checkversion_autoupdates to force all [Facility]DownloadFolders to end with folder seperator


//Changes in 10.0.33 - 02/02/2017
//1. DM Disabled CDR for hub users from the reports menu and shortcut "Ctrl + 1"
//2. DM Removed "Manager" from the list of the users
//3. DM Fixed display of the users for HUB to show only users for selected site
//4. JCW Modified fixemailblobs to always compress and save after changing
//5. JCW Changed [Letters].AgreemtInclNew form method to always open EmailForm for Billing.
//6. DAM Added new field [Facility]CCEncrypted
//7. DAM Disabled basic encryption method on during checkverison for version < 10024
//8. DAM Added decryption for basic method during check version for the site that we on SM version > 10024
//9. DAM updated CCEncrypt and CCDecrypt methods to check per facility data encryption
//10. JCW Fixed WSC_BillingSUSync to call WS_BillingSUSync instead of WS_CheckForUpdates
//11. DM Updated Decode256 and Encode256
//12. DM Updated CC upload button to mask CCNO
//13. DM Update the drop done for changing merchant provider to not delete CC info and clear only tokens
//14. DM Added method to encrypt ALL CCNo per facility
//15. DM Updated "Select all" "unselect" all buttons for urers on HUB
//16. DM Updated User Groups for the HUB
//17. JCW Changed how ws_convertreservation2 searches for facility
//18. JCW Fixed a lot of Start and End for API names, in WSLog
//19. JCW Added option to cash received analysis report to search by date banked instead of just trx date (DISABLED)
//20. DEK made changes in AU_ExtraFiles for Crypto auto update
//21. DEK added method AU_Unzip2 for Crypto auto update
//22. DEK added code to BPayGetPayments to show BPay report
//23. JCW & DEK modified all autoupdate methods to remove folder separator after [Facility]DownloadFolder as this string already ends with a 
//24. DEK -"Allow backup to default path" added records to PermSelection, PermUnselect, InitArrays, modified Facility.system backup tab


//Changes in 10.0.32 - 18/01/2017
//1. JCW changed @hub.storman.com to @hub.storman.com@ in set password and login button
//2. JCW created WS_CustomerLogin3 and added reservation unit type as output array
//3. JCW Resized billing invoice footer images on receipt forms
//4. JCW added final invoice footer for uk billing
//5. DM Fixed Ezidebit cash sale refund on a different date
//6. DM Updated the activity calcualtion after daily to 7 days, in a case end of a month to 32 days 
//7. JCW Changed login screen so logging in as adminsupport won't check for updates. But file>check for updates still will
//8. DEK created methods  Encode256, Decode256, pk256a
//9. DEK modified CC tokenizer with Encode256  and Decode256, use search key tokenizer or code256


//Changes in 10.0.31 - 15/01/2017
//
//SAME AS 10.0.30 BUT NEW NUMBER FOR AUTOUPDATES
//


//Changes in 10.0.30 - 11/01/2017
//1. DAM Enabled manual Direct Debit Credit Card processing for Ezidebit. [Trxs]ModReceipts "Use card on file" button
//2. DAM Enabled option "Process Ezidebit real time" in System setup Modules tab if Ezidebit selected
//3. DEK added code to DailyPrepNotices and field to noticeplan for SMS autopay
//4. DEK added code to Control & ControlCode to make search by SUFacilityID, fb11206
//5. DAM Commented code for deleting CC data after CC Upload for ALL providers
//6. JCW changed InvRecCode to replace 'UserCode' with 'Reference No' and hide the 'Unit Number & Support Plan' if STHOF
//7. DEK modified PrintInvRec, fb11229
//8. DAM Added code to clear email/letter contant when SMS AutoPay option is enabled.
//9. JCW Added bpay reference field to Reservation form, and check if blank on OK button.
//10. JCW Added SecureEncryptHash to WS_UserPermissions and WS_UserPermissions1 for [Userlogins]Password
//11. DAM Added checkactivity calculations for 32 days during daily. Method UpdateActivity
//12. JCW Updated Storman logos and images for billing (STHOF)
//13. JCW Reworded confirmtwo for [Notices]Autopay
//14. DAM Added activity calculation for del events for Trxs table
//15. DAM Added work around for insomninac to allow http connections (SK and NM) Method "On Web Authentication"
// added a check for "Insomniac" file in preferences folder
//16. DM Hiden CCUPLoad button if not adminsupport user, but allowed it for KSS
//17. DM Fixed stock inventory calculation for inventory packs for multiple receipts cash sales
//18. DM Updated WS_CreateReservation and WS_CreateReservation1 for updating Contact details if NO units available
//19. DM Fixed "Next" and "Previous" buttons for units not updating unithistory in a case UnitNo has been changed
//20. DM Fixed RCHistroy table not updating when chaning unittype
//21. DM Fixed cash sale refund for Ezidebit
//22. DM allowed to save refund on different date from the original transaction for cash sales. 23-12-16
//23. DM Fix problem when adding a unit doesn't take into account SM licence. Add button on UnitOut form 23-12-16
//24. DM Set the option "Apportion the prepaid rent" as visible for Billing
//25. DM auto enabled Send SMS if mobile number is entered and Send Emails if email address is enteted
//26. DM auto disbaled Send SMS if mobile number is cleared and Send Emails if email address is cleared
//27. DM Added 2 conditions for preventing the alertmessage when DD payment is processed. OK button for modreceipts form 
//28. JCW added 2 images to InvReceipt form
//29. JCW added 1 image to InvReceiptNew form
//30. JCW added case in InvRecCode to hide or show image based on Billing facility. AU UK or NZ.
//31. DM Updated Condition for ICR from > to >= in transaction query to include transactions DateTo = end of the month
//32. JCW Moved code to show/hide new invoice footers inside On Printing Footer of InvRecCode
//33. JCW changed billing logo to be normal without chrstimas hat

//Changes in 10.0.29 - 07/12/2016
//1. JCW Removed [facility]storercheck check, in logmonloop code for Billing SU Sync
//2. JCW added next record ([agreement]) to sendtosu and sendtosuretry
//3. DEK added WSC_SM_SU, WS_SM_SU, added code to WS_CheckLicence, Exportdataovernight(15th day)
//4. JCW added method SendToSUDatafileInfo and WSC_DatafileInfo
//5. DEK modified ReadSentinelGateLog to except blang gatecode and uses unit number instead
//6. JCW added gate system name and units in use to call back api


//Changes in 10.0.28 - 01/12/2016
//1. JCW Same build as below but different version number to test auto updates


//Changes in 10.0.27 - 01/12/2016
//1. JCW Enabled autoupdates


//Changes in 10.0.26 - 01/12/2016
//1. JCW Added new field to File Menu - "Show current release notes"
//2. DEK changed critical error text to "A minor error has occured, please contact Storman Support." in ErrorLog
//3. DEK added methods CustCodeRepair and CustCodeFindSpecial to fix nonstandard characters, changes written to log file
//4. DEK added WriteProcessList on ServerShutDown 
//5. JCW Added extra logging to SendToSU and SendToSURetry to find out why some facilities are not updating between Billing and SU
//6. JCW Modified everywhere SetFacility is called for automatic cupdates. If Billing, it will always use STHOF record.
//7. JCW Uncommented changes that disabled autoupdates for 10.0.25
//8. DEK added find unit to modify unit form, fb 11209
//9. DEK added code to Control, ControlCode to make available search by [Unit]SUFacilityID, fb11206 - not finished
//10. JCW Added an IF for WSC_BillingSUSync, WSC_DatafileInfo and WSC_CheckLicence to go to sandbox if current machine name = AFTERMATH
//11. Disabled auto updates


//Changes in 10.0.25 - 00/00/0000
//1. JCW Enabled Billing to SU sync for Storman Billing to Storman Users at the end of Daily Processingdaudail
//2. JCW Renamed Update Storman Program to Check Licence in File Menus


//Changes in 10.0.24 - 18/11/2016
//BUILD GIVEN TO LATAM SITES!!!!


//Changes in 10.0.24 - 18/11/2016
//1. DAM Modified Checkversion for CCNo encryption
//2. DAM Added log to see the number of encrypted CCs
//3. DAM Added encryption in ALL Places where [Customer]CCNo is used
//4. DAM Enabled all non token CC providers search for 10/11/16
//5. DAM Added variables for CC visibility to see last 4 characters
//6. DAM modified VisibilityCC for new field 
//7. DEK modified DailyPrint, Letters.DailyDisplay to fix double click on notes display form
//8. DEK modified [Contacts]ContactsIn btn code 'Convert to Agreement' for SK
//9. DEK added Hi-Tech to be printed for Calendar notes changes
//10. JCW Changed checkversion to encrypt CC if less than 10024
//11. JCW Modified InvRecCode and [Trxs]InReceiptNew form for latam sites - IF ([Facility]country="CO")
//12. DAM Set format for Real fields on MoveIn/CreditSaleIN/CreditSaleOut/UnitHistOut
//13. RNE Set format for Reservation/Misclcash/ModReceipts/ModCharges
//14. RNE Addede a new report in WS_GetReportdata: Advertisement Tracking - changed name to Marketing Analysis
//14. RNE Fixed bug logging Email for Ezidebit FB:11219


//Changes in 10.0.23 - 10/11/16
//1. JCW Changed URL for the welcome to storman button on demo form
//2. JCW Changed WSC_BillingSUSync to call live SU instead of sandbox
//3. DAM Fixed issues with sending email inv copy and statement for KSS


//Changes in 10.0.21 - 00/00/00
//1. JCW added new method DemoAddToCustomers - to update alternate customer details in demo datafiles
//2. JCW added new method DemoCreateBillPlans - to create a new billing plan in demo datafiles
//3. JCW added new method DemoCreateMarketingTypes - to create photo id types in demo datafiles
//4. JCW added new method DemoCreateAnalysisCodes - to create new analysis codes for ORC in demo datafiles
//5. JCW added new method DemoCreateOtherChgs - to create ORC in demo datafiles
//6. JCW added new method DemoCreateCustomers - to update photo id type, car, and rego in demo datafiles
//7. JCW added new method DemoCreateStaffPINs - to create staff pin record in demo datafile
//8. JCW removed lines that created staffpins in CreateTutorial method
//9. JCW added new method DemoCreatePictures - to import PIcture record in demo datafiles
//10. RNE added decreasing fontsize method in some reports only for MAC users,it gather all form objects and decrease its font size, Invoice, statements, most of reports are afftected
//11. DAM Fixed Reverce Multiple Period button not accounting for number of months to be billed.
//12. JCW added new method DemoCreateFacility - which at the moment imports the demo storage header and footer


//Changes in 10.0.20 - 14/10/2016
//1. JCW Added CheckVersion_EncryptCCs to CheckVersion
//2. JCW Reenabled WS_AddAgreement3.
//3. JCW Reenabled check for billingsync.txt for syncing from Billing to SU.
//4. JCW Modifed sms delivery report form, to check for Letters matching Agreements, Reservations and Contacts //FB11183
//5. JCW Added header to SMS Delivery Form method
//6. JCW Modified SendSMS to check for Agreements, Reservations and Contacts when creating Letter records.
//7. JCW Added tokenizer to encrypt credit cards
//8. DAM Added a file check for KSS JSON calls "KSStest.xml" - file name. Location <>sPreferencesPath
//9. JCW Increased [Customer]CCNo max length from 30 to 255 for tokenizer
//10. DAM Added TenantID from SiteLink to [Customer]Custom1. Method SiteLinkConv
//11. JCW Modified CC Upload button to decrypt credit numbers before uploading //FB11185 
//12. JCW Added text field to Agreement MoveIn form to decrypt on form load, and display last 4 digits of card number
//13. DAM Modifed ExportDataOvernight to change the export date formats. Found by All Secure moving to v10 FB11193
//14. DAM Modified WSC_NAB to define and set $HTTPResponseCode as text and blank //FB11172
//15. JCW Added method DemoCreateUnits
//16. JCW Added method DemoCreateUnitTypes
//17. JCW Added method DemoCreateAgreements
//18. DEK modified method checkdemodates
//19. JCW Modified input field on Agreement MoveIn form for CC Numbers


//Changes in 10.0.19 - 05/10/2016
//1. JCW Changed URLs for invisible buttons on Demo Welcome form.
//2. JCW Removed Localhost from CheckUpdate method


//Changes in 10.0.18 - 28/09/2016
//1. HRZ Modified CreditSaleOk and MoveInOk methods for create CRN if CRN=""
//2. HRZ Modified [Facility]System to show a button for creating CRN for all customers
//3. HRZ Modified CreateCustCode and CreateSalesCustomer methods - 11173
//4. DEK fixed multiple invoice attachments email fb11073
//5. DEK fixed Rent Increase Rule - Search Criteria in [Notices]RentIncreaseRules, fb 11146
//6. DEK added trace in Synclog for CalendarNotes manual changes, fb11145
//7. DEK fixed Days overdue on Agreement, added lines to ReCalc method, fb10715
//8. DEK fixed sales enquiry issue, [contacts]contactsout, fb10999
//9. (DISABLED) DEK fixed  the future overdue amount shows on invoice, InvRecCode, fb10077
//10. DAM Removed URL encoding for KSS cURL, Added only replace for ' string
//11. JCW Changed the open URL from my.storman.com to support.storman.com knowledgebase at the end of check version


//Changes in 10.0.17 - 14/09/2016
//1. JCW Reworded the text box about incremental backups in system setup
//2. DAM Set CCV field as NOT compulsory for Customer Upload to Ezidebit
//3. JCW increased [UserGroup]UserID max length from 5 to 10
//4. JCW increased [UserGroup]GroupID max length from 5 to 10
//5. JCW increased [Groups]GroupID max length from 5 to 10
//6. JCW Changed WS_ListUsers and WS_ListUsers1 to check if <>sHOFacility="@HUB" to only return data facility specific
//7. JCW added CheckVersion_UserGroupIDs to set all group, user and usergroup IDs to be facilitycode + id
//8. JCW disabled WS_UserPermissions and WS_UserPermissions1
//9. JCW created a new WS_UserPermissions2
//10. JCW Added two checks to ModUsers method, if HOF is HUB only display userlogins and groups for <>sFacility when loading Mdify Users and Groups form
//11. JCW Added new method GetBPayCRN_ALL to mass generate CRNs for all customers


//Changes in 10.0.15 - 06/09/2016
//1. HRZ Modified DeleteLogFiles and LogMonServer - 10776


//Changes in 10.0.15 - 05/09/2016
//1. DAM Upadated aUnit array for SKNationalReport as it was saving duplicates values
//2. HRZ Modified PerformBackup ,AU_Backup ,AutoBackup ,[Facility]System and LogMonServer - 10776


//Changes in 10.0.15 - 01/09/2016
//1. DAM Added a condition to search only for charges Form Method [Unit]NationalAccount
//2. DAM Added  coditions for [Trxs] table in order to make transactions set to confirmed. Method on "Ok" button [Trxs]CashSales. FB - 11160
//3. DAM Fixed issue with Ezidebit processing for old cash sale system
//4. DAM Disabled DATA log for WS_GetReportData as it was taking too long to generate the report.
//5. DEK fixed 11152, agreemen.movein/autopaynotice
//6. DAM Updated email regex to accept long domiain extenstions Test@test.financial. Method - CheckEmailAddr
//7. HRZ Added DeleteLogFiles for deleting log files  - 10776
//8. HRZ Modified [Notices]NoticesIn fixing Notices  issue


//Changes in 10.0.15 - 29/08/2016
//1. DAM Updated Unit Status Report. Changed Places for Action Required and Door Size. Forms [Unit]PrintUnitsline + [[Unit]PrintUnits. FB 11012
//2. HRZ Modified InsuranceRpt and WS_GetReportData for fixing Insurance Summary report - OLR
//3. HRZ Modified WS_GetReportData and SumDiscounts for fixing Summary od Discounts report - OLR
//4. JCW Modified GLExport for Xero export to allow user to select where to save either of the 3 export files.
//5. JCW Reworded requestdate and confirmthree for Xero export.


//Changes in 10.0.14 (4D v15) - 25/08/2016
//1. HRZ Modified AgedReceivablesRpt, CalcAgedDebtors, DailyActivity, RentRoll, WS_GetReportData methods and added new parameter for web call
//2. DAM Removed Logs used for debugging from GateAction and [Letters]DailyDisplay


//Changes in 10.0.14 (4D v14) - 00/00/00
//1. JCW Added an extra warning message when deleting a facility out of Storman Central.
//2. DAM Added new column "Months" to the Income Charged Report, only if printing with details and Apportion the prepaid rent enabled.
//3. HRZ Modified [Letter]DailyDisplay form for fixing 11005
//4. HRZ Modified [UnitType]UnitTypeIN for fixing FB - 11111
//5. DEK changed GLExport, added ExportXeroAccounts/Invoices/Statements - for export to Xero format
//6. DAM Enabled SQL replication for ALL tables in Storman
//7. DAM Disabled Xero in System setup - as it is not completed
//8. HRZ Modified [Notices]NoticesIn and [Notices]NoticesOut forms for fixing Notices Next and Previous buttons issue
//9. DAM Removed BillerCode from Invoces for Bpay
//10. JCW Renamed Customer Reference NUmber to BPAy Reference on agreement move in form
//11. DAM Added queries to ReCalcUnpaid as [Trxs] Selection is getting lost. It is part of LCSD fix.


//Changes in 10.0.14 (4D v15) - 12/08/16
//1. DAM Updated ICR with Billed in Advance option enabled to use Monthly basis calculation
//2. JCW Added two buttons to [Trxs]TransOut form, one to load old miscl form one to load new miscl form - FB11009
//3. DAM Added ability to export Income Charged Report Sumamry + Details into Excel (with a Billed in Advance option) - 11006
//4. DAM Added ability to customize Surcharge message for Ezidebit only [Facility]InvSurchargeMessage FB - 11008
//5. DAM Fixed issue with resetting Always allow access when receipt is added. Method - UpdateReceipt. FB 11055
//6. DAM Added work around for the issue with updating Rent/Insuracen for multiple units  FB - 10924
//7. HRZ Modified WS_GetReportData and added Rent Increased option - SOR
//8. DAM Fixed ICR export into Excle FB 11075
//9. DAM Fixed ICR issue with UnitNo length FB 11074
//10 DAM Reworded ICR for Billed in a advance rent FB 11071
//11. DAM Updated the purge days to keep to min 10 days
//12. DAM Added data purge for KSS Sites
//13. HRZ Modified WS_GetReportData , UnitStatus , WaivedLFRpt  and DailyA - SOR
//14. JCW Added WS_AddAgreement3 for Online MI with extra parameters to control sending notices email/sms and invoice
//15. DAM Commented the Syncrecordlog for DailyActivity at MV to speed up check activity at MV end
//16. DEK adde second parameter to WS_GetReportData/WS_RequestType="Arrears"/Arrears (True;WS_FacilityCode)
//17. HRZ Modified WS_GetReportData and SumCash - SOR
//18. DEK added exeption for invreccode to ErrorLog method, fb11134
//19. JCW Commented Lines 314-324 in LogMonServer. A method used to email weekly sales to Aaron and Stephen from Billing
//20. JCW Added check for Notes converting across from contact to reservation - lines 112-116 in ConvSaleBooking
//21. JCW Added check for Notes converting across from contact to agreement - lines 203-208 in ConvSaleAgreemt
//22. JCW Replaced logos for Storman One


//Changes in 10.0.13 (4D v15) - 07/07/16
//1. HRZ Added [Trxs]ProjectedRptDialog form - 10782
//2. HRZ Modified ProjectedChargesRpt method - 10782
//3. JCW Changed 'Hub.storman.com' to 'hub.storman.com' as product name has changed from Hub to hub. Throughout Storman. 
//4. HRZ Modified ProjectedChargesRpt method and return the code back- 10782
//5. HRZ Modified Create_sharedstrings - 10782
//6. HRZ Modified [Trxs]IncomeDialog - 10782
//7. RWFR Updated all text in Storman to replace legacy names for products
//8. RWFR Daily will now alert the user if there are no credit cards to process
//9. RWFR GetMD5 now uses native 4D command rather than plugin
//10. RWFR Ores.xml now requires root element of <ORes> - 10638
//11. DAM Added [Facility]InactiveRefundDays for KSS inactive refunds and set it to 30 on checkversion
//12. HRZ Modified [Trxs]IncomeDetail - 10782
//13. DAM Modified [Facility]Request Form method to add validation for Advam SMS
//14. DAM Added condition & ([Trxs]Description#"@Web@") to KSSInactiveCCbox for KSS
//15. DAM Added WS_AddAgreement2 for Online MI to set the deposit trx date to Agreement MI date FB - 10896
//16. RWFR GoCardless now allows for direct debit ID entry manually - 9314
//17. DAM Fix updating [UnitType]NoVacant for WS_AddAgreement,WS_AddAgreement1,WS_AddAgreement2 FB - 10917
//18. DEK added UserDailyMessage1a, UserDailyMessage1, UserDailyMessage2, UserActiveProcesses, UserActiveProcessesCheck, changed Daily, DailyA - FB10996
//19. DEK added URLEncode to KSScurl - fb10984



//Changes in 10.0.12 (4D v15) - 29/06/2016
//1. RWFR Converted all calls to SUV1 via webservice or TCP_Open to use port 443 and HTTPS (CheckUpdate still uses 19811 as it doesn't handle HTTPS)
//2. DEK added Dialog([Facility];"MessageClientsDaily") instead of [Facility];"MessageClients", changed [Facility]Login, added CheckDailyRuns, userlogoff - FB10926
//3. Modified CalcRentAdvanceNew method - 10782
//4. RWFR Added ErrorLog method as default Error Call to log any errors to an ErrorLog.txt
//5. RWFR SyncRecordLog now adds error to Windows Error Log
//6. RWFR Removed delays added for PDF995 & PDF-XChange - 10775
//7. RWFR & JCW modified end of CheckVersion to open correct release notes page per build.
//8. HRZ Added NewCalcRentAdvance method and odified IncomeCharged and [Trxs]IncomeCharged form- 10782


//Changes in 10.0.11 (4D v15) - 22/06/2016
//1. JCW removed space after comma Line614 of WS_AddAgreement1 - FB10898
//2. JCW Added a check if [Trxs]TotAmt=0 wont save record. Line624 of WS_AddAgreement1 - FB10897
//3. DEK changed unit.unitin & unithistory.unitincl - FB10515
//4. DEK changed AnalysisDisplay to display HOF analysis codes correctly for HOF - FB10853
//5. HRZ Modfied DailyA method - 10907
//6. DAM Ecxluded cash sale from KSS_30DaysRefund
//7. DEK changed EmailAutoCC - FB10061
//8. HRZ Modified CalcRentAdvanceNew and IncomeCharged methods and [Trxs]IncomeCharged and [Trxs]IncomeDialog forms - 10782
//9. JCW Added to line 619 of WS_CreateReservation1 [Contacts]FollowUpDate:=Current date+1 if the reservation fails. To reactivate the Contact.
//10. JCW Added to line 620 of WS_CreateReservation1 [Contacts]FollowUpDone:=False if the reservation fails. To reactivate the Contact.


//Changes in 10.0.10 (4D v15) - 15/06/2016
//1. HRZ Modified BPayGetPayments method and [GateLog]PrintGateErrors form - fixed 10910


//Changes in 10.0.10 (4D v15) - 13/06/2016
//1. HRZ Modified DailyProcess method - 10313


//Changes in 10.0.10 (4D v15) - 
//1. HRZ Modified BPayGetPayments method - fixed the description issue
//2. JCW Added new field to Customer table - [Customer]PassPhrase as text.
//3. JCW Renamed Security Password to Web Password and moved to page two of [Agreement]MoveIn form.
//4. JCW Renamed Security Password to Web Password and moved to page two of [Agreement]MoveInEdit form.
//5. JCW Renamed Security Password to Web Password and moved to page two of [Agreement]MoveInRR form.
//6. JCW Added [Customer]PassPhrase to [Customer]CustomerIn form Page 1.
//7. JCW Added [Customer]Password to [Customer]CustomerIn form Page 1.
//8. JCW Added [Customer]PassPhrase to [Reservation]ReservationIn form Page 1.
//9. JCW Added [Customer]Password to [Reservation]ReservationIn form Page 2.
//10. JCW Added [Customer]PassPhrase in place of [Customer]Password on [Agreement]MoveIn form Page 1.
//11. JCW Added [Customer]PassPhrase in place of [Customer]Password on [Agreement]MoveInEdit form Page 1.
//12. JCW Added [Customer]PassPhrase in place of [Customer]Password on [Agreement]MoveInRR form Page 1.
//13. JCW Added new method CheckVersion_CustWebPassword to check Version line 1055. To set PassPhrase = Password on upgrade to v10
//14. JCW & RWFR modified CheckVersion to correctly update version number.
//15. JCW & RWFR modified LogMon to not call SU if training.xml 
//16. JCW & RWFR modified CheckVersion to correctly saerch for Facility records before applying updates.
//17. DEK modified DailyA SAVE RECORD([Facility])- for [Facility]LastDaily, as can be requed by readpulse; fb10421


//Changes in 10.0.10 (4D v15) - 
//1.HRZ Modified UpdateAgreeBals method and added $winref and close window
//2. HRZ Modified [trxs]masspayment - fixed the runtime error issue - added GOTO OBJECT(bAccept)
//3. DEK fixed recept report(trxs.InvRecNarrow), fb10859 


//Changes in 10.0.10 (4D v15) - 07/06/2016
//1. DEK changed updatereceipts to fix Reset late-cycle on part payment, fb8925 
//2. DEK changed dailyA to fix if DD or CC default wasn't setup previosly to exclude SM restart, fb 10418
//3. HRZ Modified BPayGetPayments method - 10855


//Changes in 10.0.10 (4D v15) - 06/06/2016
//1. HRZ Modified BPayConfirmTwo form - 10886
//2. JCW Added RunFixMatchMisc which forces a rematch on all cash sales, but can also be used to write off old cash sales.


//Changes in 10.0.10 (4D v15) - 3/06/2016
//1. HRZ Modified BPayConfirmTwo form - 10879 & 10886 & 10882
//2. HRZ Modified [Trxs]MassPayment - 10883


//Changes in 10.0.10 (4D v15) - 2/06/2016
//1. HRZ Modified MoveInCode and [Trxs]ModReceipts- 10867 ; 10864 & 10869


//Changes in 10.0.9 (4D v15) - 01/06/2016
//1. HRZ Added BearBoxErrorCode method and Modified BearBox - 10290
//2. HRZ Modified MoveInCode and [Trxs]ModReceipts- 10852
//3. HRZ Modified [Facility]ImportDialog and added new Print button- 10781
//4. HRZ Modified BPayGetPayments and [Facility]ImportDialog, fixed the report issue - 10855
//5. HRZ Modified DailyA and change the line of close window- 10854
//6 HRZ Modified BPayGetPayments to fix transaction amount issue - 10856


//Changes in 10.0.8 (4D v15) -
//1. HRZ Modified AnalysisIn form - 10781
//2. HRZ Modified BankingRpt and DailyA methods - 10781
//3. HRZ Added BPayConfirmTwo method and BPayConfirmTwo forlm - 10830
//4. DAM Set sort order for the facility array <>asAllSiteCodes FB - 10832
//5. DAM Fixed Stock purchace issue FB - 10831 
//6. DEK added method CrLfRemove to remove carriage return an line feed characters, FB10839
//7. DAM & RWFR Modified WS_Sync and SyncRequestEvents to auto fix mismatch < 100
//8. HRZ Modified [Facility]ImportDialog, [Trxs]MassPayment and FindCust - 10781
//9. DEK modified WSC_EziCCRealtime,WSC_EziEditCustomerBankAccount, WSC_EziEditCustomerCreditCard to remove
//   CR and LF - fb10840 


//Changes in 10.0.8 (4D v15) - 18/05/2016
//1. HRZ Added Quit4DMethod method - 10805
//2. HRZ Modified [Facility]AlertMessage - 10805
//3. DAM Updated stage to www for KSS
//4. DAM Fixed issues with user login if site part of MV FB 10803
//5. DAM & HRZ added code for auto shut down to Log Monitor FB - 10805
//6. DAM Fixed entering digital/public keys 10828/10829

//Changes in 10.0.8 (4D v15) - 17/05/2016
//1. HRZ Modified StructureArray ; InvRecCode and StructureArray2 - 10781
//2. HRZ Modified [facility]system; [agreement]movein and [agreement]creditsalein - 10781
//3. HRZ Modified EzidebitPCI, [Trxs]InvReceipt; [Trxs]InvReceiptFooter; [Trxs]InvReceiptFooterNew; [Trxs]InvReceiptFooterTwo; [Trxs]InvReceiptNew; [Trxs]InvReceiptNewCash; [Trxs]InvReceiptTwo; [Trxs]InvReceiptTwoCash reports-10781
//4. HRZ Add GetBPayCRN and BPayGetPayments methods - 10781
//5. DAM Updated WSC_CheckMVUserPassword - 10803
//6. HRZ Modified BearBox method - 10291


//Changes in 10.0.7 (4D v15)
//1. HRZ Modified [Facility]System -10779
//2. HRZ Modified WSC_EziGetPaymentDetail and [Trxs]ModReceipts - 10780
//3. HRZ Modified [facility]GateSetup - 10287
//4. DAM removed Letters table from auto datapurge. Method LogMonPurge. FB 10788.


//Changes in 10.0.7 (4D v15) - 29/04/2016 - 12.35pm
//1. HRZ Modified On SQL Authentication Database Method to fix SSL ODBC issue
//2. DAM Updated Ezidebit URL to call live API instead of demo
//3. DAM Set values for Agreement RentAmt/NewRentAmt RegularRent/NewRegularRent for WS_AddAgreement1. WS_AddAgreement
//4. DAM Added code to update "AutoCCFailure" on startup for KSS sites - FB 10777

//Changes in 10.0.7 (4D v15) - 28/04/2016 - 8.43am
//1. HRZ Modified V10fix to fix BLOB issue. - 10409
//2. HRZ Modified WSC_ProcCardPresentAuthNet method - 10577
//3. DEK modified [Agreement]AutoPayRentAmts, DaillyA, DailyAutopay, dailySummary for dailySummaryReport - fb10648


//Changes in 10.0.6 (4D v15) - 26/04/2016 - 12:44pm
//1. HRZ Modified CC_Delete method and fixed Transaction Express CC delete issue - 10589
//2. HRZ Modified VisibiltyBankInfo method and fixed Transaction Express DD issue - 10586
//3. JCW Added FILTER EVENT to Analysis Code form - FB10632
//4. JCW Added FILTER EVENT to Notice Plans form - FB10632
//5. JCW Added FILTER EVENT to Rent Increase form - FB10632
//6. JCW Added FILTER EVENT to Find Customers and Agreements form - FB10632
//7. HRZ Modified VisibiltyBankInfo method and fixed Advam DD issue - 10583
//8. HRZ Modified WSC_ProcCardPresentAuthNet method and fixed AuthorizeNet CIM issue  - 10577
//9. DAM Added Read Write for [Customer] record when deleting profiles from system setup - 10601
//10. DEK modified exportMYOB to me matched with IncomeChargedReport - fb10320
//11. JCW Uncommented PrintRec on line 237 of ConfrimCloseBal - Could not see any reason for it being disabled - FB10624
//12. JCW Added check to ControlBig form, auto maximizing window for Mac builds.
//13. HRZ Modified InitArrays method and fixed the title and the description - 10637
//14. HRZ Modified MoveInOk and DD_Delete methods, and [Customer]NAB_DD form and fixed Transaction Express DD issue - 10586
//15. JCW Added a check to Daily Reprint Locklist form, for Portrait or Landscape - FB10620
//16. DAM Fixed System setup fields not showing correctly when switching from Transact Exress to Ezidebit 
//17. JCW Deleted and readded the [Trxs]Narration field on the Summary of Discounts report form - FB10626
//18. DEK added code in [letters]dailydisplay for web area MAC issue   - FB 9125
//19. HRZ Modified [Analysis]AnalysisOut - 10323
//20. HRZ Modified [MerchanPlan]MerchPlanOut - 10329
//21. HRZ Modified [Notices]NoticesOut - 10330
//22. HRZ Modified [Notices]RentRulesOut - 10331
//23. HRZ Modified [MarketingTypes]MarketingTypesOut - 10332
//24. HRZ Modified [Agreement]UnitHistOut - 10334
//25. HRZ Modified [Reservation]ReservationOut - 10335
//26. HRZ Modified [Contact]ContactOut - 10336
//27. HRZ Modified [Trxs]StockOut - 10337
//28. JCW Added Unload Record ([Trxs]) to the end of daily summary report - FB10618
//29. HRZ Modified ConfirmTwo and removed Filter Event
//30. RWFR ContactOut - changed Form Event=On Double Click to use On Open Detail for before modify record and On Close Detail for after modify record and allow the engine to handle the modify record itself - FB10603
//31. DEK modified [Agreement]AutoPayRentAmts for dailySummaryReport - fb10617

//Changes in 10.0.5 (4D v15) - 20/04/2016 - 3.00pm
//1. JCW Resized Digital and Public key buttons to fit text on Mac
//2. DAM Added code to update quote analysis code if it is switched to Rental Fee. Method QuoteSelectUT FB 10604
//3. DAM Fixed Usuccessfull report for CC upload button Advam Stored Pan. FB 10607
//4. DAM Updated method for deletion profile for one customer "Delete" button in System Setup for AdvamStored Pan FB 10608
//5. DAM Fixed Sord Order for Customer->Reservations. On load method for form event [Reservation]ReservationOut FB 10611
//6. DAM Modified sort order to be by date/time for menu Accounting -> Customer Receipts 
//7. HRZ Modified DD_Add method for fixing Nab CIM direct debit issue - 10594


//Changes in 10.0.5 (4D v15) - 18/06/2016 - 4.48pm
//1. DAM & HRZ Fixed Error message for Ezidebit DD Public Key on DD upload. - 10621


//Changes in 10.0.5 (4D v15) - 18/06/2016 - 1.49pm
//1. HRZ Modified CheckVersion line 1048 to fix the training.xml issue
//2. HRZ Modified Printform method - 10593  and 10576
//3. HRZ Modified CardSave ;DailyAutoPay ;ProcCreditCard ;SwipeCard ;WS_Insomniac_ConvertRes ;WS_Insomniac_MakeReservations ;WS_Insomniac_MoveIn 
//       WS_Insomniac_MoveIn1 ;WS_Insomniac_POSpurchase ;WS_Insomniac_ProcessCustPaym ;WS_Insomniac_ProcessUnitTransef ;WS_PE_Get_Balance ;WSC_EzidebitGetCustAccDetails 
//       WSC_EziGetCustomerFees methods and EziDebitPCI ; EziDebitPCI1 ; [Customer]EziCCDetails and [Facility]System forms - 10461
//4. DAM Updated EzidebitPCI form with all methods for Ezidebit Client side methods
//5. DAM Disabled EMDS when using "Use Card On file"
//6. JCW Renamed 'Unwanted' to 'v10fix_Unwated'
//7. JCW Removed compulsory step and added ConfirmTwo - FB10442
//7. JCW Modified v10fix_Unwated to handle MV and MS datafiles while not deleting ALL RECORDS - FB10414
//8. DAM Updated System setup to enabled Higlander all the time when Ezidebit selected - 10580
//9. DAM Updated DailyAutoPay to retrive correct surcharges
//10. HRZ Modified [Trxs]AddCharges form - 10575
//11. HRZ Modified [Trxs]ModeReceipts form - 10598
//12. JCW Transactions added from ManuallDD will have [Trxs]OriginalReceipt set to "MDD" //FB10215
//13. JCW Added a check in FormMethod ModReceipts line 1260 to not restore balances if receipt is added from ManuallDD //FB10215
//14. JCW Reworded alertmessage "Please select transactions to print invoices/receipts for, first" to "Please select a transaction!" in 3 places
//15. HRZ Modified WSC_GetInvNo method - 10479


//Changes in 10.0.5 (4D v15) - 
//1. JCW Added new field [Customer]MarketingOptOutInactive as boolean - FB10506
//2. JCW Added trickbox for [Customer]MarketingOptOutInactive, to Agreement, Customer, Credit Sale forms - FB10506
//3. HRZ Modified CheckActivityData method - 
//4. JCW adjusted WS_AddAgreement1 to correctly add the description of deposit transactions. 
//5. HRZ Modified DailyAutoPay method - 10396
//6. HRZ Modified [Facility]System.Variable40 - 8376
//7. HRZ Modified PermCategory , PermDescription and InitArrays methods- 10238


//Changes in 10.0.5 (4D v15) - 08/04/2016
//1. HRZ Modified CalSurChargeEzidebit method - 10434
//2. RWFR Fixed ResetCustPassword webservices not displaying customer name correctly
//3. JCW added method Overnight_AmtToBillCheck to LogMonLoopCode line 681 - to check for [Agreement]NoticeAmtToBill agreements in Billing.
//4. JCW modified v10fix to not delete everything in MV datafile.
//5. JCW Added colour text to active and inactive for ezidebit
//6. JCW Direct Debit merchant details now hide when 'none' is selected 
//7. DAM Added Read Write to RemoveOldGroups
//8. DAM ADD befoew WSC_EziGetCustomerFees ARRAY TEXT(WS_CCtype1;0) ARRAY REAL(WS_FixedFee1;0) ARRAY REAL(WS_PercentFee1;0)


//Changes in 10.0.5 (4D v15) - 19/03/2016
//1. JCW Unpublished/hidden insomniac methods from WSDL


//Changes in 10.0.5 (4D v15) - 08/03/2016
//1. DEK changed v10fix, line275, fb10413
//2. DEK created WS_GetEziFees, fb10429 
//3. DEK added records to <>asUserPermissions and <>asAccounting, fb 10428
//4. DEK added Account/Write off balance permission, fb10428
//5. DEK modified ReadFalconXTGateLog to write open door, fb10417
//6. DEK modified v10fix to truncate OLD_.... tables, added v10Fix_OldTables , fb10414
//7. DEK added code to remove "\n" to [Facility].System.{vCCKeyPub/vDDKeyB/vCCKeyB/vDDKeyB1}


//Changes in 10.0.5 (4D v15) - 08/03/2016
//1. HRZ Medified EzidebitPCI, [facility]System forms - 10411
//2. HRZ Added CalSurChargeEzidebit method - 10411
//3. HRZ Modified DailyAutoPay, CreateEziDebitHTMLCCICC , CreateEziDebitHTMLCCIDD , CreateEziDebitHTMLChargeCard , CreateEziDebitHTMLSaveCustomer and CreateEziDebitHTMLSaveCustomerA methods - 10411
//4. DAM Added Matchtrxs for new cash sale system, on Ok button FB 10286
//5. DAM Adjusted WS_UserPermissions to check and respond for locked records.
//6. HRZ Added WSC_EzidebitGetCustAccDetails method - 10411
//7. JCW Added new method to v10fix - RemoveOldGroups to delete UserGroups that do not match a Userlogin or Group.
//9. DEK fixed DailyA, line 578 error, lines 549/554 - fb10085 
//10. DEK fixed MoveOutCalc, message applied to move out page only - fb10378
//11. JCW added new method - Hub_UserPermissions
//12. JCW added button to ModifyUsers form 'Send to Hub' - hidden unless adminsupport
//13. JCW added trigger to Groups table for Storman Hub
//14. JCW added trigger to UserGroups table for Storman Hub
//15. JCW modified line 28 opn UserLogin trigger for Storman Hub
//16. JCW modified StructureArray2 to allow syncing of Groups, UserGroups, and UserLogins for Storman Hub
//17. JCW enabled triggerss for Groups, UserGroups, and UserLogins for Storman Hub
//18. JCW added check to ModUsers for Storman Hub *
//19. JCW defined vDate in SyncSendEvents for Storman Hub 
//20. JCW added check to SyncUpdateRecord Line 43 for Storman Hub *
//21. JCW added new WS method- WSC_HubGroups 
//22. JCW added new WS method- WSC_HubGroups 
//23. JCW added new WS method- WSC_HubUsers 
//24. JCW added new WS method- WS_HubUsers
//25. JCW added check to AddGroup button method for Storman Hub * Lines: 19 20 21 25 26 27
//26. RWFR ACN/ABN displays as appropriate now for customers - 9902
//27. DEK fixed multiple email addresses issue, [Message].MessageEdit.Field3, SendMail, [Message].MessageEdit.Variable2 - fb10422
//28. RWFR NAB, Advam & GoCardless now use [Facility]TestAccount setting


//Changes in 10.0.4 (4D v15) - 
//1. DAM Commented WSLog for WS_CheckMVUserPassW
//2. DAM Added a check for new contact for notehistory WS_AddContact for SK
//3. RWFR KSS30D now excludes National Accounts - 10359
//4. RWFR KSSReversal sets DateFrom/DateTo to be current date - 10314
//5. DAM Modified the way refunds work in case the last payment is AutoCC, KSS Only FB 10280
//6. DAM Modidfied "Driving licence" to "Drivers licence" in check version for a new category and for customer's selection FB 10104
//7. DAM Fixed KSS only permission issue for cash sales - FB 9336
//8. DAM Modified KSS 30 days inactive agreement to generate charge with AC "UNC" instead of refund.


//Changes in 10.0.4 (4D v15) - 22/02/2016
//1. RWFR RequestMessage now takes 8th parameter to set entry field to be of password type - 10360
//2. RWFR Changed change password to use new 8th parameter in Request Message - 10360
//3. JCW Added new method to set WebID to EmailAddress - checkversion line 1023
//4. JCW Added [Customer]WebID:=[Customer]EmailAddress - Customer Trigger line 32


//Changes in 10.0.3 (4D v15) - 16/02/2016
//1. DAM removed the Non token update from Storman CheckVersion
//2. DAM disabled saving CC account details if "None" is selected from drop down
//3. DAM Commented the loggings for WS_GetUnitTypes1
//4. DAM & RWFR chagned the way uset logins works if MV address @Hub.storman.com, ModUsers, button login, SetPassword  FB 10352.
//5. JCW Added Password hashing to checkversion

//Changes in 10.0.3 (4D v15) - 15/02/2016
//1. JCW Repaired Structure
//2. JCW Added window ref for CalcAgedDebtors running on server


//Changes in 10.0.2 (4D v15) - 09/02/2016
//1. HRZ Modified [agreement]transferunit variable 8 and 25 - 10297
//2. JCW Added a check to the login button, if username or password are entered blank - FB10306
//3. DAM Added logings to FixUntitled
//4. DAM Commented FixUntitled from Checkversion 
//5. DAM Added FixUntitled to Logmonloopcode to execute the same time as checkactivity
//6. DEK fixed issue by creating temporary  local array to keep original values 10285
//in next methods:
//
//AgreemtAbortCode 
//ContactsInCode 
//ConvSaleAgreemt 
//ConvSaleBooking 
//ConvToAgreemt 
//CreditSaleOk 
//Daily 
//DailyA -4
//DailyPrint -4
//EmailAutoCC -5
//EmailInvoice -4
//EmailReceipt 
//EmailStatement 
//FixInvNos  - in loop
//KSSUpgrade 
//MoveInCode 
//MoveInOk 
//OR_CreateResv -2
//PrintReceipt -4D
//PrintReceiptOption 
//PrintStatement 
//SiteLink ----
//WS_AddAgreement -2
//WS_AddContact 
//WS_BnSCreateRes 
//WS_BnSSendReceive 
//WS_ConvertContact 
//WS_ConvertReservation 
//WS_ConvSaleBooking 
//WS_CreateReservation -2
//WS_GeneratePDF -4
//WS_Isomniac_ConvertRes-1
//WS_Isomniac_makereservation
//WS_Isomniac_movein-2
//WS_Isomniac_movein1
//WS_OnlineOrder 
//WSC_GetInvN0-3
//Contacts.CallCentre
//Contacts.contactsiin
//Facility.System
//Reservation.reservationin
//Trxs.CashSale
//Trxs.Transout
//7.DEK, [Letters]Dailydisplay, added HTMLEdit contents control, 10142
//8. DEK , [Letters]Dailydisplay, added HTMLEdit contents control, 10318
//9. DAM Added WS_SecondCust to WS_CustomerEdit1 and WS_CustomerLogin1 - 10303
//10. DAM Updated CheckVersion for KSS to Apply Isurance Rates rounding = 50 - FB 10302
//11. RWFR Fixed version number display in floating window
//12. JCW Changed copyright to "Copyright Â© 2016 Storman Software Limited"


//Changes in 9.4.4 (4D v15) - 02/02/2016
//1. DAM Added a UnitType check for empty eQuotes - FB 9751
//2. JCW Added AU_Unzip and AU_AutoUpdater for Automatic updates - FB10273
//3. HRZ Modified BearBoxXML method - modified Storman username and password test account
//4. DEK added method KSSInactiveCCbox, modified LoadAnlsArrays to run that method - 10280
//5. DAM Added WS_RepeatValue ouput parameter to WS_GetIns - 10278
//6. HRZ Modified [Trxs]ModeReceipts form to set [Customer]Balance - (The code commented on 2/2/2016 for more testing) 10215
//7. HRZ Modified [Agreement]CreditSaleIn.Field10; change location of QUERY([Analysis];[Analysis]Code ... - 10243
//8. DEK -"Edit Customer name" added to InitArrays, modified MoveInCode, PermSelection, PermUnselect - 10282 
//9. DAM Added extra paramter for WS_CustomerLogin + WS_CusomerEdit - 10104


//Changes in 9.4.4 (4D v15) - 28/01/2016
//1. HRZ Modified CheckVersion method for fixing Non Token Merchants- 10269
//2. JCW Added autoupdate and unzip
//3. DAM Added extra check for <>aiNextInvNo during Logmonloopcode
//4. DAM Added extra check for WS_ActionText paramters in WS_UserPermissions
//5. DEK added new method KSS30D_Refund to calculate KSS refunds, referenced in DailyA, currently commented for code review, changes 10281


//Changes in 9.4.2 (4D v15) - 26/01/2016
//1. JCW Added encryption to Storman User passwords - FB10247
//1. JCW modified methods:
//       SetPassword
//       WS_ChangeMVUserPassW 
//       WSC_ChangeMVUserPassW
//1. JCW modified Forms:
//      [Facilty]Login 
//      [Facility]LoginChange
//      [UserLogins]UserLoginsIn
//2. DAM Adjusted WS_UserPermissions to check and respond for read only status
//3. DAM Adjusted WS_UserPermissions to check and respond for locked records.
//4. HRZ modified [facility]system to show Test account and WSC_AuthnetCreateCustProfTrx for proccessing test acccount - 10261
//5. HRZ modified [facility]system to show correct information for CardSave - 10261
//6. JCW Changed [Customer]Password on [Agreement]MoveIn form to be password field 


//Changes in 9.4.2 (4D v15) - 25/01/2016
//1. HRZ Modified [facility]system form; all Non Token merchants removed from dropdownlist, also CCAccDetails changed as well.  - 10245
//2. HRZ Modified CheckVersion; will set None for all unsupported merchants in the Facility table. - 10245
//3. DAM Adjusted WS_UserPermissions to check and respond for read only status FB 10258
//4. HRZ Modified PromotionsReport method - 10239
//5. DEK modified LogMonPurge, added read/write option and extra log record with details in case of locking - LOCKED BY() -10250


//Changes in 9.4.2 (4D v15) - 22/01/2016
//1. JCW Added $ProgressWin and CLOSE WINDOW to Aged Recev Report.
//2. JCW Added $ProgressWin and CLOSE WINDOW to Arrears Report.
//3. HRZ Modified GateAction and BearBoxXML methods - 10208
//4. HRZ Added RemoveSpace method - 10129
//5. HRZ Modified CreateCustCode method and [Contacts]ContactsIn form - 10129
//6. DAM Fixed Day to Bill FB 10155
//7. DEK fixed [Facility]system, security page, AutoShutdown option had wrong or duplicated with AutoQuit names - fb10251 
//8. HRZ Modified ProcCCAuthNet , ProcDDAuthNet methosds and [facility]system - 10221
//9. HRZ Modified[facility]system - 10114
//10. HRZ Modified below methods and forms:   - 10239
//UnitStatus ;Activity ;AgedReceivablesRpt ;AnticipatedOut ;Arrears ;;utoPayReport;BankingRpt ;Batch 
//CalcBalance ;CheckInQty;CheckMatch ;CheckRentChgSeq ;CustAnalysis ;CustomerBalances ;DailyA ;Download 
//GeneratePrimaryKeyValues ;GraphOccup ;GraphOccup141215 ;IncomeCharged ;IncomeReceived ;InsOwing 
//InsuranceRpt ;IORecReport ;KetStats;LengthStayRpt ;LienStatusRpt ;MatchTrxs ;MonthlyCompare ;MonthlyEnq 
//MonthlySum ;NinetyDayCash ;Occupancy ;Overdues ;PaidtoDateRpt ;PeriodReportsPrint ;PettyCashReport 
//PrintEvents2 ;PrintoutDel ;ProjectedChargesRpt ;PromotionsReport ;RetinAdvance;RentIncrRpt ;RentRoll 
//ReservationSum ;RevenueReport ;RVHistory ;SalesEnqRptOpt ;SchedDeposits ;SMSDeliveryReport ;StampDutyRpt 
//StokitemReport;StockTakeForm ;StockValueRpt ;SumCash ;SumCharges ;SumDiscounts ;Termination;ThreatLevelReport 
//UnderRented ;UnitTypeList ;VacancyRpt ;WaivedFRpt;[Activity]EditActivity;[Analysis]AnalysisOut;[ChartAccts]ChartAcctsOut
//[Customer]CustomerOut;[Facility]System;[InsuarnceRates]InsuranceRateOut;[Journal]JournalOut;[Unit]UnitOut
//11. DAM Fixed prorate calulation when changing day to bill for credit sales. [Agreement]CreditSaleIn.Field10 FB - 10243
//12. HRZ Modified [facility]system form; all Non Token merchants removed from dropdownlist, also CCAccDetails changed as well.  - 10245
//ARRAY TEXT(aDescriptions;16)   -> ARRAY TEXT(aDescriptions;11)
//aDescriptions{1}:="None"   -> aDescriptions{1}:="None"
//aDescriptions{2}:="Advam"   -> Removed
//aDescriptions{3}:="Advam StoredPAN"   -> aDescriptions{2}:="Advam StoredPAN"
//aDescriptions{4}:="AuthorizeNet"   -> Removed
//aDescriptions{5}:="AuthorizeNet CIM"   -> aDescriptions{3}:="AuthorizeNet CIM"
//aDescriptions{6}:="Cheq"   -> Removed
//aDescriptions{7}:="CTel"   -> Removed
//aDescriptions{8}:="EziDebit"   -> aDescriptions{4}:="EziDebit"
//aDescriptions{9}:="Payment Express"   -> aDescriptions{5}:="Payment Express"
//aDescriptions{10}:="NAB"   -> Removed
//aDescriptions{11}:="Verisign"   -> Removed
//aDescriptions{12}:="NAB CM"   -> aDescriptions{6}:="NAB CM"
//aDescriptions{13}:="BPOINT"   -> aDescriptions{7}:="BPOINT"
//aDescriptions{14}:="CardSave"   -> aDescriptions{8}:="CardSave"
//aDescriptions{15}:="Transaction Express"   -> aDescriptions{9}:="Transaction Express"
//aDescriptions{16}:="eMatters"   -> aDescriptions{10}:="eMatters"
//aDescriptions{17}:="Realex"    -> aDescriptions{11}:="Realex"
//13. DAM Modified WS_UserPermissions to check the tables locked - FB 10260




//Changes in 9.4.2 (4D v15) - 19/01/2016
//1. DAM Modified all Storman WS calls to be over https - FB 10105
//2. DEK added code to Batch & Facility.Graphs to fix batch print/email for Graf of Occupancy, fb 10200
//3. HRZ Modified VisibiltyBankInfo method - 10224
//4. HRZ Modified [Notices]NoticeIn form - 10227
//5. DAM Added paramter WS_RetrievingFacilityDetailsExt for Ezidebit fees - FB 10234
//6. DAM Modified WSC_Ezigetcustfees for WS_RetrievingFacilityDetailsExt - FB 10234


//Changes in 9.4.2 (4D v15) - 18/01/2016
//1. DAM Fixed WS_ConvertContact [Customer]FirstName:=[Contacts]Firstname. FB 10199
//2. JCW Adjusted WS_UserPermissions to create UserGroups correctly.
//3. HRZ Modified [Quote]ModQuote form - 10152
//4. DAM defined output paramters fro WS_GetIns
//5. DAM Added new WS_RetrievingFacilityDetailsExt - FB 10234
//6. HRZ Modified [Notices]EmailEdit and [Notices]NoticeIn forms - 10227
//7. JCW HTTPS port changed to 19812
//8. JCW HTTP port changed to 19818


//Changes in 9.4.2 (4D v15) - 13/01/2016
//1. JCW Added $WinRef and CLOSE WINDOW to Deposits Held Report.
//2. JCW Added $WinRef and CLOSE WINDOW to Paid to Date Report.


//Changes in 9.4.2 (4D v15) - 08/01/2016
//1. DAM Fixed WS_CustomerLogin to return correct number of units for Reservations. FB - 10150
//2. HRZ Modified BearBox Method - 10151
//3. HRZ Modified VisibiltyBankInfo method - 10224



//Changes in 9.4.2 (4D v15) - 06/01/2016
//1. DAM Fixed multiple places where Filter Event command is used. FB 10125
//2. DAM Fixed batch payment deletion for Ezidebit highlander, it requies the amount to delete the payment FB - 10128 
//3. DAM Modified BankingRep to set bankeddate to the report date if OnlineSale is enabled. FB - 10106


//Changes in 9.4.2 (4D v15) - 31/12/2015
//1. DAM Added secure connection check to On Web Authentication method - FB 10105
//2. HRZ Modified the LogMonLoopCode method - 10112
//3. DAM Modified display of [Analysis]OnlineSale field for receitps, only Ezidebit. FB - 10106
//4. DAM Modified WS_AddReceipt to set DateBanked to 00/00/00 and Confirmed to True in OnlineSale Field is enabled for AnalysisCode. FB - 10106


//Changes in 9.4.2 (4D v15) - 23/12/2015
//1. DAM & JCW Modified alertmessages for graph of occupancy - FB 10036
//2. DAM Added new fields [Custormer]IDType - FB 10104
//3. DAM on checkversion set [Custormer]IDType to "Driving licence" for all cust records that havelicenceno # "" FB 10104
//4. DAM on checkversion add new [Marketingtypes] record "FI" driving licence FB 10104
//5. DAM Modified [Agreement]CreditSale,MoveIn,MoveInEdit. [Reservation]ReservationIn - FB 10104
//6. DAM Added new category "FI" to types and categories FB 10104


//Changes in 9.4.1 (4D v15) - 22/12/2015
//1. HRZ Modified [facility]system - 9930
//2. DAM Removed "Create Chart" from "Select" menu CDR FB 10099
//3. DAM removed Form Event=on Resize for [Letters]Daily form method as it caused run time error for email component. FB 10080
//4. JCW Renamed LogMonRemoveEvtLog to LogMonPurge
//5. JCW LogMonPurge will now record all deletions in the synclog
//6. JCW LogMonPurge will ignore 0 days for deleting
//7. HRZ Modified ExportMYOB - 9922


//Changes in 9.4.1 (4D v15) - 21/12/2015
//1. JCW ValidTo date now jumps forward when ValidFrom date is changed, in Promotions form - FB9311
//2. JCW Added a check for Promotions being saved with ValidTo being earlier than ValidFrom - FB9311
//3. JCW Changed the way WS_CheckMVUserPW is used from login screen - FB10041
//4. HRZ Modified [facility]system - 9930
//5. JCW Modified LogMonRemoveEvtLog to also delete Letters and Unit Status Trx - FB9939
//6, JCW Changed copyright to "Copyright Â© 2015 Storman Software Limited"
//7. HRZ Modified [Agreement]MoveIn - 9941
//8. JCW Added $WinRef to all Open Window commants in DailyA. Lines: 533, 538, 760, 763, 775 - FB10085


//Changes in 9.4.1 (4D v15) - 15/12/2015
//1. HRZ Modified [facility]system - 9930
//2. HRZ Modified [facility]controlbig - 9973
//3. HRZ Modified SwipeCard method - 9998
//4. DAM Fixed DoProRataRent not taking into account the UnitType AC FB - 10046
//5. DAM Added support for Win 10 pdf. Methods: SelectPDFDoc,PrintSelection,Initialise, FB - 10059
//6. HRZ Modified ParseBackupPrefsFile and SaveBackupPrefsFile methods - 9951
//7. DEK modified [Facility]Graphs form and methods//fb10036


//Changes in 9.4.0 (4D v15) - 09/12/2015
//1.DEK added Project forms Chart_SVG, Chart_Insert_Field, fb10036
//2.DEK added methods SVG_Graphs8, SVG_Grpahs8_run, fb10036
//3.DEK modified method EmailIncode to fix bug 9995
//4. HRZ Modified ExportMYOB method - 9922
//5. HRZ Modified [Notices]MailMergeCompose, [Notices]NoticesIn, [Notices]RentIncrease, [contacts]callcenter forms - 9999
//6. HRZ Modified PrintSpecForm, LettersPrint, LettersInCode, DailyPrint, CreateTutorial, CreateTrxMoveOut methods - 9999


//Changes in 9.4.0 (4D v15) - 08/12/2015
//1. DAM Added check for processing CC refund not on the same day of the transaction FB 10027.
//2. JCW Added ne WS for reseting user password - WS_OLMResetPassword
//3. CW replaced C_STRING with C_TEXT FB10028
//4. CW replaced C_INTEGER with C_LONGINT FB10029
//5. CW replaced Array String with Array Text FB10030
//6. CW (RR) removed UseDraw FB10037
//7. CW replaced _o_compositing with 4096 in Open Window commands
//8. CW removed all _o_ before C_TEXT
//9. CW removed numbers in C_TEXT()
//10. HRZ Modified [Trxs]ModReceipts and SwipeCard - 10024
//11. HRZ Added MaskSMSLog method - 9931
//12. HRZ Modified SendReceiveHTTP and HTTP_ThincSMS - 9931
//13. HRZ Modified [facility]system - 9930
//14. HRZ Modified System method and [facility]system form - 9940


//Changes in 9.3.10 - 1/12/2015
//1. HRZ Modified the [Reservation]ReservationIn - 10019
//2. HRZ Modified the message from "Void (Cancel) card.." to "Void card for ..". [Trxs]ModReceipts and SwipeCard. FB 10011


//Changes in 9.3.10 - 30/11/2015
//1. HRZ Modified the [Agreement]MisclCash.button4 - 10019
//2. HRZ Modified the message from "Void (Cancel) card.." to "Void card for ..". [Trxs]ModReceipts. FB 10011

//Changes in 9.3.10 - 27/11/2015
//1. DAM Modified transaction amount paramter WSC_ProcessRefund from int to real. FB - 10025


//Changes in 9.3.10 - 27/11/2015
//1. HRZ Modified ProcCreditCard 
//2. DAM Modified the message from "Void (Cancel) card.." to "Void card for ..". Method SwipeCard. FB 10011
//3. HRZ Modified [Trxs]ModReceipts


//Changes in 9.3.9 - 25/11/2015
//1. DAM Fixed location of unithistory on the agreement info screen
//2. DAM Added a new condition for [UnitHistory]inDigiAgmtID and [UnitHistory]stDigiAgmtID for "00000000000000000000000000000000"
//3. HRZ Modified [Trxs]ModReceipts, ProcCreditCard, SwipeCard, MoveInCode, RealVaultPayerSetUpEdit, RealexAddCCDetails and RealexAuthRequest
//4. HRZ Modified RealexDeleteStoredCard, RealexEditCCDetails, RealexProcessingRefund, RealexRaisingCCPayment, RealexRefund and RealexVoidRequest
//5. HRZ Modified [Agreement]MisclCash form and ModReceipts method


//Changes in 9.3.9 - 25/11/2015
//1. HRZ Modified RealexAuthRequest method
//2. HRZ Modified ProcCreditCard method - 9932
//3. HRZ Added RealexRefund method
//4. HRZ Modified RealexDeleteStoredCard, RealexEditCCDetails and RealexProcessingRefund methods
//5. DAM Fixed surcharge message for DailyAutopay FB - 9980


//Changes in 9.3.9 - 24/11/2015
//1. HRZ Modified [Trxs]ModReceipts - 9937
//2. HRZ Modified RealexProcessingRefund method - 9987
//3. HRZ Modified RealexAuthRequest method
//4. HRZ Modified ProcCreditCard method - 9932


//Changes in 9.3.9 - 23/11/2015
//1. HRZ Modified BearBox method -9895
//2. HRZ Modified [Trxs]ModReceipts and ProcCreditCard method - 9937
//


//Changes in 9.3.9 - 19/11/2015
//1. HRZ Added RealexVoidRequest - 9937
//2. HRZ Modified RealexProcessingRefund - 9937
//3. HRZ Modified [Trxs]ModReceipts - 9987
//4. DAM Fixed Ezidebit payment status check for transactions with surcharges - FB 9991
//5. DAM Added a WS call to retrive customer fees for Ezidebit when printing an invoice to show the Surhcarge note - FB 9980
//6. HRZ Added RealexAuthRequest method




//Changes in 9.3.8 - 18/11/2015
//1. HRZ Modified [Trxs]ModReceipts - 9981
//2. HRZ Modified SendMail - 9956
//3. DAM Masked WS password for get report data - FB9982
//4. HRZ Modified SelectUnitA method and commented DigAgmtID:="", because it doesn't use anywhere



//Changes in 9.3.8 - 17/11/2015
//1. DAM Fixed note on Inv for Surcharges for Ezidebit - 9980
//2. HRZ modified [unit]AgreemtInclNew



//Changes in 9.3.8 - 16/11/2015
//1. HRZ Modified [Trxs]ModReceipts - 9926
//2. HRZ Modified [Customer]EziCCDetail  - 9978
//3. RWFR Use Card on File now shows surcharge value to 2 d.p.


//Changes in 9.3.8 - 16/11/2015
//1. RWFR SwipeCard method now clears credit card number variables at the end of the process
//2. RWFR Surcharge value in Process Card prompt now formats surcharge value to 2 d.p.
//3. DAM Added "Test Account" option for Ezidebit in system setup for "adminsupport" only FB - 9971
//4. DAM Updated all Ezidebit WSC to use [Facility]TestAccount FB - 9971


//Changes in 9.3.7 - 13/11/2015
//1. HRZ Modified [Trxs]ModReceipts - 9960
//2. JCW Modified CheckDemoDates to move all dates forward to be in line with current date - FB9944
//3. HRZ Modified [unit]AgreemtInclNew and [unit]Insurance methods- 9961
//4. HRZ Modified [Facility]System - 9970
//5. HRZ Modified [Customer]EziCCDetails - save UUID in the [Customer]custPaymentProfID
//6. DAM Added new field [Facility]TestAccount - 9971
//7. HRZ Modified [Trxs]ModReceipts - 9965
//8. DEK Modified [Facility]System - 9959


//Changes in 9.3.7 - 09/11/2015
//1.HRZ Modified ProCreditCard - 9924
//2. HRZ Modified [Trxs]ModReceipts and [facility]system forms - 9924
//3. HRZ Added new method RealexProcessingRefund- 9926
//4. HRZ Changed [Trxs]ModReceipts - 9926
//5. DEK changed ManualDD -9942
//6. DAM Set [PhotosCards]Size as indexed FB 9954
//7. HRZ Modified StructureArray and StructureArray2
//8. HRZ Modified UTP_WS_AddUnit, SelectUnitA, Proxy_WS_EditUnit,UTP_WS_EditUnit and UT_Web_Services methods
//9. HRZ Modified [Facility]System and adding Digital Agreement URL 
//10. HRZ Modefied UTP_WS_AddAgreement, UT_Web_Services, Test_WS_ AddAgreementStuff, UTP_WS_ ConvertReservation and Proxy_WS_ConvertReservation methods
//11. CW changed Minico's address to "10851 North Black Canyon Hwy, Suite 200, Phoenix, AZ 85029"
//12. HRZ Modified MaskCCLog method and addred Realex option 
//13. DEK Modified [Trxs].ModReceips.bload, fb9943,fb9946
//14. DEK DEK modified InvRecCode for csv output mexican file as requested, fb9904


//Changes in 9.3.7 - 09/11/2015
//1. JCW Renamed 'MYOB - Old version' and 'MYOB new Version' in dropdown system setup.
//2. HRZ Added new method, RealexRaisingCCPayment - 9924
//3. HRZ Added Currency Code to [facility]system - 9924
//4. HRZ Modified [trxs]modreciept - 9924
//5. DAM Modified WS_GetPricing to exlude Pack discount calculation for single analys-9914
//6. DAM Modified WS_OnlineOrder to save discount transactions


//Changes in 9.3.6 - 02/11/2015
//1. HRZ Modified ChequeReturn - 7154
//2. DAM Modified and improved loggings for SMS - 9588
//3. DAM Added SMSLog.txt for saving SMS logs - 9588
//4. HRZ Added new method, FilterNotesByDate - 2885
//5. HRZ Modified MoveIn, ReservationIn,CreditsaleIn, MoveInRR, MoveInEdit and ContactsIn forms. Added date range picker in Notes tab - 2885
//6. HRZ Added RealVaultPayerSetUp - 9897
//7. JCW Added a loop to check for PDF Creator in PrintSelection lines 79-92 and 103-116.
//8. JCW Added a loop to check for PDF Creator in SelectPDFDoc lines 25-38 and 78-91.
//9. JCW Added header to PrintSelection.
//10. JCW Added header to SelectPDFDoc.
//11. DEK DEK modified InvRecCode for csv output mexican file output
//12. DAM Added new WSC for retriving Ezidebit fees. Method WSC_EziGetCustomerFees - 9882
//13. DAM Added ability to retrive Ezidebit fees for "Enter Card". Method SwipeCard - 9882
//14. DAM Added ability to retrive Ezidebit fees for "Use Card on file" Real Time only. Method [Trxs].ModReceitps.bLoad - 9882
//15. HRZ Added UT_RealVaultPayerSetUp - 9897
//16. HRZ Rename RealVaultPayerSetUp to RealVaultPayerSetUpEdit
//17. DAM Added new Special Option 62 for Master Card. Methods DailyAutoPay, [Customer]EziCCDetails.Upload, 
//17. DAM [Customer]EziCCDetails.Upload1, [Facility]System.Variable6,[Trxs]ModReceipts.bLoad - 9882
//18. HRZ Added new method RealexAddCCDetails - 9900
//19. DAM Added a new message for DailyAutoPay processing for Ezidebit + Highlander enabled - 9882
//20. HRZ Added UT_RealexAddEditCCDetails - 9900
//21. HRZ Added new method RealexEditCCDetails - 9900
//22. DAM Hidden "Edit Surcharge" button for Analysis Codes
//23. HRZ Added new methods RealexDeleteStoredCard and UT_RealexDeleteStoredCard - 9898
//24. DAM Modified WS_GetPricing to exlude Pack discount calculation for single analysis code - 9914
//25. HRZ modified VisibilityCCInfo, CC_Add, [facility]system, [customer]Ezidebitupload, CC_Edit and CC_Delete - 9897
//26. DAM Fixed Notices not showing for Bulc Communication Wizard when 2 notices with the same name 
//27. DAM DAM Fixed logmon disabled when login in + during CC upload


//Changes in 9.3.6 - 29/10/2015
//1. DEK added lines to InvRecCode for panama-mexican csv to fix second line & field value
//2. HRZ Modified BearBoxXML - 9895
//3. DEK modified InvRecCode for csv output mexican file for discounts
//4. DEK modified InvRecCode for csv output mexican file output fot Type  taken from [Trxs]Drawer as requested
//5. HRZ Modified and addinf [Facility]EmailAddress to InvReceipt, InvReceiptFooter, InvReceiptFooterNew, InvReceiptFooterTwo, InvReceiptNew, InvReceiptNewCash, InvReceiptTwo, InvReceiptTwoCash, InvReceiptUS, InvReceiptUSNew, InvReceiptUSTwo - 8281


//Changes in 9.3.5 - 23/10/2015
//1. HRZ Added UT_WS_EditContact - 9784
//2. JCW Adjusted alert message for Insurance Rates, where start and and end value do not match.
//3. JCW Notice plans can now be opened, disabling the HTML. So email content can be added/edited as raw HTML code - FB9878
//4. JCW Added new field [Notices]DisableTinyMCE, as boolean - FB9878
//5. JCW Added a check for invalid characters in [Facility]HomePage - FB9851
//6. HRZ Modified CheckEmailAddr and [facility]system for checking URL - 9851


//Changes in 9.3.5 - 23/10/2015
//1. JCW Added check for SKBilling to OnStartup lines 523-529 - FB9877
//2. JCW Added check for SKBilling to OnServerStartup lines 65-71 - FB9877
//3. DAM Fixed New MoveIn button on dashboard opening existing agreement that is selected. Form [Facility]ControlBig.hihglight Button from 1-10. FB - 9579


//Changes in 9.3.4 - 22/10/2015
//1. HRZ Modified the StructureArray2 methods - 8585
//2. HRZ Modified Facility and Accounting tabs in [Facility]System and added two new fields- 8585
//3. HRZ Added new methods (PrintCreditReceipt and InvCreditRecCode) - 8585 
//4. HRZ Modified CreditSaleOK, WS_GetInvNo, WSc_GetInvNo, InvoiceNumber  - 8585


//Changes in 9.3.4 - 20/10/2015
//1. DAM Modified WS_AddReceipt for Ezidebit refunds. 


//Changes in 9.3.3 - 20/10/2015
//1. DAM Fixed processing refunds for Reservations "Use card on file" - Method [Reservation]ReservationIn - FB 9862
//2. DAM Fixed alermessage for refunds batch transactions. Method SwipeCard FB - 9858
//3. DAM Fixed Storman not allowing Ezidebit refunds for customers with no profile [Trxs]ModReceipts -  9865
//4. DAM Fixed Runtime error for Real Time token payments failing
//5. DAM Fixed Storman picks wrong Analysis Code for refunds Method "SwipeCard"- FB 9855
//6. DAM Fixed Storman is not setting Confirmed to True for Refunds "Set datebanked to today" enabled - FB 9863


//Changes in 9.3.3 - 19/10/2015
//1. JCW Modified the Projected Charges Report to always exclude tax. Lines 190 & 194 - FB9849
//2. JCW Added header to Projected Charges Report.
//3. DAM enabled Refunds for Ezidebit


//Changes in 9.3.3 - 16/10/2015
//1. JCW Modified [Agreement]MisclCash form method to display â¢ on transactions that have not yet been confirmed.
//2. DEK modified  [Facility].Request & [Notices].NoticesIn methods to add extra references to SMS - FB 9840
//3. DEK modified  CheckUpdate & StormanUpdate2 methods to avoid second digit truncation of [Facility]UseGateSys - FB 9848
//4. DEK modified StormanUpdate at StorpayUsers to send letter instead of digits- FB 9848


//Changes in 9.3.3 - 13/10/2015
//1. JCW Days late field and title in Agreement Screen can now be hidden - FB8839
//   Forms: MoveIn & MoveInEdit
//   Methods: MoveInCode Lines 2197-2200 & MoveInEdit Lines 1239-1248
//2. DAM Fixed Customer balance was getting update to the agreement balance which caused issues for customers with multiple agreements, method Recalc - FB9820
//3. DAM Fixed problem processing Ezidebit with Email AutoCC enabled causing losing agreement record. Method: InvRecCode
//4. DAM Moved [Customer] and [Agreement] balance calculation for Real time token processing before sending emails to fix invoice FB9837


//Changes in 9.3.2 - 12/10/2015
//1. JCW Added new field. [Customer]AltStatus, as boolean. - FB8473 
//2. JCW Added [Customer]AltStatus to AgremeentMoveIn form. True = Secondary Customer False=Alternative Contact-FB8473
//3. JCW Added [Customer]AltStatus to ReservationmoveIn form. True = Secondary Customer False = Alternative Contact - FB8473
//4. DEK - added round function to calculation in [Trx].ModReceipts - fb9760
//5. DEK - ProcessStormanHTMLTags, created temporary character for Signoff field to update it later with <br> in HTML  - fb9773
//6. DAM Added new field [Facility]Highlander for Ezidebit - 9819
//7. DAM Added [Facility]Highlander to system setup for Ezidebit and visible only for adminsupport - 9819
//8. DAM Modified all WSC for Ezidebit to call 3-5 API - 9819
//9. DAM Modified logs when calling WSC Ezidebit to be able to identify if it is highlander - 9819


//Changes in 9.3.2 - 07/10/2015
//1. DEK added lines to InvRecCode for panama-mexican csv output as customer required 


//Changes in 9.3.2 - 06/10/2015
//1. JCW added logging when an Agreement's late cycle is reset. Line 428 of DailyA


//Changes in 9.3.2 - 2/10/2015  **OFFICAL RELEASE**
//1. JCW added logging to CC upload button, to record number of success and fail CC uploads.


//Changes in 9.3.2 - 30/09/2015
//1. RWFR Fixed additional insurance charges for an agreement not showing paid amount - 8595
//2. JCW removed alertmessages from unitincl.field 3 and field4 - FB9779


//Changes in 9.3.2 - 23/09/2015
//1. JCW Removed [Contacts]ResDeposit from Contact form, as now unused. FB9774
//2. JCW Copied new KeyStatsCalcSK from Denis.


//Changes in 9.3.2 - 21/09/2015
//1. JCW Added a check in WS_AddReceiptTrx for Online Orders. To set them as complete. Line 274
//2. JCW Added Email facility when an OnlineOrder is created.
//3. JCW Uncommented an if statement that was causing the OK button in MV menu to not work correctly.


//Changes in 9.3.2 - 17/9/2015
//1. HRZ Modified MoveInOk (Line 404) and [Reservation].ReservationIN - 8762


//Changes in 9.3.2 - 16/09/2015
//1. JCW changed MoveInCode to use $Agree instead of $Customer - FB9764
//2. JCW Added field for Onine Orders [Agreement]OrderID as text.
//3. JCW Removed 'boxshop' from CheckOnlineOrders, now uses [Agreement]OrderID.
//4. JCW WS_AddReceipt will now check and complete an order, if created as Online Order.
//5. JCW WS_OnlineOrder sets Customer Password as CustomerCode for Storpay.


//Changes in 9.3.2 - 10/09/2015
//1. HRZ Modified eMattersBillSmartAddEditDel, UT_eMattersBillSmart, [Customer]AdvamDetails and [Facility]System and added new parameter C_Boolean($11) - 9750
//2. DAM Modified SendMail to avoid the error when sending multiple emails.
//3. JCW Added CheckOnlineOrders to DailyA line 129.
//4. JCW Created new method CheckOnlineOrders to check for incomplete boxshop orders before daily processing.
//5. JCW Added field for Online Orders [Agreement]OrderComplete as boolean. 
//6. JCW Added button on Credit Sale form to cancel and delete incomplete online orders.
//7. DAM Fixed runtime error for cardsave reservations - 9726


//Changes in 9.3.2 - 09/09/2015
//1. HRZ Modified [Facility]System, enabaled CC Upload button - 9750


//Changes in 9.3.2 - 08/09/2015
//1. JCW added new table [OnlineOrder].
//2. DAM Modified KeyStatCalc for SK to show correct discounts
//3. HRZ Modified GLExport and add setfacility for fixinf MYOB issue


//Changes in 9.3.2 - 07/09/2015
//1. DAM + RWFR modifed UpdateReceipt to update [Unit]StatusChange only when Unit status has changed - 9725
//2. HRZ modified InitSites line 169
//3. HRZ modified exportMYOB - 9706
//4. DAM Added Automatic checkactivity calculation for SK sites when chagning option for UnitType exlusion


//Changes in 9.3.2 - 04/09/2015
//1. DAM Updated WS_GetReportData to retrive SK format KSR
//2. HRZ Added UT_WS_AnalysisDetails
//3. HRZ Modified UT_Web_Services
//4. DAM Added new fields to Activity table [Activity]OtherDiscArea, [Activity]OtherDiscUnitNo
//5. DAM Modified WSC_AddReceiptTrx to be able to call current WS_AddReceipt


//Changes in 9.3.2 - 03/09/2015
//1. HRZ Modified the LoadBackupPrefs lines 11 and 12 to fix 9585
//2. HRZ Modified the Compiler_Web and the UT_WS_RetrievingFacilityDetails - added new output parameter WS_UserCode
//3. HRZ Modified the StructureArray , added new field to analysis - 9716

//Changes in 9.3.2 - 02/09/2015
//1. RWFR Fixed reservations & eMatters losing customer record
//2. RWFR eMatters stores masked credit card details - 9710
//3. RWFR eMatters fixed $ReseMatters not being declared before processing
//4. RWFR Fixed title breaking when exiting cash sales - 9576
//5. DAM Added New field to facility table UTExludeKeyStat, added new option in system setup - only SK
//6. DAM Disabled Deletion of reservations for all SK sites.

//Changes in 9.3.2 - 01/09/2015
//1. HRZ Modified ExportMYOB and fix issue related to new version of the MYOB - 9702
//2. HRZ Modified GLExport method and [Facility]AcctgSystem form and fix issue related to new version of the MYOB - 9706
//3. HRZ added CheckOnlineReservation method - 9707
//4. DAM Modified how CardSave works
//5. HRZ Modified the DailyA method - 9707
//6. DAM Added new fields to [Activity] OtherRentedUnitNo, OtherRentedOccupArea, OtherRentedValue, OtherRentedValActual
//7. HRZ Added UT_Ws_listusers for testing Ws_listusers
//8. HRZ Modified UT_WEB_SERVICES for testing Ws_listusers
//9. DAM Added KeyStat calculation for SK + new form for KSR


//Changes in 9.3.2 - 31/08/2015
//1. DAM Added Bpoint alertmessage to show when triggering an error
//2. RWFR Fixed display of discount amount in add charges screen - 9551
//3. RWFR Quotes will not save if no analysis code or size selected - 9700
//4. RWFR vCustNextMatch is now loaded from NextCashSaleNo array - 9640
//5. DAM Fixed Units not shown for CCUpload button - 9599
//6. RWFR Fixed bAbortArray not being set at start of ModReceipt - 9659
//7. HRZ Modified proxy_WS_ConvertContact and UT_Web_Services - 9693

//Changes in 9.3.2 - 28/08/2015
//1. JCW added: WS_CTOutcome (string), WS_CTOutcomeDate (date), WS_CTFollowUpDate (date). To WS_AddContact for new Online Reservations module.
//2. DAM Added a check for digital key for uploading AU Post file. Won't upload for 7D71C831-5069-466B-7E20-7534958F97CD
//3. HRZ Modified ProcCreditCard method If ([Customer]CustomerCode="@MISCL") to set customer name - 9660
//4. HRZ Modified CC_Delete method replace [Customer]CustomerCode with [Customer]customerProfileID - 9657
//5. HRZ Modified [Trxs]ModReceipts.bLoad to save [Agreement]BalanceOwing, [Reservation]Balance and [Customer]Balance - 9669


//Changes in 9.3.2 - 26/08/2015
//1. DAM Added Rent Amount to export file for PA
//2. DAM Fixed system not picking up correct analysis code - 9649
//3. DAM Fixed Deletion "W" transactions not workind for Direct Debit Ezidebit transactions - 9615
//4. DAM Fixed Agreement record is getting lost when printing report - 9599
//5. JCW Added new field on Analysis table. [Analysis]OnlineSale as boolean to handle analysis codes that can be sold through boxshop.
//6. JCW Added new WS Method. WS_GetBoxShop to retrieve all analysis codes that have been enabled for online sale. 
//7. DEK Prorate calculation changed when unit moving out, by Eugene, fb 7958
//8. HRZ Added WS_SKCallURL method For online Reservations we need  call to https://storageking.com.au/storpaynotify.php?reservation=<reservationid>


//Changes in 9.3.2 - 20/08/2015
//1. DAM removed error description for all WS


//Changes in 9.3.2 - 19/08/2015
//1. DAM changed occupany report to not exclude any unit types that might be set to exclude from key stats.
//2. JCW added alert message, which setting a Unit Type to exclude from KSR.


//Changes in 9.3.2 - 18/08/2015
//1. JCW Added new field [UnitType]ExcludeReports as boolean.


//Changes in 9.3.2 -17/08/2015 *CODE ROLL BACK*
//1. JCW Copied all WS_A, WS_C, WS_D, WS_E, WS_G, WS_R, WS_S, WS_U, methods back to this code
//2. JCW Coped invisible button into eventlog form.
//3. JCW Added '%' to Analysis form.
//4. HRZ Added UT_WS_RetrievingFacilityDetails method - 9626
//5. HRZ Modified the PeriodReports and the [Facility]SelectEmails - Change inter process arrays with global arrays - 8978
//6. Modified the ManualDD and fix If (Records in selection([Analysis])=1) issue
//7. JCW Added all WS unit tests
//8. HRZ Modified the [Trxs]ModReceipts - 9401
//9. HRZ Modified the ManualDD and fix If (Records in selection([Analysis])=1) issue
//10. HRZ Added gError="Cancel" for fixing cancle button issue in ManualDD and [trxs].Modreceipt
//11. HRZ HRZ Modiffied [TRXS].ModReceipts.Button3EnterDD and ManualDD for fixing 9529
//12. HRZ Modified WS_GetReportData method and added : WS_WebServicePassword, WS_ORErrorCode, WS_ORErrorDescription and WS_ORSuccess-9639
//13. HRZ Fixed [customer].Ezidddetails , added [Customer]DDProfileID:="" in the Upload button - 9530
//14. HRZ Modified the [EventLog]PrintEvents form and added If ([EventLog]EventTable#0) .... - 9591
//15. HRZ Modified the EmailAutoCC line 651 - 9103
//16. HRZ Fixed InitArrays (line 417) - g changed with cash - 9485
//17. The length of the SeqNo in the [TRXS]InVReceipt and [TRXS]InvReceiptFooter increased as much as possible - 9361
//18. HRZ Modified [Reservation].Reservation, line 943, added vOriginalReceipt:=[Trxs]OriginalReceipt - 9316
//19. DAM Added Up/Down Rounding method for all RoundAmt Insurance calculation-8689
//20. DAM Added a check for Bank account details before uploading Ezidebit profile-9565
//21. DAM Added chagnes to the export files for Panama
//22. DAM Fixed Cash sales surcharges-9617
//23. DAM Disabled refunds for Ezidebit in Storman Agreements/Credit Sales/Reservations/Refunds
//24. DAM Comment sending emails to BnS customers when converting Reservation to Agreement
//25. DAM Added code for"PA"to be able to send email when processing CC-9603
//26. DAM Added new WS Error code for WS_GetAgreementInfo-Storpay
//27. DAM Disabled"Cancel"button for Ezidebit CC and DD"Edit", also added validate transactions to both buttons
//28. DAM Fixed Surcharges for DD if run daily for multiple agreements-9581
//29. DAM Fixed recalc activity date not updating during daily for multistes-9554
//30. DAM Fixed"CC Upload"button not updating [Customer]Special Option correctly
//31. DAM Added notes for failed Ezidebit Real Time payments-9560
//32. DAM Fixed"Show Rented Units"option doesn't display all units-9543
//33. DAM Added new field [Customer]SpecialOption to store card type-9544
//34. DAM Uploading new profile manually/batched for Ezdebit saves special option against customer records-9545/9548
//35. DAM Processing manually Ezidebit transactions uses Special Option from Customer reco
//36. DAM Processing Ezidebit transactions during daily now use Special Option from Custom-9550/9549
//37. DAM Fixed deletion"W"Ezidebit payment is not disabeling"cancel"button-9541
//38. DAM DateBanked is not getting update for Ezidebit if"Set bankeddate to today"is enabled-9478
//39. DAM Fixed Failed Surcharges not generated 9492/9491
//40. DAM Added SMTP import from NSD form-9471
//41. DAM Added new alertmesage when CC info is deleted for when using"CC Upload"button-9433
//42. DAM Fixed CustomerProfileID and CustomerPaymentProfileID getting cleared with CC Inf"CC Upload"button
//43. DAM Added failed Surcharges for Manual DD-9436
//44. RWFR Fixed SMS & Quote in contacts disabling wrong cancel button-9572
//45. RWFR Cash sales must have a receipt greater than$0.00 now-9577
//46. RWFR Fixed SKBilling ignoring free periods when calculating last bill date-8717
//47. RWFR Fixed additional merchandise discount plans not checking transactions-9567
//48. RWFR Added new web service WS_GetSurcharges for Storpay-9574
//49. RWFR Fixed WS_AddReceiptTrx picking up inactive analysis codes
//50. RWFR WS_GetAgreementInfo & WS_GetReservationInfo now require web service password-9519
//51. RWFR WS_AddReceiptTrx now requires web services password
//52. RWFR Fixed cash sale customer details not being saved to receipts-9482
//53. RWFR Fixed checking for cash sale date not always starting from first record-9483
//54. RWFR When validating transaction mid-agreement it force saves the agreement record-9552
//55. RWFR Modify Cash Sale permission correctly works on new cash sale form-9356
//56. RWFR Delete Cash Sale permission correctly works on new cash sale form-9355
//57. RWFR Fixed merchandise discount transaction creation not correctly cycling through -9389
//58. RWFFR If required to change password when logging in and you abort it will now forc-9475
//59. DAM Commented logaction in Mailsend as it triggers an alertmessage during processing payment for customers - 9643
//60. RWFR Fixed SKBilling ignoring free periods when calculating last bill date-8717 Cong
//61. RWFR Fixed additional merchandise discount plans not checking transactions-9567 Cong
//62. RWFR Fixed merchandise discount transaction creation not correctly cycling through -9389 Cong
//63. RWFR Fixed RemoveUnit not taking account of billing plan discount in actual calcul-7958 Eugene
//64. RWFR Fixed bulk discounts not getting rounded to 2 d.p.-9551 Eugene






//Changes in 9.3.2 -
//1. DAM Added failed Surcharges for Manual DD - 9436


//Changes in 9.3.2 - 8/7/2015
//1. DAM Fixed Modifying analysis code and amount for existing cash sale receipt with surcharges
//2. DAM Added Failed surcharges to be generated during daily processing for CC - 9428
//3. HRZ Fixed PeriodReportsPrint and modified read and write for [message] and set correct value for bOk - 9402
//4. DAM Added Failed surcharges to be generated during daily processing for DD Ezidebit ONLY - 9429

//Changes in 9.3.2 - 7/7/2015
//1. HRZ Modified DD Add for fixing bug 9439
//2. DAM Fixed saving transaction records when the payment is declied/failed.
//3. DAM Disabled "Cancel" button when there is a failed surcharge on reservations
//4. RWFR Cash sale form (new) will not save unless all transaction dates are the same - 9309
//5. HRZ Modified [Trxs]trnsOut,[Agreement]CreditSaleOut [Agreement]CreditSaleIn for  fixing MoveInCall issue
//6. HRZ Modified VisibilityCCInfo for fixing eMatters issue (Line 138) - 9102
//7. HRZ change position of VisibilityCCInfo and VisibiltyBankInfo in [Reservation]ReservationIn - 9102
//8. DAM Fixed agreement loosing [Unit] after UpdateReceipt - 9473


//Changes in 9.3.2 - 3/7/2015
//1. DAM Hidden "Use Card on File" + "Enter Card" buttons when AgreeNo or CustomerCode are "" - 9407. Method [Trxs]ModReceipts at 30/06/15
//2. DAM Added a message for Surhcarge amount change if receipt amount is < than fixed surcharge amount - 9417. Method GetPlusMinusValue
//3. DAM Fixed Cash Sale surcharge for modifying receipt amount by adding match number to new surcharge - 9421. Method [Trxs]ModReceipt
//4. DAM Added ability to enter Failed Surcharges into Storman on [Analysis]AnalysisIn form - 9427
//5. HRZ Modified CheckVersion, Setup and CreateTutorial for fixinf PR - 9329
//6. HRZ Added new method - ManualDD - 9422
//7. DAM Added genearation of failed surchage transaction for Ezidebit real time - 
//8. DAM Added genearation of failed surcharge transaction for the button "Enter Card"
//9. DAM Disabled "Delete" button when CC processing failed.
//10. JCW Added progress window counter for clearinactivedeposits
//11. HRZ Modified MoveInCode and add GERROR in line 3298 - 9422
//12. EKD Modified CC Upload to remove Successfully Uploaded/All Clients [Customer]customerProfileID & [Customer]custPaymentProfID to make bNew button enabled - fb9324  
//13. HRZ Add UT_ManualDD for testing Manual DD - 9432
//14. JCW Added alertmessage at the end of ModFacilities, so user knows when facility code change is complete.


//Changes in 9.3.2 - 26/06/2015
//1. HRZ Modified SendMail for fixing multiple email issue - 9367

//Changes in 9.3.2 - 25/06/2015
//1. HRZ Modified Backup for fixing bug 9160 - Fix Cancel button
//2. HRZ Added [Trxs]CCAuthNo:=WS_AuthorisationNumber to WSC_AdvamStoredPAN  - 9307
//3. HRZ Modified PeriodReportsPrint for fixing bug 9153 - Commented line 365
//4. HRZ Modified CheckMail - 9368
//5. HRZ added QUERY([Analysis]; & ;[Analysis]Inactive=False;*) to SwipeCard, DailyA, DailyAutoPay and [trxs]ModReceipts - 9310


//Changes in 9.3.2 - 22/06/2015
//1. DAM Added Surcharge calculation for existing receipts
//2. DAM Fix calculation [Customer]Balance when processing Ezidebit Real Time transactions method on button "Use Card On File" - 9406
//3. RWFR Where bAccept is set to not be visible in receipts bBoth is also now set to be not visible - 9344


//Changes in 9.3.2 - 19/06/2015
//1. JCW Added alertmessage and header to FixGateDates.
//2. DAM Modified GEtPlusMinusValue for CC Surcharges to be generated if modifying existing receipt.
//3. DAM Added new variable TrxOldAmt for checking old [Trx]TotAmt and add a surcharge. Method [Trxs]ModReceipts
//4. DAM Added code to add a surcharge in a case amount for receipt is changed.  Method [Trxs]ModReceipts
//5. DAM modified "UtilitiesAction" to not search facility record if one selected - 9403.


//Changes in 9.3.2 - 16/06/2015
//1. JCW Added a check for Facility Code before UnitTypeCode in WS_AddAgremeent Line 307.
//2. DAM Removed relation from [Unit] table that was breaking UnitNo
//3. JCW Added a check for Units that have not yet been rented on WS_AddUnit Line 98
//4. DAM Modified CC status check for Ezidebit unconfirmed receipts - 9357

//Changes in 9.3.2 - 11/06/2015
//1. DAM Fixed refund permission that allowing modification for batched refunds - 9328
//2. RWFR Fixed reconcile 0 error not being fixed in live code
//3. DAM Fixed amount to be charged for DailyAutoPay when using CC Surcharge
//4. DAM Added DD Surchage new message (new surhcarge calculation) for ALL DD providers during Daily, method "DailyAutoPay"
//5. DAM Added DD Surchage new message (new surhcarge calculation) for DD Export (AutoPayType =4) method "DailyAutoPay"
//6. DAM changed Sort order for UnitType drop down on [Unit]UnitIn form
//7. DAM Fixed permission issue for old cash sale system allowing to save transactions prior CMPD by setting variable $bNoPerm:=False
//8. DAM Added new message for CC Surcharge cash sales. Added changes to receipt drop down, for receipt amount changed, on load cash sales
//9. DAM Modified SwipeCard method for cash sales + agreement receipt surhcarges

//Changes in 9.3.2 - 08/06/2015
//1. DAM Modified Surcharge to allow only trx amount > 0 + Only for adding new receipts method [Trxs]ModReceipts line 544
//2. DAM Modified GetPlusMinusValue for CC Surcharge, trigger only for new receipts
//3. DAM Added a CC Surcharge message when changing Analysis Code to the code that has CC Surcharg enabled
//4. DAM Modified UpdateReceipt for CC Surcharge by commenting ([Trxs]CCAuthNo="") to allow create a surcharge when using button "Use Card On File"
//5. DAM DAM Modified UpdateReceipt for CC Surcharge by adding ([Trxs]TotAmt>0) to create CC Surcharge only for Receipts, not refunds
//6. DAM Added [Trxs]CCTransID>"" [Trxs]CCAuthNo>"" # "EER@" for disabling "Delte" button for cash sales

//Changes in 9.3.2 - 04/06/2015
//1. DAM Added new WS_AUPostUpload for uploading a manifest file when there is no payment required
//2. DAM Fixed Confirmed box for old cash sale system [Trxs]cashSale.Variable43 - 9058
//3. HRZ Added new MaskCCLog for saving log - 8882
//4. HRZ Fixed WSC_CheqStoreCC,eMattersAPI , eMattersBillSmartAddEditDel, ProcCCcTel,ProcCCAuthNet,ProcCCVerisign,CardSave  and EmattersPaymentRefund , added MaskCCLog - 8882
//5. HRZ Fixed WSC_EziEditCustomerCreditCard,wsc_bpoint_ProcessPayment,PrimaryAccountNumber, ProcCCThinc,WSC_ProcCardPresentAuthNet, WSC_EziCCRealtime,ProcCCPaymentExpress, WSC_CheqChargeCard and TrxExpressProcessTrx , added MaskCCLog - 8882
//6. DAM Disabled "Delete" button for new cash sale system if receipt trx has [Trxs]CCTransID>"" | ([Trxs]CCAuthNo>"" 
//7. DAM Commented the alertmessage for "Ok" button on cash sales
//8. DAM Modified CallKinitek to allow call to web site if no payment required
//9. DAM Modified method "CallAUPost" to process if no payment required
//10. DAM Modified WS_AddReceipt part for Box and Store to call au post only with the number of boxes saved
//11. HRZ Modified ProcCreditCard for eMatters (lines 305-307) - 9099
//12. HRZ Modified CreateBackupXML for Mac backup issue - 8668
//13. DAM Modified method "CheckCCStatus" for checking status of cash sales.
//14. DAM Fixed error "Incorrect password" for WS_BnSTrxMO if box id is not found in Storman
//15. DAM Modified WSC_EziAddPayment + WSC_EziCCRealTime to display error messages correctly
//16. DAM Modified DailyAutoPay which error message to display after ERR_Ezi - 9040
//17. DAM & RWFR Modified Logmonloop code for removing online reservations onl from HOF
//18. DAM Fixed visibility for "Delete" button on AutoPay/Notices tab for Advam Stored Pan. It is invisible only for KSS as Jeff suggested


//Changes in 9.3.2 - 27/05/2015
//1. JCW Added alertmessage at the end of Check Activity if running on Server, so user knows when complete.
//2. DAM Added code below for setting transactions as NOT Confirmed. Method WS_AddReceiptTrxs
//3. HRZ Modified DailyAutoPay method (lines 169~171 and 617~619) and CheckCCStatus method (lines 57~59) - 9049
//4. HRZ Modified MoveInCode method (lines 2399-2405) - 9152
//5. RWFR WS_Sync sends details of error when invalid IP address
//6. RWFR WS_Sync sends details of error when a 30@ type error
//7. RWFR Added else to case in WS_Sync to send unspecified error if it gets to that
//8. JCW Added query to reselect Insurance Rates after copying to all sites from MV. 
//9. EDK added code to Charges Builder to bypass ReCalc method for Cash Sales


//Changes in 9.3.2 - 20/05/2015
//1. JCW Renamed Header and Footer buttons in Invoice Setup. 
//2. HRZ Modified the eMattersBillSmartAddEditDel method, added "Item" and fixed the XML file- 9066


//Changes in 9.3.2 - 18/05/2015
//1. DAM Fixed location of Trx amount field for additing refunds [Trxs]ModReceipts
//2. DAM Modified "CardSave" method to avoid using cURL and use one processing method for Mac and Win
//3. DAM Fixed added ability to process refunds for CardSave and modified method "CardSave" - 8228
//4. DAM Added a request for max authorized amount for GoCardless. Method "GoCardless_GenerateURL" - 8550
//5. DAM Added (Position("<a href";$outText)>0) to [Letters]AgreemtInclNew form method to be able preview the link for GoCardless - 8322
//6. HRZ Added two new methods (eMattersAPI and UT_eMattersAPI) - 9075
//7. HRZ Modified the SwipeCard lines 626 to 630 and  734 to 738 - 9075
//8. HRZ Modified the ProcCreditCard lines 127 to 144 - 9075
//9. DAM changed the case order to allow check CMPD first [Trxs]Modreceipts
//10 HRZ Modified "Transaction saved" to "Transaction approved" in the eMattersBillSmartAddEditDel - 9067
//11. HRZ Modified The "Transaction Ok! TOKEN DELETED." to "token successfully deleted." in the eMattersBillSmartAddEditDel - 9068
//12. DAM Replaiced <>SFacility with [Facility]FacilityCode to be used for Key Stat Calculation, method "KeyStatCalc" - 9035
//13. HRZ Modified the SwipeCard method for fixing bug related to [Trxs]CCAuthNo (lines 538-542 , 640-644 and 761-765) - 9089
//14. HRZ Modified the eMattersAPI method, added GVAR_AuthCode - 9089
//15. HRZ Modified the EmattersDDR method  line 97 - 9094
//16. HRZ Modified the DailyAutoPay methods, lines 1572 to 1577 - 9095
//17. DAM Added new array <>aiDailyProcNo for writing Daily process for all sites. Method "InitSites".
//18. DAM Modified how Daily works and allow to run multiple daily at one Server.
//19. DAM Modified LogmonServer to check for the <>aiDailyProcNo values.
//20. HRZ Modified DailyAutoPay line 270 - 9093


//Changes in 9.3.2 - 04/05/2015
//1. JCW Changed FORM EVENT on outside call for Insurance Rates - FB8430
//2. HRZ Modified the CreditSales method - 9006
//3. HRZ Modified the BankingRpt method - 9002
//4. DAM Replaiced <>sFacility with [Facility]FacilityCode in all WS
//5. HRZ Modified the StayLength and AvgLgthStay methods - 9007
//6. DEK modified and added method to exportdataovernight 8540
//7. JCW Adjusted SLK files for Demo import.
//8. HRZ Modified the MailSetup and PeriodReports methods - 8484
//9. DEK modified changeDaytoBill for a new movein - 8737
//10. JCW Modified messages in System Setup for Ezidebit
//11. JCW Facility Sort order in MV enviroments can only be changed by adminsupport
//12. JCW Changed modify facilities form
//13. HRZ Modified the MoveOutCalc method - 8920
//14. JCW Adjusted Visibility CC for brand new move ins - FB8940
//15. DEK added  code to CtreateTrxMoveout regarding Sublets -fb8964
//16. HRZ Modified the OtherSitePmt and SwipeCard methods - 8950
//17. RWFR ReceiveMail process now calls process 1 at the end to trigger refresh of messages table - 7638
//18. RWFR Swipecard now checks for surcharge if it changes the analysis code used - 9015/9016
//19. RWFR DailyAutopay processes surcharges for direct debits - 9017
//20. DAM Added code for taking in account "Rent" ORC during daily - 8958

//Changes in 9.3.2 - 23/04/2015
//1. DAM Fixed SyncRecordLog by adding (Count paramters=1) to save logs in new log
//2. HRZ Modified the UpadateReciept method - 8569
//3. HRZ Modified the RVHistory method - 8875
//4. HRZ Modified the CheckRentChgSeq method - 8871
//5. DAM Fixed Unconfirmed Receipts form not showing reservations - 8705
//6. HRZ Modified the InvState2Calc method - 8846
//7. HRZ Modified the PeriodReportsPrint method - 8977

//Changes in 9.3.2 - 20/04/2015
//1. DAM Fixed customer balance not updating and causing issues with negative balance on invoice when adding a refund - 8778
//2. HRZ Added the CreateBackupXML method - 8668
//3. DAM Added query for the [userlogin] record after initarrays in login method

//Changes in 9.3.2 - 17/04/2015
//1. HRZ Modified the HTTP_ThincSMS and SendSMS methods - 8721
//2. HRZ Modified the SendSMS method - 8970
//3. JCW Fixed and added alertmessages for Transaction matching in agreement screen - FB8766
//4. JCW Fixed radio buttons on Print CRent Increase Letters form - FB8829
//5. DAM Added ability to reserve "ToClean" units for WS_CreateReservation for kss only.
//6. JCW Re-sized various buttons across various forms for Mac.
//7. JCW Fixed xliff for Print APs - FB8948
//8. JCW Changed button wording for send email - FB6312
//9. DAM Fixed WS_CreateReservation is not able to reserve last "available" unit
//10. HRZ Modified the PeriodReportsPrint method - 8961
//11. HRZ Modified the UnitStatus method - 8537
//12. HRZ Modified the MoveInCode method - 8762
//13. JCW Changed progress box for GeneratePKs
//14. JCW Changed progress box for Deposits Held Report
//15. JCW Changed progress box retrieving ezidebit IDs.
//16. EKD MoveIn method, ([Customer]CustomerName="") extra condition added by eugene 16.04.2014 for delinquent
//17. DAM Added a new log for WS_GetUnitType using SyncRecordLog
//18. DAM Modifyied SynCrecordLog to create new files when the size of the txt files is too big
//19. DAM Replaiced all WS_WebServicePassword with "X...XX"
//20. JCW Added a note to Send Details form for periodic reporting
//21. JCW Changed progress box for Merge Data Export - FB8826
//22. HRZ Changed DailPrint for Transaction Balance - 9084



//Changes in 9.3.2 - 13/04/2015
//1. RWFR InvoiceNumber method added to handle calls to WSC_GetInvNo and prevent near-endless loops
//2. JCW added ReadOnlyAll & UnloadAll to the end of all Web Serivce methods. - FB8936


//Changes in 9.3.2 - 7/4/2015
//1. HRZ Modified the DailyA method - 8374
//2. JCW Added CheckDemoDates to the end of CreateTutorial. To fix old dates in all demos
//3. HRZ Modified the ContactsInCode method - 8360
//4. HRZ Modified the ProcessStormanHTMLTags method - 8953
//5. DAM Excluded "Reserved" status for KSS for WS_GetUnitTypes if WS_VacantAll = TRUE
//6. DAM Added query for units when an online reservation getting deleted without payment.
//7. DAM Modified WS_BnSSendReceive to add correct reference for AU Post
//8. HRZ Modified the DailyA method - 8961
//9. HRZ Modified the ButtonsArray method - 8583
//10. EKD Modified Sublet method for Marina          - 8965  23/04/2015


//Changes in 9.3.2 - 07/04/2015
//1. HRZ the Backup method - 8642
//2. JCW Fixed copy to all button for insurance rates
//3. RWFR Fixed InsuranceCalc saving Other Regular Charges when the calculated value was 0
//4. RWFR Fixed insurance erroring incorrectly when the start value matched the previous end value
//5. RWFR Fixed recalc and calc of insurance not correctly using analysis code description
//6. RWFR CallAUPost - Fixed barcodes not going to next record
//7. RWFR CallAUPost - Quantity is set to 1 for sending from facility
//8. RWFR KSSCurl - URLEncode on name fields
//9. RWFR SyncRecordLog - Now accepts $2 as any value and creates log file if not present
//10. RWFR KSSCurl - Logs to JSONLog.txt now
//11. RWFR WSC_AddAdvamCCTransaction - now correctly masks sensitive fields
//11. RWFR WSC_AddAdvamCCTransaction - now logs to AutoPayLog.txt
//12. RWFR LogMonServer - Authenticate loop for triggering recalculate balances no longer executes if the record is marked as complete
//13. RWFR EmailAutoCC - Only recalculates balances if transaction was successful
//14. RWFR MoveOutCalc - Reselects ORC for agreement at end of method
//15. RWFR WS_AddReceiptTrx - Errors and logs if Customer record is locked to prevent mismatched balances
//16. RWFR WS_AddAgreement - Unloads all records at end of method to prevent further locking of records
//17. RWFR Moved header information on CreditSaleIn to page 0
//18. RWFR ReCalcInsurance - Renamed buttons on second dialog to scheduled or immediate
//19. JCW Added viError:=0 at the start of ProCCThinc &  SyncUpdateRecord
//20. RWFR SendReceiveHTTP now has logging for Advam
//21. JCW Copied RecalcInsurance and InsuranceCalc from KSS
//22. DAM Fixed issue for button "Ok & New" 8379
//23. DAM Added method ReadOnlyAll for WS
//24. DAM Added ReadOnlyAll UnloadAll for all WS
//25. HRZ Modified CheckMail - 7638
//26. HRZ Modified the method BillNextCharges - 7666
//27. HRZ HRZ Modified the method DailyPrint -7674
//28. HRZ Modified the ProcessStormanHTMLTags - 8246
//29. HRZ Modified the CheckEmailAddr - 8248
//30. HRZ Modified the ChangeCode - 8256
//31. HRZ Modified the MoveInCode method - 8575
//32. HRZ Added the SMSFields form - 8607
//33. HRZ Modified the TrxReceiptAccept method - 8641
//34. HRZ Modified the LoadAnlsArrays - 8445
//35. DAM Added extra checkes (OK=1) for WSC_bpoint_processpayment to prevent runtime errors when executing on Server
//36. HRZ Modified the method BillPlanReference - 7304
//37. HRZ Modified the InsuranceRpt method - 8412
//38. HRZ Modified the MoveinOK method - 8521
//39. HRZ Modified SwipeCard method - 8377
//40. DAM Fixed the form for DailyAutoPay, wasn't using the correct form AutoPayRentAmts
//41. HRZ Modified the SendSMS method - 8436


//Changes in 9.3.0 - 10/03/2015
//1. JCW & HRZ fixed ORC insurance permissons


//Changes in 9.3.0 - 05/03/2015
//1. RWFR Fixed runtime error in EmailAutoCC for KSS
//2. RWFR Fixed Auto-Quit client not showing for KSS
//3. EKD Fixed text on transaction screen showing as out
//4. RWRF Changed query selection to query for facility table in Kinitek Storpay.


//Changes in 9.3.0 - 25/02/2015
//1. DAM Added a check for Training.xml before KSS Culr call
//2. DAM Added a check for 61 and 64 in mobile number and replacing it with 0 for Ezidebit
//3. DAM Hide "Enter Card" button for processign Ezidebit refunds
//4. DAM Renamed "Use card on file" button to "Process refund"
//5. HRZ Modified the  CustProcess, Compiler_Variables and ContactProc methods - 7283
//6. HRZ Modified the WSC_EziProcRealtimeTokenPayme - 8640
//7. HRZ Modified the TrxReceiptAccept - 8641
//8. HRZ Modified the PeriodReportsPrint - 7974
//9. HRZ Modified the Backup - 7642
//10. HRZ Modified the DoBillNext - 8578
//11. HRZ Modified the MoveInCode - 8525


//Changes in 9.3.1 - 19/02/2015
//1. JCW was stage now www.

//Changes in 9.3.0 - 19/02/2015
//1. DAM Replaiced "stage" to "www" for KSS curl calls
//2. HRZ Modified the WSC_EziAddCustomer; WSC_EziAddPayment; WSC_EziCCRealTime; WSC_EziChangeCustomerStatus; WSC_EziDeletePayment;
// + WSC_EziEditCustomerBankAccount ;WSC_EziEditCustomerCreditCard ;WSC_EziEditCustomerDetails ;WSC_EziGetCustomerDetails ;
// + WSC_EziGetPaymentDetail ;WSC_EziGetPayments ;WSC_EziGetPaymentStatus ;WSC_EziProcessRefund and WSC_EziProcRealtimeTokenPayme methods - 8601
//3. DAM Modified ImportNonsyncingsites to adjust PK

//Changes in 9.3.0 - 13/02/2015
//1. DAM MOdified check for Ezidebit refund status


//Changes in 9.3.0 - 12/02/2015
//1. DAM Modifed the check for CC status Real Time transaction and Batched
//2. DAM Modified Date Banked for Ezidebit transactions during daily
//3. DAM Modified ID checks for Ezidebit transactions
//4. DAM Modified DailyAutoPay for Ezidebit




//Changes in 9.3.0 - 11/02/2015
//1. DAM Added release of records for WS_Insomniac_GetCustBal
//2. DAM Added read write for [customer] [trx] for WS_Insomniac_ProcessCustPay
//3. DAM Modified code for Ezidebit daily processing


//Changes in 9.3.0 - 10/02/2015
//1. DAM Changed how BankID and transaction ID saved for Ezidebit
//2. DAM Modified date banked for Ezidebit Real Time transactions, now it is based on analysis code setting.
//3. DAM Set Real Time trxs to be confirmed before daily and banking, unless "set datebanked to today" is enambled for analysis code.


//Changes in 9.3.0  09/02/2015
//1. HRZ Modified the WSC_EziProcRealtimeTokenPayme method
//2. DAM Replaiced CustomerCode with UUID for Ezidebit
//3. DAM Added refund funcion for Ezidebit
//4. JCW Fixed Adding Other Recurring Charges


//Changes in 9.3.0 04/02/2015
//1. DAM & HRZ Fixed Backup XML for Mac
//2. EziDebit add->Delete->add profile.
//3. BSBNo query in CheckVersion


//Changes in 9.3.0 - 03/02/2014
//1. DAM Added new field [Facility]SVGFontSize and added the ability to enter it Font size on Map edit
//2. DAM Hidden the "Resend" button for new emails (emails that haven't been sent) 
//3. DAM Added new option in system setup to decrease the size between the lines in âDaily summary reportâ [Facility]UseSmallDailySum
//4. DAM Fixed EziDebit real time processing errors are not saving the transactions
//5. DAM Excluded MISCL from PTD Report
//6. DAM Added definition for new buttons in system setup for EziDebit in checkversion
//7. DAM Replaiced customer code to UUID for CC and DD profiles for EziDebit
//8. DAM Added multiple checks for locked/read state for customer record in WS_SetPassword
//9. DAM Added update gate for Insomniac
//10. DAM Added [Facility]ShowNonVacantUnits to enable "Include Unit Types with No Vacant" by default in system setup + structure + functionality to Sale Enq form - 8556
//11. RWFR Fixed name of cash sales not showing correctly in banking reports
//12. RWFR Fixed Add Charge/Add Receipt not working when clicking OK & Next
//13. RWFR Fixed editing an existing cash sale not allowing you to add transactions
//14. JCW added method to clear BSB Numbers for all customers, that are not blank but should be. 



//Changes in 9.3.0 16/01/15
//1. HRZ Modified the WSC_EziProcRealtimeTokenPayme method - 8422
//2. DAM Added code to save records before API calls for KSS
//3. DAM Modifyed the message for eQuote and eReservation for KSS
//4. HRZ Modified the DD_Add and MovinCode methods - 8502

//Changes in 9.3.0 30/12/14
//1. DAM fixed the method on the update to retrive the EziDebitID - 8431
//2. DAM Fixed EziDebit setting trx to confirmed for batch processing - 8459

//Changes in 9.3.0 23/12/2014
//1. DAM Fixed runtime error for Inv adjustments form, if there is no Type and Category for IA - 8447
//2. JCW Removed [Facility]Startup form On StartUp - FB8161
//3. JCW Increased Analysis Code Limit from 27,000 to 270,000 - FB8282
//4. DAM Fixed Cash sale trx didn't have the match no set

//Changes in 9.3.0 22/12/2014
//1. RWFR Prevented cash sales being saved with match 0
//2. RWFR Re-added delete function to cash sales

//Changes in 9.3.0 17/12/2014
//1. DAM Added option to delete all customer's profiles using Delete Prof button in system setup
//2. DAM Added clearing CC info after deleting a profile using "Delete Prof" button in system setup
//3. HRZ Added CreateEziDebitHTMLChargeCard method - 8284
//4. HRZ Added CreateHTMLErrorPage method - 8284
//5. HRZ Modified compiler_Variables method - 8284
//6. HRZ Added CreateReferenceEziDebit method - 8389
//7. HRZ Modified [Customer].EziCCDetails.Upload and [Customer].EziDDDetails.Upload - 8389
//8. DAM Adjusted banking report for including EziDebit trx if option is enabled in system setup - 8362
//9. HRZ Added CreateEziDebitHTMLSaveCustomer method - 8385
//10. HRZ Added CreateEziDebitHTMLSaveCustomerA method - 8385
//11. HRZ Added CreateEziDebitHTMLCCICC method - 8385
//12. HRZ Added CreateEziDebitHTMLCCIDD method - 8385
//13. HRZ Rename JCWCreateRandom form to EziDebitPCI - 8385 & 8284
//14. RWFR Fixed cash sales bugs for national mini
//15. DAM set [Agreement]NoticeAmtToBill to 0 for revenue report and for WS
//16. JCW fixed InsuranceRates not deleting existing records before syncing to all facilities.
//17. DAM Fixed EziGetCustomerDetails not receiving customer id and added parameter to it for setting a facility
//18. DAM Removed deletion of all CC data and replaiced CCNo with xxxxxxxxxxxx +last 4 digits 
//19. DAM Replaiced 0s to Xs for CCno diring upload
//20. DAM Removed -1 from Ins prorata calculations when adding a unit using old system - 8419
//21. DAM Fixed DRC Report if total units of a unittype is 0. Also changed the headers.
//26. DAM Fixed mobile number for EziDebit 8425/8427


//Changes in 9.3.0 1/12/14
//1. HRZ Modified CheckVersion Method - 8341

//Changes in 9.3.0 28/11/2014
//1. DAM modified swipecardform to be able to process diner cards
//2. HRZ Modified OpenControlLink - 7087
//3. HRZ Modified ProcCreditCard - 8283

//Changes in 9.3.0 24/11/14
//1. DAM Added invisible variable vTaxRate to invoices for BilBox - 8079
//2. DAM Modified WSC_EziGetPaymentDetail to read payment status correctly
//3. DAM Added error message for processing EziDebit if returned an error
//4. HRZ Add EventlogException_WS and Modify WS_GetReportData - 7678
//5. HRZ Modified GateAction - 8300
//6. DAM Fixed Error message for EziDebit DD during daily
//7. DAM Fixed Real time processing for EziDebit not recognising error codes. Added CCtrxID and CCAuthNo
//8. DAM Disabled the "Cancel" button when processing Real Time EziDebit
//9. DAM Fixed issue with EziDebit DD failed note doesn't have custome code
//10. DAM Excluded calculation vNet from vNetSum if trx tax amount is 0, for BilBox
//11. DAM Commented part for removing customer record if a payment for reservation is not done

//Changes in 9.3.0 19/11/14
//1. DAM Fixed printing receipt if there are no trx selected 18/11/14 - 7665
//2. DAM Modified Payment at other site to retrive customer details from HOF for receipt modification - 7816
//3. DAM Modified Payment at other site shows only trx for customer entered, not all other sites payments - 7816
//4. HRZ Modified IncomeCharged - 7757
//5. HRZ Modified PrintInvRec - 7995
//6. HRZ Modified SVG_MAP - 8058
//7. DAM Fixed Storpan upload not picking up autopay customers 
//8. RWFR Fixed changing facility using <>sFacility instead of FacilityCode for contacts - 7282
//9. RWFR Fixed default analysis code for receipt not checking surcharge - 8149
//10. RWFR Moving a receipt from one agreement to another now recalculates the balances correctly - 8046
//11. RWFR Pro-rata charges/credits for units take account of last billing plan rather than current billing plan to cover cases where it has been changed - 7958
//12. RWFR Changed daily processing window type from modal as additional modal windows were not always displaying on top - 7544/8005
//13. RWFR vDaysLate now checks minimum balance for arrears rather than using 0 - 7706
//14. RWFR If the agreement balance is changed the move out figures automatically recalculate - 7669
//15. RWFR LastDiscAmt is set to 0 if no value is found when undoing last charges - 7668
//16. RWFR Fixed cash sales not setting bAbortArray on cancel


//Changes in 9.3.0 18/11/14
//1. RWFR Fixed syncing methods using incorrect variables (SyncSendEvents/SyncReceiveEvents)
//2. RWFR Fixed cash sales not setting to correct match value
//3. RWFR New cash sales module is always enabled now
//4. RWFR Fixed incorrect message on refunds for cash sales
//5. RWFR Fixed incorrect balances for cash sales
//6. RWFR Fixed it trying to recalculate all transaction for MISCL customer for cash sales
//7. RWFR Editing a cash sale now loads new form
//8. RWFR Disabled old cash sales code
//9. HRZ Editing Backup method
//10. DAM Added vPage variable to all Inv forms, added code to set the vPage to printing page and - 8075
//11. DAM Set vPage variable to be invisible by default - 8075
//12. DAM Set next inv no to be hidden in system setup for syncing site - 7804
//13. DAM Fixed cannot take payment for other site - inactive non-credet refund - 7839
//14. DAM Modified callAUPost to use [facility]City instead of [facility]state
//15. DAM Fixed Record locked for UserLogins - 7966
//16. DAM Fixed process BackupPro


//Changes 9.2.2 14/11/14
//1. DAM Fixed Reservation for "National Account" - 8270
//2. DAM Added code to checkversion to clear [Customer]customerProfileID and custPaymentProfID if = 0 - 8266
//3. DAM Removed code for exluding inactive analysis codes from <>asChargeCat
//4. DAM Fixed keystat for not KSS bad debt
//5. DAM Added - to window name for Server/Client/Standalone - 7928
//6. DAM Added code to show active for EziDebit and autopay for other providers for Unsuccessfully uploaded report
//7. DAM Added log for processing Advam DD during daily
//8. HRZ Add WSC_EziProcRealtimeTokenPayme method - 8277
//9. HRZ Add UT_EziProcRealtimeTokenPayme - 8277
//10. RWFR Removed code in UpdateNewRent assuming billing plan changes had not already altered the other regular charges - 7922


//Changes 9.2.2 12/11/14
//1. DAM Fixed "National Account" for KSS
//2. DAM Removed help tip for senf jrnl every .. in system setup - 7698
//3. DAM Fixed Legend for Anticipated move outs report - 7352
//4. DAM Fixed reuntime error for removing CC in system setup - 7550
//5. DAM Added alertmessage for setting a customer to a Delinquent, adding a note + alertnote + setting the variable to display - 8272
//6. DAM Added quotedrate for eReservation and [Quote]price to eQuote for KSS

//Changes in 9.2.2 11/11/14
//1. DAM Added gError variable to Err_EziGetPaymentStatus for loggings
//2. DAM Added loggins for all EziDebit methods
//3. DAM Modified input paratmers for WSC_EziGetCustomerDetails and WSC_EziGetPaymentDetail
//4. DAM Added loop for all analaysis codes to check CC status for EziDebit

//Changes in 9.2.2 10/11/14
//1. DAM Fixed increase for ORC for SK in DoBillNext - 7922 Search 06/11/14  
//2. HRZ Modified Print Form - 8181
//3. HRZ Modified VacancyRpt - 8172
//4. DAM Fixed EziDebit use card on file - 8223
//5. HRZ Modified ProcCreditCard and DailyAutoPay - 8073
//6. DAM Fixed emails are sent for all facilities even if one facility is selected in checkemail - 7709

//Changes in 9.2.2 06/11/14
//1. DAM modified EziDebit CC/DD upload if CustomerprofileID/DDprofile ID are not blank
//2. DAM Fixed Online Reservation - HOF info - 7793
//3. DAM Added get localized string for deposit held report 30/10/14
//4. DAM Replaiced Records in table to Records in selection for Adding more units
//5. DAM Fixed DRC Report and text in system setup - 8171
//6. DAM Removed help tip for Occupancy Level in days - 8182
//7. DAM Fixed % on DRC report - 8190
//8. DAM Fixed DRC errors for notice blob - 8203
//9. DAM Fixed Total for ... agreement(s)/reservation(s) is missing - 8124
//10. DAM Fixed Storman Website problem by seting form to grow - 8150
//11. DAM Fixed Daily processing cut off text - 8151
//12. DAM Fixed Credit sales screen issues - 8176
//13. DAM Added code for fixing [Messages]facility field + for displaying issues + on checkversion apply formlula to [Message] table - 8129
//14. DAM Modified WSC_EziDebitRealtime for processing errors correctly - 8223
//15. DAM Modified WSC_EziDebitRealtime to process amount in Cents - 8223
//16. DAM Modified WSC_EziAddCustomer to display errors during CC upload in System setup - 8233
//17. DAM Fixed Periodic Reporting Setup unable to save changes - 8133
//18. HRZ Modified Backup method - 8162
//19. DAM Added check compresion for VacantDRC blob
//20. DAM defined variable as real for sendign sms - 8106

//Changes in 9.2.2  28/10/14
//1. DAM Modified Trxs trigger to save code/date correctly for EventLog, this fixes the EventLog Exceptions Report - 6131
//2. DAM Added WS_WebServicePassword to WS_AddOtherCharges, WS_EditOtherCharges
//3. HRZ Added LoadEmail - 7203
//4. DAM Fixed Customer balances report is not working for batch reporting - 7963
//5. JCW Added 'FixUntitled' method to the end of CheckVersion.
//6. RWFR Added  --fail --silent --show-error  when calling Curl so only errors get logged
//7. JCW Adjusted text boxes in [Gate]GateIn form.
//8. DAM Added a new WS WS_EditAgreement 
//9. DAM Modified WS_AddOtherChs WS_EditOtherChs to use WS_ProrataCharge corrently
//10. DAM Added WS_Remove to WS_EditOtherchgs
//11. HRZ Added UT_eMattersBillSmart - 7892
//12. DAM Added new WS_DoMoveOut - 7128
//13. DAM Fixed invoices are not attached during daily if "show ptd on inv" is disabled search for 08/10/14
//14. JCW Fixed web pages on contact us button for Tutorial
//15. DAM Updated Box and Store password
//16. DAM Fixed help tip on facility PK - 7727
//17. DAM removed/commented all TRACE and Set Text to pasteboard commands
//18. DAM Fixed Periodic Reporting recipient missing in Email and Event Log setup when restart Storman - 6984
//19. DAM Fixed View Notes window to fit - 7670
//20. DAM Fixed Send Message to Other Users - 7772
//21. DAM Set [Facility]DailyHideWebL=false in checkversion and removed it from all methods - 7844
//22. DAM Fixed barcode table for syncing
//23. DAM Fixed Periodic reporting is not saving for W/M/Y
//24. RWFR Fixed unicode characters not syncing correctly - 7364
//25. DAM Fixed Runtime Error for SVG Receipts/Footers - 7608 
//26. DAM Fixed Marketing types and notices files have wrong facility code when creating new datafile, now it works only for tutorial datafile
//27. DAM Fixed Receipt Amount field not updating the remaining balance when clicked OK and Next button - 7661
//28. DAM Fixed Customers receiving the same sms msg when sending bulk sms 7692
//29. DAM Fixed Incorrect hint of Minimum Custom Rent Increase % - 7717
//30. JCW Changed bulk communication wizard to check for declined Contacts instead of 'Deactivated' - 7750
//31. DAM Fixed legend on Occupancy report for batch print & email report - 7755
//32. DAM Fixed Customer Balances report not displaying MISCL as Cash Sales' customer name - 7753
//33. DAM Income Charged Report - Option 'Show negative trxs on separate line' only working when 'Show Detail' is disabled - 7757
//34. DAM Fixed Trx Exp - Incorrect Month and Year format when uploaded CC details - 7724
//35. DAM Fixed Modifying the description of CC payment causes the balance changing - 7911
//36. DEK  modified, at least four, was Cannot change reservation number, must be 4 digits - 7824
//37. DEK  modified, set proper object names - issue in Access Control System Setup - 7808
//38. DAM Added new permission for national account agreements - 7950
//39. DAM Modified the [Agreement]Movein form for national accounts - 7950
//40. DAM Changed [Unittype]RCLowerActive and [UnitType]RCUpperActive from integer to real to allow 0.01 values - 7927
//41. DEK added set print option for spooler doc.name : Incorrect screen header of List of Waived Late Fees - 7776
//42. DAM Added a date request to ClearInactiveDeposits method
//43. DAM Added 2 fields to facility table RDCreport DRCEmails for RDC settings and to system setup reports tab - 7927
//44. HRZ Edited Batch method for "Save without generation"
//45. HRZ Edited ApplyRentRules - 7165
//46. HRZ Edited OtherGate method - 7201
//47. DAM Added a DRC report and triggering it during Daily - 7921
//48. DAM Modified WS_BnSQuote, WS_BnSCreateRes, WS_BnSSendReceive for cfor different calculation deposits amount
//49. DAM Added new error code returned by Storman in WS_BnSQuote
//50. DAM Added Delinquent field on Customer info tab for Credit Sales/Agreements/Reservations/CustomerIn - 7926
//51. HRZ Modified WSC_EziAddCustomer - 8071
//52. HRZ Modified WSC_EziAddPayment - 8071
//53. HRZ Modified WSC_EziCCRealtime - 8071
//54. HRZ Modified WSC_EziChangeCustomerStatus - 8071
//55. HRZ Modified WSC_EziDeletePayment - 8071
//56. HRZ Modified WSC_EziEditCustomerBankAccount - 8071
//57. HRZ Modified WSC_EziEditCustomerCreditCard - 8071
//58. HRZ Modified WSC_EziEditCustomerDetails - 8071
//59. HRZ Modified WSC_EziGetCustomerDetails - 8071
//60. HRZ Modified WSC_EziGetPaymentDetail - 8071
//61. HRZ Modified WSC_EziGetPaymentStatus - 8071
//62. DAM Added a field [Message]Facility and code [Message]Facility:=Substring([Customer]CustomerCode;1;5) in all places where record is created - 7709
//63. DAM Modified search when go File->View Email - 7709
//64. DAM Added code to display different emails for different sites in File->View Email + on the main screen - 7709
//65. DAM Added code to set Win title on Start up + on Server startup method - 7928
//66. DAM Added 3 forms for consilidating banking report - 1 dialog 2/3 compact versions of the original report - 7923
//67. DAM Added new field to [Facility] table UseBadDebts for - 7925
//68.EDK - added vMisc:=False to PrintInvRec to fix error (was not defined) - 7842
//69. DAM Added calculation of activity for bad debt if is true - 7925
//70. DAM Added Option to enable bad debt in system setup exclude KSS - 7925
//71. DAM Added UseBadDebts KeyStaCalc - 7925



// Changes in 9.2.1 24/09/14
//1. JCW Removed currency from [Agreement]RentIncreaseUnitsNew date.
//2. HRZ Add BearBoxXML and testHamid1 method
//3. HRZ Add Fundtech_DD method -7405
//4. HRZ Edit [Facility]System, add Fundtech to dropdown list -7405
//5. HRZ Edit DailyAytoPay method and add Fundtech - 7405
//6. EKD change Modify Analysis Codes, fields "MinAmt","MaxAmt","CreditPercentage","CostPrice" to avoid negative values -7851
//7. EKD Daily processing, DailyA - fixing popup warning message in loop changed to be shown in listbox DIALOG([Facility];"ImportDialog") - 7856
//8. HRZ Add eMatters code to Procreditcard method - 7857
//9. HRZ Add UT_EmattersDDR for direct debit eMatters unit testing
//10. HRZ Add UT_Fundtech_DD for direct debit Fundtech unit testing
//11. HRZ Add UT_EmattersPaymentRefund_Fail for credit card  eMatters unit testing
//12. HRZ Add UT_EmattersPaymentRefund_Ok for credit card  eMatters unit testing
//13. HRZ Edit [facility].system.variable6 for fixing 6994
//14. HRZ Edit DailyAutoPay (QUERY([Notices];[Notices]NoticePlanNo=0;*) to QUERY([Notices];[Notices]NoticePlanNo#9;*)) - 7843
//15. HRZ Edit [facility].system.variable6 for fixing 7076
//16. DAM Fixed Deposit amount for reservations created by WS_BnSCreateRes
//17. DAM Fixed subjects for emails WS_BnSsendReceive/Receive items - 7860
//18. DAM Fixed Deposit amount when converting a reservation to an agreement for BnS 7861
//19. DAM Fixed New Rent Amount for ORC for BnS - 7864
//20. DAM Fixed [Unit]InsureValue to include compulsory insurance - 7865
//21. DAM Added length of stay to descriptions of insurances charges for BnS - 7866
//22. DAM Fixed Day to bill for WS_BnSSendReceive
//23. DAM Fixed BnS rent is not triggered for WS_BnSAddTime - 7873
//24. DAM Fixed Move Out Notice Given date is not updating with WS_BnSAddReceipt - 7874
//25. DAM Fixed Monthly/weekly Box and Store rent fee - 7883
//26. HRZ Add WSRECORDLOG method and fixed 7027
//27. DAM Fixed Insurace ORC have wrong values due to rounding issues for BnS
//28. DAM Removed WS_BnSMoveOut method as it is not used suburb for shipping
//29. DAM Fixed Move out calculation for BnS by Undo charnges if Last Bill Date > Current Date
//30. HRZ Edit VisibiltyBankInfo method for fixing 7838
//31. HRZ Add UT_eMattersRefund method for testing eMatters refund - 7891
//32. HRZ Edit TrxReceiptAccept method for adding eMatters refund - 7832
//33. HRZ Add eMattersBillSmartAddEditDel method 
//34. DAM Fixed alertmessage for proccreditcard
//35. DAM Fixed ORC description for Box and Store - 7934
//36. DAM Fixed spelling mistake for email subjects for BnS - 7933
//37. DAM Fixed copy/paste in html emails - 7937
//38. DAM Added code for setting Alt mobile prefix - 6787
//39. DAM Fixed ProcCreditCard not closing a window causing runtime errors
//40. HRZ Adding eMattersBillSmart method
//41. JCW Adjusted SMS Delivery Report output
//42. DAM Fixed Refund on KSR by xcluded sweep transactions from calculation when running income received report - 7722 
//43. DAM Commented code in ControlCode for gatesystem 12 (now 12 is bearbox)
//44. HRZ Edit GateAction and add BearBox code - 7760
//45. DAM Fixed Add/Edit/Delete buttons not affecting Bank Account Info fields - 7725
//46. HRZ Add UT_BearBoxXML method for unit testing of BearBoxXML 
//47. DAM Fixed [Agrement]AgreeNo at the agreement info tab
//48. DAM Added 2 WS output parameters to WS_DoBilling for errors - 7796
//49. DAM Added one Input parameter to BillNextChrages - 7796
//50. JCW Updated NTK Plugin reg codes


// Changes in 9.2.1 05/09/14
//1. DAM Added changed to KSS eQuote/eReservation
//2. DAM Fixed SyncReceive to be able to receive data from other end
//3. DAM Added method FixEventLogTable to set PK for [EventLog]
//4. JCWDAM Added NoticeBilled as the error when sending autopay failed emails. 
//5. DAM Added READ WRITE([Facility]) on Initsites to save next inv number and cash sale number
//6. DAM Added CallAUPost method for BnS
//7. DAM Added UnitActivity for WS
//8. DAM Added ProjectedCharges for WS - 7682
//9. DAM Added code to ignore licence check if there is training.xml file
//10. DAM Added a check for Periodic reporting codes and changed tabs visibility based on the emails codes - 7150
//11. DAM Added "IA" Marketing type code for Inventory Adjustments - 7173
//12. DAM Changed Stock adjustments form to work according to the IA marketing type - 7173
//13. DAM Renamed fields on stock adjustment form if there is an active IA marketing type - 7173
//14. JCW Fixed tab order in [Unit]AgreementInclNew subform. 
//15. DAM Fixed runtime error with a set "SearchInvNo" for KSS WS_GeneatePDF
//16. DAM Modifyed FacCountry.xml set MobileFormat to TRUE for all countries - 7642
//17. HRZ Fix Tab order - 7763
//18. DAM Fixed Allowed to unit for secondary users - 7758
//19. DAM Added index to [Barcode]Code field to fix runtime error
//20. DAM Fixed CallAUPost
//21. HRZ Modify WS_GetUnitTypes and and four output parameters (w_arUTArea, w_arUTNoTotal,w_arUTUnitTypeLength and w_arUTUnitTypeWidth)
//22. HRZ Add Entry Filter for fields Phone (Home/Work(Ext)/Mobile) and Facsimile in AgreementIN, CustomerIn, ContactsIn, FacilityIn, System, ReservationIn and SupplierIn
//23. HRZ Rename labels from fax to Facsimile in two forms (System and SupplierIn)
//24. DAM/RWFR Fixed Inv Receipt Code where ORC was calculated 2 times in total amount - 7714
//25. DAM Added WS_TotAmt to WS_BnSSendReceive to dispay total amount paid
//26. HRZ Add method EmattersPaymentRefund (XML POSTING STRING) - EMATTERS API (XML)  -7821
//27. HRZ Add method EmattersDDR (XML POSTING STRING) - EMATTERS API (XML) -7821
//28. HRZ Edit [Facility]System form. Add eMatters to drop down list- 7821 
//29. HRZ Edit StructureArray and transaction table - 7173


// Changes in 9.2.1 /04/08/14
//1. DAM Fixed SpaceRemover to use wrong facility code
//2. DAM Added authorization for gocardless
//3. DAM Added new Web report Cash Received Analysis report -7676
//4. DAM Fixed Fields at AnalysisCode forms and UnitType in froms
//5. DAM Added AgedReceivables report to WS - 7680
//6. DAM Added Inventory Valuation Report to WS - 7679
//7. DAM Fixed Arrears report not working if Recalc balances option is not ticked 
//8. DAM Added Arrears report to WS - 6862
//9. DAM Added Income Received reprot for WS - 7677
//10. DAM Fixed legend on arrears report
//11. DAM Set [NoteHistory]ContactNo, [Letters]ContactNo, [Contacts]ContactNo, [Trxs]InvNo, [Trxs]invDate to be indexed Again v13.5
//12. RWFR Removed KY code from CheckVersion
//13. JCW Renamed permission for viewing emails. 
//14. DAM & RWFR Fixed EziDebit CC processing
//15. DAM Added Renatal Rate Variation report to WS
//16. DAM Added code for replacing &gt; and &lt; with < > if there is a 4DIF statement in an email
//17. DAM Fixed IOReport showing wrong columns
//18. DAM Fixed 4D References in SVG Footer/Header
//19. JCW Removed Page 2 from Tutorial Form.


// Changes in 9.2.1 22/07/14
//1. DAM Fixed Daily freezing when click "Cancel" button for processing - 7544
//2. DAM Fixed XML read to put bankbranchcode into the bank account number
//3. DAM Fixed UnitType deposit wasn't charged on movein if the deposit analysis code is disabled Bill on move in - 7087
//4. DAM Removed help tip on recalculate insurace in Insurance Rates - 7439
//5. DAM Fixed Recalcinsurace uses global variable instead of local
//6. DAM Fixed insurance rates disappear after recalculate - 7438
//7. DAM Added code for changing currency to Â£ for "GB" on XML Read - 7449
//8. DAM Fixed Banking summary not showing Reservation number - 7469
//9. DAM Added help link to [Facility]AdjustRatesDialog - 5133
//10. DAM Fixed Total Unit numbers not showing for DRC Adjustmenst - 7062
//11. DAM Fixed KSR for Letter printing format USA
//12. DAM Made all notices to be shown in Bulk Communication Wizard - 7153
//13. DAM Added track data to process swiped CC for transactions first
//14. DAM Modifyed API calls for KSS Sale Enq and Reservations to check email address
//15. DAM Fixed OR for non syncing sites - 7459
//16. DAM Fixed "Display Selection" button for Analysis Codes - 7096
//17. DAM Fixed vAddr1-vAddr7 variables are not displaying for SVG Header - 6595
//18. DAM Fixed Interprocess variables not working for emails [[4DTEXT <>sCurrentUser]] - 7072
//19. ESD Changed wording in SMS Delivery Report from Not Delivered in RED to Unconfirmed in Orange
//20. DAM Fixed tab order for [Trxs]ModReceipts - 7186
//21. DAM Fixed Anticipated MO report showing wrong dates - 7351
//22. DAM Fixed Mail Merge Report  - 7164
//23. DAM Fixed Sending SMS - 7430
//24. DAM Fixed ORC for Other Credit Sales - 7185
//25. DAM Fixed help link button for messaging other users - 7566
//26. DAM Fixed Country is not setting for new customers Accounting -> Modify Customers -> Add new - 7569
//27. DAM Added alertmessage when creating a new customer without a name Accounting-> Modify Customers - 7568
//28. DAM Fixed window form for daily reprint letters - 7574
//29. DAM Fixed delete button for Accepted Credit Cards - 7550
//30. DAM Fixed "CCUpload" button for Mac - 7552
//31. DAM Added an alert when trying to remove blank attachments - 7575
//32. DAM Fixed text in system setup "Stop sending notices at the end of late cycle" - 7551
//33. DAM Added code to update next agreement/contact/inv/credit sale number when opening System Setup - 7555,7556,7557
//34. DAM Added the help icon for Reservations out form - 7577
//35. DAM Fixed form format for sales enqs from waiting list - 7580
//36. DAM Fixed runtime error when printing receipts - 7589
//37. DAM Fixed Notice Plan allowing to type letters in number field - 7595
//38. DAM Added alertmessage for deleting attachments - 7637
//39. DAM Set follow up date for reactivated sale enq to be current date +1 - 7625
//40. DAM Fixed sending a sms to a sale enq shows letters for all customers - 7609
//41. DAM Fixed multiple issues with reservation screen window - 7624
//42. RWFR Fixed opening of PDF during printselection - 7576
//43. DAM Added an alertmessage for reservation expected move in date if it before reserved date - 7626
//44. DAM Increased length for agrement number on summary of charges - 
//45. DAM Increased CC Trans ID length on [Trxs]ModReceipts - 7611
//46. DAM Fixed printing inv for agreement/customer range - 7578/7579
//47. RWFR Fixed DRC Delete triggering when no record selected - 7591
//48. RWFR Normal window title is restored exiting unit types - 7596
//49. RWFR Print previous bank rec now shows last 185 days - 7590
//50. DAM Fixed SMS character counter not working for copying and pasting texts - 7627
//51. RWFR Fixed AddVoucher not selecting correct analysis code - 7639
//52. DAM Added new alertmessage for sending /receiving emails if facility address is blank - 7484
//53. RWFR Fixed RemoveORC using blank dates in narration - 7601
//54. RWFR Fixed SMS message box displaying when it shouldn't on letters - 7619
//55. RWFR Fixed SMS message box being enterable in letters screen - 7619
//56. DAM Added a check for gaps between insuracerates - 7636
//57. DAM Fixed EventLog report fields overlapping - 7633
//58. DAM Fixed calculation of days late if LCSD is 00/00/00 on new move in - 7632
//59. DAM Fixed Next/previous buttons for Notices were changing the tab - 7629
//60. DAM Fixed [Customer]NoActiveAgreemts and [Customer]AgreemtsOperating not updating when changing customer name - 7628
//61. DAM Fixed Reservation number is not showing for the Threat Level report - 7629
//62. DAM Fixed date for Auto rent increase - 7581
//63. DAM Fixed Daily billing plan is not working for multiple situations - 7548
//64. DAM Fixed switching billing plans from daily to weekly
//65. DAM Disabled button "Today" on cash sales if user has no permissions to modify Banked date - 7540 
//66. DAM & RWFR Fixed issue with printing invoices for inv system 2 and one inv per customer -  7036
//67. RWFR Fixed apostrophe issue when sending emails
//68. RWFR Hide web area option removed - 7006
//69. DAM Fixed CardSave for Mac - 7104
//70. RWFR PTI PayExpress enabled for Storlogix output
//71. DAM & RWFR Fixed SMS Delivery Report printing total amount on each page - 7337
//72. DAM Fixed Income Charged Dialog drop down not to show inactive analysis codes - 7660
//73. DAM Added space for Income Charged details report - 7654
//74. DAM Updated follow up note on calendar if customer name / phone has been changed - 7602
//75. DAM Fixed Invoice printing for country code "PA" and invoice set per agreement - 7324
//76. DAM Fixed Inventory Packs description error in Cash Sales - 7289

// Changes in 9.2.1. 03/07/14
//1. DAM Fixed length for Agreement No on [Letters]LettersBig - 7177
//2. DAM Added method SpaceRemover to remove spaces from Customer Codes - 7433
//3. DAM Decreased size of rows for floating box by 4 pixels - 7398
//4. DAM Set Primary Key field for Progress table to be indexed and autoincrement - 7196
//5. DAM Set [Customer]AgreemtsOperating to remove 10 characters instead of 6 - 7471
//6. DAM Commented the code for setting trx table to read only mode during daily causing it to 0 Inv numbers - 7145, 7036
//7. DAM Added Unload record for [Facility] table for OR - 7039
//8. RWFR Fixed currency format getting cut off in some situations - 7142
//9. RWFR Removed incorrect export to Excel code for paid to date report (was generating an aged receivables) -7140
//10. RWFR Fixed cut off form in Find Units Available at Other Site - 7421
//11. DAM&WS Fixed the issue with notice preview - 7432
//12. DAM Fixed Mac backups not working correctly - 6961
//13. DAM Changed allertmessage for check return - 7474
//14. DAM Fixed creation blank quotes for sales enq - 7488
//15. DAM Added fixed customercode creation if create a new customer from accounting -> Modify customers - 7489
//16. DAM Fixed tab order for modules system setup - 7491
//17. DAM Fixed displaying RentAnalysis with , - 7496
//18. DAM Fixed Deletion letters from agreement/reservation notice history - 7502,7503
//19. JCW Added a note to the bottom of SMS Delivery Report - stating this report is not accurate.
//20. DAM Fixed User Groups are not showing after printing - 7497
//21. DAM Fixed headings Inv/Receipt setup - 7505
//22. RWFR Fixed referral vouchers not adding on non-syncing sites
//23. RWFR Fixed surcharge not using the correct variable - 4982
//24. DAM Fixed Print Inv Receipt form - 7509
//25. DAM Added a new message for saving a billing plan without billing plan code - 7508
//26. DAM Fixed Grops box for on Analysis code form - 7504
//27. DAM Fixed titles for Mod receipts and Mod charges - 7511,7512
//28. RWFR Fixed gate alarm code not triggering for F2000 when gatekeyed = 0 - 6424
//29. RWFR Fixed changing email & eventlog setup arrays not copying to server - 6424
//30. DAM Added new page for from [Agreement]ModDetails for Print Out Old and Delete - 7510
//31. DAM Modified the form [Supplier]GLReceipts - 7498


//Changes in 9.2.1 27/06/14
//1. DAM Added GoCardless_GenerateURL for creating an URL that is sent to customers. 
//2. DAM Added GoCardless_ConfirmAuth for confirming authorization done by customers
//3. DAM Added GoCardless_CreateBill for processing a payment against existing authorization
//4. DAM Modifyed VisibiltyBankInfo for GoCardless
//5. DAM Modified DD_Add for adding new customer profile
//6. DAM Added a new reserved notice description "GoCardless" - is to be used sending GoCardlessURL
//7. JCW&DAM Set PrimaryKey field for Pictures table to Automatic Indexing and Auto Increment.
//8. DAM Added GoCardless_Cancel for delition DD profile ID
//9. DAM Added chagnes to SPointImport
//10. DAM Added code for displaying error messages for GoCardless
//11. DAM Added Deposit Held report to WS_GetReportData - 7400
//12. DAM Added Staff Conversion Report to WS_GetReportData - 7401
//13. DAM Added Average length of Stay report to WS_GetReportData - 7402
//14. RWFR Fixed Ezidebit manual credit card transactions not defaulting to unconfirmed
//15. DAM Removed all black fields from UnitTypeIn form - 7519
//163 DAM Fixed tab order for Billing Plans
//164. DAM Fixed black fields and tab order on Analysis Code In form - 7525
//165. DAM Fixed text overlaping on Rent Increase Rules - 7506
//167. DAM Fixed WS_GetData
//20. JCW Fixed missing headings throughout Storman - 7501, 7493, 7499, 7500, 7494, 7501


//Changes in 9.1.9 / 9.2.1 16/06/2014
//1. DAM Fixed WS_GetReportData was using 31/05/13 for RentinAdvance calculation
//2. JCW Added a search in BankingSumry to search for only Active Analysis Codes before generating report, incase of inactive double up codes.
//3. RWFR Fixed CCNo display on StoredPAN form
//4. RWFR Fixed delete units button checking wrong permission
//5. RWFR Fixed quotes using analysis categories not handling waiting list correctly
//6. RWFR Fixed WS_GetInvNo using wrong variable to get site invoice number
//7. DAM Modifyed System Setup for a new merchant provided GoCardless
//8. RWFR Fixed next reservation number grabbing incremented value in some situations
//9. DAM Increased External IP length to 100 characters 


//Changes in 9.1.9 09/06/14
//1. RWFR Replaced checks for ProductCode with <>sProduct for next numbers in system setup
//2. DAM Fixed error not showing when sending emails.
//3. DAM Added loggings for sendmail. It uses value from CC loggings and triggest on 1 and 2

//Changes in 9.1.9 06/06/14
//1. DAM Fixed Alertmessage when entering PIN for staff members in Access Control - 7077
//2. DAM Fixed Initial backups not working - 6532
//3. DAM Fixed Sort Order for Rate variation history report - 7264
//4. DAM Fixed unit not showing on agreement if performing a new move in from dashboard - 7283
//5. DAM Changed parameters for KSS CURL Reservation API
//6. DAM Fixed button "Select all" for permissions if used not with English version of Storman - 7016
//7. DAM Changed page layout for [Eventlog]PrintLog, changed time format for EventTime - 6548
//8. RWFR Fixed insurance prorata calculation not working when changing rate - 7199
//9. RWFR Fixed Recalc not getting charges in selection when fixing broken matching - 7378
//10. RWFR Daily date is now appended to ASB bank export files - 7407
//11. DAM Added changes to JSON structure for KSS case - 7412
//12. DAM Fixed Activity record is locked during daily and Unit is locked alertmessage - 7267, 7284
//13. RWFR Changed Advam Direct Debits to accept "Processing" as a completed status - 7299
//14. RWFR NextAgree/Reserve/Credit/Inv/Contact numbers no longer sync between site and head office - 7180
//15. DAM Added new field [Faciity]MobileFormat to save format for all mobiles phones. System setup -> Settings 2 - 7409
//16. DAM set all mobiles numbers to use format [Faciity]MobileFormat if <>bFormatMobile=true from FacCountry.xml - 7409
//17. DAM Added new field [Customer]AltDOB - 7410
//18. RWFR Added semaphores and web service added for handling next invoice number -7180
//19. RWFR Note about rent paid up until changed to your account paid up until - 7181
//20. RWFR Recalcinsurance method will prompt to select sites on a MV - 7395
//21. DAM Added method CallAUPost
//22. DAM Added new field [Barcode]Billed for AU Post call
//23. DAM Added changes to WS_BnSCreateRes, WS_BnSSendReceive, WS_AddReceipTrx
//24. RWFR Fixed BillNextCharges using invalid prior billing details when undoing last charges -7419
//25. RWFR SyncRequestEvents no longer uses WS_EventCountOut as variable name as it was never set, uses the correct $EventCount variable
//26. JCW Redesigned Welcome to Storman form for each of the Demo Versions, contact and email are now buttons. Each URL goes to correct Web Address. - 7046, 6342, 7204
//27. JCW Fixed xliff on Welcome to Storman form - 7392
//28. JCW Fixed Receipt Analysis Codes for all Demo Versions - 7095
//29. JCW Fixed duplicated key during creation of Vault Demo - 7191
//30. JCW Fixed customer matching during creation of Vault Demo - 7192
//31. JCW & DAM Moved vDateFrom above the QUERY for [Notices]Description, on RentIncreaseRules. To show a date on the Output form rather than 00/00/00.  - 7279
//31. JCW Fixed First time launch of Demos, asking to create a database. - 7190

//Changes in 9.1.9 26/05/14
//1. DAM Added DD profile upload for "Transaction Express"
//2. DAM Changed DD fields visibility for "Transaction Express"
//3. RWFR UpdateReceipt & Recalc both now check for matching issues before continuing and fix them - 7378
//4. RWFR CheckPrefs now looks in correct preferences folder
//5. RWFR Fixed lower limit incorrectly setting RCDays to 0 - 6419
//6. RWFR If batch report cannot generate a report due to error or no data it will add a note to the email - 6422
//7. JCW Resized SMS template box in Notice Plans.
//8. DAM Fixed Cash Sales not updating MiscDetals field for Activity Calculation - 7387
//9. JCW Changed examples for SMS template in Notice Plans
//10. RWFR Disabled ability to add to wait list for merchandise items - 6515
//11. RWFR ASB Curl errors are logged to synclog and alerted on screen - 7363
//12. RWFR Transaction description defaults to +Refund when refunding - 6520
//13. RWFR Fixed array incrementing incorrectly when cancelling reservations - 6536
//14. RWFR Syncing site login now downloads language setting for user - 7166
//15. RWFR MiscDetls for matching are no longer written incorrectly if you change facility before saving - 7131
//16. RWFR Ninety day cash actual report always shows 31 days now - 6978
//17. RWFR When email list refreshes when viewing all emails it no longer loses selection - 7356
//18. RWFR Fixed changing billing plan periods from monthly/weekly not using system setup configuration - 6890
//19. RWFR OK is set to 0 on alert for no transactions when printing a statement in cash sales - 6936
//20. RWFR Refunds no longer create rent owing on credit sales, now show as other - 7301
//21. RWFR Login method at syncing sites alerts if userlogins record is locked
//22. DAM Set UnitType Analysis codes for individual/organization to be "RF" when importing units - 7375
//23. RWFR New cash sale narrations now save - 6734
//24. DAM Set UnitType sort order to auto increase when importing units - 7374
//25. RWFR Fixed KSS Receipts in Customer Receipts trying to print for all transactions in list - 6959
//26. RWFR OK & New button in analysis codes no longer dissapears after first clicking it - 7014
//27. RWFR Fixed text incorrectly showing in unit types when DRC was disabled - 7061
//28. RWFR Changed "Yes" to "Taxable" on income charged report - 7064
//29. DAM Fixed radio buttons for Rental Rate Variation report
//30. RWFR Fixed incorrect text when using the repeat function in insurance rates - 7083
//31. DAM Changed title "Next Step" to "Next" for Mac on Bulk Communication Wizard - 7202
//32. DAM Added order by date for Income Charged Report, won't affect previous order - 7216
//33. DAM Renamed button bCancel to bCancel1 for [Agreement]ModDetails - 7003
//34. DAM Fixed location of the analysis code drop down box for inventory transfer - 7183
//35. RWFR Added extra parameter to GetAnalysis so CalcAgedDebtors doesn't lose customer selection - 7098
//36. RWFR Changed sort on inventory item enquiry to read filter this data - 7105
//37. RWFR Fixed changing primary phone to/from mobile not altering formatting - 7312


//Changes in 9.1.9 16/05/14
//1. RWFR & ESD changed the path that DownloadMail stores the TempMsg.txt. Instead of being relative to the 4DC it is now uses <>sStormanPath+"TempMsg.txt"
//2. RWFR When an online reservation is removed it sets the sales enquiry to be followed up
//3. RWFR When an online reservation is removed a note is added to the sales enquiry
//4. DAM Set [Facility]PrimiryKey and [Group]GroupID to be indexed for 4D after v13.5
//5. DAM Fixed adding a note to sale enq when online reservation is removed

//Changes in 9.1.9  07/05/2014
//1. JCW Added individual Map scaling during the creation of Marina, Storage and Vault demos.
//2. JCW Fixed spelling mistake on Sales Promotion Report heading. 
//3. JCW Adjusted wording in file menu for "Update Storman Program".
//4. RWFR & JCW Fixed invoices ORC totals for customers with multiple agreements and multiple ORC amounts.
//5. RWFR & ESD removed "file://" from ProcessHTMLTags


//Changes in 9.1.9 30/04/2014
//1. DAM Set follow up done to true and date to 00/00/0000 for WS_CreateReservation
//2. ESD Removed UnixPathHTML method (added code into ProcessStormanHTMLTags) and further modification to ProcessStormanHTMLTags to work on Mac
//3. JCW Adjusted wording in Periodic Reporting Setup
//4. JCW Added Style Sheets for text in Support & Website form.
//5. DAM Fixed sending pictire references in emails for Mac.
//6. DAM Fixed inserting fields into emails for Mac.
//7. DAM Fixed [Agreement]InsureValue is not updating during WS_CustomerEdit.
//8. DAM Fixed Reservation deposit amount on the first tab if the amount has been changed during charging.
//9. DAM Fixed SMS messages are not saved in Letters table for Bulk Communication.
//10. DAM Changed URLs for B&S
//11. DAM Set bImport:=0 for ExportData method and for CreateTutorial to fix demo dates
//12. JCW Recreated all .SLK files for Vault, Rent, Storage and Marina Demos.

//Changes in 9.1.9 11/04/2014
//1. JCW Adjusted wording for Dated MoveIns & Outs in system setup.
//2. DAM Removed test alert message "A" during Daily for one agreement
//3. DAM Added Spoint Marina convertor - SPointImport
//4. DAM Added MMS database convertor - BerthImport
//5. RWFR Added secure cipher list to start web server
//6. ESD Added UnixPathHTML method and modified ProcessStormanHTMLTags to fix incorrect paths in HTML emails on Mac platforms


//Changes in 9.1.9 03/04/2014
//1. JCW Recalculate Balances now displays all broken CustomerCodes in a window, also added the option to Set Match to 0 and rerun for broken Trx.
//2. RWFR/JCW Fixed backup path accepting invalid paths
//3. JCW Changed Print To date on Customer Analysis Report form, to use current year.
//4. RWFR UnitIn form reduces selection on UnitAgree to 0
//5. JCW Changed Reservation form saying "Customer Code" to "Customer Name"

//Changes in 9.1.9 28/03/14
//1. RWFR Changed default URL's for web areas from http://www.storman.com to http://www.storman.com/blank.html
//2. RWFR Changed DateFormat to use Get System Format command
//3. RWFR You can use HTML Email references in SMS messages now
//4. RWFR You can use HTML Email references in Email Subjects now
//5. ESD Fixed image paths with spaces breaking in HTML email
//6. JCW Added wording for import & export buttons on Email Notice templates
//7. RWFR Fixed several issues found with Subletting

//Changes in 9.1.9 24/03/14
//1. SDD Add new method ChangeCodeandFacility to fix up Billing
//2. DAM Fixed amount for CardSave, not the amount is in cents
//3. DAM Set <>aiFacilityField{42}:=1 to be able generate Primary Keys for ORC
//4. DAM Added Boat,Owner,Utilities,Shipping,Barcode,UnitAgree tables to SetupArrays method
//5. DAM Added new input/output parameters for WS_GetData to export all fields for a table
//6. DAM Added ability for BnS Create their own auto generated emails
//7. DAM Changed OR_EmailCust to be able to send different emails if only ONE parameter is passed
//8. DAM Added changes to calculation of ORC when converting agree to res for BnS
//9. JCW Set Primary Key field for ChartTotals to Autoincrement.
//10. DAM Changed field type [InsuranceRates]Rounding from LongInt to Real as rounding can be less than 1
//11. SDD Add Customer Balances report to WS_GetReportData
//12. SDD Add Rent in Advance report to WS_GetReportData
//13. DAM Added RELATE ONE for billingplancode in Moveincode to fix ORC calculation when switching from weekly to monthly billing plans (search 05/02/13)
//14. DAM Modified WS_BnSAddTime for switching billing plans Weekly/Monthly
//15. DAM Modified Import Shipping according to the files provided
//16. RWFR Fixed banking summary running over the page in A4
//17. RWFR IBAN enabled for non-US/AU/NZ customers - will most likely need adjusting on a case by case basis
//18. SDD Increased length of [Authenticate]IPAddress field from 25 to 80 to accomodate Custodian Vaults
//19. DAM Set field [GateLog]GateKeyed to be indexed as causing sequestional searching during the changing facilities 
//20. DAM Increased tge length of the [OthChgs]Description to 80 characters
//21. DAM Changed calculation Insurnace for BnS
//22. SDD Changes to OR_OnlineReservation to stop it locking the facility record
//23. DAM Moved generation of ORCanceled email to add ability to use fields from Unit table
//24. JCW Grouped the two radio buttons on [Contacts]MonthlyEnqOpts. Unable to select the two.
//25. RWFR Fixed emails not being viewable in 920
//26. DAM Fixed ReadMXL file not recognising Deposit and Monthly rate
//27. DAM Changed <28 to <=28 for [Agreement]NoticeDaysPrior during Daily
//28. DAM Added Street suburb for BnS
//29. DAM Added changes to KSScURL
//30. DAM Fixed runtime errors for Marina datafile by replacing relateone[UnitAgree]UnitNo with QUERY([Unit];[Unit]RUnitNo=[UnitAgree]UnitNo) 
//31. RWFR Fixed errors with sublet not correctly opening new agreement
//32. RWFR Fixed unloading of facility record during mass upload
//33. RWFR Restored code changing analysis quantity on delete of line item in cash sales
//34. SDD Fixed 'Today' button on Move Out tab which allowed MoveOutDate < OutNoticeDate
//35. SDD UpdateReceipt - Update of LateCycleStDate - Changed Sum([Trxs]TotAmt) to For loop as some v4D Sum fails in compiled mode
//36. RWFR Fixed bChange code not working correctly if set when user clicks ok (as units were lost)
//37. RWFR Password field shouldn't show in clear text on Mac
//38. RWFR Fixed alignment of units text in Daily
//39. RWFR Added option to block all notices from going to customer who have reached the end of the late cycle
//40. RWFR Removed incorrect help tip from RCDays
//41. RWFR Made surcharge fields visible
//42. DAM Added new fields for [Boat] table
//43. DAM Added method FixUntitled for notices

//Changes in 9.1.9 16/01/14
//1. DAM Added changes for BnS receiving the boxes
//2. RWFR Fixed address change logging not working
//3. DAM Changed Read XMl for imporing RM marketing category
//4. DAM Fixed runtime error when changing unit status from main dashboard
//5. JCW Added new Demo Dialoge Form when first starting Storman.
//6. JCW Adjusted StartupDemo form, wording and tab box size.
//7. DAM Fixed xliff in Analysis codes/system setup/UnitTypes/Customer Balances Report
//8. DAM Added "CN" to FacCoutnry.xml
//9. DAM Fixed xliff for reports
//10. DAM Added EQuote for KSS when clicking @+ sign on ContactIn form
//11. DAM Fixed chaing facility code for Contact records because of the new trigger conditions
//12. DAM Set variable vtBackupPrefsErrorMessage to be not editable on backup tab in system setup
//13. RWFR Added FixInvNos method for KSS
//14. RWFR On setting invoice number for a transaction it checks there are no higher currently present, if so it uses the next valid one
//15. RWFR Changed copyright date to 2014

//Changes in 9.1.8 30/12/13
//1. RWFR Fixed cash sales not obeying cant mod prior correctly
//2. RWFR Added CustomRate parameters to WS_CreateReservation

//Changes in 9.1.8 18/12/13
//1. RWFR Added method called FixCashSales to fix where the date of the charges/receipts do not agree
//2. RWFR Altered auto quit client behaviour
//3. RWFR Updater now creates a batch file which waits 120 seconds before launching the installer silently
//4. RWFR Replaces [Transaction] with [Trxs] on upgrade
//5. DAM Increased size of the field [Authenticate]IPAddress to 25 characters to save IP + Port number

//Changes in 9.1.8 13/12/13
//1. SDD Changes to ModFacility to allow it to work on a MV server (with great care) - Have not changed the areas that would allow this to happen, so can only be run from Execute
//2. RWFR Fixed date formats being set incorrectly on move out tab and general tab of credit sales
//3. RWFR Fixed spaces being allowed in customer codes and standardised where it is being called using method RemoveSpecial
//4. DAM Set the field [Agreement]NewBillingPlan to [BillPlan]SwaptoCode on switching to new Billing Plan
//5. RWFR Changed lock status and sales promotion report to use listboxes
//6. RWFR Fixed DownloadMail SMS references not working when customercode was short
//7. RWFR Changing agreement billing plan period type with insurance plans on uses InsuranceCalc now
//8. RWFR Removed code on shift key breaking calendar (showed calcerrors but got rid of normal note)
//9. RWFR NinetyDayCash uses CalcNextBillDate method to subtract months as AddToDate missed last days of months
//10. DAM Fixed xliff variables during DP and on ReservationIn form
//11. RWFR Fixed stock valuation report header level being too low
//12. RWFR Fixed eventlog exceptions report dialog not using date selected
//13. JCW Renamed CDR Column from [BillPlan]FreeMths to [BillPlan]FreePeriods
//14. DAM Set unittype online rates invisible according to the unittype settings
//15. RWFR Fixed printinvcode setting tBoolean to True
//16. RWFR Made text areas on login form bigger
//17. RWFR Fixed reservation receipts breaking customer receipts form
//18. RWFR Made select all button on select sites form bigger
//19. RWFR Occurances of [BillPlan]FreeMths are replaced on upgrade with [BillPlan]FreePeriods
//20. RWFR Fixed radio dialogues on PaidToDate report
//21. RWFR Fixed SelectCust using On Printing Detail form event instead of On Display Detail
//22. RWFR PeriodReportsPrint deletes message if no attachments generated
//23. RWFR Fixed paid to date, unpaid values and overdue not being calculated correctly if no transactions were matched off only added in the past
//24. RWFR Fixed no sorting occuring on display of transaction in agreement sometimes
//25. RWFR Fixed new demos not opening
//26. DAM Fixed switching between live and demo datafiles.
//27. DAM Added to fix the runtime error for sets not being defined for agreements with no transactions.
//28. JCW Regrouped both sets of Radio Buttons in Unit Status Report form. 
//29. JCW Added a query to the Income Charged Report, Description. To only search for Active Codes

//Changes in 9.1.8 29/11/13
//1. RWFR Fixed SyncOnOff not setting last sync date/time as prompted
//2. RWFR Fixed SyncOnOff not changing menu names in correct process
//3. RWFR Fixed StartWebServer not changing menu names in correct process
//4. RWFR Fixed opening photos/pdfs using tutorial path instead of pdfdocs path
//5. RWFR LogAction no longer prompts to disconnect other users

//Changes in 9.1.8 26/11/13
//1. SDD ExportSageInvoices - Was only sending matched trxs - have changed to send all trxs, and fixed endless loop
//2. SDD Extended width of buttons on Confirm dialogs
//3. SDD Updated GetValidDate and used in all cases where [Trxs]TrxDate:=something to check for Date>=[Facility]CantModPrior
//4. SDD Fixed Insurance refund calculation by 1 day to match actualy MoveOut calc
//5. SDD ArraysToText - modified to detect condition where multiple arrays are of a different size
//6. SDD DailyA - Modified to disallow entry of missing Analysis Code during start up checks
//7. SDD System Setup - Dont allow Tax Exempt agreements if turning off Allow Tax Exempt Agreements
//8. SDD Main Control Screen - Changed to use Call Process and On Outside Call as Post Key doesn't seem to work in v14
//9. SDD WS_Sync Modified to handle SeqNo Mismatch that is 1 out between site & HOF
//10. SDD WS_Sync Fixed bug where LastUpdateTime was still being updated when there was sync mismatch / Also not logging Mismatch in SyncLog.txt
//11. SDD SyncRequestEvents - If Soap Server not reachable error then wait 15 mins and try again
//12. SDD InvRecCode - Changes to display AgreeNo and UnitNo for Billing with appropriate legends
//13. SDD Contacts Trigger - Modified to enforce FacilityCode matches start of ContactNo
//14. RWFR Customers with CC profiles have all CC fields cleared when switching from a tokenized system
//15. DAM Fixed Bulk Communication Wizard not displaying email content if there are 2 notices with the same name
//16. DAM Fixed Bulk Communication not sending emails to inactive customers with more than one inactive agreement
//17. DAM Increased the site of email address field for Bulk Comm Report
//18. DAM Fixed RVHistory report showing incorrect Unit numbers
//19. DAM Changed footer picture format for InvReceiptTwo to be Truncated (non-centered)
//20. DAM Fixed runtime error when opening Analysis code if there are no Analysis categories.
//21. DAM Changed column name for Fiscal printer
//22. DAM Fixed Customer name not showing when printing Inv for cash sale for fiscal printer
//23. DAM Commented Unload records for TrxReceiptAccept
//24. RWFR SK insurance set on upgrade
//25. RWFR Stopped lower activation in rent control update decreasing time at current occupancy
//26. RWFR Fixed Cash Sales tax calculation when editing net value
//27. RWFR Removing quote from waiting list removes , as well
//28. RWFR Removing quote from waiting list if last one will remove sales enquiry from waiting list
//29. RWFR Fixed periodic reports display issue on Mac
//30. RWFR Fixed listbox row and array value getting out of line for select notice
//31. RWFR Fixed InvState2Calc using customer for trx search when it should use agreement
//32. RWFR Added more logging into the banking report to alert for locked records
//33. RWFR PrintOutDel now has option to hide Storman SMS notes
//34. RWFR Fixed missing text on demo welcome screen for Mac
//35. RWFR EventlogAgreement & EventlogReservations limit search to facility
//36. RWFR Cash Sales will alert if trying to print invoice or statement when no cash sale is selected
//37. RWFR Fixed PrintReceiptOption when not being called from cash sales breaking
//38. DAM Fixed conversion from US date format to NZ for gate systems
//39. RWFR Fixed Quitnow method being set to execute on server when it shouldn't
//40. RWFR Fixed GetValidDate calling SetFacility breaking daily

//Changes in 9.1.8 15/11/13
//1. DAM Fixed xliff in system setup for autopay bank account
//2. DAM Added button for Storman SMS to check balance in System Setup
//3. DAM Fixed Import function for Email Notices
//4. RWFR Fixed turn syncing on/off changing menu item the wrong way
//5. RWFR Date on Direct Debit export files is now Daily instead of current date for when running multiple days
//6. RWFR Address fields are loaded for cash sales custom receipts
//7. RWFR Fixed inventory item enquiry showing customers for purchases, adjustments & transfers
//8. RWFR Printing inventory item enquiry no longer shows incorrect transactions afterwards
//9. RWFR Fixed TrxListSort not matching dropdown sort routine
//10. RWFR Fixed PrintReceiptOption not prompting to select transaction
//11. RWFR Fixed PrintReceiptOption calling Recalc when it shouldn't
//12. RWFR Fixed PrintReceiptOption changing tBoolean to False
//13. RWFR Fixed reversed sorting of Sales Enq No & When Required for Contacts
//14. RWFR Rebill prompt works in all cases of changing billing plans now
//15. RWFR Manually entering a new billing plan will trigger change of billing plan after next billing now
//16. RWFR Removed code blocking customers with a new billing plan to not get rent increase notice
//17. RWFR When analysis cannot be found in LoadAnlysArrays and using lists it displays description rather than dropdown
//18. RWFR When analysis code cannot be found LoadAnlysArrays disables entry rather than setting Trxs to read only
//19. RWFR Fixed bill next charges showing incorrect amount when rent increase was due and the agreement has multiple units
//20. RWFR ApplyForm turns automatic relations off before executing method then back on
//21. DAM Added code for changing Facility Code correctly
//22. RWFR Set UnitTypeCode not to be unique, RUnitType still is
//23. DAM Set all charges analysis codes to be shown for ORC 
//24. RWFR Fixed ResLetterRef losing Trxs in selection
//25. RWFR Fixed EmailInvoice trying to use sets that didn't exist
//26. RWFR Fixed EmailInvoice when the user cancelled in a reservation from trying to create the invoice anyway
//27. RWFR Fixed reservation alert notes being logged with the wrong category and format
//28. RWFR Fixed not working learn more link on transaction tab of Reservations
//29. RWFR Fixed EmailInvoice not setting $Resv if more than 1 parameter was passed
//30. RWFR Fixed display issues when not using control screen
//31. RWFR If send by email is ticked but no email address is filled in you cannot save the agreement
//32. RWFR If send by SMS is ticked but no mobile number is entered you cannot save the agreement
//33. RWFR Removed tooltips from length/width/area in units as they didn't make sense for rentals
//34. RWFR Entering gatePIN for a customer only checks if the gatePIN has changed
//35. RWFR Fixed minimum PIN length showing as Alarm
//36. RWFR Adminsupport & Designer logins should no longer take up slots of the customers licence
//37. DAM Fixed alertmessage for BSB number
//38. RWFR Fixed incorrect note & help tip on RCEmail
//39. RWFR InsuranceCalc uses the [Facility]InsWeeklyMthly field
//40. RWFR Added new permission for deleting units
//41. RWFR Added missing xliff variables for permissions and their descriptions
//42. DAM Fixed tickboxes on Header/Footer for custom designed Inv
//43. RWFR Fixed CheckInvQty not running if analysis categories were not setup
//44. RWFR Fixed CheckInvQty not running correctly on server
//45. RWFR Added suburb to printoutold form
//46. DAM Added options "Organization" and "Individual" to the drop down at the Mail Merge
//47. RWFR Fixed OK & Next in Transaction Receipts not unloading customer
//48. RWFR Added date of report to event log exceptions
//49. RWFR Fixed behaviour of event log exceptions dialog
//50. SDD Various field width and height adjustments to accommodate Mac (& Windows for that matter)

//Changes in 9.1.8 12/11/13
//1. RWFR Removed unavailable from the map legend as they don't show
//2. RWFR Set email sending timeout to 120 seconds
//3. RWFR Fixed cancel in reservations not rolling reservation number back if applicable
//4. RWFR Deleting a quote will check if it is a preferred unit type and remove it if applicable
//5. RWFR Credit card refunds will now say that in the description
//6. RWFR LetterPrint no longer tries to print emails, gives instructions instead
//7. RWFR LetterPrint no longer tries to print when no letter is selected
//8. RWFR Fixed print notes in contacts not working when All category was selected
//9. RWFR Changing quote from unit type to analysis code clears it from the waiting list if set and disables the waiting list option
//10. RWFR Changing quote from analysis code to unit type enables the waiting list option
//11. RWFR Fixed cancel button not being disabled in Cash Sales after processing credit card
//12. RWFR UnitHistOut, CreditSaleOut & ReservationsOut when sorting by Alpha Order uses CustomerName not CustomerCode now
//13. RWFR MessageEdit form requires @ and . in email address to be able to save message now
//14. RWFR Added blank string to end of each call of MESSAGE
//15. DAM Added Alertmessage for CardSave if there is an error

//Changes in 9.1.8 11/11/13
//1. RWFR Fixed contacts new emails not opening form with correct settings
//2. DAM Fixed runtime error for CardSave when the card is decliened

//Changes in 9.1.8 08/11/13
//1. RWFR Waitlist opens in a new process
//2. RWFR Waiting list no longer cuts off form
//3. RWFR Set Journal PrimaryKey to autoincrement
//4. DAM Added CardSave CC processing for UK
//5. RWFR Set Cashbook, cashbooktrxs, chartaccts PrimaryKey to autoincrement

//Changes in 9.1.8 07/11/13
//1. RWFR Fixed floatbox not showing all 8 processes
//2. RWFR Fixed wrong date format used for Next Bill Date
//3. RWFR Changed shortcut for print notes on control screen from Ctrl+V to Ctrl+P
//4. RWFR vUnits is set to blank before each line of the Income Charged Detail report
//5. RWFR Export data file exports emails as 4e7 now
//6. RWFR Fixed bCheckMatch not being decleared when doing batch print or email for Income Received
//7. RWFR Unit coordinates can no longer be made negative
//8. RWFR Stopped sort orders lower than -1 for facilities
//9. RWFR Warning given when setting sort order to -1
//10. RWFR Lengthened CustomerName to 255
//11. RWFR Lengthened ContactName to 255
//12. RWFR Fixed commissions module tickbox being marked as invisible by default
//13. RWFR Fixed dropdown for weekly/monthly conversion being hidden
//14. RWFR Fixed progress windows not closing
//15. RWFR Fixed Add/Edit/Delete button statuses not being changed when adding a credit card via all cards (was overriding previous fix)
//16. RWFR Added new online monthly/weekly/daily rates fields
//17. RWFR WS_CreateReservation now uses Online rates fields
//18. RWFR Online reservations now uses Online rates fields
//19. DAM Changed URL for Kintek
//20. RWFR Added new field to control Vacant DRC for online (on or off)
//21. RWFR Made new duplicate method of RentControlUpdate to run on Online Rates

//Changes in 9.1.8 05/11/13
//1. RWFR Analysis QtyOnHand auto-recalculates in Stock Inquiry rather than prompting
//2. RWFR Fixed style sheet on subject for bulk communication emails
//3. RWFR Fixed missing style sheet on column titles for [UnitType]OccupSmall
//4. RWFR Rounding customer balance in MoveInCode to 2 d.p. to get around floating point precision issue
//5. RWFR Added new option in system setup to control converting rates in agreements/reservations from one period to another (e.g. Monthly to Weekly)
//6. DAM Added changes to SiteLink Converter
//7. DAM Fixed Deleting profile for DD EziDebit 
//8. SDD CreateRevJrnls - Fixed 2 problems where no description was being displayed for KSS
//9. SDD LogMonitor - Fixed problem where message about sites not done LastDaily would appear every 10 seconds
//10. RWFR Future dated transactions no longer trigger overdue message on invoice
//11. DAM Added [Facility]ExtrnalIP field System Setup - Security tab
//12. RWFR Fixed vName being updated by uploading of CC details for StoredPAN
//13. RWFR Fixed Add/Edit/Delete button statuses not being changed when adding a credit card via StoredPAN or BPoint
//14. RWFR ModReceipt unloads credit card variables from enter card when closed

//Changes in 9.1.8 31/10/13
//1. RWFR Fixed Search method looking for non-existant TrxsIn form (renamed TransactionIn to fix)
//2. RWFR Altered calculation of days stayed for graph of occupancy summary
//3. RWFR Updated StoredPAN to v2
//4. RWFR Fixed double uploading of StoredPAN ID's
//5. RWFR Fixed update button showing instead of upload on initial StoredPAN creation

//Changes in 9.1.8 29/10/13
//1. RWFR Re-enabled print for periodic reporting by creating a user with the address of Print
//2. RWFR CC fields now show on autopay printout when not disabled
//3. RWFR Map now saves when pressing enter
//4. RWFR Stopped outnotice date being able to be set in the past even when the user has no permission
//5. RWFR Narration prints for cash sale charges
//6. RWFR EmailAutoCC recalculates paid to date
//7. RWFR Notice plan number set correctly on creation of new agreement
//8. RWFR Using OK & Next in receipts will no longer break balance
//9. RWFR Restored average length of stay calculation for graph of occupancy summary
//10. DAM Added SiteLink method for conversion
//11. DAM Added additional loggings in GateAction / LoadGateUnits for facility SSPSS
//12. SDD ExportSageInvoices - Modified to send Inactive Customers, Use AgreeNo for Receipts, Change SC to SP for Receipts and fix email addresses with commas
//13. RWFR Replace ' with &#39; when saving HTML areas
//14. RWFR Fixed periodic reporting settings not saving
//15. RWFR Fixed periodic reporting not generating correctly for print/email

//Changes in 9.1.8 24/10/13
//1. SDD Customer Receipts and Customer Charges - Added Last Month to drop down menu
//2. DAM Fixed Runtime error for Invsystem=0 in InvRecCode (Search for 08/10/13)
//3. DAM Added code for Fical Printer for DP/Cash Sales/Reservations/Credit Sales
//4. SDD On Startup - Moved InitSites later in method and won't run if Shift Down to allow opening of old datafiles
//5. DAM Added new WS_MarketSrce for setting marketing category for WS_CreateReservation
//6. DAM Added reading Deposit amount from Ores file and setting the reservation balance to it for WS_CreateReservation
//7. DAM Fixed WS_GetUnitTypes returning all Unavailable units instead of all Vacant
//8. SDD Turned on Unique attribute for Primary Related Keys, RAgreeNo, RReserveNo, RUnitNo, to avoid duplicate records
//9. RWFR Renamed transaction table to trxs
//10. RWFR Added commissions module as a paid item
//11. DAM added new paramter to CaclRentedValues for WS (silent mode)
//12. DAM Added new WS parameter to WS_CustomerLogin WS_adUTSize - an array with unit sizes


//Changes in 9.1.7 04/10/13
//1. DAM Fixed UnitType Drop Down list not updating when switching between units using "Previous", "Next" buttons 
//2. DAM Fixed WS_BnSQuote
//3. DAM Fixed Notes not sorted correctly on Reservation Notes & Alerts tab
//4. SDD Fixed recalculation of ORC Amounts when switching BillPlans using different [BillPlan]PlanPeriods
//5. SDD Fixed problem where sites would stop syncing after 11pm at night on New Sync
//6. SDD Added code to WS_Sync to update VersionDate at HOF
//7. SDD Code to pick up main facilityh datafile on launch and switch to that datafile
//8. SDD Changes in FixCustCodeInvalidChar to avoid duplicates - TO TEST
//9. SDD New method TempFixCustCodeDuplicates to fix up duplicates for KSS
//10. SDD Change to FixCustCodeInvalidChar to avoid duplicates
//11. SDD SelectUnitA - Fix problem where reactivate agreement did not work
//12. SDD WS_GetUnitTypes - Added four new output arrays for KSS - WS_UTArea,WS_UTNoTotal,WS_UTUnitTypeLength,WS_UTUnitTypeWidth

//Changes in 9.1.7 27/09/13
//1. SDD Other Regular Charges - Made separate array and controlled by [Analysis]DontShowBank to indicate it is an ORC type of Charge
//2. SDD Analysis Codes - Display DontShowBank on Charges with title Show as Other Regular Charge
//3. SDD Reformat Automatic Receipts Form to eliminate truncated fields
//4. SDD Save Datafilename in Preferences folder and locate on upgrade to start with company datafile
//5. DAM Added changes to InvRecCode for country PA for Fiscal printer
//6. SDD WS_Sync - Changed logging message to show received from site
//7. RWFR Fixed credits not showing on statements for KSS
//8. RWFR Added ImportShipping method
//9. RWFR Added WS_DepositAmt to BNS Quote

//Changes in 9.1.7 20/9/13
//1. SDD SendEmail - Add On Err Call to avoid error message on server
//2. SDD ChangeDaytoBill - Fixed so it does run the method after the first BillNextCharges
//3. RWFR Pro-rata of OtherRegularCharges now correctly uses [Agreement]MthsAdv instead of [BillPlan]PlanPeriods
//4. RWFR Credit Card numbers report - Changed to print last 4 digits of CCNo for KSS only
//5. SDD EmailIn - Change message on the bottom of the form for KSS
//6. RWFR - Moved Qty out of round

//Changes in 9.1.7 19/9/13
//1. RWFR Fixed WS_CreateReservation not allowing current date (again!?)
//2. RWFR Fixed unit type code for KSS
//3. RWFR 100% credit percentage only uses cost price for used items for KSS
//4. SDD RemoveUnit - Change calculation of LastBillAmt to use Actual Rented Rate instead of Rack Rate
//5. SDD SyncUpdateRecord - Modified so that DEL events will always Delete the record even if the LogDetail does not match the previous fields
//6. RWFR Fixed credits where qty > 1 for KSS
//7. RWFR Removed customer signature boxes off of invoices

//Changes in 9.1.7 17/09/13
//1. RWFR Fixed description of unit type not being set correctly for KSS when changing width or area
//2. RWFR Unit type defaults to first analysis code in list
//3. RWFR Analysis category defaults to first option in list
//4. RWFR Fixed insurance permission not working correctly (was checking wrong permission)
//5. RWFR Fixed select/unselect all buttons in modify groups
//6. RWFR Set minimum default timezone to 0, set maximum to blank
//7. RWFR Made permissions areas bigger
//8. RWFR Added select/unselect all for facilities/users
//9. RWFR Fixed facility selection for users
//10. RWFR Fixed change day to bill using bill plan periods instead of [Agreement]MthsAdv+[BillPlan]FreePeriods
//11. RWFR Fixed EmailAutoCC setting transaction table to read only

//Changes in 9.1.7 15/09/13
//1. SDD Fixed calculation of PaidToDate for BillPlan that is based on Days
//2. RWFR Added unit type changes on upgrade for KSS
//3. RWFR Fixed endless loop in periodic reports if you click cancel on daily
//4. RWFR Fixed progress window during periodic reports
//5. SDD TriggerLog - Modification to only send specified number of fields as it was back in Sept 2012 for KSS HOF
//6. RWFR Insurance is variable in WS_BNSCreateRes
//7. RWFR Added new WS_BNSQuote
//8. RWFR Added new WS_BNSPostcode
//9. RWFR Moved LoadListBoxColour to ControlCode

//Changes in 9.1.7 11/09/13
//1. RWFR Changed format of Unit Size description for KSS
//2. RWFR Userlogins/groups list boxes are no longer editable
//3. RWFR Removing insurance now correctly calculates a pro-rata
//4. RWFR Changed Unit Type code format for KSS
//5. RWFR Enabled OK button if the user has permission to edit comments
//6. RWFR KSS re-rounds to nearest 10c for returns where percentage # 100
//7. RWFR Custtype must be entered for KSS before converting
//8. SDD DoBillNext - Changed so that PriorDisc is updated even when LastDisc=0
//9. SDD CreateTrxMoveOut - Changed to always be tax inclusive even for TaxAddToAmt=True since that LastBillAmt should always be Tax inclusive
//10. SDD SelectUnitA & RemoveUnit - Modified to correctly adjust the LastBillAmt & LastDiscAmt fields after adding or removing a unit - This will enable refunds to be calculated correctly
//11. NOTE in relation to the above item this change also needs to be made in the Transfer button but I could not find where this happens

//Changes in 9.1.7 06/09/13
//1. RWFR Restored some indexes to the UnitStatusTrx table to prevent long searches
//2. RWFR Fixed RentAnalysis/OrgAnalysis being changed when opening unit type form
//3. RWFR Unit changes are saved in bChange = True before recalculating vTotal as it loses it otherwise
//4. RWFR SKBilling won't use LastBillDate as invoice date
//5. RWFR Moved old 4D Write email to its own form
//6. RWFR <>asEmailSendToReports array added
//7. RWFR Select sites now uses a listbox
//8. RWFR Changed Units available at other site to use list boxes
//9. RWFR Removed invalid fields from units available at other site
//10. RWFR Fixed units showing wrong rates when billing plan has been changed
//11. RWFR Period Report print now allows users to receive different emails
//12. RWFR Period Report print has a progress window
//13. RWFR Periodic report loads/saves settings to users
//14. RWFR Company name/trading as on invoices now stored in vtCompanyName
//15. RWFR Sales enquiries now set vText
//16. RWFR Hid CheckInvQty messages on server
//17. RWFR Billing plan loaded when display unit list on agreement

//Changes in 9.1.7 04/09/13
//1. RWFR Fixed insurance not allowing changes correctly
//2. RWFR Fixed crashing of emails on IE10
//3. RWFR Fixed various locations setting url to about:blank - causes issues with IE10, defaulting to our website
//4. RWFR Fixed On Unload not being enabled by all email forms causing them never to unload emails
//5. SDD Transaction Description - Found a place where it was getting truncated to 30 chars - changed to 80
//6. RWFR Fixed upper increase of rent control update when sending an email decreasing rents
//7. RWFR Fixed upper increase  of rent control update when not sending an email setting it to $0 if upper rate maximum is $0
//8. RWFR Fixed SKBilling to stop it executing for other users
//9. RWFR vTotal is now recalculated when bChange = True in MoveInCode
//10. RWFR Hidden transfer button for KSS
//11. SDD Add Check Activity of Income section prior to Periodic Reporting
//12. RWFR Fixed Unit Type Code change in Unit not resetting sizes where appropriate


//Changes in 9.1.7 02/09/13
//1. DAM Added [Authenticate]ReferenceID for Box and Store when there is a refund to a customer
//2. DAM Added WS_BnSConfirmReturn for Box and Store to call Storman when there is a refund
//3. RWFR InvHeader_, InvFooter_ & Receipt_ fields are able to be copied to other facilities
//4. RWFR Fixed facility record not being loaded causing sales enquiries prompt not to show
//5. RWFR Fixed invoice date: showing instead of date: on invoices
//6. RWFR Fixed upper DRC using semi-colon as email seperator still
//7. SDD Fixed bug in Cash Sales causing InvPack Disc Amt to have incorrect tax amount
//8. RWFR Fixed upper DRC being set to $0 if upper limit was 0
//9. RWFR Insurance amounts are calculated for daily billing plans
//10. RWFR Now supports stacking repeating insurance in InsuranceCalc
//11. RWFR Now supports stacking repeating insurance in RecalcInsurance
//12. RWFR  Now supports stacking repeating insurance in RemoveUnitTransfer

//Changes in 9.1.7 27/08/13
//1. RWFR Fixed PATG
//2. RWFR Fixed unit selection being changed not allowing you to edit unit values on agreement

//Changes in 9.1.7 26/08/13
//1. SDD/RWFR Fixed control screen text
//2. RWFR Added rounding for insurance plans
//3. RWFR Added ability to hide amounts for next rent due
//4. RWFR Fixed webID permission selection
//5. RWFR Added ability to hide next rent amounts from invoice
//6. RWFR Fixed total not including other regular charges on invoice
//7. RWFR Added fixing follow dates, recalc balances, insurance rate rounding & lastdiscamount to checkversion
//8. DAM Added code for Fiscal Printer for Panama
//9. SDD/RWFR Fixed incorrect ordering on invoices
//10. SDD Fixed problem of multiple units in description line when DoBillNext
//11. DAM Added "Delete prof" button in System setup for removing Advam/Bpoint customer profiles ID


//Changes in 9.1.7 23/08/13
//1. RWFR Fixed auto client quit hiding when it shouldn't
//2. SDD Fixed Is a folder problems from conversion back from v13
//3. DAM Set fields [Transaction]InvNo, [NotesHistory]ContactNo, [Contact]ContactNo to be indexed
//4. DAM Added code to read arrays with next values from Server when closing system setup (search for 12/08/13)
//5. DAM Added WS_WebServicePassword to WS_GetActivityData
//6. SDD CalcRentAdvance method - fixed divide by zero problem at line#165
//7. DAM Added ability to Add notes passing Agreement number for WS_AddNote
//8. DAM Fixed CCExpiry notices were not being sent (search for 19/08/13)
//9. RWFR Fixed edit unit types & rates permission not working correctly as it was checking for old unittype being "" when it should of been not ""
//10. RWFR Added new field HideNotice to Notices table and have changed places hiding AutoCC to hide these instead
//11. RWFR Converted UserLoginsIn and GroupsIn to use list boxes
//12. RWFR Customer type mandatory for KSS in Contacts
//13. RWFR Fixed RCOccDays being set to 0 in RentControlUpdate
//14. RWFR Fixed initial customer permissions being loaded incorrectly in CreateGroupArrays
//15. RWFR Moved vFind & vNote get edited text to be done on after keystroke on objects rather than timer, may help with vNote getting cleared as well
//16. DAM Added shipping charge to MO calculation (search for 21/08/13)
//17. RWFR Added ability to configure accepted card types to Banking tab in system setup
//18. RWFR Added logging to MV_CheckMVUserPW
//19. RWFR Stopped add/remove unit adjusting last bill amounts
//20. RWFR Fixed CC Upload not always clearing customers credit cards
//21. RWFR Fixed Advam StoredPAN checking for custpaymentID
//22. SDD Cash Sales - Fixed problem when deleting line item adjusted Inv Qty twice
//23. SDD REMOVED Daily Processing - UpdateActivity - Added code to check and adjust income numbers over the past 32 days
//24. DAM Fixed WS_GetActivityData - when refereing should use pointer instead of the value fo the pointer
//26. DAM Changed name of input parameter for WS_GetActivityData
//25. DAM Done changes to WS for BnS
//26. SDD Cash Sales - Fixed problem where new lines added did not adjust the Qty correctly
//27. SDD Cash Sales - Fixed problem with calculating of discounts
//28. SDD WS_Sync - Modified web service syncing to report incoming IP Address and respond to 301,302,etc type delay requests
//29. SDD Control screen - Fixed sorting issue which caused Bal Owing column to be incorrect

//Changes in 9.1.7 29/07/13
//1. DAM Set [UnitType]Description field to be editable for KSS
//2. DAM Added new field [Facility]TransferWizard to be able to disable New Transfer Wizard feature
//3. SDD Modified Agreement Trigger to generate an error if there is no customer code on a valid agreement gives -16003
//4. DAM Added code to check size of arrays in LogMonLoopCode (search for 29/07/13)
//5. DAM Modified xliff at PromotionsIn form
//6. DAM Added new WS WS_GetData to pull data from [Agreement],[Customer],[Reservation],[Contacts] tables
//7. DAM Set field [Letters]ContactNo to be indexed field (to remove sequential searching)
//8. RWFR Fixed RentControlUpdate setting the control field to 0 instead of the tracking field
//9. SDD InsuranceCalc - Stopped pro-rata dialogs displaying when amount to apportion is zero
//10. RWFR Fixed decreasing rates for RentControlUpdate not setting Fixed to 0 if not set
//11. RWFR Fixed decreasing rates for RentControlUpdate checking wrong field for percentage
//12. RWFR Fixed dropdowns/buttons on unit types being editable even when the user had no permission
//13. SDD New method called FixCustCodeInvalidChar to fix the apostrophe problem at KSS.  Only to be used by us, and not connected to any menu
//14. RWFR Fixed bChange/bChangeNew being called when no units are selected
//15. SDD Modified the syncing of pictures to use the codec that is stored in the [PhotoCards] table i.e. .jpg - This should be tested before release!
//16. SDD Fixed SyncUpdateField to also work for the PhotoCards table which is wasn't
//17. RWFR Fixed previous/next buttons not being disabled in unit types when the ok button was
//18. RWFR Added permission to control unit comments
//19. RWFR Added permission to control editing the WebID
//20. RWFR Added permission to control overriding insurance plans
//21. SDD Fixed resizing issues of ListBox on main Control screen
//22. SDD Fix bug where LastAnalysis could select an invalid Analysis code when entering Receipts
//23. RWFR Analysis table now errors when trying to save record with invalid Analysis code
//24. RWFR Moved phone format to display settings in system setup
//25. RWFR Disabled rounding for buybacks
//26. RWFR New option to hide web areas during daily to prevent crashing added
//27. DAM Set the [EventLog]KeyValue to be indexed (to remove sequential searching)
//28. DAM Added Activity table to InitNextPrimaryKeys to fix runtime errors when saving new records


//Changes in 9.2.0 23/07/13
//1. DAM Fixed the issue when switching between units the UnitType is not updated.
//2. DAM Added WS_CTStoredBefore to WS_CreateReservation for KSS, issue 161. (Search for 15/07/13).
//3. DAM Removed sub header from Inv Valuation report.
//4. DAM Added "modifyed" QB export.
//5. DAM Added method "Standardization" currently available only for SK.
//6. DAM Fixed QB export file extention for Mac.
//7. DAM Added code for recalculation Resercation balance for Web payments (Search for 18/07/13)
//8. DAM Added code for releasing records in WS_AddReceiptTrx
//9. DAM Added code for deleting [BarCode] table records if reservation is getting deleted

//Changes in 9.2.0 17/07/13
//1. DAM Set [Unit]InsureCertNo to "" on MO.
//2. DAM Increased length [UnitType]Description from 25 to 50 characters
//3. DAM Changed particulars for ASB Direct Debit to say DIRECT DEBIT
//4. RWFR Changed reference for ASB Direct Debit to be [Facility]LastDaily date
//5. RWFR BouncedEmail method added

//Changes in 9.2.0 16/07/13
//1. DAM Added code for releasing [Contact] Record in WS_CreateReservation. (Search for 11/07/13)
//2. DAM Added code for releasing records in WS_CustomerEdit. (Search for 11/07/13)
//3. DAM Added code for releasing [Customer] record WS_CustomerLogin
//4. DAM Added WS_CallTakenBy to WS_AddContact/WS_CreateReservation/WS_AddAgreement (Search for 15/07/13)
//5. DAM Set [Customer]CustType to be = [Contact]CustType when converting contact record to reservation (Search for 15/07/13)
//6. DAM Added WS_CTCustType to WS_CreateReservation/WS_AddAgreement
//7. DAM Set [Agreement]UserLogin:=[Reservation]UserLogin when for WS_ConvertReservation

//Changes in 9.2.0 09/07/13
//1. DAM Replaced array <>aiPrimaryKeyField with <>aiFacilityField to be able to clear whole table when using Send Data to Remote site search 25/06/132
//2. DAM Increased size of the field [Unit]InsureCertNo to 20 Char
//3. DAM Moved Customer Info 3 tab to the 4th place
//4. DAM Added contra record to ASB export.
//5. DAM Added feature to transfer units with insurance only for Vault
//6. DAM Set followup date to 00/00/00 and followupdone to true when creating a reservation and passing WS_OREnquiryNo
//7. DAM Copied all changes fro Vaults: additional fields in customer table
//8. DAM Changed WS_CustomerEdit to return values regarding locked [Customer] table

//Changes in 9.2.0 24/06/13
//1. DAM Modified WS_BnSCreateReservation to avoid error -16002 for Reservations
//2. RWFR LogEvent now checks type of $11->
//3. DAM Fixed WS_BnSCreateRes when there are no units in selection 
//4. RWFR Blank analysis codes are deleted on startup
//5. RWFR Incorrect notes/letters deleted on creation of sales enquiry
//6. RWFR Customer/agreement/reservation balances checked when opening agreement or reservation
//7. RWFR Fixed billing plan issue with regards key stats
//8. RWFR Fixed moveout transaction date
//9. DAM Fixed not real move out when removing units from agreement
//10. DAM Fixed agreement balance when opening customer with multiples agreements. search for 19/06/13
//11. DAM Fixed deletion all records during working with sales enq search for 19/06/13
//12. DAM Changed MO/Transafer Unit Prorate calculation based now of LastMnthAdvance instead of MnthAdvance search for 20/06/13

//Changes in 9.2.0 06/06/13
//1. DAM Fixed runtime error on closing custom designed SVG Header/Footer/Receipt 
//2. DAM Fixed xliff for Access Control Setup
//3. DAM Fixed Rental Demo requires to recalculate balances because of matching
//4. DAM Fixed mobile no format on Customer Info 2 tab
//5. SDD Fixed all 'Path' problems.  PDFDocs now in StormanFiles, and DemoDataFiles are stored in Resources, Marina.txt etc also in Resources folder
//6. DAM Fix DRC if the fixed amount is = 0 so the DRC still process the % increase or decrease
//7. SDD BillPlans - Option to Bill based on days - need to check things with Robert DoBillNext #1000, Form Method [Unit]AgreementInclNew Code double up removed
//8. RWFR Fixed incorrect characters being uploaded in name to Advam StoredPAN
//9. RWFR Removed buyback signature area on narrow receipts
//10. RWFR Fixed DailyPrint invstate2calc losing transactions
//11. RWFR Added method to find transactions with invalid analysis codes
//12. RWFR Fixed contacts generating invalid customer codes
//13. DAM Fixed Map not prompting new move in if double click on vacant unit
//14. DAM Fixed spelling mistake in system setup. Changed "Seperate" to "Separate" invoice & statement system
//15. DAM Fixed dialog window for Average Length of Stay report
//16. RWFR On adminsupport login will advise sites that lastdaily is 3 days old or more
//17. DAM Moved Boat Info tab to the second place for Marina Software
//18. DAM Fixed Customer Balances report from DashBoard
//19. DAM Fixed Next/Previous button for Units not changing the Unit sizes
//20. DAM Fixed [Unit]ReserveDeposit not changing if the deposit amount is changed
//21. DAM Fixed filter for "Month" Accounting->Customer Charges 
//22. DAM Fixed Agreement Screen Edit 1 tab
//23. DAM Changed Kinitek WS_BnSCreateRes method to avoid calculation for 2 extra boxes
//24. RWFR Fixed unit status report
//25. RWFR Fixed daily autopay report to give sub-totals

//Changes in 9.2.0 22/05/13
//1. SDD Added [Customer]WebID to Customer 1 tab of agreement processing
//2. SDD Fixed SMTP error caused by incorrect Email Address in DRC Vacant Units processing
//3. SDD Fixed Remove Unit Wizard so that wizard is not invoked if only one unit and gives alert message immediately
//4. SDD Added Search button to Customer output form in Modify Customers
//5. SDD Added DoWriteOff menu option to the Accounting menu - this make make Accounting menu too long and we may need to revisit!
//6. DAM Changed ORes sending confirmation emails to BnS customers
//7. SDD Fixed Control Screen for v13 with new ListBox for the Units / Agreements - just needs designer colour choice for highlights
//8. RWFR Fixed Rental Credits being calculated incorrectly
//9. RWFR Enabled replication - warning PrimaryKey field on Facility table must be unique now! I have set it to autoincrement

//Changes in 9.1.6 30/04/13
//1. SDD Added new webservice WS_GetActivityData which retrieves an Activity Data record for a given Facility / Date
//2. SDD Extended length of [Transaction]Description to 80 chars and associated Substrings
//3. SDD Exclude ToClean units in WS_CreateReservation
//4. SDD UnitType Form - Add button Calc Weekly Rate & remove dialog when modifying MonthlyRate, set default Analysis Code to Rental Fee, For KSS only Description field not modifyible, Online Res field true for new records
//5. SDD Removed Alert message in LogAction in MV that says There are 1 other users logged on, as there is nothing they can do about it
//6. RWFR Fixed restoring of sets in EmailInvoice not occuring
//7. RWFR Fixed reservation selection being lost in InvRecCode

//Changes in 9.1.6 26/03/13
//1. DAM Fix ORes to delete Customer and Reservation if there are more than one unit reserved
//2. SDD DailyAutoPay - German bank file third attempt
//3. SDD SyncCheckSumMain - Was not using primary key field, and shortened message in log file
//4. RWFR Shortened transaction descriptions during daily so whole agreement number is included
//5. DAM Fixed runtime error when click "Ok" button closing agreement details
//6. DAM Fixed title on input form for Marketing Types and Categories
//7. SDD Prepaid Report - Extend mask to allow millions in totals field for vault
//8. SDD Initialise - Change location of Backup and Logs folders to be beside the datafile
//9. DAM Fixed "Previous" & "Next" buttons for Maintenance -> Units
//10. SDD Mirror Database added to System Setup -> Backups and relevant code to make it operate
//11. DAM Removed check [Agreement]NewRentAmt>0 in UpdateNewRent as Rent Increase should always triggerge
//12. DAM Fixed Tiered Late Fees are not saved on notices in
//13. SDD Added field [Facility]GateTimeZoneDefault in GateSetup and use this as [Customer]GateTimeZone default when creating new Customer records
//14. SDD Improve performance of applying training file settings - dont run on Client - Reduce number of SAVE RECORD's - show progress
//15. SDD MoveOutCalculation - For KSS if MoveOutDate < LastBillDate it will Auto Undo Bill Rent prior to MoveOut
//16. DAM Fixed setting SVG references for Map

//Changes in 9.1.6 11/03/13
//1. RWFR Disabled German tax calculation in CalcTaxAmt
//2. DAM Added shipping table to ModFacility
//3. DAM Added new WS_Deposit parameter to Kinitek API
//4. RWFR Added new Organization Rental Fee for unit types
//5. RWFR MoveInCode automatically uses next array value and does not prompt user
//6. SDD ProjectedChargesRpt - Modified so that it is exTax where [Facility]TaxAddtoAmt is true and inclTax where false and included note on the report to that effect
//7. SDD ReadUserLogins in LogMonLoopCode - Modified to handle locked records and disallow Admin,Sync,Daily etc
//8. RWFR Made receipt design editable in invoice & quote design
//9. SDD LogMonServer - Changed no of days eventlog is retained in MV from 200 days to 65 days to improve performance
//10. RWFR Quote records are now re-selected when sending an email after generating the prefilled fields
//11. SDD Custom Search - Fixed search by formula so that you don't have to enter the tablename
//12. SDD DailyAutoPay - German Bank file Direct Debit
//13. DAM Added code to read UnitType info from KSS server
//14. SDD Changes to allow operation of logical mirror - will cause error on quit of server this first time
//15. DAM Fixed display issue on form AnalysisIn for Mac
//16. DAM Fixed duplication notices with 0 DaysAfter
//17. DAM Fixed xliff message when duplicating Notices
//18. DAM Fixed xliff on the Boat Info page
//19. DAM Fixed saving new boats if not all request info is entered
//20. DAM Add the check for date AuthCCsigned for Marina for autopay customers
//21. DAM Fixed xliff for ModifyReceipt
//22. DAM Fixed reactivating inactive agreements using new system
//23. DAM Hided 5 digit user code and password for tutorial datafile
//24. DAM Fixed EzyDebit during DP  
//25. DAM Changed text aliment on Map
//26. DAM Added relate one[unit]UnitTypeCode when switching between units using "Next" and "Previous"
//27. DAM Changed link on Storman start up to work for marina/rentals
//28. SDD SyncGetEvents - Modified to calculate size of text to be synced as CHK events are quite large & causing sync errors
//29. SDD SyncProcessCheck - Truncated table names to fit within the 8 chars of BillPAnls
//30. SDD SyncUpdate - Removed unnecessary search of CHK events
//31. SDD DailyAutoPay - Changes to German DirectDebit text file and cause receipt transactions to be generated for all direct debits
//32. SDD LogMonServer, Daily, DailyA - Changes to allow DailyActivity to be recalculated on the server in a client server situation
//33. SDD LogMonLoopCode - Only write message to log once per day re UserLogins not being found instead of every 10 secs


//Changes in 9.1.5 12/02/13
//1. RWFR Fixed inventory packs not being able to be added in ModChargesArray

//Changes in 9.1.5 11/02/13
//1. RWFR -ive is hidden on banking report if vNegAmt = 0
//2. DAM Removed message email merge when button "Cancel" is clicked
//3. RWFR StandardFacility now deletes rather than changes RF, DP, LF, IN, CRD, CA & CH codes
//4. RWFR StandardFacility now force sends tables with new records
//5. RWFR LogMonLoopCode check <>tLoggingOn before calculating activity

//Changes in 9.1.5 07/02/13
//1. RWFR DD check at start of DailyAutoPay checks DDProfileID field now
//2. RWFR Fixed query on agreement table for Ezi DD's, was querying wrong table part way through query
//3. RWFR Closed query on agreement table for Ezi DD's
//4. RWFR Fixed advam DD dailyautopay always checking BSB as NZ has no BSB
//5. DAM Setting field [Reservation]BoxnStore to blank on update to 915

//Changes in 9.1.5 01/02/13
//1. RWFR Fixed setting of Active/Inactive for Ezi DD's
//2. DAM Disabled map and the map icon for Rental Demo
//3. RWFR WS_GetUnitTypes has new variable WS_VacantAll if set to true will get all units of vacant statuses rather than just those set to Vacant
//4. RWFR StandardFacility had some queries fixed
//5. RWFR UserGroup/UserLogins text reading has had more logging added to see why it is not triggering
//6. DAM Added code to LogMon for setting Box and Store reservations as inactive if created more than 2 weeks ago 
//7. DAM Modified Kinitek server address to call when boxes arriving and leaving depot

//Changes in 9.1.5 31/01/13
//1. DAM Fixed DD upload for Ezi Debit
//2. DAM Added xliff description "Bill on Move In" and "Bill on Move Out" for all product types
//3. DAM Fixed WS_Insomniac_AvailIns allowing to sync insurance from Storman to Insomniac
//4. DAM Fixed xliff on transfer unit form
//5. DAM Added new fields to [Shipping] table as weight calculations has to be done in Storman
//6. RWFR Fixed insurance calc triggering too soon for RR
//7. RWFR Autopay fields set on demo creation
//8. RWFR Fixed contacts being updated causing them to appear twice on the control screen
//9. RWFR bAddNew is declared when opening unit on map
//10. RWFR Automatic relations turned on when opening unit on map then disabled again when closed
//11. DAM Removed parameters from WS for Box & Store and changed the way it works
//12. DAM Fixed xliff for adding units for different product types

//Changes in 9.1.5 25/01/13
//1. RWFR German bank export enabled
//2. RWFR Removed non-functional cancel button during daily letters
//3. SDD CashSales - Fixed change of TotAmt when TaxAddtoAmt=True and Merch Discount
//4. RWFR Rental Fee analysis code must always be visible for agreements & reservations
//5. RWFR Fixed Daily & PrintInvCode using same set name causing wrong transaction to appear on invoices
//6. DAM Fixed xliff when coverting Reservation to Agreement. xliff when adding unit to an agreement
//7. SDD Transaction trigger - Error no -16021 when AnalysisCode is less than 6 chars to prevent analysis code being set to "IP"
//8. SDD Mail Merge - Changed window type to 4096 to allow display on Mac of Web Area
//9. SDD DailyPrepNotices - Reset NoticeAmttoBill to zero if it was going to bill rent and notice on the same day to stop rental fee billing as a late fee
//10. RWFR QuotedRate set on reserved units in demo
//11. RWFR Moved syncing disable to top of training file method
//12. RWFR Added phone numbers to customer merge data export
//13. RWFR Fixed transaction trigger not executing code correctly, skipping most of it
//14. RWFR Fixed display issues on cash sales statement type 2
//15. RWFR TakePayment for reservations will load specific reservation rather than all for customer
//16. RWFR Fixed selecting a customer code for a transaction when a customer has more than 1 reservation and no agreements
//17. RWFR Fixed other regular charges not undoing correctly for SK
//18. RWFR Fixed bAddNew not being declared when modifying units
//19. RWFR Fixed add unit type button not working
//20. RWFR Fixed unit types & rates adjust rates permission not working correctly
//21. RWFR Startupdemocheck creates database folder if not present
//22. RWFR Startupdemocheck recognises other product demos as demos
//23. RWFR Disabled hmTAPI for now
//24. RWFR Fixed Unit Type listing not showing weekly figures when it should
//25. RWFR Fixed missing XLIFF variable "Create Email"
//26. RWFR Set receipt printer invoice header to be truncated rather than scale to fit
//27. DAM Fixed xliff "From" and "To" for inv
//28. DAM Fixed customers balances, transactions, descriptions for Insomniac
//29. DAM Added arServices array for KSS to loop through their services from center xml

//Changes in 9.1.5 17/01/13
//1. SDD Merchandise Plan Discounts - Set to use correct parameters in CalcTaxAmt for when TaxAddtoAmt is true
//2. RWFR Cash Rounding only triggers in AU & NZ now
//3. SDD CreateTrxMoveOut - Fix narration display when TaxAddToAmt is true for refund of OtherRegCharges
//4. SDD CreateTrxMoveOut - Also changed calc of refund for OtherRegCharges to use calculated vMoveOutDate instead of [Agreement]MoveOutDate
//5. SDD SystemSetup - Renamed RefundOther to RefundOtherRegChgs and moved to Reports & Refund tab
//6. RWFR Fixed new blobs/pictures not saving correctly
//7. SDD SyncSendCheckSums - Fixed syntax errors

//Changes in 9.1.5 16/01/13
//1. RWFR Fixed GB address settings on invoices triggering for non-GB countries
//2. RWFR Fixed errors with OK & New not showing for units when adding them
//3. RWFR Fixed errors with 4D transactions and units not being closed or started correctly
//4. RWFR Added FutureTrxs to Agreement table
//5. RWFR ModCharges & ModReceipts now check against FutureTrxs to see whether to reset the late cycle
//6. RWFR Fixed pictures not syncing correctly
//7. RWFR Fixed missing total line on reservation deposits held
//8. RWFR Fixed photoscard deposit held not being in same format
//9. RWFR Fixed photoscard deposit held totals not working correctly
//10. RWFR Fixed photoscard deposit held footer not working correctly
//11. RWFR Insurance Summary shows N/A instead of 0 for active agreements not billed a premium in the month of the report
//12. RWFR Moved bank account field being filled in checks to OK button as they were causing endless alerts when trying to clear them
//13. DAM Changed Advam DD to use HTTP Post request and edit the DailyAutoPay method
//14. RWFR Fixed PrintEvents2 not picking up event table 0 events when set to do so
//15. RWFR PrintEvents2 ignores adminsupport events when set to
//16. RWFR PrintEvents2 picks up events with multiple codes
//17. RWFR PrintEvents2 uses set after finishing loading it to prevent 0 records being selected
//18. RWFR SyncLogTraffic is now in a semaphore
//19. RWFR vLegend is cleared on Lien, Autopay, Projected Charges & Unit Type Listing
//20. RWFR CustAnalysis and GraphOccup now set their orientation to portrait
//21. RWFR Fixed threat level report using wrong date when running through batch
//22. DAM Xliffed [Barcode]Receive and [Agreement]TransferUnit forms
//23. RWFR Fixed batch settings not saving for buttons 43-49

//Changes in 9.1.5 15/01/13
//1. SDD Occupancy Report small - Minor change to allow Description to overlap category if no category entered
//2. SDD Sales Inquiry Report - Fix syntax error caused by vReportSettings being too short
//3. SDD Staff Conversion Analysis - Fixed total lines being cut-off
//4. RWFR Fixed takepayment selection row not being set on load
//5. RWFR SwipeCard also updates reservation balances now
//6. RWFR TransOut add new also reduces reservation selection to 0
//7. RWFR Fixed entering agreement number on transaction checking wrong field length in ModCharges/ModReceipt
//8. RWFR After entering a new agreement or unit number on a transaction in ModCharges/ModReceipt aDesc gets set to 1
//9. RWFR Pro-rata of other regular charges does not generate for stock items
//10. RWFR Fixed not saving of changes to analysis table when billing other regular charges
//11. RWFR Fixed contacts output form

//Changes in 9.1.5 14/01/13
//1. RWFR Fixed not being able to set receipt analysis codes to <None> special option
//2. RWFR Fixed cheque return options being swapped between charges/receipts
//3. RWFR Double clicking on rent increase preview screen no longer changes the form after clicking ok/cancel/delete
//4. RWFR Fixed incorrect font on credit tax value
//5. RWFR Fixed formatting on ModCharges & ModReceipts
//6. RWFR Fixed statements for cash sales not having $Date2 set
//7. RWFR Fixed statements for cash sales not picking up all charges
//8. RWFR Fixed address & name being lost for cash sales on statements
//9. DAM Fixed Receipt SVG
//10. DAM Added option to disable guidelines for SVG headers/footers/receipts
//11. RWFR Stopped stray agreements/units being picked up by add new transaction
//12. RWFR Fixed cash sales with blank names not showing as "Cash Sale" when printing transaction list
//13. DAM Added buttons to clear the content of SVG headers/footers/receipt
//14. RWFR Restored usage of Text to Blob and Blob to Text to syncing methods
//15. RWFR SKBilling system now records dates and calculates paid to dates per a normal billing plan
//16. RWFR SKBilling system now performs undo last charges correctly
//17. RWFR 4D Reports won't execute past 31/12/13

//Changes in 9.1.5 10/01/13
//1. RWFR Fixed undo last charges not recognising record number 0
//2. DAM Fixed Ezi DD to save DD profile ID to correct field on upload
//3. RWFR Fixed CheckVersion planperiod using plurals
//4. DAM Fixed prorate calculation for Remove/Transfer units when billing plan has fixed discount and removing more than one unit

//Changes in 9.1.5 09/01/13
//1. RWFR Replaced Thinc with NAB or Storman SMS as appropriate
//2. DAM modified OR to load the vtCurrencySymbol variable for all sites
//3. RWFR Changed blob to text and text to blob to use convert text commands for UTF-8
//4. SDD CheckSums - Fixed Checksum using wrong primary key for Unit.  Activity & Facility seem to be working correctly.
//5. RWFR Other Regular Charges deal correctly with inventory items for billing, prorata and unbilling now
//6. RWFR On credits tax is expressed as a positive number like the credit itself
//7. RWFR Fixed TrxListSort re-prompting for dates
//8. RWFR Fixed notice plan 0 notices always showing when adding letters/emails for other notice plans
//9. RWFR Fixed not being able to select template when only 1 present for letters/emails
//10. RWFR Fixed alignment of numbers of transaction tabs and agreement tab of MoveInRR
//11. RWFR Removed $ symbol from Autopay report
//12. RWFR Bpoint for CRN1 replaces numbers with text equivalents
//13. RWFR Fixed incorrect help tip for email statement
//14. RWFR Fixed email subject for bulk communications not being saved
//15. DAM Removed Code for tax calculation for German sites
//16. RWFR Fixed not being able to set analysis code special options back to none
//17. SDD Added new method for Safe Store called DoWriteOff which zeros old small balances
//18. RWFR Fixed special option for receipts saying Cheque Return charge instead of Default for Cheque Return
//19. RWFR Added new RequestDate method and form
//20. RWFR Replaced all instances where we were using RequestMessage to get a date with RequestDate
//21. SDD MoveOut Calculation - now fixed so that it uses the calculated MoveOutDate (OutNoticeDate+NoticeDays) rather than actual MoveOut
//22. RWFR Fixed transaction printout showing blank name for cash sales where no name was entered
//23. RWFR Filtered out double clicking on rent increase rules preview
//24. RWFR Fixed cut-off agreement number in rent increase rules preview
//25. RWFR Stopped analysis codes set to bill on move out from working even when set to inactive
//26. RWFR Stopped analysis codes set to cheque return charge from working even when set to inactive
//27. RWFR Commented out level function in overdueslist as it caused CSV exports to have runtime errors
//28. RWFR Fixed rent rounding altering paid to date (only on new billings)
//29. RWFR Added autopay type message to credit sales
//30. RWFR PrintInvNew form uses Print Invoices and Statements as title now
//31. RWFR Re-disabled calculation of merchandise discount plans on existing cash sales
//32. RWFR Fixed statements not printing for cash sales
//33. RWFR Fixed mass payment dialogue about inactive agreements producing the reverse of what is expected
//34. RWFR ModReceipt shows reservation info if a reservation is selected
//35. RWFR TakePayment screens no longer show grey to the right in the window
//36. RWFR Reservation Take Payment screen no longer has horizontal scroll bar
//37. RWFR Take Payment screens have been set to single selection mode
//38. RWFR Double clicking on a reservation in take payment screen selects it
//39. RWFR When creating/opening a cash sale the values of all the arrays are reset
//40. RWFR Stopped Cheque Returns working on refunds
//41. RWFR Fixed unit deposits not being marked as confirmed
//42. RWFR Fixed reservation details not showing on transaction out form
//43. RWFR Fixed ModCharges from TransactionOut form not working for reservations
//44. RWFR Fixed facility code not appending to changes to customer code on ModCharges when it should
//45. RWFR Set all charges to be marked as confirmed
//46. RWFR Fixed deletes and addition of charges not saving correct balances when done from the Modify Charges menu
//47. RWFR Set Rent Increase Rules DaysAfter field to match InvoiceFee if set to 0
//48. RWFR Fixed credit card buttons showing when merchant set to 0
//49. RWFR Fixed adding new charges/receipts from trxout form loading previous values
//50. RWFR Ok & Next button now works in Charges screen
//51. RWFR Ok & Next button now works in Receipts screen
//52. RWFR Fixed ModReceipts from TransactionOut form not working for reservations
//53. RWFR Fixed facility code not appending to changes to customer code on ModReceipts when it should
//54. RWFR Direct debit customers no longer have their credit card info show during daily
//55. RWFR Fixed deletes of receipts not saving correct balances when done from the Modify Receipts menu
//56. RWFR Fixed SwipeCard leaving automatic relations on
//57. RWFR TriggerLog checks for deleted fields now
//58. RWFR UnitType structure array fixed
//59. RWFR Fixed credit card processing in agreements or modify receipts breaking balances
//60. RWFR Fixed UpdateReceipt not updating reservation balances
//61. RWFR Fixed move in charges not correctly billing
//62. RWFR Fixed reservation deposit refunds getting the incorrect amount
//63. RWFR Fixed DailyAutopay balances
//64. RWFR Fixed DailyAutopay AutoCCSuccess using incorrect balances for invoices/statements
//65. RWFR Fixed SwipeCard AutoCCSuccess breaking customer balances
//66. RWFR Changes to Unit Types & Rates monthly figures get recorded when pressing next/previous buttons
//67. SDD Completed CheckSum processing for all unique key tables (still need to discuss Transaction, Letters, PhotosCards, UnitHistory, NotesHistory, UnitStatusTrx)
//68. DAM Adjusted ShutdownCode, Added code for NextAgreeNo, NextReservNo, NextContactNo, NextInvNo
//69. SDD Fixed button display issue on Reservation - Was showing two buttons on top of each other
//70. SDD Change read location in S_GetBackupPrefsFile of Backup.xml on Mac to the same as Windows (standalone)
//71. SDD RentinAdvance Report - Modified to use RF Analysis code so that tax will be correct when tax rate is in Analysis record
//72. SDD Unit Activity Dialog - Hide unused fields
//73. SDD GL Report - Moved rightmost fields back inside page layout so that it fits
//74. SDD Customer Analysis Report - Limited legend to 18 lines
//75. SDD Avg Length Stay Report with Comments - Extend length of Agreement field to fit
//76. SDD Length Stay Report modified to use vStDate instead of vDate as variable was changing
//77. DAM Fixed tax calculation for cust type: individuals, country: "DE" if [Facility]TaxAddtoAmt=True
//78. RWFR Fixed Storercheck not opening on Windows XP
//79. DAM Fixed [Agreement]LastDiscAmt nad [Agreement]LastBillAmt for Gernamy if [Facility]TaxAddtoAmt=True
//80. DAM Changed the BankAccNo format according to the length of string in xml file import
//81. SDD Complete the rest of the tables for sending MD5CheckSums
//82. DAM Changed settings for database localization: if a user has a language abbreviation in the settings Storman will load the same language after login 
//83. DAM Fixed prorate calculation when adding/transferring/removing units. Also added tax calculation for German sites 
//84. RWFR Fixed cash sale discounts being lost when unselecting a transaction
//85. RWFR Added learn more link for cash sales output form
//86. RWFR Fixed map icon not hiding when it was supposed to
//87. RWFR Fixed letters/emails not loading description or subject when adding new letter/email
//88. RWFR Fixed check activity showing permission error when it shouldn't
//89. RWFR Fixed title being lost when converting from sales enquiries
//90. RWFR Fixed calculation of merchandise discount for cash sales when discount is not shown on invoice
//91. RWFR Stored before is now Rented before for appliances
//92. RWFR Fixed being able to save changes to stock purchases before the can't modify prior date
//93. RWFR Fixed select/unselect all not triggering all permission in group
//94. RWFR Fixed double reversal of transactions with discounts when undoing last charges
//95. RWFR Fixed DoBillDT prompt when undoing charges
//96. RWFR Put cash sales inside a transaction
//97. RWFR Fixed new stock purchases etc. picking up old values
//98. RWFR Fixed NAB CC enabling buttons even if error uploading customer profile
//99. DAM Fixed display issue on marketing ranking report
//100. RWFR Lengthened bank account name field for customers to 255
//101. RWFR Added find button to analysis code screen
//102. DAM Fixed Sales Promotions Report
//103. RWFR Centrallogs email is now disabled
//104. RWFR datachecklogs email is now disabled
//105. DAM Fixed Email subject for Bulk Communication Wizard
//106. DAM Fixed processing bar when sending emails to contacts for Bulk Communication Wizard
//107. RWFR Added option to default to taking deposits at agreement stage instead of reservation stage
//108. RWFR Added [Reservation]ReasonDeclined, works like contacts one
//109. RWFR Sales Enquiry report can be run for all, converted, declined or open contacts
//110. RWFR Each part of GB addresses are left on seperate lines
//111. RWFR Added new permission that if a user does not have but has the edit analysis codes will only allow them to edit pricing
//112. RWFR Added new permission to control access to the adjust rates button in unit types & rates
//113. RWFR Added new permission to control if the user is allowed to change vacant units to Company, Repair or Unavail
//114. RWFR Billing plans now have option to disable editing of months in advance figure on agreements
//115. RWFR Disabled 'There are x records with errors in the synchronisation process. Will try again next sync cycle.' message from displaying for users
//116. DAM Fixed moving multiple objects on the map
//117. RWFR AutoCC notices no longer appears as templates
//118. DAM Fixed errors for removing horizontal and vertical spaces on a map
//119. RWFR Added fullpage & print plugins to Tiny_MCE
//120. RWFR Added entity encoding to Tiny_MCE
//121. RWFR TrainingFile now changes contacts emails and mobile phone numbers
//122. RWFR Fixed broken send email button in contacts
//123. RWFR Fixed invoice fees breaking balances
//124. RWFR Moved periodic reporting to the end of daily
//125. RWFR UpdateActivity is now called just before periodic reporting even on Client to ensure reports have data
//126. RWFR Fixed swapping analysis codes on a charge not checking quantity on hand when saving
//127. RWFR Fixed swapping analysis codes not updating quantities correctly
//128. RWFR When swapping analysis codes on a credit it checks that you arent pushing the inventory value below 0
//129. RWFR When deleting a credit it checks that it won't push the inventory value below 0
//130. RWFR Fixed incorrectly name weekly refund basis setting and hid option when not on weekly refunds
//131. RWFR If RoundAmt is passed a number less than 1 it treats it as 1
//132. RWFR Unit Types DRC can now be configured with round to nearest x cents
//133. RWFR Lengthened email address fields to 255 characters
//134. RWFR Restored correct Storage.4DD
//135. DAM Added work-area to Inv header/footer and receipt design
//136. RWFR Fixed Ezidebit DD's using CC profiles
//137. RWFR Updated all places where late cycle resets are being calculated to ignore future dated charges/credits bar adding/modifying a charge itself & part payment prompts for receipts
//138. RWFR All places where it was using [Facility]NextAgreeNo now use the array value
//139. RWFR Stored Goods is hidden for rentals
//140. DAM Fixed canceling changes in UnitTypeCode will lead to changes are saved to units, but not to the UnitType
//141. RWFR All places where it was using [Facility]NextReserveNo now use the array value
//142. RWFR All places where it was using [Facility]NextContactNo now use the array value
//143. RWFR Added semaphore for NextResNo array
//144. RWFR Added semaphore for NextSalesInqNo array
//145. RWFR Added new option to not show charges on printed receipt printer receipts
//146. RWFR Other Regular Charges added to SyncCreateCust
//147. RWFR Added ability to edit cash invoices for invstatement>0
//148. RWFR Added semaphores to Agreement abort code
//149. RWFR Added UnitListing field to reservations table
//150. RWFR Added PaidTotal field to reservations table
//151. RWFR Fixed array errors in StandardFacility
//152. RFR <>aiPrimaryKeyField set for Tables 37, 41 & 42
//153. SDD Rename [BillPlan]WeeksMonth (Boolean) to [BillPlan]PlanPeriod (A5-Day,Week,Month,Year) which is updated on upgrade to 9.1.5
//154. SDD BillPlan forms change to drop down menu displaying xliff of Day,Week,Month,Year
//155. DAM Fixed moving of a text on map if the object is rotated
//156. RWFR Stopped Ezidebit passing "First Name:" as the first name as it was using vFirstName variable instead of vCustomerFirstName
//157. RWFR Fixed incorrect permission names for Maintenance list
//158. RWFR All places where getting HTML Email content from web areas loop up to 10 times to ensure values are actually loaded
//159. DAM Fixed border line of the Billing Plan table, fixed xliff and alignment for currency symbol and fields
//160. RWFR Stopped customer analysis report deleting marketing types
//161. DAM Fixed the same Reservaion cannot be open 2 times
//162. RWFR Can change colour of background on map
//163. RWFR [Agreement]ContactNo, [Reservation]ContactNo, [Transaction]MiscDtls, [RCHistory]UnitType & [StaffPINS]FacilityCode are updated when changing facility code now
//164. RWFR Fixed settings module syntax error
//165. DAM Fixed loading of first email when sending from "Autopay/Notices" tab


//Changes in 9.1.4 03/12/12
//1. DAM Fixed WS_Insomniac_POSpurchase passing trx amount is different from amount in Insomniac, also added amt tendered
//2. RWFR Bank name is visible for German version
//3. RWFR Fixed EmailIn form displaying script error
//4. RWFR Updated Email Component
//5. RWFR SKBilling now fills in Last & Prior billings correctly

//Changes in 9.1.4 27/11/12
//1. RWFR Added options to Length of Stay Report to allow split report and include existing customers
//2. RWFR Fixed daily user being left logged in after daily
//3. RWFR Fixed group ID's not showing in modify users & groups
//4. RWFR Fixed open query in UnitTypeListing causing only 1 unit type to show
//5. RWFR Fixed incorrect currency symbol showing in deposits for reservations
//6. RWFR Fixed autologout causing report menu to be lost
//7. RWFR Fixed incorrect loading of records on StockOut
//8. RWFR Fixed broken button on StockOut
//9. RWFR Fixed prices getting automatically reset when changing stock purchases & transfers
//10. RWFR Fixed stock transfer receive modifications resetting stock to 0
//11. RWFR Fixed buybacks showing when they shouldn't
//12. RWFR AddORC checks if customer record is selected otherwise transactions will fail to add correctly
//13. RWFR Pro-rata option on bill next charges also does other regular charges now
//14. RWFR Other regular charges when choosing analysis code will no longer prompt to pro-rata charge if agreement hasn't been billed
//15. RWFR Removed instances of SET TEXT TO PASTEBOARD used for testing
//16. RWFR GetAgreementInfo web services now take account of rent and other charge increases for next amount
//17. RWFR If no valid agreements in selection agreement edit screen will not attempt to open
//18. DAM Added [BarCode] table for shipping
//19. RWFR Added warning to Invoice/Quote/Statement edit process
//20. RWFR Fixed alignment of amount columns in credit sales
//21. RWFR WS_CreateReservation allows same day reservations
//22. DAM Changed properties of the "Greeting" method in order to run it from html
//23. DAM Modified WS_Insomniac_POSpurchase to work with customer's accounts and with cash sales
//24. DAM Modified WS_Insomniac_MoveInCost to work according to the tax settings for analysis codes in Storman
//25. DAM Modified WS_Insomniac_MoveIn when creating transactions with different tax options
//26. DAM Fixed creating of MI transaction for Insomniac

//Changes in 9.1.4 19/11/12
//1. RWFR Fixed unit type & unit next/previous buttons not disabling when they should
//2. RWFR Synclog now uses semaphore
//3. RWFR OtherChgs now included in next rent amount

//Changes in 9.1.4 13/11/12
//1. RWFR Changed array type for printing map
//2. RWFR Invoices for Germany now print post code before city

//Changes in 9.1.4 12/11/12
//1. DAM Changed Visibility bank details for German sites
//2. DAM Changed ref no for Inventory packs from 10000 to 27000 

//Changes in 9.1.4 09/11/12
//1. RWFR Fixed printing receipt for cash sale locking customer record

//Changes in 9.1.4 08/11/12
//1. DAM Added line "Balances Owing for more than X days" to arrears report as it was removed in v9
//2. DAM Fixed QOH bug when adding charges for cash sales with amount #1
//3. RWFR Worked around broken 4D command when printing map
//4. RWFR Added regex checks to avoid combinations of letters & numbers when converting to an agreement
//5. RWFR Fixed cash sale description not being enterable
//6. RWFR Changed the variable used for daily processing summary title
//7. RWFR Fixed resize elements showing on units on map
//8. RWFR Resized PrintInv & PrintIvnNew forms
//9. RWFR Fixed wrong field hiding when choosing to hide employer field
//10. RWFR Fixed CCExpiry & CCAuthExpiry notices not triggering correctly
//11. RWFR RVHistory report now correctly excludes units rented at list price if option is not selected
//12. RWFR Fixed cutoff text on PrintUnitsLine
//13. RWFR If show comments box is ticked for unit status report it defaults to landscape
//14. RWFR All footer references for vDate changed to vPrintDate
//15. RWFR Fixed Lien report calling on display detail instead of on printing detail
//16. RWFR Added adjustable scale on map rather than hard coding to 10

//Changes in 9.1.4 05/11/12
//1. DAM Added a condition to WS_CustomerLogin, WS_CustomerEdit, WS_AddPDf, WS_GetUnitTypes for all secure Onehunga
//2. DAM Set [Reservation]CalltakenBy = to "Web" when reservation is created ny calling Web service
//3. RWFR Converting to an agreement now rejects non-numeric agreement numbers
//4. RWFR Fixed notice HTML area not being unloaded causing out of memory errors
//5. RWFR Fixed ProcessStormanHTMLTags doing mass find and replace for various situations to <br> to just replacing CR with <br>
//6. RWFR Altered size of TinyMCE HTML code editor to fit window size
//7. RWFR Background Image for SVG Map is now saved to server resources folder
//8. DAM Added ability to use [[4DLOOP ..]]
//9. DAM Set [Facility]PhoneFormat field lenght to 25 the same as for PhoneNo
//10. DAM Fixed tax calculation for transactions on MO based on agreement type, only for Germany 
//11. RWFR If next cash sale sets to 0 it will do a check on startup to recalculate

//Changes in 9.1.4 29/10/12
//1. DAM Added new table "Shipping" and new interface Maintenance->Shipping

//Changes in 9.1.4 19/10/12
//1. DAM Added tax inclusive billing for organization and exclusive for individuals only for Germany

//Changes in 9.1.4 17/10/12
//1. RWFR Fixed import agreements not setting rented values correctly for weekly based agreements
//2. DAM Fixed run time error when uploading new CC for Bpoint
//3. DAM Added Utilities to maintanence menu for all products

//Changes in 9.1.4 16/10/12
//1. DAM Replaced [Facility]FacilityCode with variable <>sFacility as there might not be records in selection
//2. DAM Fixed Insomniac MI not populating UnitHistory table
//3. RWFR Fixed alignment on agreement screen of rents

//Changes in 9.1.4 15/10/12
//1. DAM Added new variable vNetSum (invisible by default) for Spanish version
//2. DAM Increased the size of [Facility]Address to 100 characters
//3. DAM Modified WS_AddAgreement not to create a Contact record is it is a credit sale
//4. DAM Modified WS_CreateReservaton to save Sale Enq with blank date and blank output if there are no available units 
//5. RWFR Fixed errors displaying when previewing notices

//Changes in 9.1.4 10/10/12
//1. RWFR Fixed Analysis Code not being related in CheckActivityData for transaction
//2. DAM Fixed "&" special character for custom designed INV headers and footers
//3. DAM Replace "; " with "," for Batch emails in the method  GetEmailSendTo
//4. DAM Fixed UnitStatus report not showing Unit No if the length of UnitNo is bigger than 9
//5. DAM Set the variable vbUpdateGate to true if the customer's access status is changed
//6. DAM Added code to clear [CashBookTrxs] table every time after export to Quickbooks is complete in order to avoid appearing old trx at the export
//7. RWFR Changed bpoint payment process to check different variable for success

//Changes in 9.1.4 04/10/12
//1. DAM Disabled opening Updates.4W7 if connection to SU is faild as the file Updates.4w7 hasn't been updated since 2007
//2. DAM Fixed print receipt by default not displaying agreement no and customer code 
//3. DAM Fixed sum of ORC on invoice for RM
//4. RWFR Fixed ClearInactiveDeposits marking them as receipts
//5. RWFR Stripped CRLF, CR & LF out of custom map field
//6. RWFR <>tLogging value is copied to server now

//Changes in 9.1.3 02/10/12
//1. DAM Fixed Runtime error for Billing Plans with Fixed Bill amount
//2. SDD Modified InitSites to remove loop causing long delay in calculating NextCashSaleNo
//3. DAM Fixed Periodic printing for vacancy report
//4. DAM Fixed notices that are printed on MO
//5. DAM Fixed "Change Rates in Unit Types" permission didn't allow to save changes
//6. DAM Changed sort order for Cash Reved Analysis Report for facility "SSSSS" at it was in v8
//7. DAM Fixed forms to print for Ins system 1 and 2
//8. DAM Set Ins summary report to display active agreements is option "All Current Policies"
//9. DAM Fixed NextAgreeNo setting to 0 when converting reservation to agreement
//10. DAM Fixed Agreement balance owing if there are no transactions selected

//Changes in 9.1.3 21/09/12
//1. SDD Cash Analysis Report - Fixed error on cross line additions
//2. SDD Added two database methods in Backup Startup and Backup Shutdown to turn off/on webserver for KSS
//3. RWFR Changed ThincSMS URL to ours
//4. RWFR Stopped calls to support messages in Storman Users as this system is no longer used

//Changes in 9.1.3 20/09/12
//1. RWFR Fixed | being used instead of & for invstate2calc filtering
//2. RWFR Fixed voucher redemption end if being in the incorrect position
//3. RWFR InvRecCode attach statement line now also checks [Letter]SentWithStatement
//4. DAM Added xml read for KSS notices. They need to use tag KSSTag[reference]KSS

//Changes in 9.1.3 19/09/12
//1. DAM Fixed Back Account No for reservations
//2. DAM Fixed Marketing types for Other Credit sales, the drop down boxes were showing all types for all facilities
//3. RWFR Stopped Next/Previous in unit going outside selection
//4. RWFR Stopped Next/Previous in unit not saving changes
//5. DAM Fixed Inv No is not getting assigned when printing cash sales transactions
//6. SDD CheckActivityData - Removed new routine to calculate Receipts analysis and reverted to previous v8 methodology
//7. DAM Fixed Sales Enq displaying issue, the size of the quotes was "" only ","
//8. SDD UpdateReceipt - Added second parameter to set the value of vLateResetCycle, and set it true for Webpayments and Webservices
//9. RWFR Fixed InvState2Calc getting called by receipts
//10. RWFR Fixed some differences in determination of whether text shows for InvState2 attachment line
//11. RWFR Stopped Next/Previous in unit types going outside selection
//12. RWFR Stopped Next/Previous in unit types not saving changes

//Changes in 9.1.3 18/09/12
//1. DAM Fixed Quote size for WS_AddContact
//2. DAM Added a parameter WS_CreateNote to WS_CustomerEdit to stop creating customer notes
//3. DAM added a condition to check MI date for Insomniac. If it 00/00/00 -> set it to current date
//4. SDD MatchTrx - Change in the way tax is calculated when matching
//5. RWFR Fixed balance brought forward notation appearing on receipts - invstatement2
//6. RWFR Fixed mincustomrentincrease if being skipped zeroing rent increase
//7. RWFR Fixed cash sale match numbers getting mixed up
//8. RWFR Insurance is autoremoved on move out without prompting for credit
//9. RWFR For prorata insurance if amount is negative will prompt using credit text
//10. RWFR For prorata insurance if amount is negative will use insurance credit as transaction description
//11. RWFR Fixed refresh of customer balance variable
//12. RWFR Fixed credit card processing not disabling cancel button
//13. RWFR Made change to amount due for RM
//14. RWFR Altered StoreCheck temporary file to be in the same location on all OS's
//15. RWFR Fixed Line Feeds breaking SVG

//Changes in 9.1.2: 14/09/12
//1. DAM Fixed Insight gate system when setting customer's gate pin to ""
//2. RWFR Fixed invoices & receipts running recalc for cash sales
//3. RWFR Fixed credit sales not generating invoice numbers on close for InvStatement=2
//4. RWFR Fixed reserved units being set to rented or locked
//5. SDD Fixed MatchTrx so that the arrays are cleared properly on recalc
//6. SDD CashAnalysis report restored and Accounting menu modified  ReportMenu
//7. RWFR CheckInvQty can be scheduled to run overnight - CheckInvQty in Overnight.XML
//8. RWFR Fixed GeneratePrimaryKeys not working on MV
//9. DAM Added new field for rent increase [Agreement]RentIncreaseUnitsNew
//10. RWFR Fixed EmailAutoCC not having message record loaded when creating Letter
//11. RWFR Fixed AutoCC manual transactions not setting correct balance for customers
//12. RWFR Fixed issue with OtherChgs export
//13. RWFR Print/EmailStatement for Inv2 gives invoice numbers to un-invoiced charges
//14. DAM Fixed insurance issue when removing one unit from agreement

//Changes in 9.1.2: 10/09/12
//1. DAM Fixed syntax error in Updatereceipt
//2. DAM disabled button "Enter Card" for processing CC with Thinc CM
//3. DAM Fixed Thinc CM 
//4. RWFR KSS - Autopay defaults Valid From
//5. RWFR MinRentIncrease if 0 doesn't trigger rent increase check
//6. RWFR Receipts no longer generate with wrong balance
//7. RWFR Fixed Income Charged report not showing credits seperately

//Changes in 9.1.2: 06/09/12
//1. DAM Fixed the length of the agreement field on banking summary report
//2. RWFR Fixed reply window opening behind current message window
//3. RWFR Fixed custom SVG map opening if first character was a Line Feed
//4. DAM Fixed Sales promotions report
//5. DAM Fixed special characters  for html emails when using 4DSCRIPT
//6. DAM Fixed xliff variable for Marketing Ranking
//7. DAM Fixed Title for Customer Analysis Report
//8. DAM Fixed Title for staff conversion report
//9. DAM Removed option use cashbooks from forms: Setup new datafile and Upgrade Storman
//10. DAM Added domains for downloading SMS receipts to DownloadMail method
//11. DAM Changed the [Unit]BldgLocation field length to 6 characters

//Changes in 9.1.2: 05/09/12
//1. DAM Changed tax code for sage exports. If analysis code is taxable - the code it t1 otherwise it is t0
//2. RWFR Stopped DoBillDT picking up service billing plans
//3. DAM Fixed xml import bugs
//4. RWFR Fixed banking report cutting off text in Windows XP
//5. RWFR Added build date to footer
//6. RWFR Disabled charge selection on receipts for RM
//7. RWFR Weekly premiums for insurance now recalculate at 0.2308 of the monthly figure rounded to 2 d.p.

//Changes in 9.1.2: 27/08/12
//1. DAM Excluded the PETTY transactions from banking report
//2. SDD Send Data to other site - Check Primary Keys only displays tables that have a problem
//3. SDD Stock Value Report - Calculation of tax exclusive value of Cost Price fixed
//4. DAM Fixed Deposit Held Report, changed cancel transaction to validate to update the agreement and reservation records
//5. DAM Added PostalSuburb t import to [Facility]City when importing xml
//6. RWFR Image manager added to bulk wizard

//Changes in 9.1.2: 24/08/12
//1. DAM Changed Tax code for sage export from T0 to T9
//2. DAM Fixed receipt dates for sage export for GB

//Changes in 9.1.2: 23/08/12
//1. SDD Change Transaction table field MiscDetls to Text and insert Note
//2. SDD Changes to ChargeAnalysisRpt & GetArrayfromMiscDetls
//3. RWFR Removed remaining code where it was limiting the cash sale charge list by category
//4. SDD Changes to MatchTrx to work with new MiscDetls text field instead of subrecords
//5. DAM Fixed Runtime error when reprinting Inv from Accounting-> Reprint Inv ny declaring vMisc in PrintReceipt Method
//6. DAM Fixed tax calculation for stock purchases
//7. DAM Fixed calculation of the cash sale's balance when fixed merchant discount is used

//Changes in 9.1.2 16/08/12
//1. RWFR Email Invoice will respect statement setting of notice now
//2. RWFR Fixed discount not being taken account of when choosing whether to generate statement

//Changes in 9.1.2 15/08/12
//1. RWFR If < is missing off custom SVG text it adds it to front
//2. RWFR </ br> is not added to lines using <ul> <ol> </ul> </ol> or <li> as these are lists handled by HTML itself
//3. RWFR Fixed PrintReceiptOption not printing all records on narrow receipt
//4. RWFR Fixed PrintReceiptOption not restoring selected records
//5. RWFR Set vConfirm to clear on printing new invoices
//6. RWFR Vacant units have their insurance values cleared
//7. RWFR Email Invoice copy attachs statements now


//Changes in 9.1.2 03/08/12
//1. RWFR Fixed invoice footers moving during daily
//2. RWFR Fixed balance going out when using card on file
//3. RWFR Fixed statements not generating past first agreement in daily

//Changes in 9.1.2 27/07/12
//1. RWFR Changed calculation for generation of statements under invstatement=2
//2. NGBW Updated OR_NewMailMessage to use the Email Component to send as images were not being handled correctly
//3. RWFR Fixed contact size required not being set in WS_CreateReservation
//4. RWFR Fixed contacts not being set to reserved when converted in WS_CreateReservation

//Changes in 9.1.2 22/07/12
//1. RWFR Fixed end of late cycle page not showing correct fields during daily
//2. RWFR <>FieldSettings is now set on change site

//Changes in 9.1.2 20/07/12
//1. DAM Changed Sage Export for UK, queries for UK are based on Inv date instead of Trx date
//2. DAM Fixed Deposits held report
//3. DAM Fixed inv for cash sale, not to show words "Overdue"
//4. DAM Deleted Print Message button on emails
//5. DAM Added a "SC" as trx type for negative receipts when exporting to sage only for UK
//6. DAM Fixed OtherChgs table if an email or a letter is created from autopay/notices tab
//7. RWFR Fixed end of late cycle page not showing correct titles during daily
//8. RWFR Fixed invstatement=2 during daily not going to next agreement when checking for un-invoiced charges
//9. RWFR Fixed automatic credit card payments not updating balance/lock status


//Changes in 9.1.2 15/07/12
//1. DAM Fixed bug with access status on agreement screen
//2. DAM Added Insight gate system

//Changes in 9.1.2 13/07/12
//1. RWFR EmailAutoCC for invstatement = 2 now generates invoice numbers before statement
//2. DAM Fixed Alert Message for <None> in ORC
//3. DAM Fixed Insurance Summary Report, to use Analysis code = "Facility Code" + "IN"
//4. DAM Fixed form for Accounting -> Print Receipts
//5. DAM Deleted wrong help tips on the noticein form
//6. DAM Changed [Unit]BldgLocation length from 2 to 4 characters
//7. DAM Fixed SVG Footer and Heder references do not appear during DP

//Changes in 9.1.2 11/07/12
//1. DAM Added a check for No of records in the set "ToRestore" to prevent RunTime Error in the method EmailInvoice at line 773
//2. RWFR Delete button on ModCharges & ModReceipts just does a cancel if the transaction primary key is 0
//3. RWFR Added DoBillDT method


//Changes in 9.1.2 05/07/12
//1. RWFR Fixed InvStatement 2 statement calculation not using an empty group
//2. RWFR Fixed InvStatement 2 attaching old statements if one was not supposed to be attached
//3. RWFR Fixed locations of units on map changes not saving
//4. DAM Fixed Print Invoice/Receipt from the Accounting menu

//Changes in 9.1.2 03/07/12
//1. DAM Added unit door size to UnitStatus Report
//2. DAM Fixed Remove units for Weekly billing plan
//3. DAM Added [InsuranceRates] table to InitNextPrimaryKeys
//4. DAM Fixed [Promotions] and [PromotionsHistory] primary keys
//5. RWFR Fixed InvState2Calc changing agreement selection

//Changes in 9.1.2 27/06/12
//1. DAM Put definition of the $Reserve variable out of the If condition to fix syntax error in method InvState2calc
//2. RWFR Invoice system 2 statements no longer print in daily if balance is 0
//3. RWFR Altered invoice system 2 during daily to better pick up those with invoice numbers of 0
//4. RWFR Removed block on non-merchandise items showing in cash sales as you can now control it on the analysis code

//Changes in 9.1.2 22/06/12
//1. RWFR Find units available at other site number vacant now matches the unit records returned, i.e. only vacant/to clean
//2. RWFR Have disabled activity checksum for now until we figure out what is going wrong
//3. DAM Fixed the ControlBig to show text and pictures on right places, also added new xliff variables for control big.
//4. DAM Fixed the Login window to display Spanish translation in full size 
//5. DAM Fixed custome fields for Credit Sales

//Changes in 9.1.2 20/06/12
//1. DAM Added re-printing statement after reprinting inv for InvStatement=2
//2. DAM Commented the command clear set("SearchInvNo") in PrintinvRecCode to fix runtime error when printing Inv for InvStatement=2
//3. DAM Moved the "Copy" sing on Inv to one level down for InvStatement=2
//4. RWFR Added new permission to edit unit type rates independent of the edit unit types permission
//5. RWFR Background image for map is now stored in resources folder
//6. RWFR Extended redraw timer for map to 1 minute
//7. RWFR Changed overnight exports to go to <>sExportPath instead of the attachments folder
//8. DAM Fixed Prorate issue when transferring the units
//9. DAM Fixed RunTime error when transferring the units

//Changes in 9.1.2 18/06/12
//1. RWFR Sales Enquiry report - reason for declined section only covers those that are declined
//2. DAM Added new variable vTaxSum (invisible by default) for Spanish tax, as it is required to be on invoice
//3. DAM Added new transfer unit button and changed the old system
//4. RWFR Fixed next agreement number variable not being incremented correctly
//5. DAM Added condition during DP do not execute the method printselection if there are no records in selection
//6. DAM Fixed reference problem with AutoCCSucces notice
//7. DAM Added the transfer button module.

//Changes in 9.1.2 07/06/12
//1. RWFR Fixed endless loop in sending emails during rent control method
//2. RWFR Fixed upper limit of 0 not being treated as unlimited during rent control method
//3. RWFR Changed description in text of DRC to say seperate by semi-colon not comma

//Changes in 9.1.2 06/06/12
//1. DAM Added a check for database localization at LogMonLoopCode and changed a condition for GateError when using Spanish datafile.
//2. DAM Change window type for Bulk Communication Wizard
//3. RWFR Altered balance brought forward calculation for InvStatement=2
//4. RWFR Set FieldSettings to be lengthed before attempting to set items 94 & 95 for KSS
//5. RWFR Added ability to set background image on SVG Map

//Changes in 9.1.2 31/5/12
//1. RWFR Fixed display of custom footers on invstatement=2 statements
//2. RWFR Fixed invoice numbers being applied to early for invstatement=2 during daily
//3. RWFR Fixed email statements not being filtered during daily for invstatement=2
//4. RWFR Set print preview to force to false for pdf printing
//5. DAM Added Utilities table to Modfacility
//6. DAM Fixed ModFacility for OtherCharges table 
//7. DAM Fixed waived fee counter is not resetting
//8. DAM Fixed manual printing and emailing statement with inv if conditions are met
//9. DAM Fixed balance owing for an agreement when converting from reservations
//10. DAM Fixed xliff for sage export
//11. DAM Fixed the file extension for for Sage export

//Changes in 9.1.1 24/05/12
//1.DAM Fixed not displaying tax no at inv if there is no tax format in FacCountry.xml.
//2. DAM Disabled "Invisible by default" option for header and for total variables on invoices.
//3. DAM Fixed a syntax error when canceling a cash sale.  
//4. DAM Set to show analysis codes only that have the KeyStatCategory = Merchandise for cash sales. 
//5. DAM Fixed recalculate balances for reservations as it was calculated previously as a sum of all transactions.
//6. RWFR OtherSitePmt no longer uses vNote for variable
//7. RWFR WS_CustomerEdit no longer uses vNote for variable
//8. RWFR Fixed statement printing for original invoice/statement system
//9. RWFR Fixed arrears report handling refunds incorrectly
//10. RWFR Changed periodic report setup window type
//11. RWFR Fixed Sage exports prompting multiple times for file location and not closing the document when done
//12. DAM Fixed discount displaying bug when adding a charge if analysis code is in a Inv Package
//13. DAM Fixed VAT No on invoices for UK
//14. DAM added recalculate balances for all customers after an update to version 9

//Changes in 9.1.1 18/05/12
//1. DAM Added Date for closing balance to Statement generated during DP
//2. DAM Set not to show unavailable units in Rent Increase Report
//3. DAM Set to print Landscape Access History log report 
//4. DAM Fixed locking the screen when converting Sale Enq to Reservation
//5. DAM Fixed quote for analysis codes
//6. DAM Fixed subject field for Bulk Communications
//7. DAM Fixed special characters in HTML Emails
//8. DAM Disabled all menu items when Bulk Communications is open
//9. DAM Changed a check for agreement No length when converting from reservations and Sales Enq to agreements. 
//10. RWFR Single line items in cash sales can now be negative to allow for custom discounts
//11. RWFR Cash sales whose total is less than or equal to zero cannot be saved
//12. DAM Added a xliff variable for Credit sale.
//13. DAM Made fields for CC authorisation dates visible even a customer is not on Autopay
//14. RWFR HTML email tag processing changes CRLF, CR & LF to <br /> correctly now
//15. RWFR HTML email tag processing changes multiple spacing to use &nbsp; correctly

//Changes in 9.1.1 09/05/12
//1. DAM Fixed Mail Merge, now it saved emails as sent
//2. DAM Added table [Utilities], added fields [Faciltity]Utilities, [Facility]UtilitiesLogFile, [Facility]UtilOutFile
//3. DAM Added new fields [Unit]UpdatePULS, [Unit]ReadPuls - for requesting data from PULS
//4. DAM Added new special option "Default for Power" for Charges Analysis Codes (Available only for Marinas)
//5. DAM Added new filed [Agreement]BillUtilities and set it = to <>vUtilities for new agreements
//6. DAM Added a condition to send only 3 emails to support if logmon has crashed
//7. DAM Added a check for valid Email Address in Bulk Communication Wizard
//8. DAM Added a check for "," in XML Import as "," - is used in European countries for separation 100,00
//9. RWFR Fixed upgrade from reservation to agreement not converting transactions
//10. DAM Fixed UserLogin name when converting from reservation to agreement to use Current User


//Changes in 9.1.1 24/04/12
//1. RWFR Changed map when opening units to unload the record first
//2. RWFR When syncing activity table it uses the correct key value fields
//3. DAM Changed files for Demo South Africa, also changed FacCountry.xml file to have correct date format
//4. DAM Changed order of the case statement for dateformat method
//5. DAM Changed format for Next Credit sale No in System Setup
//6. DAM Set NextCreditSaleNo and NextInvNo = 1 when setting up a new datafile
//7. RWFR SyncLog now changes current time to UTC time instead of converting last sync time to current
//8. DAM  Added a button to change to and from UTC format in EventLog
//9. RWFR TransOut form no longer tries to modify a record if the line is blank
//10. RWFR TransOut add button unloads customer/transaction record to stop it loading existing values
//11. DAM set buttons "Previous", "Next" inactive when changing unit status from the MAP
//12. DAM Added ability export/import emails from/into Notices by using buttons on Email Edit Screen.

//Changes in 9.1.1 20/04/12
//1. RWFR On upgrade to 9.1.0 it now converts the last sync time/date to UTC
//2. RWFR SyncCreateAllProc can handle the 3 ex-subtales now
//3. DAM Fixed format for date and time fields at Modify facilities form
//4. DAM Fixed Opening Sale Enq from Control Screen
//5. DAM Changed length for Agree No at Automatic Receipts Report from DP
//6. DAM Fixed showing Unit Size at Sales Enq
//7. DAM Fixed adding PDF if file is too big
//8. DAM Change variable length from 5 to 9 digits when changing Agree No
//9. RWFR Fixed customer balances report sort breaking as query selection was done after order by
//10. RWFR Syncing code now updates last sync time/date correctly

//Changes in 9.1.0 16/04/12
//1. DAM Deleted the button "Button" for testing from SVG form
//2. DAM Fixed WS_CutomerLogin, previously this method returned all OtherChargers for a facility
//3. DAM Fixed web link for Graph of Occupancy
//4. RWFR Adjusted PTD agreement column headings
//5  DAM Changed format for a drop down at the form "Mass dynamic Rent Controll Adjustments"
//6. RWFR Billing of free month on periodic billing with show incentive on invoice now works correctly
//7. DAM Fixed processing bar when generating new Invoice Numbers
//8. DAM Replaced Storman.4DD with Storage.4DD when opening facility datafile from tutorial (File->Facility Datafile)
//9. NGBW Added conversion from UTC datetime for [Facility]LastSyncTime in WS_SUSync
//10. RWFR Fixed undo last charges when using bill each unit seperatly with show incentive on invoice

//Changes in 9.1.0 11/04/12
//1. DAM Fixed resizing object after rotation.
//2. DAM Set pointers when object has been rotated.
//3. DAM Set invisible resizing handles in the corners when object has been rotated to angle # 90, 180, 270 degrees.   
//4. DAM Changed a xliff variable for Non-syncing site on Central.
//5. DAM Fixed Extra discount on new Move In. 
//6. DAM Fixed xliff for the description of Unit Activity Report.
//7. RWFR Fixed deposits recharging at agreement stage if already charged at reservation stage
//8. RWFR Fixed suburb not showing when switching to New Zealand or Australia for mailing address
//9. RWFR Rebill option on changing billing plans now uses Yes/No instead of OK/Cancel
//10. DAM Fixed country for street address, now changes to country are saved.
//11. DAM Fixed status for Sales Inquires to be "SalesInq" for US
//12. RWFR Fixed tax not appearing correctly on receipts
//13. RWFR Fixed footer causing incorrect length of receipt
//14. RWFR Set receipts to use username if actual name is blank
//15. RWFR Fixed spacing issue in TakeAsRent
//16. RWFR Cancel with no refund is enabled after entering a name for the reservation
//17. DAM Added a condition to check whether the SMS account details are entered in System Setup or not before sending SMS. (added for Agreem, Res, SaleaEnq)
//18. DAM added xliff variables for "to rent as well" and "do not change"
//19. RWFR Changed ModQuote to use listbox instead of grouped arrays
//20. RWFR Changed plain white icon used by ModQuote to transparent
//21. RWFR Sales Enquiry number is displayed on the control screen
//22. RWFR Billing plans - option to change billing plan when it ends blank option has been replaced with <Do not change>


//Changes in 8.9.1 10/04/12
//1. RWFR Added time sent to letters table which is filled in when letters record is created
//2. NGBW Set CheckVersion to check whether references are showing on notices before converting to HTML
//3. RWFR Fixed moving objects before rotation was set


//Changes in 8.9.1 04/04/12
//1. NGBW Updated WS_AddEmail to use HTML instead of 4D Write
//2. NGBW Updated WS_AddEmail to work correctly with new Agreement/Reservation number lengths

//Changes in 8.9.1 03/04/12
//1. DAM Fixed Scroll Bar at UnitType Report.
//2. DAM Set options "Optional Invoice" and "Optional Statement" invisible for KSSUpdate
//3. DAM Modified permission 208: now users are able to see UnitType, but unable to modify it if they don't have permission
//4. DAM Renamed column on Daily Summary Report from "Sent" to "Send"
//5. NGBW Added command to CheckVersion to set references to view before exporting notices to HTML.
//6. DAM Moved UpdateActivityOff to the licence tab in System Setup for update to v9 and made it visible only for adminsupport and Designer
//7. DAM Fixed BackUp destination folder was not showing
//8. DAM Fixed tax format on Invoices
//9. RWFR Removed use of UseStorerCheck field
//10. RWFR Thinc SMS assumes messages are sent
//11. RWFR Thinc SMS headers are now logged to the synclog
//12. RWFR Commented out code to sync with SHOF for now
//13. DAM Fixed multiplying items on cash sale by setting Price Per Item tax exclusive if the "tax exclusive" option in System Setup is enabled 
//14. RWFR UpdateGateUnits accepts a 3rd parameter for when it is a vacated unit. If set <>sGatePIN is set to the RUnitNo instead
//15. RWFR LogMonUpdateGate will check for RUnitNo = <>sGatePIN if no units are in selection after first search
//16. RWFR Set vRentAmt & vNewRentAmt to be based on fields when agreement is first loaded rather than calculated
//17. RWFR Widened agreement & date columns on small banking report
//18. RWFR If name for cash sale is blank it displays the text "Cash Sale" now
//19. DAM When importing data in to Storman if there is an amount in [Agreement]DepositAmt -> Deposit transaction will be created

//Changes in 8.9.1 23/03/12
//1. RWFR Set remaining transaction around the software to use No of Weeks when billing plan is weekly
//2. RWFR Removed extra setting of vTitle breaking Adjust Analysis Codes Rates title
//3. NGBW Added KSS Feature - require [Contacts]ContactName to not be blank.
//4. DAM Fixed Syntax error during DP which caused DP to hang up while searching for agreements with invalid LCSD
//5. DAM Deleted buttons for emailing and printing Invoice buttons on Petty Cash form.
//6. DAM set variable vOriginalReceipt:="" when adding a refund in Petty Cash to avoid syntax error.
//7. NGBW Updated EmailInCode to set set an id even if the Letter has not yet been saved
//8. NGBW Set [Customer]ArrearsSum to display correctly on Mac
//9. NGBW Updated WS_AddReceiptTrx to use new Agreement/Reservation number lengths
//10. NGBW Updated WS_AddReceiptTrx to update Reservation balance when transaction is added.
//11. NGBW Updated OR_EmailCust, OR_EmailCustAgree and OR_OnlineReservation_Cancel to use HTML email.
//12. DAM Added code for setting QON to 0 for all Analisis codes with InvItem enabled. method KSSUpdate 
//13. DAM Added xliff varibales for Description of Prorata Trx when using Weekly Billing Plan
//14. DAM Fixed quiting 4D Server if HOF Facility has ODBCPassword # ""

//Changes in 8.9.1 14/03/12
//1. NGBW Set OR_CreateResv to set [Contacts]CallTime
//2. DAM Added xliff variable for "Referral promotion requiring agreement number"
//3. RWFR Date check on syncing now uses UTCDate
//4. DAM Fixed condition for calendar update when reactivating Sales Enquiry
//5. DAM Added condition to StartupdemoCheck to change path to .4DD file if it is not 4D Remote Mode

//Changes in 8.9.1 13/03/12
//1. RWFR On upgrade Storman is set to use Standard headers/footers/receipts
//2. RWFR In setup method Billing Plan sort order defaults to 1 not 0
//3. RWFR After exiting marketing types it now updates unit types with size categories
//4. RWFR Ok & New button now hides when editing analysis codes
//5. RWFR Added missing ODBCPassword field to system setup
//6. RWFR Ezidebit credit card transactions during daily are marked as queued if status is W
//7. RWFR Uses of Last Day now have code to check for leap years
//8. RWFR Fixed demo not setting 4D User to Admin to match the Storman user
//9. RWFR Have set new invoice system to not attempt to apply formula if there are no transactions
//10. RWFR Backup settings in system setup use Never instead of None
//11. RWFR [Unit]LastRentAmt is set to 0 when a unit is vacated
//12. RWFR Set list of groups on a user to not have a border
//13. RWFR Reset items on invoices, quotes & statements to be adjustable
//14. RWFR Widened address fields on invoices & statements
//15. RWFR Widened add sales promotion button
//16. RWFR Notices screen on Windows opens in Movable Dialog box again (Mac has to be left as Compositing Mode)
//17. RWFR Fixed set colours window size on map
//18. RWFR [Contacts]"SelectQuote" opens in correct window size now
//19. RWFR [Unit]"SelectUnit" opens in correct window size now
//20. RWFR Gave all new permissions to admin/owner group on new data files
//21. RWFR Fixed changes to agreement screen edit 2 new fields not saving
//22. RWFR Set print map to ignore Resize marks
//23. RWFR Set print map to ignore blank elements
//24. RWFR Set print map to resize background rectangle
//25. DAM Added Help Links to all tabs in System Setup
//26. DAM Changed "Other regular charges" to "Other Recurring Charges" on Rent Increase Wizard form
//27. DAM Renamed "Mass Communication Wizard" to "Bulk Communication Wizard"
//28. DAM Added ability to add picture references in SVG
//29. DAM Changed xliff from "Customer Invoice" to "Customer Footer"
//30. DAM Added a help link to form "Insert Fields"
//31. DAM Added xliff "ODBC/Web Services"
//32. DAM Xliffed SVG form
//33. DAM Added xliff for Facility Map
//34. RWFR Can now print SVG Map
//35. DAM Marked [Unit]UpdateGate:=True for Insomniac Movein and now it generates Random Pin for a customer 
//36. RWFR MoveInCode relates billing plan on bChange and bNewChange
//37. RWFR at text hidden when backups set to Never or Weekly
//38. RWFR When tutorials access the support website form it says "Not available in the tutorial" for the password
//39. RWFR Fixed weekly backup form opening in wrong window size
//40. RWFR Re-enabled text dialog when pressing adjust rates
//41. RWFR Changed icon for Add Image on SVG Map
//42. RWFR Adjust rates dialog uses seperate titles for Analysis Codes & Unit Types now
//43. RWFR Email subject in bulk communication wizard is now changeable
//44. RWFR Widened agreement number field on UnitIn
//45. RWFR Updated UnitIn Learn More links
//46. RWFR Updated UnitTypeIn Learn More links
//47. NGBW Added ability to resize custom objects on the map
//48. RWFR On move out the value used for last billed amount is post discount if the discount is not being removed
//49. RWFR Fixed MoveOutCalc using current billing plan settings rather than last bill plan
//50. RWFR Create move out transactions button changes aPageNo by -1
//51. NGBW Set [MerchPlan]MerchPlanIn to edit quantity when clicking on cell instead of having to click on value.
//52. DAM Changed the check on the Code for INV Packs. Now it checks the Code's length (less than 8 and bigger than 6 characters)
//53. RWFR Narrow receipts show list of charges again if matched off, otherwise just the receipt transaction
//54. DAM Hid text "Vehicle Info" header if all relating to it fields are hidden 
//55. RWFR Enabled rotation of objects on map
//56. RWFR Reset alignment of address fields on statements to be left aligned
//57. RWFR Insurance owing report now only prints for a single facility not all
//58. RWFR Disabled autolog off while daily is running
//59. RWFR CheckCCValid displays customer code at start of error message
//60. RWFR Set customer balances to be set correctly where swipecard was not set to use a custom email notice or one was not generated at all
//61. RWFR If autopay is enabled on an agreement it checks the authorisation is entered before you can save the agreement
//62. RWFR Sites are allowed to have primary key ranges less than 0
//63. RWFR Generate primary keys works when primary keys are already assigned, it was only working when the primary keys was 0
//64. RWFR InitNextPrimary keys no longer hardcodes the MV range
//65. RWFR StaffPINs adding new record now sets facility code on record
//66. RWFR All activity fields past 77 now sync to head office including charge in advance values
//67. RWFR Fixed narration for remove unit transaction
//68. RWFR Removed extra calculation of balance from DailyAutopay
//69. DAM Xliffed variables in RemoveUnit method
//70. DAM Added Path to index.shtml file for OnlineRes for Standalone version.
//71. DAM Set buttons "Cancel", "Send Email & Close" invisible when open an existing email and button "Close" set invisible when creating new email from "AutoPay/Notices" tab
//72. DAM Fixed narrow receipt, now it is showing On Printing Break and on Printing Footer.
//73. RWFR Cash Sales discount when calculating is not rounded incorrectly
//74. RWFR Fixed print receipt (full) not including all charge transactions


//Changes in 8.9.1 21/02/12
//1. RWFR Changed Sort: to Filter: on Inventory Item Inquiry
//2. RWFR Moved Autopay Reference from Invoice Setup to System Setup
//3. RWFR Print Invoice / Receipts changed to Print Invoices / Receipts
//4. RWFR X & Y coordinates for tutorials are multiplied by 50 on import now
//5. RWFR Uses correct array type when getting child nodes from custom objects
//6. RWFR Fixed inventory item enquiry opening analysis code to edit afterwards
//7. DAM Changed all web linkes on the form [Notices]NoticesIn 
//8. RWFR Insurance Rate Premiums are now labelled per month
//9. RWFR Added code to convert insurance rate premiums from monthly to weekly
//10. RWFR Added help link to edit email notice screen
//11. RWFR Adjusted position of buttons on daily processing screen
//12. RWFR ORes.XML now supports new parameter UseHOFSMTP
//13. RWFR Online reservations will now use the head office SMTP details for sending online reservations emails if UseHOFSMTP is set to true
//14. RWFR Fixed up various daily processing forms to prevent display of grey areas
//15. DAM Changed Sort Order when reading xml file to start from 7 to avoid overlapping with default analysis codes 
//16. DAM Fixed xliff for xml import and for userlogins
//17. DAM Commented lines for import bank branch code in ReadXML method causing problems as the lenght of [Facility]BankBranch is 25 characters
//18. DAM Added caclulation of UnitType Area while UnitType import.
//19. DAM Fixed xliff issue on Reservation Page

//Changes in 8.9.1 16/02/12
//1. NGBW Fixed NotesHistory filter on Reservations not using [Reservation]CustomerCode
//2. NGBW Added $5 parameter to BalanceDateCalc to allow calculating for non-invoiced charges
//3. NGBW Edited OpenControlLink with READ WRITE([UnitHistory]) to allow editing unit history when opening from control screen
//4. NGBW Fixed "Hourly" backup setting not saving
//5. RWFR Fixed move out calculation wording incorrectly referring to adding billing plan discount
//6. RWFR All demos should be picking up rounding from facility file
//7. DAM Replaced Logo references with a picture variable on every report
//8. RWFR Fixed display issue in Access Control Setup
//9. RWFR Fixed Promotions & Promotions History in CDR not working correctly
//10. RWFR Minico print insurance button hidden for non-Minico customers
//11. RWFR Deleting late fee credits no longer increased waived late fee counter
//12. RWFR Added help link to promotions report dialog
//13. RWFR Added help tip for unlimited waived late fees option in system setup
//14. RWFR Process Dialog redesigned
//15. RWFR vAddr7 is declared when printing a cash sale invoice
//16. RWFR DeleteAgreement form now correctly sets vLeg1 & vLeg2 text
//17. RWFR Recalc now sets reservation/agreement balance to 0 if there are no transactions
//18. RWFR Fixed cash sale invoices not picking up all transactions
//19. RWFR Eventlog code to find customer/agreement only triggers when length of [Eventlog]AgreeNo > 12
//20. RWFR Eventlog code to find customer/agreement doesn't re-query if record in selection matches eventlog record
//21. RWFR Changed array type of $variables1 on SVG Map OK button to LongInt
//22. RWFR Added MaxDaysPassword option to training file allowing it to be set to 0 to prevent passwords expiring
//23. RWFR Added ability to print messages the site has created themselves
//24. RWFR Fixed not being able to change map colours on a Mac
//25. RWFR Can change colours used for unit statuses on SVG Map now
//26. RWFR Fixed ConvToAgreement not cycling through units correctly
//27. RWFR Increased length of agreement number on sales commission report
//28. NGBW Added ability to insert images in map.
//29. RWFR Fixed highlight object not being recreated when clearing custom objects


//Changes in 8.9.1 03/02/12
//1. SDD Added Sync Code to enable events to sync between site and Storman HOF server - see SyncLogNew for comments re new SyncStatus numbers
//2. RWFR Mass Payment opens in own window
//3. RWFR Password length and time options unlinked from complex password for display
//4. RWFR Disabled converting to PNG for SVG areas on invoices
//5. RWFR Fixed prev/next buttons not showing when viewing units
//6. RWFR Fixed incorrect style sheet on rent increase rules
//7. RWFR Fixed width of add insurance rate button
//8. RWFR Copy to all button hides if not MV for insurance rates
//9. RWFR Added border rectangles to modify users & groups
//10. RWFR Storage control file is ignored by startup page
//11. RWFR Removed Lite option from startup page
//12. RWFR Country selection for new data file defaults to AU if international date format or US if not
//13. RWFR Inventory Item Inquiry opens in seperate window
//14. RWFR Promotions now has help link
//15. RWFR Account inquiry opens in its own window
//16. RWFR Replaced old website method with interactive form
//17. DAM Changed type of the field [Facility]ReportLogo_ from Picture to BLOB
//18. RWFR Added password requirement to all possible non-insomniac web services
//19. DAM Added ability to edit ReportLog using SVG, also references can be used in ReportLogo
//20. DAM Fixed datepicker on MassPayment form

//Changes in 8.9.1 01/02/12
//1. NGBW Updated DoBillNext so LastDiscAmt with [Facility]TaxAddAmt is the correct value
//2. NGBW Fixed border disappearing from notes section of control screen when editing
//3. NGBW Adjusted SendSMS to save all of send SMS to [Letters]SMSMessage
//4. RWFR Force matching button removed as it no longer functions
//5. DAM Moved code for SVG from InvRecCode to PrintinvrecCode method to stop crashing PDF creator
//6. DAM Changed the windows types for forms [Facility]InvSetup and "SVG" to be able do modification on SVG attribute window
//7. DAM Adjust the SVG window size accordint to Hearder, Footer or Receipt size
//8. RWFR Ad Hoc Email's pick up custom late fee amount when choosing to bill charge
//9. RWFR Added help link to Reservations output form
//10. RWFR Added help link to mass DRC edit form
//11. RWFR Fixed size of billing plan dropdown on mass DRC edit form
//12. RWFR Increased length of exclude unit types on select unit types screen
//13. RWFR Fixed inventory purchases help link
//14. RWFR Fixed unit listing help link
//15. RWFR Fixed unit form help link
//16. RWFR Extended length of agreement number field on customer balances & aged debtors
//17. RWFR Fixed statement address details to match layout of invoices
//18. RWFR Fixed voucher code visibility
//19. RWFR Added casual daily billing to MoveInRR
//20. DAM adjust SVG to US letter format
//21. DAM Replaced xliff varibales for Agree't# Res# with Agreement No, Resevation No.


//Changes in 8.9.1 26/01/12
//1. RWFR Set multi-month reversal button to be visible for all
//2. RWFR GeneratePrimaryKeyValues now goes to next facility record in loop
//3. RWFR Disabling gate message in generate primary key values only shows if gate is on
//4. RWFR If backup setting are not loaded OK button in system setup will still work
//5. RWFR 4D Report is ignored as a process in GetProcessNames
//6. RWFR Sending emails now shows alerts when there is an error again
//7. RWFR Removed additional StaffPIN creations in CreateTutorial
//8. RWFR Declared vReprintCopy, bPrtRec & bEmailReceipt in PrintInvRec
//9. RWFR Fixed balance brought forward when printing historical invoices using print invoices/receipts
//10. RWFR Fixed DoProrataRent nows uses [Agreement]UnitsOccup instead of [Unit]UnitNo
//11. DAM xliffed forms [Notices]MailMergeDialog, [Notices]EditEmail
//12. DAM removed grid when saving a SVG
//13. RWFR Software Financial Settings text no longer in italics
//14. DAM changed fromat for next Agree No and Res No in System Setup
//15. RWFR Added missing seperation lines on old style statements
//16. RWFR GST text now shows correctly on old style statements
//17. RWFR Unit Type dropdown is disabled when the user only has permission to edit the status
//18. RWFR Fixed display of Notices section of agreement screen edit
//19. NGBW Made adjustments to forms so emails would display on Macs
//20. NGBW Changed window type of DailyProcessing to Compositing for Macs so emails would display
//21. RWFR vDaysLate variable updates when you load notices tab
//22. RWFR Delete receipt sets read write to true so you can delete transactions without a valid analysis code
//23. RWFR Printing/emailing statements now refreshes transaction list afterwards
//24. RWFR When removing a unit the dialog now refers to Pro-rata credit and the transaction description uses the same
//25. RWFR When cancelling editing a receipt/refund it correctly turns off automatic relations preventing the loss of the customer/agreement record
//26. RWFR Declared missing variables in ModCharges
//27. RWFR ModCharges screen sets bAbortArray values now so doesn't loop endlessly
//28. DAM added xliff varibales for "Rent Credit Unit" and for all product types

//Changes in 8.9.1 23/01/12
//1. NGBW Added <>asInputFields to InitArrays.
//2. DAM Deleted condition for checking autopay type when trying to process a CC payment with CC details on the file.
//3. DAM Created new xliff variables for [Facility]RentCalcNew, [Facility]System
//4. DAM Changed the wording for error on the button "Match" at Agremenet/Transaction tab to be "Please select more than one transaction"
//5. DAM Fixed xliff variable for Rent Increase Rules 
//6. NGBW Updated WS_AddAgreement and WS_ConvertReservation to use [Notices]RefDateField=11 instead of >10.
//7. DAM Added a new field [Facility]MerchantDetails1 for Authorise.net to have two modes when the Card is Present and when it's not.
//8. DAM Changed method ProcCreditCard for Authorise to process 2 accounts (Present, Non Present Cards) 
//9. DAM Added a condition to select a country during Storman Start Up and avoid run time error
//10. RWFR Declared vPlus & vMinus in MiscReceipts
//11. RWFR Moved creation of Staff PIN in CreateTutorial till after InitNextPrimaryKeys
//12. RWFR Added ability to user webserverclient.txt next to server/client application files to trigger running web server on client
//13. DAM Changed methods for Authorise.Net to use different Login ID for testing. (Non Present Card Account)
//14. RWFR Notices section of agreements layout and wording has been updated to match functionality
//15. RWFR Added Send optional invoices/statements to agreements
//16. RWFR Updated functionality of attach invoice/statement for notices to take account of setting on agreements
//17. RWFR Updated agreement edit to take account of new fields
//18. RWFR Fixed rent increase rules preview trying to calculate next bill dates when no unit/agreement was in selection
//19. RWFR Made adjustments to the setting of the agreement increase from date in ApplyRentRules as it was inconsitant with the behaviour elsewhere
//20. RWFR Added last increase date to unit listing for rent increase rules preview
//21. RWFR Fixed Unit Type not displaying on rent increase rules preview
//22. DAM added xliff variables for [Notices]NoticeIn, also for MoveIn, CreditSale, MoveInedit, MoveInRR
//23. DAM fixed issue caused by changeing the field type from Boolean to LongInt -> causing xliff canges
//24. RWFR Removed adjust rental income for prepaid rent from Consolidated Key Stats as this option was not intended to be added
//25. RWFR Added missing VALIDATE TRANSACTION to unit type forms unit type code field
//26. NGBW Added Inventory Packs feature.
//27. RWFR Added Insurance Admin Fee to System Setup, only functional for MiniCo Report
//28. DAM Xliffed the form [MerchPlan]MerchPlanIn and all related methods
//29. DAM added xliff variable "Autopay Authorisation is not yet valid" in method DailyAutoPay and "Insurance admin fee:" in System Setup
//30. RWFR Updated MiniCo with new rates to be valid from Feb 1st 2012
//31. RWFR Reports menu redesigned and uses ReportMenu method to generate
//32. SDD Modified LogMonLoopCode to allow multiple site systems to sync each site to HOF
//33. SDD Modified SyncReceive to READ ONLY and UnLoadAll to try and prevent having to quit Client and relaunch after receiving site
//34. SDD Fix syntax error in Modify Receipts after adding a receipt
//35. RWFR Projected Charges Report when run on a Facility whose prices are ex-Tax now includes tax in the future projection, not just the already billed transactions
//36. RWFR Re-replaced execute on server calls that were only using a stack size of 32000 with 128000
//37. RWFR Syncdecode now check eventdate for checksum dates against UTC Date/Time
//38. RWFR Syncupdate will deal with checksums on different tables and not delete them
//39. RWFR SyncCreateAllProc puts "SEND" code in Activity events allowing them to be synced rather than exported
//40. RWFR Fixed inconsistant keyvalue in TriggerLogActivity versus the Activity table trigger
//41. RWFR Delete and Display Agreement forms have a wider column for the agreement number now
//42. NGBW Added HTML Email feature.
//43. NGBW Changed calculation of [Activity]DepositsHeld to use accurate values.
//44. RWFR RefundAgrChange extended to 9 digits in all places
//45. RWFR Unreconcile only looks for a facility code in report name if MV now
//46. RWFR Increased length of [Letter]LetterDesc to 80 to store full email subjects
//47. RWFR Fixed adding new units to an agreement not forcing an update to the gate system
//48. RWFR When updating activity records in logmonloopcode it now says Activity instead of Matching
//49. RWFR Set SwipeCard for Ezidebit to check $2=True instead of vCCNo=""
//50. DAM has changed [Facility]InvHeader_ type from picture to BLOB
//51. RWFR Set SwipeCard to notify users that Ezidebit doesn't support refunds
//52. DAM has changed [Facility]InvFooter_ type from picture to BLOB
//53. DAM has changed [Facility]Receipt_ type from picture to BLOB
//54. RWFR ActionMail no longer appends text descriptions of eventlog records when sending a customer
//55. RWFR Backup settings in system setup now support full hourly, daily, weekly & monthly settings.
//56. NGBW Added CreateUserID to [UserLogins] trigger to generate UserID for imported records
//57. DAM Replaced 4D Draw with SVG for Custome Designed headers, receipts, footers.
//58. NGBW Added Save/Restore buttons to [Notices]EmailEdit
//59. NGBW Set "New email" button on ControlBig to open HTML email editor

//Changes in 8.9.1 22/12/11
//1. NGBW Set bMod on UnitTypesIn to check permissions.
//2. NGBW Fixed Birthday notices not triggering.
//3. NGBW Fixed "Pay deposit online" button only appearing for Advam in OR_Thankyou.
//4. RWFR Increased length of agreement number to 9 and reservation number to 8
//5. RWFR Adjusted various agreement move in forms and the output forms to accomodate the agreement number
//6. RWFR Adjusted the Autopay form that if the facility code is included it cuts off the first two letters as references only cope with 12 characters
//7. SDD Changes to ReverseLog to allow for UnDoing of MOD records
//8. RWFR Login at startup option is removed, all data files other than tutorial are forced to login at startup
//9. NGBW Changed field length of [Transaction]CCTransID from 16 to 50.
//10. RWFR Adjusted reports where required for longer agreement/reservation numbers
//11. NGBW Fixed DoBillNext not using [Unit]WeeklyRate correctly.
//12. NGBW Fixed calculation of vAmt3 in MoveOutCalc using Round instead of RoundAmt.
//13. NGBW Set CheckCCStatus and CheckDDStatus to call UpdateReceipt to update balances.
//14. NGBW Set MoveInCode to OBJECT SET COLOR on vEziCCStatus and vEziDDStatus to red if no payment profile is found.
//15. RWFR Added call taken by to display on agreements & reservations
//16. RWFR Added button to map to reset unit co-ordinates
//17. RWFR Changed to NTK plugin from MD5 plugin
//18. NGBW Updated BankingRpt to only hide EziDebit transactions if they have not got a banked date.
//19. NGBW Added WS_ORSalesEnquiryNo to WS_AddAgreement and WS_CreateReservation to select an existing enquiry.
//20. NGBW Moved location of backup on System.bOK so initial backup is created without backup prefs file.
//21. NGBW Added ReceiveMailProcess to run ReceiveMail in a separate process.
//22. NGBW Adjusted CalcNewRents to pick up the billing plan and calculate correctly for Weekly & Casual plans.
//23. NGBW Added setting of [Unit]LockStatus to MoveInOK instead of on change of asLockStatus.
//24. RWFR Fixed Checksum Record ignoring all non-PrimaryKey fields
//25. RWFR You can now customise the number of days in the future you allow move outs for
//26. RWFR Added option to remind later to update check, this delays it 30 days
//27. NGBW Added second parameter to GetMD5 to enable hashing of documents.
//28. NGBW Updated InetBackups to use document hashing instead of hashing the filename.
//29. RWFR Added legal information to login screen
//30. RWFR Added customizations for SSWAR
//31. RWFR Added expected move in time to Reservations table, ReservationsIn & PrintReservations forms
//32. RWFR PrintReservations form is additionally sorted by ExpectedMoveInTime when sorting by date
//33. RWFR Added expected move out time to Agreement table, MoveIn, MoveInEdit, MoveInRR & [Unit]Terminations forms
//34. RWFR [Unit]Terminations form is additionally sorted by ExpectedMoveOutTime
//35. RWFR Fixed calculation of PTD when discounts not shown on invoices
//36. RWFR Fixed undo not working when discounts not shown on invoices
//37. RWFR Corrected display of amount to undo
//38. RWFR If $RentAmt = 0 in RecalcUnpaid then the PTD calculation uses 0 months to prevent errors
//39. NGBW Modified SchedDeposits, MoveOutCalc and TakeAsRent to pick up transactions based on KeyStatsCategory of Deposit.
//40. NGBW Fixed up adjustments on InvQtyOnHand in CashSales.
//41. RWFR Fixed deposit amounts being set higher than 0 when not set to charge a deposit for Online Res & Web services
//42. RWFR Added missing reports to batch & periodic reports
//43. RWFR SMS Delivery Report hidden if not Thinc
//44. RWFR DatabaseSetup requires you to be logged in as Adminsupport to function now as this gets around the permission issue
//45. SDD SyncCheckValidSite Added SyncError 160 which when entered at HOF will automatically accept the NextSeqNo as passed from the site and continue syncing
//46. DAM changed the RemoveUnit method, If it's not a real moveout it loads values to [Unit]MoveIn and [Unit]MoveOut from the last record for this unit in UnitHistory
//47. RWFR Fixed changing facility code not updating primary key ranges causing syntax errors
//48. RWFR Added semaphore to ensure only one process is accessing the next agreement/credit sale number at a time
//49. RWFR Added new fixed amount option for billing plans - includes per period and customer type based pricing options
//50. RWFR Added number of agreements & sum of autopay amount to bottom of autopay report
//51. RWFR Deleting a facility through modify facilities deletes all associated records
//52. RWFR Fixed <>sCurrency not updating after changing in System Setup
//53. RWFR Daily login is used until daily process is ended now
//54. RWFR Fixed statements not closing after editing them
//55. RWFR Removed old upgrade code from CheckVersion
//56. RWFR Added new check if version is less than 8200 to inform user they need to restore backup and upgrade to 8.2.0 first
//57. RWFR When using bill each unit seperately the incentive appears for free periods now and the amounts adjusted
//58. RWFR Fixed min & max amount on analysis codes blocking credits incorrectly
//59. RWFR Moved UpdateReceipt call to form event=on unload of ModReceipts
//60. RWFR Fixed DailyAutopay calls to UpdateReceipt not using "Web" parameter as it was not updating balances correctly
//61. RWFR UpdateReceipt now uses vOldAmount when not calling "Web" which stores the original totamount of the receipt
//62. RWFR UpdateReceipt now ignores all future dated transactions when calculating balances
//63. RWFR Fixed copying promos not setting billing plans/analysis codes correctly
//64. NGBW Added check to DailyAutopay to not process AutoPays that do no fall in the Auth date range.
//65. RWFR Added missing fields to clone module & facility copy to all
//66. NGBW Removed setting [Agreement]DepositAmt to [UnitType]DepositAmt in ConvToAgreemt
//67. NGBW Updated OR_CreateResv so [Reservation]Balance is set for Deposit even if ORes.xml set to not charge deposit.
//68. RWFR Added ability to edit a contact using WS_AddContact
//69. NGBW Updated CalcTaxAmt to one RELATE to [Transaction] if there are transactions in the selection.
//70. NGBW Added WS_aQuantityOnHand output variable to return the quantity on hand of an Inventory Item.
//71. RWFR Customer analysis report shows suburb, city & state rather than just city & state
//72. RWFR Fixed new move in billing plan vouchers not creating note
//73. RWFR Fixed LoadFacilityCountries using SetFacility as it was causing an endless loop. Replaced with ALL RECORDS([Facility])
//74. RWFR Added missing set & variables to Banking Report method before ChargeAnalysis is called
//75. NGBW Added BNZ Direct Debit export to DailyAutopay.
//76. NGBW Added field [Facility]DirectDebitOption and options to System Setup.
//78. NGBW Moved creation of DD export files to before the Autopay report was run.

//Changes in 8.2.9 10/11/11
//1. RWFR Made a change to PrintSelection for batch printing to try and keep duplex settings
//2. RWFR Declared variables in ProcCCThinc used for TCP_Receive
//3. RWFR Added TTV01 & TTV02 to list of test accounts for Thinc

//Changes in 8.2.9 09/11/11
//1. NLT Comment out code for cash receipt exports to QB (designed for Steve Wile but not used:remove rather than replace MiscDetls subtable)
//2. NLT Replace coding for insurance summary report which relied on Miscdetls subtable
//3. SDD InitSites - Changes to allow faster startup if EventSeqNo is wildly wrong - also allow Control Down to force recalc of EventSeqNo
//4. SDD Removed subtable [Facility]SendToList and changed field to Text with Arrays
//5. SDD Inventory Valuation Report - Modified report method so that Qty Bal of zero will not show a value on hand
//6. SDD Changed [Facility]SendToList to Listbox on form EventLog
//7. SDD Removed subtable [Facility]PrintLogSettings and changed to work with arrays
//8. SDD Removed subtable [Facility]GateTimeZones and removed functionality
//9. SDD Removed subtable [Customer]CardNos
//10. RWFR Replaced [UnitType]RCHistory usage with full table
//11. RWFR Replaced [Agreement]OtherChgs usage with full table
//12. RWFR Replaced [Facility]StaffPins usage with full table
//13. RWFR Cash Sales no longer use [Transaction]MiscDetls subtable
//14. RWFR Fixed cash sales not checking if next match number was in use
//15. RWFR Fixed cash sales resetting next match number to 1 if it was greater than 9999
//16. RWFR Fixed cash sales setting read write on all tables
//17. NGBW Added fixes for EziDebit.
//18. NGBW Changed date format to 24hr on agreement gatelog.
//19. RWFR Changed behaviour of marketing types copy to all button delete option to match description
//20. NGBW Updated ModFacility to update new tables and fields.
//21. NGBW Fixed vIncludeRented on UnitSelect causing all units to disappear when unchecked.
//22. NGBW Set ProcCCThinc to save the error message and to suppress XML parsing errors.
//23. NGBW Removed checking for charge transactions to cancel reserverations in LogMonLoopCode.
//24. DAM Added a query, so inactive analysis codes cannot be added at new MoveIn
//25. NGBW Updated SelectUnitA to prevent users setting $MoveInDate less than [Facility]CantModifyPrior.
//26. NGBW Updated DoBillNext and DoBillCasual to not check [Agreement]TaxExempt before setting tax on discounts.
//27. NGBW Updated Key Data vars in ControlBig to the ##,###,##0 format.
//28. RWFR Eventlog Date & Time are now stored as UTC Date/Time
//29. RWFR Where eventlog date/time is being displayed it now shows the current timezone
//30. RWFR Last sync date & time are now stored as UTC Date/Time
//31. RWFR Where last sync date/time is being displayed it now shows the current timezone
//32. RWFR Replaced other regular charges sum loops with calls to sum command again
//33. RWFR Fixed adding other regular charges not updating list of charges displayed
//34. RWFR Built output forms for CDR for ex-subtables we are keeping
//35. RWFR Removed all leftover sub-table commands and links
//36. RWFR Renamed ex-subtables we are keeping
//37. RWFR Added ex-subtables to InitPrimaryKeys & StructureArray
//38. RWFR Fixed SetupArrays not checking newer tables on startup
//39. RWFR Set triggers on ex-subtables we are keeping so they sync
//40. NGBW Changed field type of [Customer]CCInfo from String(10) to Text.
//41. RWFR Agreement Edit Check only runs on active agreements
//42. RWFR Added prompt to agreement edit check

//Changes in 8.2.8 07/10/11
//1. NGBW Added CheckPrefs and UpdatePrefs to read and modify/create a Preferences.xml file
//2. NGBW Modified On Startup and Quit to load and update the screen size from the Preferences.xml.

//Changes in 8.2.8 06/10/11
//1. RWFR Fixed depreciation schedule when old item is set to 100% depreciation

//Changes in 8.2.8 04/10/11
//1. NGBW Added calculation of tax to WS_AddChargeTrx
//2. NGBW Removed UpdateReceipt from WS_AddChargeTrx causing incorrect balance.
//3. NLT Fix overstated totals in printing of Sum of Cash Received report caused by incorrect form event usage
//4. NLT Fix bug in reversing prepaid of Gl Report where facility record not loaded when tax is calc'd.
//5. NLT Fixed debits / credits under prepaid section of GL Report 
//6. SDD Consolidated Occupancy - Fixed bug where vDate (Report date) changed to current date on second page due to footer - renamed variable.
//7. NGBW Added option to reverse all dishonoured and failed payments for EziDebit.
//8. NGBW Moved checking of Direct Debits and Credit Cards from DailyA and BankingRpt to CheckDDStatus and CheckCCStatus.
//9. SDD Fixed bug in UpdateReceipt when updating LCSD based on RentUnpaid instead of BalanceOwing it needed to be decreased by the Receipt TotAmt 
//10. SDD Mod Users & Groups - Added Language field to Userlogin and Sets Database Localization to this value if en,es,fr
//11. NLT Added 'Export complete' alert messages to end of all accounting exports
//12. NLT Added Prepaid rent to Consolidated Key Stats report.
//13. SDD Added CheckSum for Activity records - THIS NEEDS TO BE TESTED
//14. RWFR Set Global Variables in WS_CreateReservation & WS_AddAgreement so reading of ORes.xml works


//Changes in 8.2.8 14/09/11
//1. RWFR Fixed incorrect pro-rata and bill move in charges display for casual daily
//2. RWFR Undo works with record number 0 now
//3. RWFR Currency symbols display in BillPlanQuote
//4. RWFR Fixed display of format of numbers in BillPlanQuote
//5. RWFR Billing Plan Swap To Code dropdown now displays correctly based on casual billing setting
//6. RWFR Fixed CTSelection not always triggering bChange and bNewChange
//7. RWFR Billing plan list in agreement is locked after first billing to prevent changing to incorrect plans
//8. NGBW Fixed WS_AddContact using Head Office facility code instead of correct site.
//9. NLT Fixed problem where payment amount not showing when printing a receipt under new inv system.
//10. NLT Fixed batch refunds so it always exports the date in dd/mm/yyyy format (NM)

//Changes in 8.2.8 08/09/11
//1. NLT Fix bug in Moveoutcalc for billing plans where discount is sometimes removed
//2. NLT Fix Pro-rata narration where the agreement's 'mths in advance' is different to the bill plan's 'periods in adv')
//3. RWFR Statements can now be edited via Invoice & Quote Design
//4. RWFR Re-enabled full syncing hours
//5. RWFR Added logging for inventory to triggers based on presence of file called Inventory.txt in the resources folder
//6. NGBW Added error handlers for EziDebit web service errors.
//7. NGBW Changed setting of [Agreement]NoticeBilled to only be approved if not "P".
//8. RWFR Added option to reset late cycle start date based on rent owing rather than full agreement balance
//9. RWFR Added option to show statement detail for invoice/statement system
//10. NLT Fixed display of date title in Cash Sale showing as "userlogin"
//11. NLT Fixed bug so user can now edit date banked on Cash Sale
//12. NLT Fixed 'read only' mode error message on re-opening a cash sale
//13. NLT Fixed cash sale loading data from previously entered cash sale
//14. NGBW Set Online Res marketing details to be entered in Sales Enquiry.

//Changes in 8.2.8 05/09/11
//1. RWFR Weekly tickbox in reservations now prompts for reset of quoted rates
//2. RWFR Fixed Other Credit Sales bill next charges not displaying correctly
//3. RWFR Fixed rent increases being partially applied even if you click cancel on the bill next charges dialog
//4. RWFR Fixed various small variable and field calculation errors for billing related items
//5. RWFR Users without permission to edit units can still change status now
//6. RWFR Updated FacCountry.XML for Australia
//7. RWFR Fixed un-invoiced charges which don't appear on statements in the invoice/statement system from being included in balance calculations
//8. RWFR Fixed NextCreditSaleNo not advancing correctly
//9. RWFR Fixed NextCreditSaleNo not being checked correctly
//10. NGBW Changed CalcInvBal using Abs on TaxAmt causing issues with outgoing stock.

//Changes in 8.2.8 01/09/11
//1. RWFR CasualBilling form added to Agreement table
//2. RWFR Casual_xxx methods added to control CasualBilling form
//3. RWFR Added form and object methods to CasualBilling form
//4. RWFR Added flag to Billing Plans to mark as casual daily based billing
//5. NGBW Fixed Notices Charge Analysis Code not saving.
//6. NGBW Added check to DailyPrepNotices to ensure Late Fees are not created without an Analysis Code.
//7. NGBW Fixed grouping of radio buttons on Auto Rental Increase form and Xliff issue.
//8. RWFR Daily now uses Customer table Date of Birth and CCExpiry
//9. RWFR Disabled code that set Agreement table Date of Birth and CCExpiry
//10. NLT Removed other bank trx from Summary of Cash Received report.
//11. NGBW Set ExportCustCSV to use [Customer]CustomerName if [Customer]LetterCustomerName is blank.
//12. NGBW Set help links on dashboard to redirect to "Intro to Storman" kb article for demo.
//13. NGBW Set ConvToAgreemt to not allow adding to existing agreement if [Facility]UnitPerAgreement=True.
//14. NGBW Set replacement of SMS fields to format amounts.
//15. NGBW Fixed [Facility]Request not showing correct value if textfield is filled in, and added var to display correct char limit.
//16. NGBW Set BillNextCharges to display ORC total instead of Rent of 0 for Other Credit Sales.
//17. NGBW Added ability to create Credit Sale with WS_AddAgreement.
//18. NGBW Fixed WS_AddAgreement not setting a valid Agreement number ever.
//19. RWFR Cleared CCNo field when deleting a credit card profile
//20. NGBW Set WS_GetAgreementInfo to send customer details even if [Customer]Password<"  ".
//21. RWFR Enabled full export/import for all users
//22. RWFR Fixed missing else in OccupRpt preventing loading of rates
//23. RWFR Added missing total area from small occupancy report
//24. RWFR Fixed SMS successful message not showing for manual SMS messages
//25. RWFR Stopped lock list clearing non-status 6 overdues
//26. RWFR Fixed reprint/emailed invoices not sorting correctly
//27. RWFR Suburb/City/State are set to Uppercase again
//28. RWFR Fixed address field code not referencing correct fields
//29. RWFR Address field code only triggers on validate & data change now
//30. RWFR Notice Fee now has varying length descriptions
//31. RWFR Online Reservations now excludes units set to repair
//32. RWFR Added [UnitHistory]Casual field to indicate records used by the casual billing system
//33. RWFR Fixed up calculation of rent fields and included new casual billing
//34. SDD Fixed Array Range bug in MoveinOut
//35. SDD Fixed bug causing CheckSum error to be emailed when in fact it was an auto fix

//Changes in 8.2.8 10/08/11
//1. NLT Fixed moveout calc to not include discount in pro-rata rental credit when the incentive is always removed
//2. RWFR InvoiceEditProcess now calls SetFacility
//3. RWFR If city is blank invoices no longer leave space for it
//4. RWFR Receipts no longer say balance of this invoice due
//5. RWFR Print invoice/receipt shows as Print invoices and statements if using new system

//Changes in 8.2.7 08/08/11
//1. RWFR Fixed not all alarm events for Falcon, Storlogix & Digigate being picked up correctly
//2. RWFR Removed entry filters on address fields to allow for non-ASCII characters
//3. RWFR Added new field [Facility]TaxFreeDefault
//4. RWFR If [Facility]TaxFreeDefault is True then agreements and reservations default to tax free
//5. RWFR Added WS_ORUnitSelect to WS_CreateReservation to allow for reserving of specific units
//6. RWFR Added new field [Notices]LateCycleIgnore
//7. RWFR Code added to daily to ignore notices where latecycleignore = true
//8. RWFR Added variable minimum for unit types with variable length enabled
//9. RWFR Added code to various places to ensure rates used are the variable minimum length if set

//Changes in 8.2.7 05/08/11
//1. RWFR Fixed RecalcUnpaid not accounting for discount amounts
//2. RWFR Fixed SendSMS overwriting letter descriptions with "SMS"
//3. SDD SyncUpdateRecord - check AD+ events belong to correct facility before overwriting existing record
//4. SDD System - changed PrimaryKey setup fields to have commas so easier to check value
//5. RWFR Fixed InitSites not being called before importing XML
//6. RWFR Fixed UnitType based occupancy reports display issues
//7. RWFR Balance due by now working for Invoices in new system
//8. RWFR Fixed cancel button not being disabled when printing an invoice in the new system
//9. RWFR Permission added to Mths Advance field
//10. SDD change names on System Setup tab to be shorter to fit for Mac
//11. SDD EventLog - Added Copy to Clipboard button for AdminSupport users to retrieve LogDetail
//12. SDD SyncToSite - Fixed problem where HOF trying to resend 0 events - now reduces HOF SeqNo by 1
//13. SDD DailyA - Added RecalcActivity when run on MV otherwise it never gets done
//14. SDD IncomeCharged Dialog - Add back buttons to advance date by one month quickly
//15. RWFR Added Dock Walk Report for Marinas, uses LOB analysis code for live on board
//16. NGBW Added parameter to SendSMS to create a new [Letter] record if true.
//17. NGBW Set [Customer]CustomerName and [Customer]CustomerCode to not enterable on [Agreement]SelectAgreement.
//18. RWFR Set MoveInOK to not allow saving of agreement if a <None> analysis code is present in other regular charges
//19. RWFR Fixed ChecksumRecord not working correctly
//20. SDD LogMonLoopCode - Stopped CheckMatchMisc running at night
//21. SDD RemoveORC - If Other Charge does not exist as a charge then just delete it
//22. SDD KeyStats - For Billing adjust names of ChargeCategories to what is in the arrays to use Licences etc
//23. RWFR Fixed PrintReceiptOption incorrectly changing agreement record selection
//24. RWFR Fixed date prompts on TransOut happening before modify record
//25. RWFR MoveInOk unsets Send by SMS if mobile is blank



//Changes in 8.2.7 21/07/11
//1. RWFR Startup form defaults to existing datafile option if one is present
//2. RWFR Added insurance recalc button to insurance rates to ensure correct values & schedule increases
//3. SDD Removed <>iSendTrigger from TriggerLog and LogEvent and based everything on [EventLog]RecordStatus using both Sync and SyncAdd users
//4. SDD EventLog Display - Added number of records displayed

//Changes in 8.2.7 12/07/11
//1. SDD Changes to SyncProcessCheckSum and SyncUpdate to ensure that FIX records are sent
//2. NLT pass parameter to CreateRecJrnls to fix parameter not found error when running for Great Plains.
//3. SDD Modify Facilities - Added dropdown to display facilities not synced in past hour and not synced in past day
//4. RWFR Fixed delete button showing in credits when vLeg had a value
//5. RWFR TakeAsRent & RefundDeposit now deal with additional remaining credit balances as well
//6. RWFR If DebugMode.txt is present in the resources folder, debug logging is enabled
//7. RWFR Stopped new sales enquiries locking the facility record
//8. RWFR Fixed delete button showing in receipts/refunds when vLeg had a value
//9. SDD New method CheckBackupLog which ensures datafile is using a journal log. Called by On Startup and On Server Startup
//10. SDD System Setup - Slider for photo compression was not enterable - fixed.
//11. SDD TakePicture - If photosize > 500K it will ask you to reduce the photo by 50%
//12. SDD LogEvent - If Blob containing pictures and letters is larger than 500K event will be set to SyncStatus=13
//13. DAM Added Button "Email Receipt" to the transaction tab.

//Changes in 8.2.7 06/07/11
//1. RWFR Fixed issue where printreceiptoption caused agreement record to be lost
//2. RWFR On upgrade to 8.2.7 it checks inventory quantities, balances & any duplicate sequence numbers and corrects them
//3. RWFR Stopped date picker on addbanktrx from using getvaliddate
//4. RWFR Fixed cash sales not recalculating discount when anything other than the quantity was edited
//5. RWFR Added size = 0 to additional PIN name check query
//6. DAM Fixed banking report not printing previous reports before Can't Mod Prior Date
//7. SDD Fixed Invoice not printing Charge Total vTot on the second and subsequent pages of an invoice
//8. DAM Fixed Move Out calculation with discount
//9. RWFR Fixed Date Banked not being allowed for future dates when processing a credit card automatically
//10. RWFR LastMthsAdv is set to 1 if periodic billing 
//11. RWFR When undoing last charges periodic billing position is decreased by 1
//12. RWFR Reprint invoice form now checks that you have selected an invoice to reprint

//Changes in 8.2.6 30/06/11
//1. RWFR Fixed display of billing amount for periodic billing when clicking bill next charges
//2. RWFR Fixed issue where copying notices created duplicates by checking noticeplan number and deleting all records in selection that matched
//3. RWFR Set trigger on agreement to ensure that active agreement is set to false if buyback is true no matter what
//4. RWFR Widened floating window process & facility list
//5. RWFR Made change to include 4D Volume Desktop in being ignored from reinitiliazing event sequence numbers

//Changes in 8.2.6 23/06/11
//1. RWFR Cannot save agreement if additional user has a name of "Please enter name" or ""
//2. RWFR Fixed UnderRented not showing FMR
//3. RWFR Fixed UnderRented not totalling FMR
//4. RWFR Permissions Control error now includes permission number
//5. RWFR Fixed logmonloopcode not passing parameter 16 to GateAction
//6. RWFR Fixed incorrect variable being used for balance due by for invoice/statement system
//7. RWFR Made a change to reselect the customer record just before sending an SMS during daily
//8. RWFR Fixed misalignment of waiting list button
//9. RWFR Removed paper type option in print selection for KSS as it was causing freezing
//10. SDD SyncUpdate - Fixed issue where blobs were not being uncompressed
//11. SDD Floating Process Window - eliminated the floating windows with the 'extend' button and made the default one draggable vertically
//12. RWFR Added Server user to be used when application type = 4D Server
//13. RWFR Fixed receipts for inactive agreements being affected by refund permission
//14. RWFR Prevented credit cards being processed for anything other than the total amount in cash sales
//15. SDD SyncRecordLog Insert full text of response from server when the File Incomplete error is generated so we can track
//16. SDD On Web Connection Defined vbEventContent as a Blob in Compiler_Web so that syncing can work when uncompiled
//17. SDD SyncGetEvents - Fixed TEXT TO BLOB using Mac Text without length which truncates to 32k by adding new method SyncTextTotBlobAdditional note - this fixes the syncing problem Wrong Record Count that has been occurring for CHK events
//18. RWFR Added MC & CC product codes for Carparks - only <>vtUnits & <>vtUnitsCap have been adjusted at this point
//19. RWFR Added walk order field to Unit table
//20. RWFR Unit status report can now be sorted by walk order
//21. RWFR Fixed CT based pricing not working when changing customer type


//Changes in 8.2.5 20/06/11
//1. RWFR WS_AddPDF now checks customer code <6 instead of #10 to see if it is invalid
//2. RWFR Fixed Periodic Billing not setting last bill amount correctly
//3. RWFR Rewrote PDF method due to 4D Changes
//4. RWFR Fixed periodic billing affecting insurance calculations when there was free periods
//5. RWFR Add Charge button is hidden if there are any merchandise discount plans
//6. DAM Fixed adding/editing notes to/in NotesHistory table when changes are made to an alert-note on reservaiton. 
//7. RWFR Added balance due by for new invoice system
//8. RWFR LastBillDate is now advanced when moving the move in date into the future
//9. DAM Fixed auto adding records to NotesHistory table
//10. RWFR Defaulted name of new key cards to Please enter name


//Changes in 8.2.5 10/06/11
//1. SDD LogMonLoopCode Was only syncing for SP & RR - Have added TT & BB for Marinas & Vaults otherwise they can't sync

//Changes in 8.2.5 31/05/11
//1. RWFR Added, corrected or removed incorrect Learn More links
//2. RWFR Adjusted size of buttons on confirm two to allow for longer button names
//3. NLT fullstop added at Andy's request to periodic reporting screen.
//4. RWFR Added clearing of LastInc on Vacant units to KSSUpgrade
//5. RWFR Fixed checkbox behaviour on UnderRentedDialog
//6. RWFR Added learn more link to Rental Variation History report dialog
//7. RWFR Added learn more link to Threat Level report dialog
//8. RWFR Added missing icon to sales enquiry report dialog
//9. RWFR Fixed border colour on variable on sales enquiry report dialog
//10. RWFR Fixed incorrect learn more link on the Inventory Valuation report dialog
//11. RWFR Fixed layout and style sheets on Inventory Valuation report dialog
//12. NGBW Set bAbort to hide when successful for CC_Add/CC_Edit and CC_Del.
//13. RWFR Fixed periodic reporting setup not showing/hiding error message properly
//14. RWFR Fixed vLeg7 being reused in UnitIn form, replaced Mux No with vLeg14
//15. RWFR Moved percent in MerchPlanIn inside field
//16. RWFR Fixed text positioning in tab header line on NoticesIn
//17. RWFR Fixed incorrect gradient size in RentIncreaseRules
//18. DAM Added a method "ReadXML" to import info for a new database.
//19. DAM Replaced test details to account details for Simple Certified Mail
//20. RWFR Removed margins on all Control screen forms
//21. RWFR Added learn more links to ModUsers, UserloginsIn & GroupsIn
//22. RWFR Removed all the incorrect checks to permission 14 on tab controls
//23. RWFR Added ?src=lm to learn more links that had it missing
//24. RWFR Replaced EAM codes with learn more links
//25. RWFR Added new DaysPrior method and moved object methods code to it
//26. RWFR Added new SetMatch method and moved object methods code to it
//27. NGBW Added logging of Web Service errors to Auth.Net CIM methods.
//28. RWFR Increased size of periodic reports window
//29. NGBW Set bUpload on [Customer]AuthNetDetails to set bDelCC to enabled.
//30. RWFR ModCharges/ModReceipt checks if unit is Vacant before trying to use it to find an agreement & customer


//Changes in 8.2.5 27/05/11
//1. RWFR Fixed using check available units not adding quotes properly
//2. NGBW Added WSC_EziGetPaymentDetail to replace WSC_EziGetPaymentStatus.
//3. RWFR Added boxes around dropdowns in agreement screen edit so colour changes are visible in Vista & Above
//4. RWFR Fixed prompt for amount for other regular charges not having billing plan in selection
//5. RWFR Fixed prompt for amount for other regular charges not including billing plan free months
//6. RWFR Fixed loops for vOthTotal & vNewOthTotal not setting to 0 before loop
//7. RWFR Fixed vNewOthTotal only including the last other regular charge in its total
//8. RWFR Replaced remaining instances of vOthTotal & vNewOthTotal using Sum
//9. RWFR Removed code that was moving the balance brought forward date a month when there was more than 9 transactions
//10. RWFR Fixed no style sheet on analysis code variable on TransOut
//11. RWFR Added learn more link to Chart of Accounts message in ReconcileNew/Uncreconcile
//12. RWFR Stopped buttons being cut off in take payment from other site when resolution is 1024*768
//13. RWFR Updated CustomerIn form to match lastest variable names/look etc
//14. RWFR KSSUpgradev8 now sets Services & StorageFees to Agreements & Reservations only on upgrade

//Changes in 8.2.5 25/05/11
//1. RWFR Commented out the shift down option in receive mail
//2. RWFR Eventlog is written for gatelog on modifies as well
//3. RWFR Initsites doesn't reinitiliase eventlog sequence number in standalone if the array is already filled
//4. RWFR Fixed site based voucher redemption not limiting search to a specific facility
//5. NGBW Adjusted how TrxSortList and MiscReceipts picks up "This Week" values.
//6. RWFR Fixed display issues on ModReceiptOthrSite

//Changes in 8.2.5 24/05/11
//1. RWFR Fixed gatelogout display issue
//2. NGBW Fixed Occupancy Report not printing the correct report and several display issues.
//3. NGBW Added setting of ORC if InsuranceRates are present and Insurance is not Sort Order 4.
//4. NGBW Commented out checking of dates in LogMonLoopCode.
//5. NGBW Commented out generation of the Activity Checksum in SyncLog until the issues with it can be resolved.
//6. NGBW Set CheckVersion to check all the [Notices]Letter and Email BLOBs and set the Blank fields accordingly.
//7. NGBW Added BillPlan to tables to export overnight.

//Changes in 8.2.5 23/05/11
//1. NGBW Added check to Credit Sale in MoveInCode to exclude blank Agreement Numbers.
//2. NGBW Set Receive mail to only alert about waiting messages if more than 0.

//Changes in 8.2.5 23/05/11
//1. RWFR Replaced all uses of UTF8 Text with Mac Text as UTF8 text has a bug
//2. RWFR Fixed WS_CreateReservation having Unit Type search using less than instead of greater than
//3. NGBW Fixed Syntax Error in TakePicture due to $File not being defined.

//Changes in 8.2.5 20/05/11
//1. RWFR Added code so that $PPTax in KeyStats is set when the facility has no tax set and neither does the RF Analysis code
//2. RWFR Fixed CreateCustCode when searching not using name as typed
//3. NGBW Added invisible button to [Transaction]ReconcileNew to tick the box without having to highlight the record first.
//4. RWFR SwipeCard expiry date format is consistent with other entry areas
//5. RWFR Gate area always shows if licenced for gate
//6. RWFR Fixed quotes appearing as $0 by default
//7. NGBW Set UnreconciledReport to generate same way as ConfirmCloseBal.
//8. NGBW Modified [Letters]EmailIn to set Close button to disabled if email not already sent.
//9. RWFR Quotes & Reservations now support variable length properly
//10. NGBW Set LettersInCode to not select notices with [Notices]LetterBlank=True.
//11. RWFR Fixed incorrect balance when converting sales enquiries to reservations and charging deposits


//Changes in 8.2.5 19/05/11
//1. NGBW Fixed SMS not attempting to generate if no SMS notices setup.
//2. NGBW Set Picture39 on [Agreement]MoveInNew to hide when Text39 does.
//3. RWFR Income Charged report settings are now saved - other than dropdown for analysis code
//4. NGBW Added check to MoveInCode to prevent opening of Agreements from Other Credit Sales.
//5. RWFR KSSEventlog checks for presence of Eventlog.txt before attempting to use it
//6. RWFR New permissions for units, add & edit.
//7. RWFR New permissions for unit types, add & edit.

//Changes in 8.2.4 19/05/11
//1. RWFR Updated KSS upgrade method
//2. NGBW Added [UnitType]MonthlySpecialRate, [UnitType]WeeklySpecialRate and [BillPlan]WebDescription.
//3. RWFR Fixed deposits not being added correctly when creating a new move in

//Changes in 8.2.4 18/05/11
//1. NGBW Removed SumCash setting substring for vHdr.

//Changes in 8.2.4 16/05/11
//1. RWFR Fixed SelectUnitA trying to bill out deposit when customer had not been selected
//2. RWFR Fixed display of quantity in cash sales to allow for inventory items where quantities are not whole numbers
//3. RWFR Buybacks for KSS on KSR are always tax exclusive
//4. RWFR Fixed prompt for entering customer mobile phone showing on load
//5. RWFR Added sort order to arrays for CTPriceFrom and do a SORT ARRAY using it
//6. RWFR Fixed Advam method using wrong LinkTest element
//7. RWFR Fixed key stats report not picking up prepaid setting when run as a batch process
//8. RWFR Fixed display of credit card entry on ModReceipt for Ezidebit
//9. RWFR Changed all instances of formatting of ##0.00 to ###,##0.00 on key stats
//10. RWFR Fixed Ezidebit check for active/inactive profiles not being consistent with other payment providers
//11. RWFR Fixed Ezidebit checking for payment profile
//12. RWFR Fixed style sheets for Windows XP
//13. RWFR Fixed display of periodic billing text
//14. RWFR Fixed insurance text getting cut off
//15. RWFR Prior Bill date is updated when undoing last charges

//Changes in 8.2.4 13/05/11
//1. RWFR If StorerCheck is not licensed then it shows a message to contact Storman
//2. RWFR If customer email address is blank you cannot select send notices via email
//3. RWFR If customer mobile phone is blank you cannot select send notices via SMS
//4. RWFR If not billing sales commission report is now correctly removed from the menu
//5. RWFR InitNextPrimaryKeys now sets default tables so the order by works on the correct tables
//6. RWFR Removed changes to customer table from transaction trigger causing balances & other changes to be lost
//7. NGBW Set PETTY to be excluded from queries where MISCL is excluded.
//8. RWFR All places balance is updated (except for deletes) the LatestTrxDate is set if it exceeds the current one
//9. NGBW Added alert message to Use Card on File button on [Transaction]ModReceipts if no profile uploaded.
//10. NGBW Adjusted display on [Eventlog]PrintEvents.
//11. NGBW Fixed alignments on StockValRpt.
//12. RWFR Added new method CalculateBaseRateNoUT which doesn't change the UnitType selection
//13. RWFR Replaced call to CalculateBaseRate in UnitTypeIn with CalculateBaseRateNoUT
//14. RWFR Added learn more web url links to Income Dialog
//15. RWFR Fixed CTPriceFrom not prompting to set WeeklyRate
//16. RWFR Added option in system setup whether or not CT Pricing is on (Financials tab)
//17. RWFR Added two sets of titles to Unit Status report which show depending on portrait or landscape printing
//18. RWFR Tidied up PTD report
//19. RWFR Fixed stamp duty report column being cut off
//20. RWFR Fixed autopay report column being cut off
//21. RWFR Fixed alignment of column heading on arrears report
//22. RWFR Fixed layout problems on Anticipated Moveouts report
//23. NGBW Fixed WSC_AuthnetCreateCustProfile not returning a payment profile id.
//24. RWFR Fixed layout problem on Stock Item Report
//25. RWFR Fixed cutoff column titles on Prepaid Report
//26. RWFR Fixed alignment of columns on projected charges report
//27. RWFR Fixed column alignment on staff conversion report
//28. RWFR Added link to purchase MU to message other Storman users
//29. RWFR Added print preview option to printing letters
//30. RWFR Removed doubling of % symbol on AnalysisIn
//31. RWFR Fixed opening of AdjustRatesDialog & made radio buttons work
//32. NGBW Added else clause to setting of printer arrays in [Facility]System form method.
//33. RWFR Fixed changes to [Facility]NextResvNo not being saved
//34. NLT Fix bug in summary of cash received report
//35. NLT Fix column headers on sum of cash received report

//Changes in 8.2.4 12/05/11
//1. SDD Insurance Summary report now show amounts for inactive customers when printed for prior month date
//2. SDD Prepaid Report uses correct tax rate when using NewTaxRateFrom
//3. SDD Modify System Setup to remove CashBook options
//4. NGBW Removed bPrev and bNext from [Analysis]StockInquiry.
//5. NGBW Moved setting on $SaveValue on PrintInvRec as if it is not executed it caused the UpdateSystem to change the field incorrectly.
//6. RWFR [Contacts]SizeQuote will now contain size quoted for all quotes comma seperated up to 25 characters
//7. RWFR Removed blanks from MarketingTypes.slk demo file as we now have the <None> option in dropdowns
//8. RWFR Added radio button to merchandise plan discount selection
//9. NGBW Set bMod in MoveInCode and ReservationIn method to not attempt to load transaction record if none are selected.
//10. RWFR When using the find button in contacts if it finds one record and modifies it the scroll bars are now hidden
//11. RWFR Stopped delete button in CustomersOut dialog repeating, and fixed selection afterwards
//12. RWFR Fixed selection after clicking add butotn in CustomersOut
//13. NLT Fix various problems on modify customers screen.
//14. NGBW Fixed column display issue on [Agreement]MoveInNew.
//15. NGBW Added [Contacts]MailSuburb to [Contacts]ContactsIn and setting of Customer suburb on Conversion.
//16. NGBW Renamed bPrint on [ChartAccts]ChartAcctsOut to "Print List".
//17. RWFR Altered text on Send to Support request
//18. NLT Fix updating of balances on reservations after it has been converted to an agreement.
//19. RWFR Updated some links to the knowledgebase
//20. NGBW Reworded sort dropdown on [Reservation]ReservationIn.
//21. NGBW Fixed [Agreement]FindDialog not changing colour of old default button when changing. Also fixed not setting correct one.
//22. RWFR Fixed Voucher Redemption adding facility code to referral agreement number
//23. RWFR Fixed triggers not being enabled on PromotionsHistory table
//24. NLT remove alert message when clicking 'Increase Rates' for Analysis and Unit Types list asking user to select the items to increase.
//25. RWFR Moved check for number of records in selection=0 before the modify record in FindCust
//26. NGBW Changed Notes History variable from vLegend to vNoteHistBody to prevent issues with notes adding incorrectly.
//27. NLT Fixed alignment of totals on rent roll report
//28. RWFR Fixed letter being created even when no notices setup for Print Form
//29. RWFR Added Print Form to CreditSaleIn & MoveInRR
//30. RWFR Fixed reservation deposit amount not being set correctly on conversion from sales enquiries
//31. NLT Fixed display issues on insurance summary report 
//32. NLT Allow user to change the rent increase date during auto rental increase process
//33. NGBW Set Quote subform on [Contacts]ContactsIn to allow double click event to edit.
//34. NGBW Added variable to System Setup to perform inital backup if preferences file does not exist.
//35. NGBW Changed [Eventlog]RVHistory and WaivedLFRpt to use [Eventlog]AgreeNo instead of [Eventlog]KeyValue.
//36. RWFR Set database setup to show maintanence for standalone and administration for client/server
//37. NGBW Fixed Unit Activity Report display issues.
//38. RWFR Added additional fields on unit table for Marinas + Height for Storage
//39. RWFR Added Boat Info tab in UnitIn
//40. NLT Fix right-hand column on Reservations Summary from being cut off
//41. NLT Fix right-hand column on Rental Increases Report from being cut off
//42. NLT Fix various display issues on Cash Received Analysis report
//43. NLT Fix various display issues on Sched Deposits Held report.
//44. NGBW Set editing of Tax on Credits to always save as a negative.
//45. RWFR Projected Charges Report now allows for up to 80 recurring analysis codes
//46. RWFR Fixed date display of Projected Charges report for US customers
//47. RWFR StaffPIN's download sets extra parameters for Sentinel on download now
//48. RWFR Fixed read only errors coming up during Print Out Old & Delete
//49. RWFR Hid non-applicable field when viewing list of receipt analysis codes
//50. RWFR Restored 4D Draw map for now
//51. RWFR After deleting a record from TransOut it now refreshes the selection
//52. NLT Fixed reservations where if you change the customer name it asks you if you want to charge a deposit (again).
//53. NLT Fixed reservation bug where it was creating a deposit refund even when the deposit hadn't been paid.
//54. RWFR Fixed inventory item inquiry not doing an order by after query selection causing balances to look wrong

//Changes in 8.2.4 10/05/11
//1. NGBW Set PrintInvRec to query for Unit when printing by customer else the invoice has no unit number.
//2. NLT Automatically bump sales enq number to the next number if two are opened at the same time + remove alert advising this.
//3. NLT If sales contact only has mobile phone number display this number in the sales follow-up list
//4. NLT Change alert message for viewing email attachments when there are no attachments.
//5. NLT Leave reservation open after clicking refund deposit paid button.
//6. RWFR Paid To Date removed from credit sale
//7. RWFR Fixed email buttons in sales enquiries getting disabled
//8. NGBW Added <agreeno> to be retrieved in SyncDecode.
//9. NGBW Set ContactsInCode to clear any quotes on new Sales Enquiry.
//10. RWFR CheckVersion 8200 and above upgrade code set to run on all non-syncing facilities
//11. NGBW Moved creation of Notes in ProcCreditCard to after all the processing methods.
//12. NGBW Set [Letters]DateSent to equal Current date in DailyPrint for SMS messages.
//13. RWFR Customer menu will not have incorrect items removed
//14. RWFR Maintanence menu will not have incorrect items removed
//15. RWFR Changed vRentAmt to vRentAmtInv in invoices
//16. RWFR vTot will not appear when it shouldn't on invoices
//17. RWFR [Facility]GLCodeExt now syncs
//18. NGBW Set [Letters]DateSent to equal Current date in DailyPrint for SMS messages.
//19. NGBW Added LetterDelete method for letter delete buttons on input forms to call.
//20. NGBW Set LetterDelete to not prompt to delete if no letter is highlighted.
//21. NGBW Set [Agreement]MoveInNew to prevent [Agreement]InsureCommence being greater than [Agreement]InsureExpiry.
//22. RWFR Overlock and replace lock are hidden for marinas and appliance versions
//23. RWFR Hid gate licensing for appliance version
//24. RWFR Report column display now uses appropriate name
//25. RWFR Renamed Daily Locklist to Daily Arrears List for appliances
//26. RWFR Set appropriate terminology in Daily Rent Increase report
//27. RWFR Fixed gradiant bleeding into detail section in print log settings
//28. RWFR Lengthened RequestMessage entry area
//29. RWFR Fixed unit type price listing report on menu having wrong name
//30. RWFR Fixed wrong terminology on reservations summary
//31. RWFR Fixed wrong terminology in units section
//32. NGBW Change EmailInCode and LettersInCode to take into account [Agreement]LateFeeAmt.
//33. NGBW Set [Transaction]TransOut to use [Analysis]Description instead of substring of [Transaction]AnalysisCode.
//34. NGBW Added delays when using Print Location> PDF for checking and opening documents.
//35. RWFR Fixed incorrect title of Unit Type Price Listing
//36. RWFR Fixed message in ExportData
//37. RWFR Fixed incorrect terminology on List of PINs
//38. RWFR Fixed incorrect terminology in GateResetOnSite
//39. RWFR Fixed incorrect terminology on Lien Status Report
//40. RWFR Fixed lien status report relates not occuring
//41. RWFR Fixed incorrect terminology on Average Length of Stay Report
//42. RWFR Fixed incorrect terminology on Vacancy Report
//43. RWFR Fixed incorrect terminology on Agreement Out
//44. RWFR Fixed incorrect terminology on Credit Sale Out
//45. RWFR Fixed incorrect terminology on Reservation Out
//46. RWFR Fixed incorrect terminology on Occupancy Ranking
//47. RWFR Moved secondary windows during daily autopay
//48. RWFR Marked cancelled due to different amounts autopay transactions as skipped
//49. RWFR Added missing custom footer option
//50. RWFR Made Batch Print window display correctly at 1024*768
//51. RWFR If deposit is 0 in online reservations it doesn't save now
//52. RWFR Removed blank from attachments array
//53. RWFR Set StartWebServer to update correct menu item
//54. RWFR Fixed ModChargesArray not checking permissions
//55. NGBW Set [Letters]EmailIn to show Email subject and to use it when creating emails.
//56. RWFR Fixed display of insurance rates form
//57. RWFR Reservations now allows you to switch tabs while entering a note
//58. RWFR Fixed alignment of days in UnitTypeIn
//59. RWFR Added link on autobackups page to website if it's disabled
//60. RWFR Removed currency symbol from printed quote
//61. NGBW Added "Password" XLIFF variable.
//62. RWFR Fixed printed order of notes
//63. RWFR View Attachments does not attempt to open if there are no attachments
//64. RWFR Contacts import now includes contact number
//65. RWFR Digital Key shows as inactive when you first switch to Ezidebit
//66. RWFR Added phone buttons to Notices sections
//67. RWFR Reservation Purchase Order Number now shows on invoices
//68. RWFR Added button for sending Custom SMS to select SMS form
//69. RWFR Message when sending a customer to support now says create email rather than send
//70. RWFR Transaction Out forms when choosing This Week only include the current week
//71. RWFR Removed currency symbols from ReconcileNew
//72. RWFR Fixed paid to date going out when day to bill was 1
//73. RWFR Fixed reverse trying to reference characters that didn't exist
//74. RWFR Removed calls to CalculateBaseRates in CalcOccupUnit
//75. RWFR Set custom header & footer sections to hide if not selected
//76. RWFR Added button to delete images from image manager
//77. RWFR Added background and cancel button to image manager & insert field
//78. RWFR Fixed incorrect terminology on Unit Status report
//79. NGBW Set bUnitRate, bSelect and bIncRate to hide when Receipts are selected on [Analysis]AnalysisOut.
//80. RWFR UnderRented now has break text with correct terminology
//81. RWFR Updated credit card upload message
//82. NGBW Fixed a bunch of display issues on [Transaction]ReconcileNew & [Transaction]ReconcileDetails.
//83. NGBW Set [Transaction]ReconcileDialog to use enter key to OK rather than Cancel.
//84. RWFR Fixed Invoice Fee's not adding correctly and having no description
//85. NGBW Added OK & New button to [ChartAccts]ChartAcctsIn.
//86. RWFR Fixed not picking up end of late cycle settings in deleteagreement form
//87. RWFR Fixed MoveInOk & ReservationsOK when adding notes not setting threat level
//88. RWFR Fixed contacts notes not setting a userlogin
//89. RWFR Added tracking of threat level to contacts
//90. RWFR When converting from a contact to a customer the threat levels are carried across
//91. RWFR Added additional form to print contacts with a threat level to Threat Level report
//92. RWFR Fixed overlap on [Contacts]ContactOut
//93. NGBW Adjusted 4 Stock forms to change old [Analysis]QtyOnHand if Analysis Code is changed.
//94. DAM Replaceed Date-pickers with variables and pop-up calendar

//Changes in 8.2.4 06/05/11
//1. RWFR Set turning on new invoice system to use progress indicator
//2. NGBW Added supression of save dialog when cancelling from 4D Write Areas.
//3. NGBW Set editing of Letter/Email history in agreements to open appropriate form.
//4. NGBW Changed [Transaction]InquiryPrintNew to use vars instead of fields.
//5. NGBW Set calls to InquiryPrintNew to set vi counter before rather than On Load.
//6. NGBW Changed unit references on MonthlyCompare and VacancyRpt for Marina and Appliances.
//7. RWFR Variable length units length is set to maximum when vacant
//8. RWFR Calculatebaserate has replaced direct calls to MonthlyRate & WeeklyRate where appropriate
//9. RWFR Added new RCUpdateArray to be called from RentControlUpdate
//10. RWFR Removed check for [Agreement]AutopayType from CC_Add & DD_Add
//11. RWFR Stopped check of [Agreement]AuthCCSigned for reservations in CC_Add & DD_Add
//12. RWFR Set Ezidebit uploads to use current date for AuthCCSigned for reservations
//13. RWFR Moved code to set userlogins, groups & usergroups inside the check if the connection with MV was successful
//14. RWFR Added variation of WS_GetAgreementInfo & WS_GetReservationInfo with no password check
//15. RWFR MiniCo insurance report uses unit history to get unit number for inactive agreements
//16. RWFR Restored MD5 Plugin
//17. RWFR Set date in occupancy report to default to current date
//18. RWFR Fixed all warnings in compiler where possible
//19. RWFR Download mail now checks for a variable to whether or not it should display no messages to be received
//20. RWFR When duplicating a merchandise discount plan it will delete then replace any matching plans at the new site automatically
//21. NGBW Fixed OccupRpt not setting Special character to invisible for [UnitType]RCSpecial=False.
//22. NGBW Enabled DRC to set Increases up to 100 periods (based on MthsAdv) in the future.
//23. RWFR Additional check on number of records in selection when doing a search in case customer found does not match the search type
//24. RWFR Fixed opening receipts from Customer Receipts setting transaction total amount to 0
//25. RWFR Authnet entry form now shows CC Expiry date entry in MM YYYY format
//26. RWFR Send customer to support has been alterted to save customer etc and notify them to click send/receive
//27. RWFR Fixed amount discounts are kept when rent increases are applied
//28. RWFR When editing the tax amount of a facility that is tax exclusive the net amount is properly calculated


//Changes in 8.2.4 02/05/11
//1. NGBW Fixed font on [Facility]LoginChange Button1.
//2. NGBW Adjusted height of text objects on [Quote]QuoteIn.
//3. NGBW Set LettersInCode to only prompt for notice charge if there are 1 or more Agreements in the selection.
//4. NGBW Changed object name of SMS label on [Letters]LettersInBig toso it would hide.
//5. NGBW Removed truncating of [MarketingTypes]Description to 20 chars in Marketing.
//6. NGBW Fixed grammar on SelectUnitContact.
//7. NGBW Updated my.storman search button on [Facility]ControlBig.
//8. RWFR Set DownloadMail to hide no messages to receive dialog if called from LogMonitor process
//9. NGBW Fixed [Activity]MonthlyCompare not displaying data correctly.
//10. RWFR Switched ChecksumRecord back to quitting PHP server

//Changes in 8.2.4 28/04/11
//1. RWFR Added check for table number is valid to UnloadAll
//2. RWFR Fixed CreateTutorial getting stuck in a loop
//3. RWFR Fixed Cheque -> Check changes not occuring since update to XML country preferences
//4. RWFR Fixed date format for call date in contacts import causing errors in non-US tutorials
//5. NGBW Set [Message]MessageOut to not prompt to send waiting emails if last email was deleted or Cancel was clicked.
//6. RWFR Removed customer birthday method
//7. RWFR Changed support renewal link
//8. NGBW Fixed up displays on a bunch of reports.
//9. NGBW Set [Transaction]StockTransferReceive to not multiply vQtyMinus by -1.
//10. NGBW Changed array type of parentvars in SVG_Map.SVG_Test from Text to LongInt as it was causing a runtime error.
//11. RWFR Removed incorrect tool tip from add alert notes to notes history
//12. RWFR Added new CCExpiryDate field to customer table
//13. RWFR Customer trigger now writes CCExpiryDate field
//14. RWFR Set DailyPrepNotices to use Customer DOB & CCExpiryDate fields instead of agreement one
//15. RWFR On upgrade to 824 CCExpiryDate is now set
//16. RWFR Added WS_ChangeUnitStatus web service
//17. NGBW Adjusted position of OK & New button on [UnitTypes]UnitTypeIn.
//18. RWFR Set Periodic Reporting to call LogAction with $1 = False to stop logmonitor resuming during daily.
//19. NGBW Changed FindCust and FindResv to check [UserLogins]AccessList to only search on accessible facilities in a MV.
//20. RWFR Added ability to quote multiple billing plans for agreements
//21. RWFR Added ability to setup variable length unit types
//22. NGBW Modified RecalcUnpaid to use [Agreement]LastBillPlan to calculate rather than [Agreement]BillPlanCode.
//23. NGBW Updated "Notice to Vacate" menu item to read "Notice to Return" for Appliances and "Notice to Depart" for Marina.
//24. NGBW Set OccupRpt and OccupRptUnit to use "Berths" for Marina.
//25. NGBW Updated OccupGetLegend and GraphOccup to use "Arrivals" and "Departures" for Marina.
//26. NGBW Set [Facility]Graph to use Marina related text and names.
//27. NGBW Set Size Category label to Invisible on [UnitType]UnitTypeIn if [UnitType]SizeCategory="".
//28. NGBW Set Delete button for DRC history on [UnitType]UnitTypeIn to grey out if no subrecords in selection.
//29. NGBW Set vFrom and vExpiry to hide if values are blank on [Agreement]AutoPayRentAmt.
//30. NGBW Added check on Backup Time in System Setup to prevent entering invalid times.
//31. NGBW Fixed [UnitType]UnitTypeLength and UnitTypeWidth from defaulting to 100 and 25 on [UnitType]UnitTypeIn.
//32. NGBW Added Cash Tendered check to Cash Sales.
//33. DAM Added two tables: "Owner" and "Boat" 
//34. DAM Added forms for marina: [Boat]AddBoatName, [Boat]AddNewEngine, [Boat]BotaIn, [Boat]BoatList, [Boat]Output, [Owner]AddNewPerson, [Owner]Output.
//35. NGBW Added code to [Facility]SetAddressStyle to set the options to show what is currently selected.
//36. RWFR Added ability to setup per customer type base rates for unit types

//Changes in 8.2.3 15/04/11
//1. NGBW Added Petty Cash Module and Petty Cash Report.
//2. DAM Added methods for Direct Debits DD_Add, DD_Edit, DD_Delete.
//3. DAM Added method WCS_Thinc for uploading, updating, deleting Customer profile for Thinc, also for triggering Thinc transactions
//4. DAM Added 2 forms Thinc_CC to upload CC profile and Thinc_DD to upload DD profile 
//5. RWFR Added UnitHistoryFix method & form
//6. RWFR Updated SyncCreateAll to use form rather than multiple prompts
//7. RWFR Fixed category text not showing on occupancy reports
//8. RWFR Removed prefill of referal agreement number - KSS
//9. NGBW Set note to automatically add when Daily does a Rent Increase.
//10. NGBW Added field to choose whether billing of rent should still be done even with [Agreement]MoveOut filled in.
//11. NGBW Added Header line to ExportCustCSV.
//12. RWFR Fixed web services calling MV not using correct IP address when at MV
//13. RWFR WSC_AddVoucher now uses port set - KSS
//14. RWFR Removed spaces from Other Regular Charges export column headers
//15. RWFR ExportDataOvernight facility + other regular charges now adds both a Carriage Return & a Line Feed
//16. RWFR Adjust WS_AddContact to cope with no Country Code being selected


//Changes in 8.2.3 08/04/11
//1. RWFR Moved order by in MoveInOk to UnitHist output form
//2. RWFR Moved birthday & CCExpiry to Customer Trigger instead of MoveInOk
//3. RWFR Replaced open window sizes when MessageEdit is being used to the correct smaller size
//4. RWFR Credit Card Valid From date is now verified
//5. SDD EventLogOut Form changed DatePrinted & DateEmailed to AgreeNo and BillPlan which are much more useful fields to have displayed
//6. RWFR Set clear successful for CC Upload to clear inactive customers as well
//7. SDD Modified SyncLog to send a CheckSum of the modified Activity Records to HOF for comparison
//8. RWFR Fixed errormail not having appropriate display for receiving mail error messages
//9. RWFR Removed ability to select PDF drivers other than PDFCreator as they no longer function
//10. NGBW Set Credits to be unable to be saved if $0.
//11. RWFR Advam StoredPAN hides Payment ID as it is not used
//12. RWFR Removed incorrect tooltip on copy to all in types & categories
//13. RWFR Fixed merchandise discount plans always deleting when using copy to all
//14. RWFR Updated tax rate settings to label old and new rates seperately
//15. RWFR If permanent internet connection is selected and POP account details filled in Logmonitor will check for new emails every cycle
//16. RWFR Removed incorrect tooltip from One Unit Per Agreement option
//17. NGBW Set DailyPrepNotices to check if customers have "Also send correspondence via SMS" if Notice only has SMS content.
//19. RWFR Added new permission to edit the transaction date on receipts. If they have this permission and not the modify receipt/refund permission they will be able to open the receipt and only change the transaction date
//20. RWFR Fixed bug where new weekly values were not being set on upgrade
//21. RWFR Set ChecksumRecords call to MD5 to get it to quit the PHP server afterwards
//22. RWFR Restored the checksum field to get the entire MD5 Checksum value, not just the first 32 characters
//23. RWFR In SendSMS if phone number is blank it will now display an error and not attempt to send
//24. NGBW Added "Inactive" field to Marketing Types and relevant methods.
//25. NGBW Added filter to MarketingTypesOut.
//26. NGBW Fixed bug when printing Note History "<None>" category. Also changed "<None>" on the filter to "All"
//27. RWFR Fixed alignment of tax name on invoices for Mac
//28. RWFR Set AU maximum bank account length to 10
//29. RWFR Set AU bank account lengths checks on Ezidebit bank account variable
//30. NGBW Created Set to save Unconfirmed Transactions in DailyA so the transaction list is not lost when modifying transactions.
//31. NGBW Removed "...or computer date & time is wrong." from "Daily Processing has not been completed...." message in LogMonitor.
//32. NLT Fixed bug in summary of cash received report where take payment for other site trx were being picked up when report run at HOF end
//33. NGBW Set WaivedLFRpt to reference [Eventlog]AgreeNo instead of [Eventlog]KeyValue to get the Agreement Number.
//34. NLT Fixed bug where agreement trigger was preventing the ability to add transactions.
//35. NGBW Set Address2 to equal [Customer]MailCity in [Customer]EziCCDetails and [Customer]EziDDDetails
//36. NGBW Changed order of vCCExpiryMonth and vCCExpiryYear in [Customer]EziCCDetails.
//37. NGBW Added ability to paste to [Facility]SerialEnter.
//38. NGBW Set RemoveUnit to set $Amt to zero if vAgreePeriod = 0 to prevent creation of NaNs.
//39. NGBW Set MoveInCode to set Variable35 and Variable12 to Disabled if [Agreeement]ActiveAgreemt=False and $FromCreditSale=False.
//40. RWFR Added code to check for duplicates of daily, sync & adminsupport logins and delete if present
//41. RWFR Fixed total insurance value not calculating
//42. RWFR Fixed layout of MiniCo report on Mac being bigger than US Letter
//43. RWFR Stopped new data file setup when changing maximum number of sites editing the facility name and code
//44. RWFR Replaced aPageNo with aPageID in DownloadMail & ReceiveMail
//45. RWFR Fixed marketing type titles not being set in new data files
//46. RWFR Added entry filters to facility name, business name, company name, facility code, short name, facility email address
//47. RWFR Changed prompt to continue when a rent increase notice is not setup to a warning as continuing would never function
//48. NGBW Changed "Ezi" name for Credit Card and Direct Debit merchant to "EziDebit".
//49. NGBW Set EziDebit methods to use [Customer]customerProfileID as the customer id and [Customer]custPaymentProfID as the Credit Card/Direct Debit identifier.
//50. RWFR Added Autopay Increase, this sets the customers autopay amount to match their new rent amount on increase
//51. RWFR When changing from weekly to monthly or vice versa it now prompts to reset to default rates
//52. DAM added a transactions export to a XML file fot HERMES
//53. NGBW Set display of CC number not truncate if over 16 digits.
//54. NGBW Set Invoice Number display on [Transaction]ModCharges to show [Transaction]InvNumber when using [Facility]InvStatement=True.
//55. NGBW Fixed bLastButton on [Message]MessageOut so it would pick up all records when unticked.
//56. NGBW Set vLeg1 on [Facility]Batch to list all email addresses of type R.
//57. RWFR Updated PTDReport phone to display Military phone if set as primary
//58. RWFR Agreement Details printout now uses primary phone
//59. RWFR Daily Summary printout now uses primary phone
//60. RWFR Arrears report now uses primary phone
//61. RWFR CCUpload now uses primary phone
//62. RWFR Select customer screen now uses primary phone
//63. NGBW Added option to UnderRented/Rental Rate Variation Report to run for all occupied units.
//64. RWFR WS_GetPricing completed
//65. RWFR WS_ConvertReservation and WS_AddAgreement now have a locked option to lock out the unit by default
//66. RWFR Vacant units now clear LastInc date

//Changes in 8.2.3 24/03/11
//1. RWFR Added support for changing tax rates in Analysis codes when [Facility]TaxRate=0
//2. RWFR Fixed possible undefined variables in WSC_CheckMVUserPword causing issues
//3. RWFR Fixed ModChargesArray not setting vTax to enterable when tax amount was clicked
//4. RWFR Blocked credit cards being processed when profile was not uploaded for appropriate payment providers
//5. RWFR Added new field and array to track other credit sale numbers
//6. RWFR MoveInCode, MoveInOK, CreditSale In OK button & AgreementAbortCode updated to use next credit sale number
//7. RWFR Added next credit sale number to system setup
//8. RWFR Moved agreement edit check to it's own method
//9. RWFR Marketing Types are now able to be set to mandatory

//Changes in 8.2.2 23/03/11
//1. RWFR Removed test server from Storercheck as it is no longer valid
//2. RWFR Added Singapore Storercheck URL
//3. RWFR Added addition of notes categories to KSSUpgrade
//4. NGBW Set [Agreement]DaytoBill method to divide [Agreement]OtherChgs'TotAmt by [BillPlan]MthstoPay when calculating prorata.
//5. NGBW Set CustomerBalances to not run if "Cancel" is clicked at date prompt.
//6. RWFR Made some adjustments to text layout of occupancy reports and replaced the star icon with an asterisk
//7. RWFR Declared order43 in periodic reports
//8. NLT Fixed problem with Activity records being set to sync status of 11
//9. RWFR Fixed Customer Balances report not generating
//10. RWFR Fixed recalc customer balances on server not executing if there was more than 1 message record that matched as a crash can cause this
//11. RWFR Fixed periodic reports losing message record when executing reports
//12. RWFR Fixed periodic reports setting tables to read only causing multiple reports not to attach
//13. RWFR Fixed periodic reports setting tables to read only causing daily to fail
//14. RWFR Fixed Marketing Types email & organization showing for non-customer type
//15. RWFR Fixed emailing of marketing types email not occuring
//16. RWFR Removed odd alert message in rent increase rules
//17. NGBW Set [Facility]Eventlog to highlight when adding users to Send To list.

//Changes in 8.2.2 18/03/11
//1. RWFR Extended vsCity line on invoice footers
//2. RWFR Set vTot in invoice footer to hide if vLeg6 is blank
//3. RWFR Reservations use UnitNo to find the agreement when converted
//4. RWFR Removed default paper tray from daily display as it was only for Mac OS9
//5. NLT Only show periodic billing details on Billing Plan screen if periodic billing option ticked.
//6. RWFR Cannot set more than one analysis code with the same special option now
//7. RWFR Fixed button titles being too long when altering late cycle notices
//8. NGBW Set CreateExcelReport to escape [ and ] chars when exporting on Mac.
//9. NLT Fix stylesheet for billing plan drop down box on dynamic rent control.
//10. NLT Fixed stylesheets for radio buttons and dropdown box on Mass DRC form
//11. NLT Fix stylesheet for DD Provider drop down box under System Setup /merchant details
//12. RWFR Added new checksum method to calculate record checksum and added to Activity table trigger
//13. RWFR Added checksums to Marketing Types, Contacts & UnitHistory tables
//14. RWFR Added two warning prompts to dropping indexes using CDR
//15. NGBW Fixed Notice Trigger dropdown not updating when using bPrev and bNext on [Notices]NoticesIn.
//16. NGBW Removed currency figure from [Eventlog]EventlogIn.
//17. NLT Change sync method for Activity table so it passes and reads the activity date and facility code instead of the primary key

//Changes in 8.2.2 11/03/11
//1. NGBW Set MoveInOK, and OK Buttons on Reservation and CreditSale to set the [Agreement]CCExpiry and [Agreement]DateOfBirth.
//2. NGBW Set ExportSageInvoices to strip New Line and Carriage Return characters.
//3. NGBW Fixed Merchandise Discount Plan display filter not filtering.
//4. SDD Removed Advam messages about expiry but must soon add a licencing option
//5. NGBW Set [UnitHistory]MonthlyRate to not show $ symbol in [UnitHistory]AgreemtIncl.
//6. NGBW Set BalFwd variable in Transactions to not show currency symbol.
//7. NGBW Made Cheque Returned button invisible for Cash Sales.
//8. NLT Removed access to Modify Journals from the accounting menu
//9. NLT Removed "Financial Reports" from MoreReports menu (GLreports method) - not used and not working
//10. NGBW Added stripping of commas to ExportSageInvoices for [Transaction]Description, [Customer]CustomerName and [Customer]UserName.
//11. NGBW Updated [Notices]NoticesIn to use a dropdown to select "before" or "after" for choosing notice trigger days.
//12. SDD Changed compression of blob in eventlog to '2' faster, rather than '1' more compact - to try and fix damage problem
//13. NLT Fix bug in secure password setup where user prompted to change their expired password and then told they can't
//14. RWFR Added new CheckTables method to check number of records per table
//15. RWFR Changed MiniCo report column titles
//16. RWFR MiniCo insurance report always prints for current month billing only now
//17. NLT Fixed display issues on Paid to Date Agreements report
//18. NLT Fixed totals line on Rental Rate Variation report
//19. NLT Change display of Marketing Types for sales enquiries so it works off the facility list instead of the HOF list
//20. RWFR Declared all button variables in PeriodicReports
//21. RWFR Fixed add button not working in Send To List
//22. RWFR Added SalesPerson to WS_CheckMVUserPword

//Changes in 8.2.2 01/03/11
//1. NLT Added Paid to Date to WS_CustomerLogin
//2. NLT Fixed font and printing of occupancy reports.
//3. NLT Removed phone numbers from Listing of Customer Transactions
//4. NLT Fixed Insurance moveout description
//5. NLT Add WS_GetIns web service to return insurance rates table details
//6. NGBW Changed RoundAmt to call Round instead for StockAdjustment, StockIn, StockTransfer & StockTransferReceive.
//7. NGBW Set creation of Letter or Email to load the selected notice even if no "Default" has been set.

//Changes in 8.2.2 25/02/11
//1. SDD Fix error in SyncGetHTTPBody and also change all usage in Blob to Text to use UTF8 without length instead of number 3
//2. NLT Fix various display bugs in cash sales
//3. SDD Create new method on the MV menu to Request a whole table from a site automatically through syncing SyncRequestFromSite

//NOTE:
//SDD while doing number 1 I note that the Advam methods use Mac Text without Length instead of UTF8.  Could this be causing a problem???

//Changes in 8.2.2 24/02/11
//1. NGBW Set vrCustomerBalance to redraw when Recalc has been run on ReservationIn so it would update in time.
//2. NGBW Added saving of Name, Expiry Date and last 4 digits of Credit Card when uploading secure profiles.
//3. NGBW Adjusted display of CC details in Agreements/Reservations/Other Credit Sales and Daily when using secure Credit Card merchants.
//4. NGBW Updated WS_CreateReservation and WS_AddAgreement to add/update Customer's Password and return Reservation/Agreement No.
//5. NLT Switch card present to use live server 
//6. NLT Fix bug in customer balance field after daily processing

//Changes in 8.2.2 22/02/11 
//1. NLT Remove commas from address fields when exporting customer details to Sage
//2. NLT change Sage file extension back to txt
//3. NLT Fixed some bugs in DailyAutoPay which was causing looping
//4. RWFR Added new permission to disallow saving of non-authorised CC transactions
//5. NGBW Set DailyPrint to prompt to confirm printing Invoices without mentioning LetterDesc.
//6. NLT Fixed bug in standalone where balance not getting updated after taking a credit card payment during daily.
//7. NLT Fix bill plan discount description bug

//Changes in 8.2.1 17/02/11
//1. NLT Fixed bug in daily autopay where one customer was being processed multiple times and the others weren't being processed at all
//2. NLT Move 'Type' column on Autopay report
//3. RWFR When clearing lock status it checks for any overdue=6 on customer table and clears them as well now if they weren't already picked up
//4. RWFR Occupancy report - landscape now matches portrait version for unit information
//5. SDD Changed all TEXT TO BLOB in syncing to use UTF8 text without length

//Changes in 8.2.1 16/02/11
//1. SDD Fixed record locking problem in SyncReceive
//2. SDD SyncGetHHTPBody - Modified Position functions to use asterisk to avoid error
//3. RWFR ORC Transactions are marked to prevent changing manually
//4. RWFR If $File is locked in SendMail will change name and use that instead
//5. RWFR Fixed issue where if autopay bank account details was blank it overwrote normal bank details
//6. RWFR Fixed picture being included in entry order on login form
//7. RWFR Fixed aPageNo on Units checking wrong permission
//8. RWFR Lengthed [Agreement]NoticeBilled field to 255 characters
//9. RWFR $0 in Advam & ProcCreditCard methods lengthened to 255 characters
//10. RWFR Fixed $Date3 not being set during statement generation when using combined invoice/receipt system
//11. RWFR Made changes to KSSUpgrade method
//12. RWFR Fixed MoveInNew form email addresses not accepting commas
//13. RWFR Lengthed [Transaction]CCAuthNo field to 255 characters
//14. RWFR Fixed On Startup not excluding unavailable units from unit check
//15. SDD Changes to SyncPrepare and SyncFromSite to try and prevent sync with no Events in it
//16. SDD Removed code from SyncRecordLog that related to CheckSums and put in a new method called SyncProcessCheckSum which makes more sense
//17. SDD Have fully tested SyncProcessCheckSum and it is working correctly, except for resyncing the agreements back from site to HOF which is not tested, but it is producing the correct CheckSum.txt file

//Changes in 8.2.1 10/02/11
//1. RWFR vOpenBalText & vCloseBalText are set for reservation emailautocc statements
//2. NGBW Moved checking of SU Facility when change RegRent to skip if no facility is set for a unit.
//3. RWFR Added Credit Card details (masked) & Bank Account details to WS_CustomerEdit & WS_CustomerLogin
//4. RWFR AuthNet CIM business/individual restored to non-xliff lowercase values
//5. RWFR Read from swipe card reader button is set to invisible for PCI method

//Changes in 8.2.1 07/02/11
//1. RWFR InsuranceCalc does a relate on the billing plan field now
//2. RWFR Fixed vAmount not being loaded into [Transaction]TotAmt when using TakePayment
//3. RWFR KSSUpgrade - Unit deposits are cleared
//4. RWFR Fixed ordering of transactions after clicking print list in TransOut
//5. NGBW Set CreateTrxMoveOut to only clear GatePIN if NoActiveAgreements < 1 rather than 2.

//Changes in 8.2.1 04/02/11
//1. RWFR Changed [Transaction]Match & [Customer]NextMatch to Long Integers
//2. RWFR Fixed overlapping form elements on occupancy reports
//3. RWFR Added button to show rented units on selectunit for sales enquiries & reservations
//4. RWFR Fixed display of vWords on swipecard
//5. RWFR Fixed loss of transaction records when there are no transactions to invoice
//6. RWFR Restored ability to update letters table when message is edited via saving/opening HTML file
//7. RWFR Fixed not clearing of unit status = 6 if status change was false
//8. RWFR Disabled removal of storercheck item as it causes issues
//9. NGBW Added UpdateReceipt to DailyAutopay to run when not sending Auto CC Notice.
//10. NGBW Fixed ApplyRentRules leaving a unit in selection causing display issues.
//11. RWFR Fixed cashreceived not being updated when changing totamt for take payment for other site
//12. NGBW Set creation of HTML emails to replace default <p> and </p> tags with <br> instead so there aren't huge gaps between lines.

//Changes in 8.2.1 03/02/11
//1. RWFR Added missing done buttons to output forms for CDR
//2. RWFR Fixed Promotions & PromotionsHistory primary keys not being checked on start up - KSS
//3. RWFR vrCustBalance was not getting set properly so balance was displaying as 0
//4. RWFR Printing receipts hides the cancel button
//5. RWFR Reset sync hours to 7-7 for now
//6. SDD Fixed vrCustBalance problem
//7. SDD Fixed Syntax error country code arrays in CreateSalesCustomer but there could be more
//8. RWFR When insurance is set to 0 it now says removal date in the dialogue box
//9. RWFR Before applying invoice numbers it confirms that the array value is not already in use
//10. RWFR Disabled KSSArrays again until such time as call centre will be used
//11. RWFR Fixed problem with changes in FacCountry.XML not being read due to element path being incorrect

//Changes in 8.2.1 28/01/11
//1. NLT Allow entry of swipe card reader info for Authnet and Ezi in mod receipts screen
//2. RWFR Insurance calc uses moveout date when called from RemoveUnit
//3. RWFR Fixed problem where $Attach was getting set to "" in SendMail
//4. RWFR NM defaults to all unit types in quotes
//5. RWFR Set appropriate new rent field to hide in agreements
//6. NLT removed references to various online knowledgebase articles where the error was self-explanatory.
//7. RWFR Fixed issue where customer login & edit sent/wrote full country name instead of code

//Changes in 8.2.1 27/01/11
//1. NLT Fix bug where 'memo' field on receipts export for QB not getting reset to blank on the debtors line
//2. NLT Stop users from entering a 'date from' prior to the 'date to' on a transaction.
//3. NGBW Set calls to WSC_EziEditCustomerBankAccount and CreditCard to always pass "YES".
//4. RWFR atLocked is refreshed when going to Access & Insurance tab to take account of changes to [Customer]Overdue
//5. RWFR Pictures are loaded by PrintSpecForm
//6. RWFR [Contacts]MailCountryCode is now set correctly
//7. RWFR CreateSalesCustomer - if [Contacts]MailCountryCode is not set to a valid value it uses the Facility one
//8. RWFR Added option to quotes to show unit types without vacant units
//9. RWFR Moved internal report and code to remove it from menu to end of menu
//10. NLT Fix various berth / unit display issues on rent increase rules screen. 
//11. NLT Replace error message for EAM017 with the one for EAM022 as referred to the same situation
//12. RWFR Refixed view attachments as code had reverted
//13. RWFR Added resend button to all email forms and moved code to method ResendEmail

//Changes in 8.2.1 26/01/11
//1. RWFR Fixed company status missing
//2. RWFR Fixed references to agreement fields in Reservations form that shouldn't be there
//3. RWFR FindCust searches LastDrawer field when searching by customer name
//4. RWFR Fixed disabling amount tendered not working
//5. RWFR Fixed Mail edit form opening too large
//6. RWFR Fixed vtPeriodicBilling not hiding
//7. RWFR Customer Code change radio buttons now behave as expected
//8. NGBW Added setting of $Ref value in HTTP_ThincSMS for contacts.
//9. NGBW Set DownloadMail to check for Contacts after checking for Customers for Thinc delivery responses.
//10. RWFR Updated tutorial files to use new country code prefixes
//11. RWFR Removed Grow property from Gate Date & Time on control screen
//12. RWFR Redid view attachment so spaces in file names won't cause problems
//14. RWFR Adjusted Banking report break line.
//15. AAP Adjust report stylesheet to decrease font-size by 1 point.
//16. RWFR Unit Activity report restored to 8.1 look as it wasn't displaying correctly
//17. RWFR Launching of Notepad & Calculator changed to use start so process doesn't lock up Storman
//18. RWFR Launching of Notepad & Calculator no longer assume that they are located on the C drive
//19. RWFR Updated opening of photo's and pdf's to use code from view attachments
//20. NGBW Added method Err_EziGetPaymentStatus to filter out "Payment with reference x not found" messages and set [Transaction]Narration to "Failed".
//21. NLT Add ability to separate out invoices / customer update files for Sage exports
//22. RWFR Added new WeeklyRentedValue & WeeklyNewRentAmt fields and updated methods

//Changes in 8.2.0 24/01/11
//1. NGBW Changed UnitStatus to sort by [UnitType]SortOrder rather than [UnitType]MonthlyRate.
//2. RWFR Paid To Dates for Storman licence are always written on change now
//3. SDD Income Charged Report - Added the option to print the detail for all analysis codes within a KeyStatsCategory and added Description to IncomeDetail
//4. SDD Re-added method ImportNonSyncingTables which was missing from 8.2 and called from SyncReceive
//5. RWFR Changed [Facility]Country to a string
//6. RWFR Added LoadFacilityCountry method which reads from an XML
//7. RWFR Replaced all calls to numeric [Facility]Country
//8. RWFR WS_GetWebPaymentChecksum - Country variable is now set to 1 if standard date format, 2 if US, 7 if ISO
//9. RWFR Added TakePayment method to Accounting menu
//10. RWFR WS_AddContact now sets CallTime/Date & Taken By fields
//11. RWFR Checksum emails for KSS sites are sent to KSS as well now
//12. SDD ReCalc method rewritten to speed it up - this build needs to be installed on Billing asap for Nardia
//13. RWFR Set [Facility]Homepage to enterable for sites
//14. RWFR Added help tip to Reverse Multi Period - KSS
//15. RWFR Fixed wrong input form set for Quotes table

//Changes in 8.2.0 17/01/11
//1. NLT Add order by for display of records after clicking Analysis + Unit Types 'increase rates' buttons.
//2. RWFR Fixed problem with currencyformat being seperated by commas, replaced with ;
//3. NLT Fix bug in 8.2 handling of export of tax for QB
//4. RWFR Added ability to hide cancel button on requests
//5. RWFR RemoveUnit requestmessage now hides cancel button
//6. RWFR Fixed changing cash amount caused amount tendered to be filled in
//7. SDD Modified usage of [Facility]TaxRate throughout Storman to call GetTaxRate to ensure it uses the NewTaxRate if specified
//8. RWFR Added <>tLoggingOn:=False to Auto Quit routine

//Changes in 8.2.0 13/01/11
//1. RWFR Added all currency symbols currently in use bar the Indian Rupee which hasn't been added to fonts yet
//2. RWFR Changed the storage format of the currency to be comma seperated as the currency symbols are up to 4 characters
//3. RWFR On upgrade to 8.2.0 the stored currency format is updated
//4. RWFR Changed MVSite for training.xml to be reversed as the field works the opposite to how I thought it did
//5. RWFR Changed client quit to be executed whenever application type = 4D Server rather than when <>tClient = True
//6. RWFR Fixed problem with group buttons not being saved at the site end on login
//7. RWFR Updated kssupgrade to take account of existing unit insurance values
//8. RWFR Set [Facility]PacketSize to 500 on upgrade as most sites internet connections should now be able to handle this
//9. RWFR Added missing output arrays to WS_CustomerLogin
//10. RWFR Fixed spacing on unreconciled report
//11. RWFR Fixed rental credit rounding not working
//12. RWFR Added receipt date to full page receipt, this is always the current date
//13. RWFR Removed unneeded loop from WS_CheckMVUserPword as the groups are now downloaded to the sites
//14. RWFR Fixed unit status not showing on UnitTypeIn
//15. RWFR Fixed overlapping autopay information in Agreement Screen Edit
//16. RWFR Fixed agreement screen edit fields being focusable/tabable etc
//17. NGBW Fixed Cash Sale setting of vPrevQty when the charge is added due to "EDIT ITEM" skipping the On Before Edit event.
//18. NGBW Commented out Transaction'MiscDtls checking [Inventory]QtyOnHand as already been checked on creation of charges.
//19. RWFR Fixed Merchandise Discount Plan output screen having gradient on top of text
//20. RWFR Set syncing to always run

//Changes in 8.2.0 12/01/11
//1. RWFR Added new fields to WS_CustomerLogin to do with Rent
//2. RWFR Added Pictures table to export of all tables
//3. RWFR Changed SyncReceive to always be Status 3 so it will not try and write activity as it imports
//4. RWFR Replaced delete code in SyncReceive with a loop  //SDD Robert, can you discuss with me what this is, and also IniitKeys in last line of this method
//5. SDD ReCalcBal Modified to use the asChgCategory so that it will work with Billing
//6. SDD Fixed checksums to remove text length problem and added fields NextBillDate,LateCycleStartDate,LastNotice and column headers for file
//7. RWFR Fixed delete button not hiding for unit types with units assigned
//8. RWFR Moved userset set selection in PrintReceiptOption to only occur when in cash sales
//9. RWFR Updated KSSUpgrade method
//10. RWFR Fixed rent amount showing as blank on DeleteAgreement form
//11. SDD Fixed delete button not hiding for unit types when using the Prev and Next buttons
//12. SDD Other Cash Sales - When adding a new line the cursor will now be positioned in the Qty field
//13. SDD ProcCreditCard - Advam - sunset code to terminate it on 1/4/11
//14. SDD UnitTypes - Modified Print List to show NoTotal, No Occup, No Vac when Weekly Rate is zero.
//15. SDD Added new methods for changing from subtables called ArraysToText and TextToArrays
//16. SDD Spaced out Structure window so that we can basically see where relationships are
//17. SDD Other Regular Charges - Fixed display of totals on front screen
//18. SDD Fixed bug in standalone where [Customer]Balance does not update on the front screen
//19. RWFR Fixed SyncCreateAllProc referring to old Win4DX instead of Resources folder.
//20. NLT Add Card present capability for AuthNet
//21. NLT Add provider-specific labels to fields for credit card and debit card merchant services
//22. NLT Restrict user from entering blank dates or a date prior to 1/1/1990 when running check activity
//23. NLT Add permission to modify the default check activity dates (under Other)
//24. NLT Add invoice option to minus one day from DateTo on invoice narration (SK Aust)
//25. SDD Fixed TriggerLogActivity which was not using PrimaryKeys & added condition to SyncUpdateRecord to prevent error
//26. RWFR Fixed issue in ExportDataOvernight which was causing query windows to appear
//27. RWFR Fixed broken If statement in DoBillNext

//Changes in 8.2.0 22/12/10
//1. NGBW Set [Eventlog] to Read Only when loading Other Credit Sales.
//2. RWFR Restored Graph of Occupancy to using 4D Chart for now
//3. RWFR Added FaxNo and Custom Fields to WS_CustomerLogin and WS_CustomerEdit
//4. NGBW Added Insurance Cancellation report to DailyA for Planet.
//5. RWFR KSSUpgradev8 - Late1 now has attachments set to False
//6. RWFR Fixed Day To Bill change not pro-rating other regular charges
//7. RWFR Removed additional prompt when pro-rating other regular charges on changing day to bill
//8. RWFR Moved Unit Type transaction creation on to UnitTypeIn form so it is consistant and delete button work as expected
//9. RWFR Query done on unit type table after double clicking one to edit it incase of deletion causing selection to change
//10. RWFR On ChangeSite it now sets the updatesystem to use a new variable ignoring the permissions check
//11. RWFR Added redraw of customer balance to recalc method
//12. RWFR Narration during KSSReversal is set not to show on invoice
//13. RWFR Removal of Other regular charges now shows removal date as current date
//14. RWFR Moved MMYY note on swipe card as it was overlapping on XP
//15. RWFR Fixed sorting of transaction on TransOut changing on print receipt
//16. RWFR Added date to lock list
//17. RWFR Widened action required column on lock list
//18. NGBW Changed MailAddress field on ContactsIn to use [Contacts]MailAddress for stripping Char(13) instead of [Customer]MailAddress.
//19. RWFR Buybacks signature only appears on receipt now
//20. RWFR For periodic billing the correct amount appears on the Bill Next Charges form
//21. RWFR Calculation of rent amount, new rent amount and discount amounts for agreements is now showing the correct total for periodic billing
//22. RWFR Minimum bank account length for Australia is now 4
//23. RWFR Widened room for description of vPath in Agreement type forms
//24. RWFR SyncReceive - Added missing tables for deletion
//25. RWFR Updated KSSUpgradev8 - changes requested by Jeff
//26. RWFR SyncReceive - replaced $Facility with $vtFacilityCode as $Facility was not defined

//Changes in 8.2.0 17/12/10
//1. RWFR Moved vLeg1 on DailySummary into the break
//2. RWFR Late cycle part payment option in system setup is now set to go On Clicked
//3. RWFR Changed query when adding/multiplying units as it was not correctly ignoring unavailable units
//4. RWFR StartupDemoCheck looks for both .data and .4DD now
//5. RWFR InitProcessVars added vAddr5
//6. RWFR Updated to 4D 12.1
//7. RWFR Updated to TinyMCE component for HTML emails
//8. RWFR Fixed continue button in end of late cycle screen in daily processing being cut off
//9. RWFR Added note to SwipeCard form that entry of date needs to be in MMYY format
//10. RWFR CCV2 entry on SwipeCard form is now hidden for non-Ezi customers
//11. RWFR Fixed up call centre screen loading up 4 facility arrays when only 3 are required
//12. RWFR List of unit types & analysis codes now loads on startup again for KSS (needed for testing)
//13. DAM Fixed vLeg8 not loading text correctly in invoices
//14. RWFR Relabelled note saying move out when deleting ORC to Removal
//15. DAM Added NAB transaction import
//16. DAM Renamed Import Charges to Transaction Import
//17. DAM Transaction import method now prompts whether to import NAB Receipts or Custom Charges
//18. RWFR Fixed print receipt option not working for reservations
//19. RWFR Fixed reservation receipt balances not being calculated
//20. RWFR Removed prompt to charge next rent from Print Receipt
//21. RWFR Removed invoice number from new full page receipt
//22. RWFR New full page receipt title is just RECEIPT now
//23. RWFR When generating email merges if a valid agreement can not be found it will not attempt to generate a letter record & email for that customer
//24. RWFR Added entry filter to from phone number for SMS accounts
//25. NGBW Added MonthlyEnq - Sales Enquiry Report feature.
//26. NGBW Added Customer data export to CSV feature.
//27. SDD CalcInvBal Rewrote method to calculate balance correctly. - Also backdated to v8.1.14
//28. RWFR Fixed receipt showing as a copy
//29. RWFR Fixed sort order of transactions after printing a receipt
//30. RWFR Fixed banking report date not showing properly
//31. RWFR Fixed default form for Contacts table being set incorrectly
//32. RWFR Fixed ordering of transactions on receipts
//33. NGBW Modified NoticesIn to work like v8.1 for previews etc.
//34. NGBW Set CreateTrxMoveOut to set [Customer]Overdue to 0 if no more active agreements for that customer.
//35. NGBW Changed InvRecCode to set vLeg9 to [Agreement]UnitsOccup if not using "Show Unit Type on Invoice" and not a Reservation.
//36. RWFR On upgrade to 820 picts are now converted to jpegs
//37. NGBW Added invisible buttons to [Facility]Startup to give more clickable area to change between existing and new datafiles.
//38. NGBW Fixed display of Contacts in CDR.
//39. RWFR Replaced 4D Chart graphs on Graph of Occupancy with SVG Graphs
//40. RWFR Replaced 4D Chart pie chart on Customer Analysis
//41. NLT Added button to Chart of Accounts bank record so user with permission 104 can clear all trx prior to bal date for bank rec purposes.
//42. NGBW Fixed sizing of FTPSession from AutoFTP method.
//43. NGBW Set ConvToAgreemt to use vtUnits for alert message.

//Changes in 8.2.0 03/12/10
//1. RWFR Updated KSSUpgrade method
//2. RWFR Added WS_PE_Get_Balance & WS_PE_Pay_Balance
//3. RWFR Fixed Deleting of receipts & refunds being done before correction of customer balance amount
//4. RWFR Fixed variables on [Agreement]'DeleteAgreement being too small and cutting off text
//5. RWFR Fixed up printing of receipt & invoices for cash sales
//6. RWFR When converting to an agreement the noticedaysprior field is set the same as if creating a new agreement
//7. RWFR Only when using OK & New does the transaction date carry over for stock transactions
//8. RWFR Fixed Total for Analysis showing incorrectly on the banking report
//9. RWFR Fixed full customer name not showing in daily processing when amount to bill is different to balance
//10. RWFR Rewrote statement date calculations to allow for agreements billed several times into the future
//11. RWFR Fixed emailed statements in daily processing not having balances correctly generated
//12. NLT Stop user saving a record if partially filled in bank account details for other credit sales (x 2 tabs - KSS)


//Changes in 8.2.0 29/11/10
//1. SDD Changed field names on facility table  LastLogSent to LastSyncDate and LastLogTime to LastSyncTime
//2. SDD SyncToSite modified to record in synclog if facility record is locked and unable to update LastSyncDate & Time
//3. RWFR BillNextCharges when undoing other regular charges now checks the description to allow for multiple charges of the same analysis code (will still fail if they have the same description)
//4. RWFR Default amount for Add Charges now uses correct new tax setting
//5. RWFR Rent Increases report no longer errors when generating to disk file
//6. RWFR When recalculating paid to date it now uses LastMthsAdv
//7. RWFR Fixed problem with loading StockIn screen
//8. RWFR Fixed Analysis Categories not loading when adding a stock transaction if the default analysis category was inactive (now excludes them)
//9. RWFR Fixed Stock adjustments & transfers not excluding other facilities analysis codes
//10. RWFR PDF invoices & statements are deleted at the start of EmailAutoCC & DailyPrint to ensure old one's are not attached by accident when a new one isn't generated due to no transactions
//11. RWFR Closing balance of statements where a date isn't specified is correct now
//12. RWFR Transaction selection where no date was specified for statements is correct now
//13. RWFR vtInvAgree is set to blank before generating statements now
//14. RWFR SyncCreateAll - replaced check of table number between 0-35 with is table number valid (was previously excluding valid tables)
//15. RWFR Promotions & PromotionsHistory table will now sync properly
//16. RWFR When doing a full export of a site the insurance rates, merchandise discount plans & both promotions tables now export
//17. RWFR Inactive codes will not be used for banking report headers
//18. RWFR Late Fees being added when bill notice only if sent was enabled and notice not chosen to be sent - fixed
//19. RWFR Fixed calls in WS_CustomerEdit to Field name passing a pointer rather than a number.
//20. RWFR Fixed [PhotoCards]Code not being set in WS_CustomerEdit
//21. RWFR Updated KSSUpgradev8 method


//Changes in 8.2.0 18/11/10
//1. NLT Fix formatting in first Daily screen
//2. NLT Fixed add new purchases button on Inventory screen
//3. NLT Fixed Paid to Date not getting cleared on control screen automatically after moveout
//4. NLT Fixed cc expiry during auto cc process not showing agreement number
//5. NLT Fixed Reprint invoice button on Reservations page

//Changes in 8.2.0 22/11/10
//1. RWFR Fixed cash received analysis report not loading correctly on first print
//2. RWFR Fixed batch printing of cash received analysis report not setting vDate
//3. RWFR Updated WS_AddUnit to take account of units that had never been rented
//4. NLT Fixed multiple day processing bug caused after credit cards are processed.
//5. RWFR Opening & Closing balance now show on Statement
//6. RWFR Added BalanceDateCalc method to get the accurate balance of an agreement, reservation or customer on a specific date
//7. NLT Stopped alert message flagging the moveout date < Can't Mod Prior Date when opening an agreement
//8. NLT Remove unit types with no units from quote screen
//9. NLT Fix display issue when selecting a unit on converting a quote to a reservation
//10. NLT Allow user to delete an ORC
//11. NLT Fix bug on Print invoice button for Cash sales
//12. NLT Fixed LCSD display during daily processing



//Changes in 8.2.0 17/11/10
//1. RWFR In KSSUpgrade "" is changed to "Don't Know" rather than "< NONE >"
//2. RWFR In MoveInOK updated KSS marketing types check to check for "" or <None>
//3. RWFR Fixed typo in WS_CustomerEdit Pincards arrays
//4. RWFR Fixed credit text not being picked up for prorata permission
//5. NLT Fixed bug in multiple day daily processing where customers being billed multiple times.
//6. RWFR Fixed error in PrintInvRecCode where old system invoices were incorrectly being reduced by invoice number
//7. RWFR Fixed [Transaction]'TransOut having black lines down the page

//Changes in 8.2.0 12/11/10
//1. RWFR For KSS when closing an agreement it checks if the various marketing types are set to < NONE > and if so alerts the user to fill them in. Reason for move out only triggers if move out date is fileld in.
//2. RWFR Added version of paid to date report with arrears comments
//3. RWFR Added option to paid to date report dialog to show arrears comments
//4. RWFR Added saving of new option of arrears comment to report settings 22 and updated documentation
//5. RWFR Prorata warning about agreement not being billed will not display if the move in date and the next bill date are the same
//6. RWFR Code in [Unit]SelectUnit has been moved from On Load to On Display Detail where it referred to individual records
//7. RWFR Replaced corrupt objects on [Unit]SelectUnit
//8. NLT Do not allow user to save agreement for Australia if bank account num is blank but BSB number is entered.
//9. NLT Increase space available for headings on right hand side of invoices (esp agreement number).
//10. NLT removed AARecurring rent from comments box for all autopay customers (not just bank authority) customers - per KSS
//11. RWFR Added new method RemoveORC for Other Regular Charges removal
//12. RWFR RemoveORC creates a prorata
//13. NLT Fixed spacing on unreconciled report
//14. NLT Fixed display of "Agreement Number" heading on invoices
//15. NLT Fixed bug where autopay balances not getting updated correctly.
//16. NLT Fixed Daily Processing Summary report header / date and title
//17. RWFR Fixed watermark overlaying 4D Draw header
//18. NLT Fixed $0 customer balance displaying in red after adding receipt.
//19. NLT Stop calc of days late on agreement screen where TotRentUnpaid <=0
//20. RWFR Changing from sales enquiry to agreement prompts for billing plan special if set
//21. NLT Rename fee on rent owing tickbox to say notice is also triggered by rent owing

//Changes in 8.2.0 08/11/10
//1. RWFR On Unit Trigger if unit status # Unavail and End Date is not blank then End Date is set to blank
//2. RWFR Moved permissions check on printing unit list to inside check if bPrint=1 for UnitTypeOut
//3. RWFR Datebanked additional mod on the transaction table only executes if it is a other site transaction
//4. NGBW Changed nested loop var from $i to $k in DailyPrepNotices as was causing $i to change and have a syntax error.
//5. NGBW Set [Facility]Eventlog to set to "No authentication" if [Facility]SMTPUsername and Password were blank and [Facility]POPAuthenticationforSMTP is FALSE.
//6. NGBW Fixed Ad-hoc Other Credit Sales alerting when adding receipts/refunds.
//7. NGBW Added check to [Analysis]StockInquiry asSortList to make sure a charge has been selected before querying.
//8. NLT Mod Key Stats so it makes provision for when bad debts is a positive figure - KSS only.
//9. NLT Align Unit Status report subheadings on bottom.
//10. SDD Changed Apply Formula back to the way it used to work.  Table name is appended within the method rather than on the dialog as was way to confusing.  Now displays only one list of fields.
//11. SDD Added new menu item to the Maintenance menu called Database Setup which provides access to 4D Preferences, MSC, and Administration Windows
//12. RWFR [Analysis]ReceiptShow for charge analysis codes now allows you to set whether the codes show for charges, credits or both
//13. RWFR [Analysis]ChargeShow now allows you to choose whether charge analysis codes appear in agreements, reservations, cash sales or a combination of the three
//14. RWFR Added permission to edit deposit amounts
//15. RWFR Added permission to edit unit insurance amounts
//16. RWFR Added permission to edit agreement insurance amounts
//17. RWFR Fixed bug in unit arrays in WS_CustomerLogin
//18. RWFR Fixed old invoice system not including receipts
//19. RWFR Changed all references to old application types to current valid ones
//20. RWFR Saved changes to facility record in EmailInvoice & PrintReceipt
//21. RWFR Fixed error in code referring to WS_aiSendNoticesSMS instead of WS_aiSendNoticeSMS
//22. RWFR Added code to skip subtable fields in adding changes to notes during WS_CustomerEdit
//23. NLT changed font of unreconciled trx report so fits more on one page.
//24. NLT Allow more room for headers on banking report - an extra line for subheading and incr string displayed from 12 to 20.
//25. NLT Split the prepaid between Ins, Other, Rent on the revenue export for KSS

//Changes in 8.2.0 03/11/10
//1. RWFR Added KSSRepeatCustomers.txt export each night
//2. RWFR Added permission to allow for editing of prorata transactions
//3. NGBW Adjusted width of Preferred Unit and set label to read "types(s)" on [Contacts]ContactIn.
//4. RWFR Added unit type listing printout to the reports menu
//5. RWFR Added a special icon & description to the unit type listing printout
//6. NGBW Fixed bDelete button not displaying on [BillPlan]BillPlanIn when changing from a Bill Plan with >0 Agreements in use to one with 0 Agreements in use.
//7. NGBW Fixed bDelete button not displaying on [Analysis]AnalysisIn when changing from an Analysis code in use to one that is not in use.
//8. NGBW Fixed LogAction pointing to incorrect XLIFF variable.
//9. NGBW Added check to [Analysis]AnalysisIn to prevent an Analysis code of being only the Facility code.


//Changes in 8.2.0 01/11/10
//1. SDD 27/10/10 90 Day Cash Actual Report was not totalling correctly - now fixed
//2. NGBW Added check to prevent blank Customer Code to be added to the reference when sending SMS with Thinc.
//3. NGBW Fixed [Transaction]UnreconciledTrx Header markers.
//4. NGBW Adjusted width of Last Bank Rec date variable.
//5. NGBW Changed width and positioning of Date and Time variables on the gate log.
//6. NGBW Added saving to set of current transactions and reloading/sorting after printing Invoice or Receipt for Cash Sales.
//7. NGBW Set Print Receipt button on [Transaction]TransOut to use the "UserSet" as it was just printing the same record each time.
//8. NGBW Fixed Other Regular Charges not showing on Daily Summary Report as was looking for "Monthly Re@" and has been changed to "Recurring Rent".
//9. NGBW Renamed "Print" button on [Transaction]TransOut to "Print List".
//10. NGBW Set RemoveUnit to trigger InsuranceCalc and removed the "On Data Change" check.
//11. NGBW Added display filter to Inventory Item Inquiry.
//12. NLT Added MerchPlan, Promotions, PromotionHistory, Quote, UnitStatusTrx, InsuranceRates tables to overnight export 
//13. NLT changed date criteria for printing a statement from the transaction page (reverted to the way it worked under old system) - KSS
//14. NGBW Set LoadButtons to load the selected Groups record if present and check whether buttons have been set for the group, else will use default.
//15. NGBW Moved "Default cost price" to bottom on [Analysis]AnalysisIn so "Default sell amount" is first.
//16. NLT Lessen white space on banking report and reduce font size for detail section and subheading
//17. NGBW Fixed Customer Receipts listing charges as well as receipts.
//18. NGBW Commented out [Transaction]TrxAmt:=vAmount as causing syntax error from Customer Receipts and could not tell why it was necessary.
//19. NLT Fix bug in CreateRevJrnls method
//20. NGBW Fixed alert message showing "AARecurring Rent".
//21. NLT Fixed Print Receipt button so prints as Tax Invoice / Receipt
//22. RWFR Alerted delinquent system message
//23. RWFR If you click on the delinquent status in an agreement you can choose to unmark it now
//24. RWFR If doing a local search and the ABN & Licence Number are blank it sets $Delinquent to 0
//25. RWFR Restored commented out code for cash sales invoices and applied invoice numbers & dates
//26. NGBW [Transaction]Reconciled will be set to true if DailyA or BankingRpt return a "Successful" for Advam Direct Debits.
//27. RWFR Fixed bug where rent was not adjusted to account for discount when discount was displayed seperately 
//28. RWFR bPrtRec is set to 0 in DailyPrint
//29. RWFR Relate One for [Agreement]CustomerCode is now done inside the agreement loop when printing statements
//30. RWFR EmailAutoCC - If no transactions are selected when generating an invoice/statement it does not try to generate the PDF
//31. RWFR EmailAutoCC - Moved line setting attachment files to after it checks for presence of PDF

//Changes in 8.2.0 25/10/10
//1. RWFR Moved the delinquent field query outside the query selection as it didn't appear to work there.
//2. RWFR Daily now resets variable for PDF Printing after generating statements
//3. RWFR Insurance is now recalculated for KSS on upgrade
//4. RWFR Uninvoiced transactions in daily are given an invoice number when the invoice is generated
//5. NGBW Set CreateTrxMoveOut to create a NotesHistory record and set the alert note if customer is set to Delinquent.
//6. RWFR Daily & EmailAutoCC Statement sections generate statement array
//7. RWFR Fixed several bugs in EmailAutoCC invoice & statement generation
//8. RWFR Fixed several bugs in DailyPrint statement generation
//9. RWFR Changed new billing plans for KSS to be active
//10. RWFR TrainingFile now displays a message when applying settings
//11. RWFR Statements in daily processing now relate a customer record
//12. SDD Stopped reuse of $i in DailyPrint and replaced with $k
//13. RWFR Multiple printed invoices no longer keep reloading the transaction record
//14. RWFR Changed the move address code as the previous work around was no longer required and was causing the initial issue
//15. RWFR TrainingFile now allows you to disable the Gate by using the new element GateOn

//Changes in 8.2.0 20/10/10
//1. SDD KeyStats Rpt All lines like this +Num(asData{1}{49})-vCurrPrepaidLate were reversed and were subtracting the old prepaid and adding the current prepaid - now corrected
//2. SDD Customer Balances Report - Set it back to do the Recalc Balances prior to printing this report.  At this stage there are still too many out of bals to be safe.
//3. RWFR Fixed buybacks line on KSS Keystats calling the wrong localized string variable
//4. NGBW Adjusted query for not downloading future move in units to check for [Unit]MoveIn<=Current date instead of >=Current date in LoadGateUnits and LogMonLoopCode.
//5. RWFR PeriodicReporting print settings dialog only displays if there is a report to print
//6. SDD Daily Processing DailyA Removed all ABORT commands after setting user to Daily, otherwise it does not set the user back correctly
//7. NGBW Fixed Inactive Agreements alerting about bad Move Out dates.
//8. NGBW Fixed border colour on [Agreement]CreditSaleIn Transaction tab.
//9. RWFR Updated KSS upgrade method
//10.SDD Reactivating Agreement - Leaves NextBillDate as it was, and Sets [Unit]MoveIn to what it previously was by checking [UnitHistory]MoveIn
//11. RWFR Created new method InsuranceCalc - called by changes to vOthInsurance and [Unit]InsureValue
//12. SDD Put back Add Charge button on Transaction page of Agreement - This must not be removed as our users will not appreciate the additional steps to simply add a charge!
//13. SDD SummaryDiscounts Report - Added Merchandise Discounts to this report for Kennards specifically
//14. NGBW When vouchers are added, they will also add the Voucher number and the value to the Note.

//Changes in 8.2.0 19/10/10
//1. NGBW Fixed padding and variable width on [Agreement]CreditSaleIn.
//2. NGBW Adjusted PrintInvRecCode for using the old receipt/invoices.
//3. NGBW Set Cash Sales to use old receipt/invoices.
//4. NLT Replace 'moveout' shortcut button with Waiting list shortcut button
//5. NGBW Set Insurance Rate to remove the ORC if setting to zero.
//6. NGBW Set Insurance to create a credit prorata if setting to zero.
//7. SDD Removed KSSArrays command from InitSites as per Robert's instruction - also removed from trigger on Analysis and UnitType - not used in this version
//8. SDD Changed fieldnames on UnitType table to UnitTypeLength and UnitTypeWidth from simply Length and Width as it was causing a conflict with the 4D Length command
//9. NGBW If using new Invoice System when generating Receipts, Current Date will be used for the date.
//10. RWFR Added label for Customer Type to Agreement Info tab for Kennards
//11. RWFR Added permission for saving report & batch print defaults
//12. RWFR You cannot add a billing plan voucher without having a unit added with agreements
//13. NGBW Set PIN event for Staff PINs to only run on On Data Change.
//14. NGBW Fixed PINs alerting incorrectly of duplicates.
//15. SDD KeyStats - Added back Various Lines that were lost in relation to the adjustment for prepaid made for Kennards
//16. NGBW Added 3rd parameter to LoadAnlsArrays to check whether to only display Inventory Items.
//17. NGBW Set hlList on [Transaction]StockIn to use LoadAnlsArrays.
//18. NGBW Set hlList on [Transaction]Transfer, [Transaction]TransferReceive and [Transaction]StockAdjustment to use LoadAnlsArrays.
//19. NLT Stop Cash sale checking for quantity on hand when opening an existing cash sale
//20. NLT Lengthen Incentive on Invoice description field to 30 chars
//21. NLT Remove incorrect help tips from Notices in field
//22. NLT Add column separators and notice details back in to Daily Processing summary report - got lost when changing to new format
//23. SDD Changed AAMonthly Rent to Recurring Rent in that it may not be Monthly
//24. RWFR Added Email Statement button - calls EmailStatement
//25. RWFR Added non-cash sale print statement buttons method - PrintStatement
//26. RWFR [Letters]SentwithStatement is now set in Daily from [Notices]AttachStatement
//27. NGBW Modified CreateTrxMoveOut to cancel the Move Out if the date is incorrect as it was not recalculating when the date was changed.
//28. NGBW Changed Occupancy to check whether should apply Old Tax Rate or New Tax Rate depending on date.

//Changes in 8.2.0 14/10/10
//1. RWFR Fixed layout of transaction screen buttons
//2. RWFR Lock out before move in now functions for all gate systems
//3. RWFR Fixed read write issue with reading in auto log off events
//4. RWFR Fixed blue border on reservations transaction screen
//5. NGBW Fixed typo on bAdd on [Unit]UnitOut.
//6. RWFR Fixed KSSUpgrade method
//7. RWFR New option to log alert note changes to the noteshistory
//8. RWFR If reasons for declining sales enquiry are setup you must select one before choosing to decline it
//9. NLT Make GL Code Extension unavailable if it is not a Central datafile.
//10. NGBW Set SendSMSField to display Notice selection form if there is at least 1 SMS Notice.
//11. NGBW Fixed Total on Cash Sale not updating when line item total is changed.

//Changes in 8.2.0 07/10/10
//1. RWFR Vacancy report nows shows billing plan if applicable
//2. RWFR Vacancy report nows shows billing plan adjusted monthly rate if applicable
//3. RWFR Fixed special column on vacancy report to show icon if applicable
//4. RWFR Added notes explaining various items on the periodic reporting module
//5. RWFR Fixed typo on the periodic reporting module
//6. RWFR Fixed banking report title showing incorrectly
//7. RWFR Fixed arrows vanishing when clicking on them in stock check module
//8. RWFR Periodic billing plan setup now states total number of periods
//9. RWFR BillPlanIn - replaced X with number of periods including free ones
//10. NGBW Added saving of Customer record in Transaction trigger as the RELATE ONE was causing changes to be dropped in StandAlone.
//11. RWFR ProcCreditCard now uses old Advam method for Card Present transactions
//12. RWFR ConvSaletoAgreement now obeys First of Month Setting
//13. RWFR ConvBookingtoAgreement now obeys First of Month Setting
//14. RWFR When selecting a unit to move in to from the control screen using Bill on First of Month the Next Bill Date is now set correctly
//15. RWFR Fixed DailyA mac window type not being set correctly
//16. RWFR System Setup on Mac now opens in a form type that allows print dialogs
//17. RWFR Fixed AutoEmailCC not being automatically enabled for KSS
//18. RWFR Altered eventlog exceptions report to include [Eventlog]AgreeNo field and to show full logdetails
//19. RWFR Print eventlog dialog radio buttons work as expected now
//20. NGBW Added method DefineTypesArray for Types & Categories to be set.
//21. RWFR Canada defaults to Letter paper size
//22. NGBW Prevented users from adding new payment profile if one already exists for another payment type.
//23. NGBW Added new button to [Transaction]ModReceipts for EziDebit RealTime processing.
//24. NGBW Set the credit card/bank account to not try update if there is nothing set in [Customer]EziCCDetails & [Customer]EziDDDetails.
//25. RWFR Fixed insurance prorate not calculating when using multiples of the premium
//26. RWFR Fixed not all other regular charges displaying after adding insurance
//27. RWFR Removed word rental from insurance prorates
//28. RWFR Fixed prompt for billplan special not displaying when converting from reservation to agreement
//29. RWFR Fixed order by in ConvToAgreement running on reservation table rather than billplan table
//30. RWFR Reservations now pass the unitno to MoveInOut rather than customercode as MoveInOut doesn't handle multiple agreements for the same customer
//31. RWFR Added copy to all button for insurance rates
//32. NGBW Updated phone number on [Facility]AboutStorman.
//33. NGBW Set alerts not to show if sending events via internet in SyncCreateAllProc.
//34. RWFR None code for KSS now has all groups selected by default
//35. NGBW Set DailyA to display [Agreement]DeleteAgreemt form to display agreements with invalid Notice Plans.

//Changes in 8.2.0 28/09/10
//1. NGBW Added Reason for Decline and Size Categories to KSSUpgradev8.

//Changes in 8.2.0 27/09/10
//1. RWFR Fixed facility record not being loaded after end of 8200 upgrade

//Changes in 8.2.0 24/09/10
//1. NLT Fix double-negative bug on discounts line (affects everyone except KSS)
//2. NGBW Set [Facility]Change Customer Code filter to allow numbers.
//3. NLT Fix Income Occupancy Rec report so it shows the same agreements as the prepaid report
//4. RWFR Updated WS_AddAgreement
//5. NGBW Added check to CreateTrxMoveOut and RemoveUnit to prevent SU Facility related code being run for other datafiles.
//6. NGBW Moved visibility setting for SUFacilityIDText to the On Load of [Unit]AgreementInclNew.
//7. RWFR Changed print invoice for cash sales to support new invoice/statement system
//8. RWFR Added true print receipt button for cash sales
//9. RWFR Added print statement button for cash sales
//10. NGBW Fixed border not showing correctly on Inactive Agreements.
//11. RWFR Take Payment now defaults to the agreement/reservation balance owing, or in the case of searching by invoice number the invoice total
//12. RWFR Added "New Customers" to promotions array customer type
//13. NGBW Fixed alignment of Bank Rec Date field on [Facility]System.
//14. RWFR Added tool tips for Unit Start & End dates
//15. NGBW Added narration to prorata of Other Regular Charges.
//16. NGBW Fixed the prorate of Other Regular Charges not showing full description.
//17. NGBW Added narration to move out calculation of Other Regular Charges.
//18. NGBW Set [Transaction]ModChargesArray to check for [Analysis]KeyStatsCategory="Merchandise" for Cash Sales.
//19. NGBW Fixed Merchandise Discounts not work for Cash Sales.
//20. NGBW Set bReceipt:=True on Cash Sales to save correctly.
//21. NGBW Added addChargeArray button to Reservations.
//22. NGBW Added handling for Reservation specific info on ModChargesArray.
//23. RWFR KSSArrays unloads the facility record now
//24. RWFR Added new KSS Upgrade method
//25. RWFR Fixed ActionMail not querying new [Eventlog]AgreeNo field
//26. RWFR Description for Other Regular Charges refunds now uses Credit like other transactions
//27. RWFR Added description for insurance sub-table on agreement form
//28. RWFR Changed delinquent system search criteria to try and pick up variances in name by making the basis of the search the licence number or abn no
//29. RWFR The text delinquent shows above the threat level for delinquent customers
//30. RWFR Fixed reverse multi-period not billing out other regular charges at the correct rate
//31. RWFR Fixed vOthTotal and vOthNewTotal not recalculating during reverse multi-period
//32. RWFR Declared all variables in clonemoduledefault using pointers
//33. RWFR Added missing fields to clonemodule
//34. RWFR Billingplan copy to all is now set On Load rather than On Header
//35. RWFR Added copy to all to promotions
//36. RWFR Vouchers now only check their own facility
//37. RWFR On startup if old PDF driver is not found and PDFCreator is present it switches to that

//Changes in 8.2.0 15/09/10
//1. NGBW Fixed typo in Batch causing VacancyRpt to fail.
//2. RWFR Fixed Batch printed Vacancy Report not generating due to 0 records selected
//3. NGBW Set number formatting on [ChartAccts]TrialBalance to be #,###,###,###.## due to previous setting causing values to be cut off.
//4. NGBW Set Gate buttons on Control to show if GateSystType=5 (Access Ezy).
//5. NGBW Added checking of [Notices]MinimumCharge and [Notices]MinimumPCent to DailyPrepNotices to determine if the [Agreement]LateFeeAmt should be used.
//6. NLT Fix bug where trx for another agreement were loaded after moving an agreement out
//7. NLT Fix pro-rata so it uses the appropriate GST rate when creating a credit on moveout.
//8. RWFR Copied Sentinel secondary users from v7
//9. RWFR Disabled auto-spellcheck on notes fields
//10. NGBW Added WS_OriginalReceipt parameter to WS_AddReceiptTrx
//11. RWFR Added unit type category to occupancy reports
//12. RWFR Added unit type category to vacant unit report
//13. RWFR Added bank reconciliation button
//14. RWFR Added buybacks button for KSS
//15. RWFR Added special icon to occupancy report
//16. RWFR Added special icon to vacant units report

//Changes in 8.2.0 08/09/10
//1. RWFR Fixed overlaps of userlogins in sales enquiry reports
//2. RWFR Fixed start date used for sales enquiry reports
//3. RWFR Fixed title not showing correctly on sales enquiry reports
//4. RWFR Titles on sales enquiry reports for the US show as sales inquiry
//5. RWFR Inventory purchases no longer allow negatives
//6. RWFR Replaced references to Stock on purchase/adjustment etc screens with Inventory
//7. RWFR Adjusted titles and window sizes for each appropriate inventory transaction type
//8. RWFR Adjusted position of date entry on key stats dialog
//9. RWFR Fixed balance not showing correctly in other credit sales
//10. RWFR Disabled extra tab for KSS till further notice
//11. RWFR Moved include other transactions line slightly
//12. RWFR Added tooltip to voucher field
//13. RWFR Added missing hide units from lock list option back to system setup
//14. RWFR Fixed reset late cycle when account is paid in system setup being cut off
//15. RWFR Firstname variable now defaults to "Firstname:"
//16. RWFR Other Regular Charges do not prompt for prorata on new moveins
//17. RWFR CalcNxtBillDate now alerts if the date passed to it is 00/00/00 and uses current date instead
//18. RWFR Fixed losing subtable records on moveout causing other regular charges not to refund
//19. NGBW Added EziDebit CC to process real time credit card transactions through Cash Sales.
//20. NGBW Added checking of unconfirmed EziDebit CC Transactions in Daily Processing.
//21. NGBW Set EventLogAgreement and EventLogReservation to check for [Unit] records being in selection before querying.
//22. RWFR Fixed insurance prorata getting wrong title
//23. RWFR Added alert message if alert note is enabled with a blank note
//24. RWFR Added spellcheck for contacts notes
//25. RWFR Added new verify option to insurance rates
//26. RWFR Prevented adding an insurance coverage outside of the insurance rates range when using insurance rates
//27. RWFR Only one prorata dialog now shows when changing the day to bill
//28. RWFR Added new method TransactionImport
//29. RWFR Rent Increase Wizard selecting only those on AP will limit it to those on Bank Authority
//30. NLT Allow user to select which letter template to use during auto rental increase process
//31. NLT Add ability to do global rack rate increase of merchandise items
//32. NLT Add ability to do global rack rate increase of unit rates.
//33. NLT Fix bugs on inventory purchases screen.
//34. NLT Make various changes to auto rental increase wizard.
//35. NLT Allow date range to be selected for Cash Received Analysis report
//36. NLT Fix prepaid bug for KSS Key Stats caused by the addition of a discounts keystats category.
//37. NLT Add option to print Inventory Valuation report exclusive of GST.
//38. NLT Add tax agency name into export to QB (needed for NZ later versions)
//39. SDD Take Payment at Other Site - Added new parameter to WS calls to retrieve the Customer Note and displayed on form
//40. SDD Email Merge - Added the ability to have an attachment on the email merge
//41. NGBW Changed events on [Activity]TotInOut to use PrintingDetail as was not printing correctly.
//42. NLT Fix bug in tax rate used when show incentive on invoice is ticked.

//Changes in 8.2.0 25/08/10
//1. RWFR Changed PDF code to use the new PDFCreator driver
//2. RWFR Removed use of AP Shellexecute and replaced with Launch External Process
//3. SMG Modified 'ExportTakePaymentRecords' and 'SendTakePaymentTrxToSites' methods which were using an incorrect query to find records to export / delete / send
//4. SMG Modified 'ImportTakePaymentRecords' so that no EventLog records are created as a result of the Import.
//5. SMG Modified 'ExportTakePaymentRecords' method so that the file created to hold exported records, has a filename length less than 30 characters - affected Mac
//6. SMG Modified 'ExportTakePaymentRecords' method so that it takes into account the second parameter (if passed)
//7. NGBW Set the shutdown of running 4D PHP instances after generating MD5 checksums.
//8. NGBW Added VALIDATE TRANSACTION to bDelete on [Units]UnitsIn.
//9. NGBW Added relation from [GateLog]CustCode to [Customer]CustomerCode to fix issue of wrong Gatelog info changing when changing the CustCode.
//10. SMG Enabled Auto Spell-checking for the 'Alert-Note' and 'General Notes' fields
//11. SMG Added check to SelectUnitA so that if the [Facility]BillOnFirst is true then the [Agreement]DayToBill is set correctly to '1'
//12. Created CheckInvQty method to check and correct Inventory Quantity on Hand values - to be run only from CDR
//13. NLT Add NotesHistory table and alert note field on customer table to overnight export
//14. RWFR If preferences folder is not present on startup it is now created
//15. NGBW Removed formatting from [Facility]TransWebURL field in [Facility]System.
//16. NGBW Added check to DailyA to make sure Daily cannot be run if before the CantModPrior date
//17. RWFR Added Advam StoredPAN system support
//18. NGBW Set Access Ezy with SerialPortNo >5 to clear PIN if greater than 65535.
//19. NGBW Set Unit Status Report to show an asterisk if a Rented unit has [Unit]ReservedTo#"".
//20. NGBW Set Unit Status Report to show all units with [Unit]ReservedTo#"" including units with [Unit]Status#"Reserved".
//21. NGBW Set [Agreement]NoticeBilled to show Successful/Pending/Failed - gError for EziDebit so will show on Daily AutoPay printout.
//22. NGBW Set "No authentication is required" option in [Facility]EventLog to clear and hide SMTP login details.
//23. SMG Added '[Facility]OResCompMarketType' and '[MarketingTypes]DispOnlineReserve' fields.   Added Marketing Types dropdown menus to Online Reservations.   Added Mandatory Marketing field to system setup, added Show Marketing Type in Online reservations to Marketing type Input form
//24. SMG Forced 'InitNextPrimaryKeys' method to be executed after any datafile import using 'SyncReceive'
//25. SDD Fixed runtime error in CheckActivityData line 194
//26. SDD Extended length of [Analysis]KeyStatsCategory from 11 to 20 to fit new descriptions
//27. SDD Removed option to display server window, as we should not have messages on server due to it running as a service
//28. NGBW Added code to BillNextCharges to change the [Agreement]LastBillDate when choosing to "Show Reversal Transaction".
//29. NGBW Fixed fields being editable under [Facility]FacilityIn
//30. RWFR Rent Increase Rules notice tab control now has original code rather than System Setup code
//31. RWFR Fixed Rent Increase Rules tab change code never executing
//32. RWFR Fixed Find Units not executing correctly due to form event=on clicked being disabled on UnitOut
//33. NGBW Added setting of [Customer]NoActiveAgreemts and [Customer]AgreemtsOperating in DoBillNext and added declaration of bAdd to DailyProcess before it is called.
//34. NGBW Set [Notices]AttachInvoice:=True in LoadLetter for Reminder notice.
//35. RWFR Fixed days late variable being set to date rather than numeric
//36. RWFR Fixed UnitType record not being loaded when quoting from check available units
//37. RWFR Special icon now shows on quotes in Sales Enquries
//38. RWFR Added additional fields to promotions out screen for KSS
//39. NGBW Set DailyA to exclude future dated charges when checking to reset Late Cycle Start Date and UpdateReceipt has been adjusted to check the [Facility]ResetLateCyclePaid.
//40. NLT Add full customer table export to overnight data export
//41. RWFR MoveOutCalc now includes the changes from 8.1.x in regards to the billing plan and mths advance
//42. RWFR Added option to only show inactive customers on the arrears report
//43. SMG Added code to the 'GeneratePrimaryValues' method to disable the Gate System at the start, and restart it after Primary Keys have been assigned.
//44. NGBW Set NewRentAmt is greater than UnitRate alert in UpdateNewRent to not for for <>sFacility="KE@".
//45. NGBW Replaced code in UpdateNewRent with code from v8 as were very different under instructions from RWFR.
//46. NGBW Commented out the ORDER BY from AgreemtAbortCode so Agreement list is not changed when clicking Cancel.
//47. NGBW Added invisible button to [Reservation]ReservationIn to prevent using Ctrl+. to quit when Cancel button is disabled.
//48. NGBW Moved code from v8 to [Notices]NoticesIn Next & Previous buttons so the Preview is updated correctly.
//49. RWFR Delinquent prompt now only shows if the customer is on the 2nd to last or last notice of the late cycle and the agreement balance is greater than the minimum balance for arrears
//50. RWFR KSSReversal will not execute for single month reversals
//51. RWFR KSSReversal will not execute if the last bill date is greater than the can't modify prior to date
//52. RWFR Fixed InvoiceNew and InvoiceFooterNew display
//53. NGBW Removed prompt from TakeAsRent to choose whether to create a charge to clear the deposit on a reservation. Added checks to prevent the reservation from being cancelled without having the deposit cleared.
//54. SMG SU Tab changes - Made previous Support Plan display-only, made 'Save Changes' button disabled unless Facility list item selected
//55. RWFR Only keystats category Merchandise & Other are shown in Cash Sales now
//56. NGBW Set Entry Filter and added setting of entry filters depending on option to [Facility]Change and checks added to OK.
//57. NGBW Commented out the querying for the Reservation in [Reservation]ReservationIn for the Print Receipt button as it was dropping unsaved Reservations.
//58. NLT Added ability to export revenue to QB versions 08/09 and higher
//59. SMG Added code to Online Reservation methods to handle the Currency symbols.   Uses first character of [Facility]CurrencyFormat field.
//60. NLT Fixed Order by problem in bank revenue export
//61. SMG Online Reservations - Modified URL to index.shtml file, for some reason it is different to V7 and V8.
//62. RWFR Fixed display of Bill Next Charges dialog when using Periodic Billing
//63. RWFR When using Show Incentive on Invoice with Periodic Billing the calculation is now correct
//64. RWFR Fixed Include other transactions incorrectly showing s when there was only 1 agreement or reservation
//65. SMG Added code to deal with when there are no Unit Types avail. for Reserving.    Added button and code to send email to Facility to contact customer.   Modified reservation summary page.
//66. RWFR Added SelectAll/None button to [Facility]SelectSites
//67. NGBW Fixed help tip for [Facility]ThreatAlertLevel in [Facility]System.
//68. SMG Set 'Online Res URL Host Name' field to visible and added help tip.   Added code so that if multiple site datafile, and this setting is changed at HOF, then option to apply setting to all sites is displayed.    
//69. RWFR Changed text on Inventory Item Inquiry to match current menu item name
//70. SMG Changed OR_OnlineReservation_Cancel to display Currency Symbol
//71. RWFR Purchases are now labelled as such in Inventory Item Purchases etc.
//72. RWFR On upgrade to 8.1.8 all purchases now have the text PURCHASE put in their OriginalReceipt field
//73. SMG Changed SUFacility ID (SU to Billing) to replace the Unit Deposit field when an "ST@" facility.  Removed SUFacilityID field from UnitIn form 
//74. NGBW Set TriggerLogActivity to pass [Activity]ActivityDate as TrxDate.
//75. NGBW Added checking of Unconfirmed Direct Debits for Advam and EziDebit in DailyA and BankingRpt.
//76. NGBW Fixed window sizes in RentIncrease.
//77. NGBW Changed text on alert in RentIncrease.
//78. NGBW Added Save record of Agreement and Reservation is appropriate places in EmailAutoCC as the records were dropping details if not already saved and Invoice generated.
//79. SMG Remove encryption of password value passed when syncing from SU to Billing
//80. SMG Added code to unlink a Unit / FacilityID on Removing Unit or Agreement Moveout
//81. SMG Changed method used to indicate an Agreement / SU Facility Info has changed - Previously the Unit number changed was added to the SUFacilitiesUpdated filed using a 'xx,' format, now is ',xx,' format to eliminate leading zero issues
//82. NGBW Added checking to InvRecCode to ensure the Agreements aren't requeried if running by Customer Code due to losing other selected Agreements.
//83. NLT NotesHistory export to only be for the last 30 days.
//84. RWFR ??? - fill stuff in here from document
//85. RWFR Stopped CalcNxtBillDate being passed a 00/00/00 date on new moveins thereby causing an endless loop
//86. RWFR Billing plans only available on move in now take account of periodic billing plan options
//87. RWFR Added borders to each dashboard button in groups setup
//88. RWFR Saving an existing marketing types record no longer alerts that the description is already entered
//89. NGBW Extended SMS limit for Thinc to 450 characters.
//90. RWFR FacilityIn screen will use <>sHOFacility marketing types for asList1 & 2
//91. RWFR [Facility]Category now searches asList2 on load rather than asList1
//92. RWFR Adjusted elements on system setup tab with bank rec can't mod prior
//93. NGBW Changed ReadCountryCodeXML to use the parent element for the find rather than a child.
//94. RWFR Fixed blue border showing on transaction tab
//95. RWFR Fixed converting from sales enquiry/reservation not setting Paid To Date & LastBillDate
//96. RWFR Deposit Amounts are now cleared on move out
//97. RWFR Adjusted layout of UnitTypeIn tab 2 to ensure no overlaps
//98. RWFR Added new variable to set if new agreement and delinquent system checks this
//99. RWFR Fixed display overlaps on PTD Agreement report
//100. RWFR Fixed display issues on Summary of Charges report

//Changes in 8.2.0 07/07/10
//1. RWFR Added successful voucher alert
//2. RWFR Set TAPI Device display on Passwords, Security & Telephony Tab of System Setup
//3. RWFR Fixed Baht symbol not displaying on Sales Enquiry to Reservation deposit prompt
//4. NGBW Fixed second bEnter button on [Transaction]ModReceiptOthrSite as was failing to save transaction records.
//5. NGBW Fixed KeyStatsCons showing incorrect values in various places.
//6. NGBW Set [Facility]ConsDialog to not decrease the [Facility]WeekEndDay value as then it was running for off dates.
//7. NGBW Fixed Sales Enquiry not formatting the mobile phone number

//Changes in 8.2.0 06/07/10
//1. NGBW Set Direct Debits in DailyAutoPay to write the BSB out with a hyphen as it should have been
//2. RWFR Added Size Category to WS_GetUnitTypes
//3. RWFR Added new method RandomPhotosCardPIN
//4. RWFR Added new method RandomWebPIN
//5. RWFR Added new parameter to CheckGatePIN ($2) that sets whether it is being called from a web service
//6. RWFR Updated WS_CustomerEdit to allow for generation of new PIN's and it now sends back the PhotosCard arrays in response
//7. NGBW Added removal of agreements from the set in DailyAutoPay if choosing to not process the credit card.
//8. RWFR Fixed converting from sales enquiry/reservation to agreement resetting the number of agreements operating
//9. RWFR Added WS_ConvertReservation to convert reservations to agreements
//10. RWFR Added Agreement Screen Edit menu item
//11. RWFR Added Promotions menu item for KSS
//12. RWFR Added Promotions Report menu item for KSS

//Changes in 8.2.0 30/06/10
//1. NGBW Added [Customer]CCName to [Agreement]AutoPayRentAmts and fixed display issues with the form too.
//2. NLT Fix bug in Sage export where credits on the customer / invoice export option not being exported properly.
//3. NGBW Commented out setting of the [Agreement]NewRentFrom in DoBillNext as it looked like it wasn't used elsewhere, and it was causing Rent Increase notices to be sent.
//4. NGBW Added declaration of vAutoNotice in UpdateReceipt as it was causing 4DSOAP/Storpay Payments to stop executing the method.
//5. SDD Improvements to EventLogIn to display Agreement No and Customer Name now that syncing is based on UUID
//6. SDD Added 'Add Charge' button to OtherCreditSales
//7. NGBW Added boolean field [Facility]ShowAdhoc to allow sites to choose whether Adhoc Credit Sales can be shown on the Dashboard. Added option to System Setup.
//8. NGBW Added CANCEL after failed CC transaction in SwipeCard to prevent issue where retrying will apply it to a current transaction.
//9. SDD Modified InitArrays to include new KeyStatsCategories for Billing
//10. SDD Modified CheckActivityData as it was incorrectly calculating the Discount category for Kennards - also removed those categories from the Cash calculation
//11. SDD Renamed the field BadDebtRec to DiscountChg to allow for the Discount category for Kennards
//12. SDD Modified KeyStatsCons as someone had commented out a line which caused it to sum all the values instead of show them just as at the date of the report
//13. SDD Also fixed currency symbols on KeyStatsCons in case each facility is from a different country
//14. SDD Modified On Exit & On ServerShutdown to use common code ShutdownCode - also added ShutdownProperly field to know on re-launch whether Storman had crashed or not
//15. SDD Modified InitSites so that it will not check the interprocess variable values for EventSeqNo, TrxSeqNo, etc if Storman was shutdown correctly
//16. SDD MoveInNew, CreditSaleIn and ReservationIn when adding a new one it will not allow a duplicate AgreeNo or ReservationNo to be used
//17. SDD Various cosmetic problems on forms as advised by Steve Barker in Bug reports 3302 - 3323 mainly for Thailand customer
//18. NGBW Added [Transaction]PrimaryKey to be used in the WS_AddReceiptTrx web service and received in WSC_AddReceiptTrx.
//19. NGBW Adjusted text on ContactsIn to read for <>vtUnits type rather than just <>vtUnits.
//20. SMG Sometimes when MV is importing a datafile export file there is a bug where the Facility Code of the exported datafile does not match what Storman expects - it previously displayed an alert requiring confirmation, this has not been changed to write an entry to the SyncLog file instead.
//21. NGBW Added delay to Waiting List display in MoveInOK as well as WaitingListDelay field added to [Facility[System.
//22. SMG When generating Primary Keys, syncing is turned off.    Syncing is turned on again either manually, or when the datafile has been exported to MV
//23. NGBW Added check to [Activity]CheckDialog to prevent users entering 00/00/00 for either of the dates.
//24. SDD Updated all report forms to call SetFooter in the On Printing Footer event and added new variable for super secret codes - not yet in use, but at least this doesn't print on the reports now
//25. SDD Added code to the included form to allow double click to modify a transaction on an agreement
//26. NGBW Added field [Facility]ResetLateCyclePaid, added option to System Setup>Financial and code to DailyA to give option whether to reset the late cycle start date if they still have a balance owing.
//27. SDD Modified CalcTaxAmt and new method GetTaxRate to allow for the new GST rate in NZ.  Added new field [Facility]TaxNewRate and added onto form System
//28. NGBW Modified [Transaction]CashSale OK button to check whether the customer has been to the Receipt tab. If not, will alert and automatically change.
//29. NGBW Fixed Cash Sales not prompting whether to continue if Receipt type is default for a merchant and it has not been processed.
//30. NGBW Added check to SwipeCard to prevent processing for $0 transactions.
//31. NGBW Fixed [UserLogins]RecordStatus being set to 3 and possibly never being set back to 0 in GeneratePrimaryKeyValues.
//32. NGBW Added check to [Transaction]ModReceipts to prevent the [Transaction]AgreeNo being set whenever a Receipt is modified.
//33. NGBW Added option of setting of the [Unit]RentedValue based on the [Agreement]RegularRent divided by number of units when importing Agreements.
//34. NGBW Set READ WRITE([Customer]) in DailyAutopay as the [Customer]Balance was not being saved.
//35. NGBW Added section specifically for the SKBilling for calculation of the Paid To Date in RecalcUnpaid.
//36. NGBW Changed text variable of [Facility]Request to vRequestData as [Facility]AlertMessage uses vData, causing issues if you take the data and then show an alert.
//37. NGBW Added Query on [Agreement]MoveInNew and [Agreement]MoveInRR vName object method to reduce the Customer selection if there is more than 1.
//38. NGBW Set IncRecCode to set vCol2 to "GST" if [Facility]Country=1.
//39. RWFR Added Promotions Module
//40. RWFR Added Promotions Report
//41. RWFR Added WSC_AdvamStoredPAN credit card processing
//42. RWFR Fixed balance being incorrect on invoices using new invoice/statement system
//43. RWFR Reprint/Reemail invoice buttons are hidden if not on new invoice/statement system
//44. RWFR Hid vVoucher for non-KSS sites
//45. RWFR Added location search to the Call Centre screen for KSS and renamed the old location search Centre Search
//46. RWFR Storman now picks up the postcode file from AU Post Office for the Call Centre screen
//47. RWFR Added new marketing type Size Category
//48. RWFR Added length, width and area to Unit Type table
//49. RWFR Added Upper and Lower Area to Marketing Types table
//50. RWFR Non-numeric characters are stripped from all SMS transmissions
//51. NLT Fix bug where swapping between weekly / monthly billing plans was not recalculating other regular charges.
//52. SMG Created DropPrimaryKeyIndexes and BuildPrimaryKeyIndexes for when there are problems assigning Primary Key Values
//53. NLT Add print form button to reservations 
//54. NGBW Changed query on [Letters]SMSDelivery as query can handle max string length of 80, so broke query into 2 parts.
//55. SMG Added WS_CreateReservation webservice
//56. RWFR Added MoveInNewEdit form
//57. RWFR Added MoveInEdit method to execute the setting of mandatory and invisible fields
//58. RWFR Added the vEditMode settings in MoveInCode
//59. RWFR Moved rent increase changes from v8.1

//Changes in 8.2.0 01/06/10
//1. RWFR [Unit]SelectUnit - added form event=on display detail section which does a relate one on the unit type
//2. NGBW Commented out Query in CreateRecJournals causing imports to fail for Facilities without a GL Ext.
//3. SMG Added additional required parameters to LogEvent method call from SyncLog and SynclogNew methods - to fix missing FacilityCode detail in 'CHK' Eventlog record
//4. SMG Added code to each method where Duplicate Record command was used - set the Primary Key of that table to 0 so a new PrimaryKey value would be assigned by the trigger
//5. SMG Added retry option to Datafile Export uploading step
//6. SMG Modified SyncCreateCust method to use the new Triggers with all required parameters
//7. RWFR Changed InitSites to only skip facility check for AdminSupport
//8. RWFR Changed Advam CC method to check AdvamErr=0 rather than OK=1
//9. SMG Called the Generate Primary Key values from the 'System' method rather than the 'OK' button of the System Input form
//10. SMG Gatelog Trigger - Now assigns a primary key regardless of whether the CustomerCode is passed in or not
//11. RWFR [Transaction]'ModReceipt - Cash Received is not to 0 on re-opening transaction
//12. RWFR SelectUnitContact checks permission 31 now
//13. RWFR EventLogOut - Find agreement updated to search new field [Eventlog]AgreeNo
//14. RWFR EventLogAgreement - updated to search new field [Eventlog]AgreeNo
//15. RWFR EventLogReservation - updated to search new field [Eventlog]AgreeNo
//16. RWFR Late Cycle permission is now checked on [Agreement]ModDetails
//17. RWFR Advam SMS timeout extended to 60 seconds
//18. RWFR CheckVersion no longer updates the version date in the facility record for MV
//19. RWFR All gate methods now ensure the facility code at a minimum is in the [GateLog]CustCode field
//20. SMG Added test in method 'CheckVersion', if 4D Client then do not process anything
//21. SMG Added check for blank date on setting [Facility]VersionDate to <>dCompileDate
//22. SMG Online Reservations Welcome screen addes 's to Business Name even when Business Name ends with an 's' - now corrected to add 's only when necessary
//23. NLT Add Primary Key to Customer table overnight export
//24. NGBW Commented out code on RentIncrease to do with setting the incorrect Facility field to the new Rent Increase Date.
//25. RWFR Moved code in Unit Trigger that set NewRentAmt to MoveInOk
//26. RWFR TotRentUnpaid now includes Keystats Category Discounts as these are included as Rent on the Keystats
//27. RWFR Auto Log Out events are now picked up from F2000 and Storlogix setting units back to Rented
//28. SMG Added [Unit]PrimaryKey:=0 to [Unit].UnitOut -> bMod method - 1 out of 3 already changed, last two missed first time.
//29. SMG OtherStartup - When Duplicating Facility record, set [Facility]PrimaryKeyMin and [Facility]PrimaryKeyMax to '0'
//30. RWFR Fixed incorrect text showing on AnalysisIn form when tax option was higher than 0 in system setup
//31. SMG Modified InitNextPrimaryKeys method replacing Min and Max functions with Order By equivalent as V11 versions are broken - notified Wayne at 4D via email.
//32. NGBW Added setting of [Contacts]SizeQuoted on bRefund and bAgree on ContactsIn.
//33. NGBW Removed setting of [Transaction]MiscDtls to disable on MiscReceipts as it caused the dropdown to be invisible. Added manual setting enterable of subtable fields on RecptIncl form method.
//34. RWFR Notices array is correctly set when changing notice plans as part of a billing plan change
//35. RWFR Added new selection to Unit Status report to allow the user to select the lock status as well
//36. RWFR Renamed Action Req to Lock Status on the Unit Status report when not run through daily
//37. RWFR Made a correction to the Unit Status report not clearing Lock Status of 6
//38. RWFR Unit Status report uses Unit Lock Status rather than Customer Overdue
//39. RWFR Stopped blank logqueue events causing alerts in logmonloopcode
//40. RWFR Stopped new rent prompt appearing for Kennards
//41. NGBW Added setting of [Agreement]BalanceOwing and [Customer]Balance in EmailAutoCC so the invoices are calculating correctly.
//42. NLT Add Direct Debits for AuthNet incl new field for bank details
//43. NLT Fix bugs in Sage export


//Changes in 8.2.0 04/05/10
//1. RWFR [InsuranceRates]'InsuranceRatesIn - Start Value updates array when changed
//2. RWFR [InsuranceRates]'InsuranceRatesIn - End Value updates array when changed
//3. RWFR [InsuranceRates]'InsuranceRatesIn - Repeat option now checks if start/end value are already the same
//4. RWFR [InsuranceRates]'InsuranceRatesIn - Start Value when changed ignores current record for checking overlaps
//5. RWFR [InsuranceRates]'InsuranceRatesIn - End Value when changed ignores current record for checking overlaps
//6. SDD Modified LoadAnlsArrays to make sure Analysis Description fields are hidden correctly so no overlap
//7. SDD Modified MessageEdit,MessagePreview, and MessageIn to avoid 4D error on deleting attachments.
//8. NGBW Modified SelectUnitA so [Transaction]Narration would show correct calculation when creating a pro-rata for an agreement with a billing plan discount.
//9. NGBW Added text field at bottom of [Notices]RentIncreaseRules for the translated version of the search options, set the cent value to not show a decimal and removed the swapping of the search symbols.
//10. NGBW Added new method RentIncrComment which fills in the text field at the bottom of [Notices]RentIncreaseRules.
//11. SMG Added Long Integer Primary Key Indexing for syncing performance enhancement - changes include PrimaryKey fields for most tables, Trigger methods, TriggerLog method, LogEvent Method, Added Fields on System Setup and MV Facility List forms, System Setup and MV Facility List Input form submission code changed, InitNextPrimaryKeys method, GeneratePrimaryKeyValues method, VerifyPrimaryKeyRanges method, changes to CheckVersion method, On Startup, LogMonServer, Tutorial, SyncCreateAllProc methods
//12. SDD InitNextPrimaryKeys - This method called the former 4D command Count Tables which does not exist in v11.  Added a method to simulate that command.
//13. NLT Fix potential NAN's in DoBillNext + on object methods in [Trx]MiscDetls'ReciptsIncl form + flag potential causes of NAN's in CalTaxAmt, RemoveUnit, CalcRentedValues and CalcRentAdvance method
//14. NGBW Fixed issue with checking NZ [Customer]BankAccount length as stored in variables. Added checking length of all variables for KSS Refund alert.
//15. SMG Modified CheckVersion to query Facility record prior to assigning Primary Key - it was getting lost previously due to other processing
//16. SMG Added checks to GeneratePrimaryKeyValues to check for multiple Facilities with the MV product code - added alert message to correct and re-run
//17. SMG Added check to determine if any records remained without a Primary Key after generating them - added option to delete any that remain.
//18. NGBW Fixed ExportMYOB, ExportQuickBooks and ExportSage! from export sometimes having prepaid journal before headers and revenue journal.
//19. SMG Added method for Server / Standalone to read ISO Country Code XML file from Preferences folder and populate arrays.   Changed popup menus to use Country Code instead of Country Name.   Modified CheckVersion to populate Country Code on upgrade.   Added [Customer]CountryCode, [Customer]MailCountryCode, [Customer]AltCountryCode, [Contacts]MailCountryCode
//20. NGBW Added check when adding receipt to make sure cannot add Analysis Code with SortOrder 53 if not a refund and [Facility]BatchRefunds is True.
//21. SMG Create placeholding Activity records so that Key Stats report will run even for brand new datafiles.
//22. SDD Modified CheckUpdate so that it will not run if it is a Tutorial datafile, otherwise it may download a MaxUnits incorrectly.
//23. RWFR Changed usage if vLeg6 to vLeg7 in Unit method and UnitIn form
//24. RWFR Renumbered 9.1.0 to 8.2.0


//Changes in 9.1.0 13/04/10
//1. NGBW Added [UnitType]MonthlyRate to Rental Increase Report.
//2. SDD Added [EventLog]Code to the EventLog Input form so we can see what flags are selected
//3. SDD Print EventLog dialog when selecting the second radio button the first stay selected.  This is now fixed.
//4. SDD Fixed Autospell check on CC Name in MoveInNew
//5. SDD System Setup - Turned off the hiding of the PDFPrinter driver when the Use checkbox was unticked.  You have to select the printer then tick the checkbox which you can't do if it is hidden.
//6. SDD Set4DUser - Added 1 second delay to see if that will stop the error when a new user logs in for the first time
//7. SDD Customer Balances Report - Fixed totals not displaying and took out CalcBalance methods which slow it down a lot - This can still be accessed by Recalculate Balances
//8. NLT Fix bug on check of expiry date on Update and Upload buttons for AuthNet and EziDebit
//9. SDD SelectUnitA -  Added  condition to ensure this does not activate Alert message for every single UnitType
//10. SDD MoveInNew - Fixed fields on page 0 where there was slight truncation
//11. RWFR [Facility]'System - Added tool tips for Batch Refunds Alert
//12. RWFR [Facility]'System - Added tool tips for Delinquent System
//13. NGBW Added to Contacts2 to only search for Contacts with Outcome="".
//14. NGBW Set value of vOccUnit on On Display Detail in UnitTypeOut and SelectUnitType form methods
//13. RWFR [UserLogins]'UserLoginsOut - ActualName field now visible
//14. RWFR KeyStats - Enabled KSS Changes
//15. RWFR [Transaction]'StockOut - Added type column and added more detail to form description
//16. SDD Added 4th option to Print Location called Print to Excel File.  Also changed all reports using this option to reference the variable <>iPrinttoFile=3
//17. RWFR [Unit]'UnitIn - Replaced Dimensions with vLeg6 which changes depending on product type
//18. RWFR Units - vLeg6 is set appropriately depending on product type
//19. RWFR Units - vLeg5 for appliances now shows the full text
//20. RWFR [Agreement]'MoveInNew - Removed min/max of 0 from SendDaysBefore
//21. RWFR [Agreement]'CreditSaleIn - Removed min/max of 0 from SendDaysBefore
//22. RWFR [Agreement]'MoveInRR - Removed min/max of 0 from SendDaysBefore
//23. RWFR CheckVersion - Stopped upgrade document being shown to KSS users
//24. RWFR Future Move In permission check now works
//25. RWFR InsuranceRates - Now has a permission 191
//26. RWFR Updated CreateGroupArrays to include the new customer category permissions
//27. RWFR [Unit]'Insurance - Insurance Rate Premium with Repeat option now correctly divides by value not by the premium

//Changes in 9.1.0 01/04/10
//1. NGBW Added ability to print either the highlighted Notes History record, a selected category, or all including date ranges.
//2. NGBW Added Note Category to PrintNotes.
//3. RWFR MarketingTypesIn display issues fixed
//4. RWFR ConfirmTwo/Three/Four OK button being too small fixed
//5. NGBW Fixed issues in GoogleGeoPlot using incorrect Country.
//6. NGBW Added ability to print Quotes and select whether to print all or a selected Unit Type.
//7. NGBW Edited EziCCDetails and EziDDDetails forms to change some text to be more descriptive.
//8. NGBW Added Entry Filter to BSB variable on EziDDDetails form.
//9. NGBW Added variable for checking CCTransID to account for EziDebit not having one in [Transaction]ModReceipts OK method.
//10. NGBW Set Activity table to sync in SyncCreateAllProc if all tables are set to sync.
//11. NGBW Set EziDebit Add Credit Card and Add Direct Debit methods to not attempt to recreate the customer profile if it already exists.
//12. RWFR On upgrade to this build it now checks that any customer balances that are not equal to agreement balances are supposed to be that way, if not it corrects and unlocks the units
//13. RWFR CheckVersion always updates the build date now
//14. RWFR vPayment is only calculated for Rental version now
//15. NGBW Fixed EziDebit Direct Debit date formatting to make sure the month is two digit.
//16. NGBW Fixed EziDebit Direct Debit update not showing alert dialog.
//17. NGBW Fixed DailyAutoPay alerting for EziDebit Direct Debits that customer bank details are missing.
//18. NGBW Fixed tab order on EziDebit forms.
//19. NGBW Fixed UnitStatusDialog radio buttons not being grouped.
//20. NGBW Set Filter Icon and Text to not show for Notes History if Note categories are not setup.
//21. NGBW Grouped radio buttons in [Facility]RentCalcNew.
//22. NGBW Grouped radio buttons in [Facility]Change.
//23. NGBW Set borders check boxes on [UnitType]UnitTypeIn to invisible.
//24. NGBW Fixed text on button in [UnitType]DRCEdit.
//25. NGBW Fixed tab orders in MoveInNew.
//26. NGBW Added new variables for AU Bank Account so BSB is on top in MoveInNew and ReservationsIn.
//27. NGBW Removed restriction of TimeZone to 16 on [PhotosCards]MoveInInclNew.
//28. NGBW Fixed grouping of radio buttons on [Agreement]PaidToDialog.
//29. NGBW Fixed form display issue of [MarketingTypes]MarketingTypesIn by adding a second set of buttons
//30. RWFR Added new marketing types title fields
//31. RWFR Titles on Customer Analysis Report changed to use new fields
//32. RWFR Titles in Types & Categories changed to use new fields
//33. RWFR Titles on MoveInNew, MoveInRR, CreditSaleIn, ReservationsIn & ContactsIn changed to use new fields
//34. RWFR Fixed object names of custom fields
//35. NGBW Fixed issue causing syntax errors with EziDebit during daily - added close window to DailyAutoPay and ProcCreditCard
//36. SMG Added PrimaryKey fields to relevant tables moving existing fields if alredy occupying the required Field position for PrimaryKey
//37. NGBW Added "Live" payment gateway to EziDebit.
//38. NGBW Moved BSB number above Bank Account in [Customer]EziDDDetails.
//39. NGBW Set to save CustomerCode instead of returned value for EziDebit CC and DD profiles.
//40. NLT Fix bug in Autopay type drop-down box
//41. NGBW Moved adding of reference code in SendSMSAdvam to just after the account details rather than after the mobile number.
//42. NGBW Increased width of CCExpiryYear variable on [Customer]AuthNetDetails and added labels to differentiate between month and year.
//43. NGBW Added Load Record to EmailAutoCC to prevent dropping of Letter record causing invoice to not attach.
//44. RWFR Changed date check to use country = 7 for South Africa
//45. RWFR Added Thailand support
//46. NGBW Fixed Date From date in ModCharges and Transaction Date and Date From date in ModChargesArray allowing setting the date prior to the Cant Mod Prior date.
//47. NGBW Set Tax Exempt label (lblTaxExempt) to hide in MoveInNew and ReservationIn if [Facility]TaxExempt is false
//48. RWFR Stock Adjustment allows for negative values in the quantity
//49. SDD Added new method called EmailWeeklySales which sends an email report each week for Billing.  Modified LogMonServer to send this on Sunday
//50. RWFR Fixed ControlBig not having associated menu bar #1
//51. RWFR Added permission to override Delinquent System
//52. RWFR Added reverse multi period system for KSS
//53. RWFR Added new parameter for BillNextCharges ($2) which sets bFred10 (show reversal transactions)
//54. RWFR Added new setting for BillNextCharges ($1), if set to 7 it does 6 but sets the date reconciled to the current date in order to be adjusted by the KSSReversal method
//55. RWFR Added new startupdemo form for new demo files
//56. NGBW Added declaration of bAdd to SelectUnitContactA to prevent Syntax Error when converting from Sales Enquiries to Agreements
//57. RWFR Added settings module & appropriate permission
//58. RWFR Added period reporting & appropriate permission
//59. RWFR Added periodic reporting to daily processing
//60. RWFR Added NationalAccountsDisable for KSS National Accounts
//61. RWFR Added [MarketingTypes]Organization & [MarketingTypes]Email
//62. RWFR Adjusted Marketing types form to move buttons rather than having duplicates
//63. NLT fixed display issues on bank account data for NZ / Aust on Other Credit Sales / buybacks tab and Agreement movein screen
//64. SDD Allowed use of OK button for ModCharges for certain users in Billing Only
//65. SDD Attempted another fix for Set4DUser
//66. SDD Added buttons to advance and retreat dates on the Income Charged Dialog box - ANDY TO DESIGN appropriate buttons to make them look nice
//67. SDD Fixed control lines on Income Charged Report and Sales Commission Reports
//68. RWFR RegRentIncrease changed to be based off RegularRent not NewRegularRent
//69. NGBW Set vLockStatus in PrintUnitsCode to be blank if Unit Status is Vacant.
//70. RWFR Stopped re-opening cash sales wiping the cash received
//71. NGBW Added BSB and Account No boxes in AutoPayFormAust.
//72. NGBW Fixed Note History Printing from changing selection.
//73. NGBW Added Notes History printing options to ReservationIn and ContactsIn.
//74. NGBW Added Notes Category filter to ReservationIn and ContactsIn.
//75. NGBW Changed format and checking of Expiry Date on [Customer]AuthNetDetails.
//76. SDD 30/03/10 Modified SelectUnitA so that [Unit]Deposit is not set when Analysis Bill on Move In is false
//77. RWFR Fixed lastdaily resetting from SetFacility being called in DailyA
//78. NGBW Added [UnitType]MonthlyRate to Rental Increase Report.
//79. NGBW Set [Unit]LastInc to equal [Unit]MoveIn if less.
//80. NGBW Fixed SelectUnitA from showing the default rental amount when a different value is selected.

//Changes in 9.1.0 23/02/10
//1. RWFR Enabled use of multiple email addresses for customers seperated by the , character
//2. RWFR Buyback invoices now show a signature area in the bottom right corner of the break (overlapping a long invoice message)
//3. RWFR Added TotalIncreaseUnits field that is the sum of all affected units when calculating the RentIncreaseUnits field
//4. RWFR After calculating Total/RentIncreaseUnits fields it does a FIRST RECORD([Unit])
//5. RWFR Altered buyback calculation for key stats
//6. RWFR Fixed issue with move in only billing plans not showing replaced = with #
//7. RWFR Unloaded transaction record after creation of deposit on conversion from sales enquiry to reservation
//8. RWFR Removed "Unit Type: " text from  [Contacts]Quote_UnitType and added additional tabs
//9. RWFR Added additional tabs to [Contacts]Quote_Other
//10. RWFR Added additional tabs to [Agreement]RentIncreaseUnits
//11. RWFR Fixed 12th month in key stats calculating new insurance wrongly for KSS
//12. RWFR Fixed CheckActivityData not recalculating MerchReturnChg and BadDebtChg
//13. RWFR Moved CC process check before all other checks in ModReceipts
//14. RWFR Fixed error with billplan generation causing bAdd to be set incorrectly
//15. RWFR Changed signature on invoice to customer signature and moved it down 4 pixels
//16. RWFR Cash Sales permissions checks DiscountDisable is True before disabling
//17. RWFR All existing cash sales have DiscountDisable set to true on upgrade (KSS)
//18. RWFR The agreement table will be exported to the KSS specified location on upgrade
//19. NGBW Added Save record after Customer Balance is set when converting Sales Enquiry to Reservation.
//20. NGBW Changed check of BSB length from 6 to greater than or equal to 4 when exporting batch records.
//21. NLT Add ability to export MYOB files for Central separately.
//22. RWFR Moved backup in daily to occur before window opens
//23. RWFR Bill on MoveIn charges are now billed with their date being the Move In date rather than the LastBillDate
//24. RWFR Updated non-MV login images
//25. NGBW Added ability to schedule multiple gate alarm sms and emails
//26. RWFR Added new masthead images to startup screen
//27. RWFR Removed all powered by logos and login images
//28. RWFR Removed old unused logos
//29. NGBW Added array for saving numbers to for SMS Gate Alerts. Added in all gate system Read* methods.
//30. NGBW Changed Batch Refund Alert message for KSS on ModReceipts OK, modified Field36BSB method to save to [Customer]BSB on change.
//31. RWFR Updated control screen images and rearranged buttons
//32. NGBW Fixed dropping of customer record after sending Auto CC Custom notice.
//33. RWFR Loaded in MV & Lite login images
//34. RWFR Loaded in new gradients & alert footer images for billing
//35. RWFR Changed all gradient/background/footer codes to use the new methods, LoadGradients, LoadBackgrounds, LoadAlertFooter & LoadReverseGradients
//36. RWFR Replaced non-control screen images
//37. RWFR Fixed custom buttons not loading for US data files
//38. RWFR Updated call centre control screen images
//39. RWFR Added support for custom buttons to call centre control screen
//40. RWFR Added search and welcome to call centre control screen
//41. NGBW Fixed EziDebit display in System Setup - added new method/form SerialEnter.
//42. NGBW Fixed blank variables on UnitsIn when opening from the map.
//43. RWFR SetPassword now works if the maximum days to keep password has been reached but the minimum hasn't
//44. NGBW Added "Check for Duplicates" option in CDR to display the duplicate records - and if they are [Transaction]SeqNo duplicates, will fix them.
//45. NLT Fixed DRC opening on preview tab if closing out of preview tab.
//46. NLT Added check to Date from field in DRC to stop user entering a date prior to current date and prior to the Last Inc and Movein dates selected.
//47. RWFR Stopped string errors when using Rentals version of software in UnitTypeIn by taking only the first 5 characters of <>vtUnitsCap for the tab names
//48. RWFR Adjusted form elements on UnitTypeIn to prevent overlapping when using Rentals version
//49. RWFR Stopped string errors when using Rentals version of software in UnitIn by taking only the first 7 characters of <>vtUnitsCap for the tab names
//50. RWFR Removed word currently from Unit Is line in UnitIn
//51. RWFR Changed names of text fields on MoveInRR form to prevent them being hidden
//52. NGBW Moved invisible button to top of SelectQuote subform.
//53. NGBW Changed display on InvReceipt to only have the description box all the way down the page if it is not a system "From" comment
//54. RWFR Fixed missing text under send notices in agreement for rentals version
//55. RWFR Set pictures to be truncated to prevent them being moved on AlertMessage, ConfirmFour, ConfirmThree, ConfirmTwo, RequestMessage, SerialEnter, Tutorial & Startup
//56. RWFR Tutorial now uses the appropriate word in place of the word unit
//57. RWFR Reason for storing changed to Reason for hiring on MoveInRR
//58. RWFR MarketingTypes now displays Reason for hiring and Reason for return for the Rental version
//59. NGBW Modified ReCalcUnpaid method due to PaidToDate not calculating correctly between months
//60. NLT Added less billing plan disc to pro-rata prompt when moving in unit, add to prompt and narration when moving out unit 
//61. NGBW Fixed move out calculation when undoing last charges from a different billing plan in DoBillNext and BillNextCharges. Added 3 fields, [Agreement]PriorBillPlan, [Agreement]PriorBillAmt, [Agreement]PriorDiscAmt.
//62. NLT Change BSB field type from Long Int to String of 6 chars and references referring to the field.
//63. NGBW Fixed Syntax Error when changing DD Merchant from Ezi to Advam.
//64. NLT Fix Sales Comm Owing report
//65. NGBW Added AlertMessage to Login form to alert if incorrect username/password combination is incorrect.
//66. RWFR Customer First Name & Facility Phone Number are now references available for SMS
//67. RWFR References are now processed when selecting a notice for a manual SMS
//68. RWFR Changed Date/Time variable on receipt to be vDateTime
//69. RWFR Changed object of [Userlogins]ActualName on InvRecNarrow
//70. NGBW Fixed display of EziDebit info in Reservations.
//71. NGBW Fixed display of Bank Account info on page 8 of CreditSaleIn.
//72. RWFR Added new inventory adjustment form
//73. RWFR Added new permission for inventory adjustment

//Changes in 9.1.0 28/01/10
//1. NLT Change batch refunds for KSS Aust to output the BSB and bank account as one field.
//2. RWFR Units newrentamt is kept equal to rentedvalue on saving unless increase from is filled in
//3. RWFR UnitsOccup is recalculated on saving agreements if blank
//4. RWFR Fixed KSS Keystats including credit sales in new agreement calculation
//5. RWFR Added new permission (184) to allow viewing of move-in only billing plans on all agreements
//6. RWFR Changed RUnitType="" check on saving to be Length(RUnitType)<6 to prevent blank unit types being created
//7. SMG SU to Billing Interface installed and working.
//8. SMG Created New Online Reservations processing for SK where a new reservation will get a fixed deposit amount from an XML file in the 'Preferences' folder on the server.    Storman will not create a Reservation Charge Transaction for the Deposit 
//9. NGBW Fixed Alternate Customer Email button not referencing the alternate customer's email address.
//10. NLT Fix title on Inventory Pricing report
//11. NLT Fix reference to Dollars on Autopay form and various alert messages.
//12. NLT Fix reference to Units so refers to berths etc  on Key Stats report
//13. NLT Fix reference to units on billing line of DoBillNext
//14. NLT Fix black footer on Income received / charged / cash received analysis reports dialog boxes
//15. NLT Fixed various minor display issues on various reports
//16. NLT Fixed syntax error regarding date on future rent increases report
//17. NLT Fixed syntax error on GL report
//18. SMG Created ConfirmFour method / Form to allow four buttons to be selected
//19. SMG Added option to Other Access Functions confirmation dialogs to Reset the Unit Staatus from 'OnSite' to 'Rented'.
//20. NGBW Added ability to read in header and save copy of email to customer's NotesHistory from read receipts.
//21. RWFR Removed extra save record on the agreement table in convtoagreement
//22. RWFR Move In only billing plans display if next bill date and move in code are the same
//23. RWFR Buyback report now includes all merchandise credits
//24. RWFR Merchandise Returns on keystats relabelled Buybacks
//25. RWFR If bank account name is not entered and bank account/bsb are then it warns user to enter acct name
//26. NGBW Added ability to email AP forms.
//27. NGBW Fixed Other Charges alert message only having text on one button.
//28. NGBW Added Thinc Delivery message handling to add emails to customer's notes history.
//29. NGBW Added Thinc Delivery Report.
//30. RWFR Removed references to Nicholas Collins desktop from the code
//31. RWFR Added code to allow creation of Marina demo in CreateTutorial
//32. RWFR Copied missing [Facility]Startup form code/design from v8
//33. SMG  Removed Indexing on Non-Key fields for UnitStatusTrx table on instruction from SDD - this includes 'Status', 'OldNo', 'LockStatus', 'Unlocked'.
//34. RWFR Fixed SMTP details being cleared on loading of [Facility]Eventlog by making sure the code only runs if the appropriate setting is 1
//35. RWFR Added Delete button to MessageEdit form
//36. RWFR Changed delete button on MessagePreview form to be our custom prompt
//37. RWFR Shortened aCustName{40} on KeyStats to fit Berths/Appliances
//38. RWFR SelectUnit (A/B) & SelectUnitContact (A/B) have had all instances of Unit/unit changed to <>vtUnitsCap/<>vtUnits
//39. NGBW Modified title text on ConfirmTwo and ConfirmThree to read "Please select".
//40. RWFR Converting to an agreement sets the paid to date to be 1 day prior to the next bill date as expected
//41. RWFR New agreements have the paid to date set to the next bill date - 1
//42. RWFR When modifying a batch refund with the appropriate permission you can edit the ccauthno field
//43. RWFR You can no longer add a $0 receipt or refund
//44. RWFR Stock adjustments are excluded from the buyback report
//45. RWFR Merchandise discounts (specifically the MD analysis code) are excluded from the buyback report and the activity total for the key stats report


//Changes in 9.1.0 13/01/10
//1. RWFR SelectUnitA unloads the reservation record before running recalc
//2. RWFR IncomeDetail now shows reservation details correctly
//3. NGBW Changed tab order on SwipeCard.
//4. SMG Updating Activity records after changing Week End Day was being done at Client end but then being overwritten by Trigger code which wasn't aware of new Week End Day.    Modified code to update Trigger variable and let Trigger do the updating. 
//5. RWFR bAdd is now set to 0 in DoBillNext to ensure pro-rata's are billed correctly for additional units on new agreements
//6. NGBW Added vDateTo on PrintInv, plus fixed up incorrect variable names vCust and vAgree were around the wrong way.
//7. RWFR Allowed : in smtp hostname
//8. RWFR Stopped clearing of email login/password on load of email & eventlog setup
//9. RWFR Re-enabled custom key stats for Kennards
//10. RWFR Header on email option changed to include header on letter option as well
//11. RWFR Fixed Rent Increase AP option not saving selection
//12. RWFR Added BatchRefunds field to Facility table
//13. RWFR Added system setup option in refunds section to enable Batch Refund Alert
//14. RWFR Added alert message to modreceipts OK button if BatchRefund=True and the analysis code special option = 53 to warn them that this will be paid by head office
//15. RWFR Bill plans only available on move in no longer show unless it is a new movein
//16. RWFR Check available units now adds a quote when a unit is selected
//17. NLT split NZ sites in revenue and receipts export.
//18. RWFR Added Kennards Questions & Story Fields to contacts/reservations & agreement tables
//19. RWFR Added additional tab to display results of questions & story fields for kennards
//20. RWFR Added code to conversion from/to sales enquiries/reservations/agreements to copy questions & story fields for kennards
//21. NGBW Added check on OnClicked form event on ReservationsIn to enable bAgree if vCount not equal to zero.
//22. NGBW Set [Reservation]Outcome and [Reservation]OutcomeDate to "" and !00/00/00! respectively when reactivating the Reservation.
//23. NGBW Fixed quotes disappearing when printing letter.
//24. NGBW Added OnLoad details to CreditSaleIn the same as ReservationIn and MoveInNew to set the "Include Trx's from other agree.." correctly.
//25. NGBW Changed tab order in Bank Info Section on MoveInNew, MoveInRR, CreditSaleIn and ReservationsIn.
//26. NGBW Changed Field36BSB in form of MoveInNew, MoveInRR, CreditSaleIn and ReservationIn from field [Customer]BSB to an Alpha variable to prevent it showing as 0 by default. Have modified Form Method and OK methods on ReservationIn and CreditSaleIn as well as methods MoveInCode and MoveInOK to take account of this.
//27. NGBW Added ability to create Custom Auto Credit Card Emails to SwipeCard and DailyAutopay.
//28. NLT Add permission to block or allow user to modify a transaction processed through batch refunds
//29. NGBW Added code to vName on [Reservation]ReservationIn to charge out the deposit if an agreement deposit is selected
//30. NGBW Added +Char(13) to ModReceipts.bAlert method alert Direct Refund text.
//31. NGBW Fixed balance calculation issue in [Analysis]StockInquiry caused by arrays not being reinitialised on analysis change.
//32. NGBW Changed variable name of [Agreement]LastBillPlan on Move Out tab from Number7 to fix formatting issue.
//33. RWFR LastBillPlan is no longer set on changing bill plan, it is set on billing
//34. NGBW Fixed code on bRefund on ReservationIn in several places due to being incorrect to several degrees as well as various display issues on ReservationsIn.
//35. RWFR Added new field to Agreement table - RentIncreaseUnits
//36. RWFR When clicking to add a new email or letter in an agreement it calculates the new RentIncreaseUnits field
//37. RWFR DailyA calculates the new RentIncreaseUnits field just before displaying the agreements to be processed
//38. RWFR RentIncrease calculates the new RentIncreaseUnits field before generating letters
//39. NGBW Added [Transaction]AddCharges and [Transaction]ModChargesArray forms for new array-based charges system.
//40. NGBW Added CalcTaxAmtArray and LoadAnlsChgArray methods for the new array-based charges system.
//41. NGBW Fixed EventLog records not displaying - added parameters to Postion and Replace string calls with *;*;*) and *;*).
//42. NGBW Fixed display issue on [UnitType]UnitTypeSelect form.
//43. NGBW Fixed display issue on MoveInNew and MoveInRR Insurance value.
//44. NGBW Adjusted location of Agreement/Reservation Number on MoveInNew, MoveInRR and ReservationIn due to clashes with label.
//45. NGBW Fixed [Activity]CheckDialog from being opened too small.
//46. NGBW Fixed dispplay issue of RentedValue on MoveInNew caused by field hidden behind box on AgreementInclNew.
//47. NGBW Fixed "Cancel" text not showing on button when changing Analysis on Other Regular Charges on an Agreement.
//48. NGBW Grouped Radio buttons on RentAdvDialog.
//49. NGBW Changed tab order on SystemIn Modules & Addons tab.
//50. NGBW Set input form for SelectCust to be CustomerIn.
//51. NGBW Increased height of vtBackupLabelName on [Facility]System and fixed display of backup notices.
//52. NGBW Added Query to CreditSaleIn vName to reduce Customer selection to single record as it was causing an alert when changing tabs.
//53. NGBW Added code to ConvSaleBooking so when converting to Reservation it prompts to charge the deposit.
//54. NGBW Fixed some issues with the enabled status of Refund Deposit on ReserveIn.
//55. SMG Corrected 'Banking has been rup up to' typo on Settings2 tab of System Setup
//56. SMG Reimplemented population of Month popup menu on the Control screen - 4D changed how they deal with Resources
//57. SMG AutoPay Banking in System Setup hidden when country not Australia or New Zealand
//58. SMG Hide Company Registration fields on System Setup when country not United Kingdom
//59. SMG Corrected typo on tool tip 'This is for the 6 digit bank and branch code for the bank on which (t)he cheque is drawn.'  - (t) previously missing
//60. SMG System Setup screen, Product Code field help icon - Display icon only if user is Adminsupport or Designer, now opens Knowledge Base article
//61. SMG System Setup, Setup Options 2 - Show / hide Can't Mod Prior trail by # days field / text depending on checkbox setting
//62. NGBW Fixed Email button on ContactsIn not filling in To field when creating an external email.
//63. NGBW Added enable/disable of bAddEmail to ContactsIn EmailAddress field and ContactsInCode.
//64. SMG Removed SUFacility from the Agreement screen (Previously overlaping the Insurance field) - now placed on the Unit Input screen in the header
//65. SMG Disabled the Photo Compression slider when the option was not selected, corrected help tip spelling mistake 'pixil'
//66. SMG System Setup -> Settings 1 - Options 'Hide Facility Map' and 'Hide Key Rent On Dashboard' now hidden if 'Don't Show Storman's main Dashboard' is ticked.
//67. SMG System Setup -> Security - Complex Password options now hidden if Complex Passwords not selected
//68. SMG System Setup -> Security - Auto Client Quit - If disabled then options now hidden.
//69. SMG Added variable $OldVersion to 'CheckVersion' so that if the version upgrading From is a V8 release then a specific URL is opened
//70. NLT Remove Sales Commission report from menu if NOT a StormanBilling datafile
//71. NLT Set insurance rates table to sync
//72. NLT Hide reprint invoice and re-email invoice buttons if facility not using new invoice system
//73. NLT remove invalid help tips from insurance rates input form.
//74. NLT remove instances where a transaction's prorata description repeats itself.
//75. SMG System Setup - Separated Bank AP details into 4 separate fields for data entry friendliness, still stored in the same field in the same format.
//76. SMG System Setup - Changed UseCashbook from being radio buttons to dropdown menu
//77. SMG System Setup - Changed CashAccrual from being radio buttons to dropdown menu
//78. NGBW Set Advam DD and CC methods to generate XML via DOM rather than using disk file.
//79, SMG When adding New Stock Purchase the Transaction date was being set to a variable that hadn't been declared - declared now in calling method.
//80. NLT add * parameter to replace string and position references where a Char(x) is involved (new 4D requirement)
//81. NGBW Fixed in DCSchedule form method and CreateBatchFiles method the formatting of the BSB number.
//82. NGBW Added alert messages if BSB is not 6 characters.
//83. NGBW Added "<None>" values to dropdowns that required them.
//84. SMG Inventory Item Output screen - Description of item wasn't being displayed from the Analysis Code.    Instead of Relate One on each Display Detail, set up 'Set Field Relation' on Form Load and reset to structure definition on Form Unload
//85. SMG Inventory Item Input Screen - Hierarchical List command Get List Item has a bug whereby if you specify a list item as a parameter it ignores it.   If you use an '*' instead it uses the currently selected one (which is what we want)
//86. SMG Split Access Control Gate Name/No field across three fields (variables) and remerged for record save.
//87. NGBW Fixed size of AnalysisIn being opened.
//88. SMG System Setup - converted 'Prepaid Rent calculation', 'Prepaid Rent Category', 'Report Column Display', and 'Key Stats Income' options to Dropdown menus.  
//89. SMG System Setup - Converted Refund Policy radio buttons into a dropdown menu
//90. SMG Send SMS (Select Notice) - changed Customer Name and Customer Code to Not be editable
//91. NGBW Added DiscountCalc field.
//92. SMG Modified Billing Plan Incentive removal to mirror functionality in V8
//93. RWFR Extended invoice narration across page
//94. NGBW Added functionality to automatically email invoices when credit card is processed.
//95. NLT Fix inablility to delete Other Regular charges
//96. NLT Add reporting of invalid analysis codes after receipts export
//97. SMG Modified 'ProjectedChargesRpt' method to allow # of recurring Analysis Codes to be greater than 20 - changed size of 'arAmounts' array.
//98. SMG 'SU' tab on the Agreement screen now only displays if Facility is "ST@"
//99. SMG Modified Tooltip for Gate Name No to remove reference to comma separating (old method of configuring)
//100. SMG System Setup - Changed Complex Passwords option display so that if user chose to abort the change at the dialog then the options would become hidden again.
//101. SMG Projected Charges Report - Uncommented vCol variable definitions as Invalid Pointer Variable runtime error was displaying
//102. SMG Added Tooltip for Open Web Page button URL field in System Setup


//Changes in 9.1.0 26/11/09
//1. RWFR Quote unittype listing now sorts by sort order first
//2. RWFR Added LastRentAmt field to Unit table
//3. RWFR Added code to set LastRentAmt to current RentedValue when rent changes
//4. RWFR Commented out code in LogAction where all user names were being set to a variable, not required and was causing errors
//5. SMG in ReadFalconXTGateLog method, FalconXT was not identifying Customer or Agreement due to missing query of Unit which provides Agreement, which provides Customer - corrected
//6. SMG Corrected where System Setup was not reading in the DD provider selection
//7. SMG Made separated Bank Details fields display (or not) correctly based on Country.
//8. SMG Made Bank Details fields (separated and non-separated) hide when Ezi Debit option chosen.
//9. RWFR ReservationsIn form method - RefundPayment section - Changed it looking for [Agreement]RAgreeNo to [Reservations]RReserveNo
//10. SMG Made Ezi Debit status appear when Customer Profile created, and disappear when not created.
//11. RWFR ReservationsIn form method - aPageNo=4 section - Now searches for letters matching reservation number
//12. RWFR MoveInCode method - aPageNo=4 section - Now searches for letters matching Agreement number
//13. RWFR Added new field [Facility]CreditSort
//14. RWFR Added new field [Facility]RentIncreaseAP
//15. RWFR Added array to select default credit sort to system setup tab 1 default options
//16. RWFR CreditSales - asSortBy is now set to [Facility]CreditSort
//17. RWFR CheckVersion - 810 - [FacilityCreditSort and [Facility]RentIncreaseAP set to 1
//18. RWFR Added array to select default print rent increase AP forms to system setup daily processing options
//19. RWFR PrintRentIncAutoPay - Added code to take account of new default print settings
//20. RWFR Changed order by formula to order by in SalesCommReport to remove crashing
//21. RWFR Removed additional logging in PrintSelection
//22. NLT Remove formatting on agreement info page for Aust bank accounts as can be a variable length; don't want to cause user to enter zeros that aren't part of the account number.
//23. RWFR ModReceipts form method now checks when assigning the last used analysis code if the user has permission to use it, if not it acts as though none was assigned
//24. RWFR Notices - SelectNotice form method - Added on load which sets asNoticeDesc:=1
//25. RWFR SM Lite Menu - Renamed Email Setup to Email and Eventlog Setup
//26. RWFR CheckActivity - now sets <>iTable to 10 and vpFile to point at the Activity table
//27. NLT Fix Tax on Key Stats report
//28. SMG Moved code to Show / Hide Unit Count on Form Events On Load, On Clicked, or On Data Change
//29. RWFR BillNextCharges - Added code to ensure that Other Credit Sales don't show the Undo Last Charges selection box when billing next charges
//30. SMG Remove code specific to Gate System # 1 and 6
//31. NGBW Fixed Waiting List not appearing when unit type being waited on coming available.
//32. SMG Made 'Enable Security Tracking' tickbox visible when creating new Notes Category record.
//33. SMG Adjusted tab control on Unit Types input screen to be centred on screen
//34. SMG Dynamic Rent Control Tab - Aligned 'Enable DRC?' and 'Yes, enable DRC...' - horizontally.
//35. SMG Adjusted highlight and header graphics to eliminate white space.
//36. SMG Corrected 'bAddRefund=1' error on opening Customer Receipt record by declaring variable in the 'InitProcessVars method
//37. SMG Added 'vtReverse:=([Transaction]TotAmt<0)' to [Transaction] ModReceipts form method to determine whether transaction was refund or receipt
//38. SMG Changed Map 'Sizes' button text to 'Size' - more accurate. 
//39. NLT Fix trial balance report where not all accounts showing - add test for report name field if MV facility
//40. SMG Moveout of customer from Customers / Agreements screen results in filtering and sort arrays changing to Sales Enquiry specific values in 'Contacts2a' method.   Arrays now reinitialised afterwards.
//41. RWFR When loading weekly based agreements unit rent is rounded to 2 d.p. when converting back from the monthly based rented value
//42. RWFR When printing invoices before checking if customer matches transaction it loads the first record in selection on the transaction table
//43. NLT Fix bug in reprinting of locklist report from MV end
//44. NLT Fix error message when modifying a rent increase date on agreement info page when day to bill is greater than the next bill date's month end date.
//45. NLT Fix entry order on Mod receipts page
//46. RWFR CheckDemoDates is now proceeded by InitSites as several tables check against the <>asSites array
//47. RWFR Fixed show incentive on invoice having wrong line for Transaction Total Amount in DoBillNext
//48. SMG Reduced incidence of message 'Invalid fields in Notice Plan...' - this was due to an attempt to expand a BLOB that wasn't compressed in DailyPrep method.
//49. RWFR Added Mail Suburb to invoice address if present
//50. RWFR Added vAddr7 to InvFooter form
//51. RWFR Reservations weekly check now checks if billplans are active
//52. RWFR Removed code in InvRecCode that caused it to move the transaction description repeatedly
//53. NLT Add Westpac DD's to Daily

//Changes in 9.1.0 18/11/09
//1. RWFR Autopay type is set on new demos now
//2. RWFR If not Client show process window option hidden
//3. NLT fix redo prior batch problem with the short date format.
//4. RWFR Send notices by email checks if send to all is ticked, if not and the customer does not have send notices enabled it alerts
//5. RWFR Fixed copying of merchandise discounts
//6. RWFR Fixed inactive agreements showing unit count
//7. RWFR Set part payment dropdown to execute on clicked
//8. RWFR Added currency symbol to autoccemail
//9. SMG Added button to Transaction tab to allow Facility to open custom Web Page.   Setting in Financial tab of System Setup.   Will be invisible unless URL is entered.
//10. SMG Added characters remaining indicator on SMS entry window
//11. SMG Added message to Backup File / Folder selector when called by 4D Client - "(Note: Files / Folder view is as seen on Storman Server computer)"
//12. NLT Fix KSS bug for gross rental fees - was deducting tax
//13. RWFR In WSC_CheckMVUserPassW when creating the groups record it checks if it still exists. If it does it alters the existing record.
//14. RWFR Forced unload of groups & usergroup at end of PermissionsControl
//15. NGBW Added vLeg field back into ModReceipts.
//16. RWFR Added Threat Level tracking system, uses security option in marketing types to tag notes with security, adds to customer threat level and records last time of threat change. Added facility setting for alert on threat level.
//17. RWFR Added Threat Level report and dialog
//18. SMG Online Reservation Sales Enquiry creation - Changed ContactNo generation to work, previous code did not.   Added Facility Code to Contact Record, previously missing.
//19. RWFR Refund permissions check if the TotAmt is equal to the old TotAmt if not permission check is run
//20. RWFR Fixed Userlogins import & UserGroups import not working correctly if any of the fields being sent were blank ($j>1 is now $j>=1)
//21. RWFR Password change date is now set in ReadUserLogins if password is changed
//22. SMG Analysis Codes description field changes size depending on whether charge or receipt.   Added code to Form Method to set absolute size, changed from relative size previously triggered by On Load on asCategory popup menu.
//23. RWFR MV logins $PWDChangeDate no longer has type re-changed to Date
//24. RWFR Changed SwipeCard title variable from vTitle to vtTitle
//25. RWFR TrxListSort uses different order by for Cash Sales now to keep it consistent
//26. SMG Accounting -> Modify Suppliers -> Made title uneditable.
//27. RWFR RemoveCharacters no longer strips commas
//28. SMG System Setup -> Merchant Details - correct 'Visit www.storercheck...' url to display properly on both Win and Mac.
//29. RWFR Added On Load Record to the unit selection, other regular charges and cash sales to ensure all fields & arrays remain selected correctly
//30. RWFR Added new requested changes (06/11/09 email) to KSSUpgrade
//31. SMG When modifying To / From dates on Credit Transaction, the Tot amount was being multiplied by vMinus (positive value) instead of negative value - now multiply by -1*vMinus which results in negative total = correct
//32. RWFR You can now enter the Last Billplan on the Moveout tab
//33. SMG Added check to see whether any user is logged in before executing auto re-login after timeout period
//34. NGBW Fixed Arrears Report calculating incorrectly when using "Bal Owing is greater than x days".
//35. SMG Adjusted height of Marketing Ranking window to display OK and Cancel buttons.   Changed window type from '0' to '4' to hide window resize indicators. 
//36. SMG Corrected Field Tab Order for Notice Plan Number on Agreement and Reservation screens
//37. SMG Corrected Field Tab Order for Unit charges area on Agreement screen
//38. SMG Corrected Field Tab Order for Other Recurring charges area
//39. SMG Adjusted window size for 'Financial Reports' screen.   Changed 'Modify' window to be a modal Dialog and adjusted window size.
//40. RWFR Added CentralGate field to Facility table
//41. RWFR Enabled Central gate support for all gate system types
//42. RWFR Changed Field Tab order for Rent Increase Rules
//43. RWFR Changed Field Tab order for Email & Eventlog setup - Email screen
//44. RWFR Changed Field Tab order for Groups screen
//45. RWFR Added code to start of CreditSales to prevent locking of facility record when SetFacility executes
//46. RWFR Removed incorrect alpha format on LastBillPlan
//47. RWFR Fixed horizontal scroll bar appearing on ContactsOut
//48. RWFR Removed prompt for version on import of files from tutorial folder
//49. NGBW Changed Field Tab order for NoticesIn
//50. NGBW Changed the alert text on SelectUnitContact if UnitPerAgreement is True to "...because your system has the âOnly allow one unit per agreementâ option enabled in System Setup.
//51. SMG Change UnitType record editing to use Transactions.   Show / Hide Previous / Next buttons depending on record being shown.   Hide / Show DRC options depending on setting.
//52. SMG When user selected 'Storman Website' from within a Demo database, the following message is displayed:  "Access to the myStorman Client Services Portal is not available in the demo database."
//53. SMG When deleting a Transaction, Storman now uses a custom confirmation window instead of the default 4D one.
//54. SMG Changed Delete Charge / Receipt to use custom confirmation windows instead of 4D ones.
//55. RWFR Projected charges report was cutting off month in date headers
//56. NGBW Changed object names on 4 fields/variables to end with "APTT" on AutoPay tabs so they are hidden if Use Autopay is not checked.
//57. SMG Balance Brought Forward was inaccurate, not taking the Balance Brought Forward transactions into account for calculation of totals.    Now including all transactions in Display set for calculating totals, then subtracting 'BalBrFwd' transactions for display
//58. NLT Fix Trial balance report where opening /closing balances for Debtors account did not subtract the bank accumulation
//59. RWFR Added error checking and logging to userlogins & usergroups imports
//60. RWFR Added Quote_UnitType & Quote_Other to contacts and code to letter/emails to generate this text
//61. NGBW Fixed height of Bank Account fields for NZ datafiles on MoveInNew & MoveInRR.
//62. RWFR Added text to reverse payments to indicate in their description that they are a reversal
//63. RWFR Add/delete unit text changes to just delete when unit per agreement is true and there is units on the agreement/reservation
//64. NLT Batch refunds - if bank account name is blank, flag transaction as having a bad account - Kennards
//65. NGBW Fixed "Access Control History" variable from disappearing.
//66. NGBW Added "Print" button back ontot MoveInRR.
//67. RWFR Show Incentive on Invoice is now set to show/hide the sub-options
//68. RWFR If SMS Provider is set to Thinc it now hides the phone number entry field in system setup
//69. RWFR Changed wording on print eventlog from "Print Selected Date Range" to "Print From Selected Date"
//70. RWFR Invoices now show full customer code
//71. RWFR Corrected wording for alert message when disabling gate system through system setup
//72. RWFR Auto-Quit Clients no longer shows for Standalone
//73. RWFR Sales commission report now prompts which report you wish to print
//74. RWFR Sales commission report - when ALL is entered for staff it now selects all staff members
//75. RWFR Forced tabbing when adding a new record to cash sales to stop editing blocking redrawing
//76. RWFR Various fixes to Sales Commission report as requested by Aaron

//Changes in 9.1.0 27/10/09
//1. NGBW HTML Email - Edit email invoice implemented.
//2. NGBW HTML Email - Edit email quote implemented.
//3. SMG Added setting on System Setup -> Online Prefs to indicate that Storpay is not allowed to accept part payments - they must be for the full amount due.   Also added supporting code to StoPay (Build > 08/10/2009).
//4. NGBW Renamed Locklist column from "Other Status" to "Action Req".
//5. RWFR Fixed credit percentage not calculating on change of quantity
//6. RWFR aPageNo is recalculated everytime on opening a credit sale due to new option
//7. RWFR LastStatusDate if blank set on upgrade
//8. NRC Converted aATTACHMENTS from string to text to prevent error
//9. RWFR Editing analysis code settings in inventory item inquiry now requires the Analysis Menu permission
//10. NRC Stopped amount tendered message when not cash in ModRecepitOthrSite
//11. NRC Forced weekly checkbox in ReservationIn to be checked and un-enterable if no Monthly billing plans in selection
//12. RWFR Added KSS specific rounding rules for credit percentages
//13. SMG Added Balance Brought Forward field for Transactions Tab.   
//14. RWFR Buybacks on 1 unit have KSS rounding applied
//15. RWFR InvAlertQty excluded from new permission check on inventory item enquiry
//16. SMG Changed Transaction Balance Bought Forward to text 'Open Balance as at <date>'.   Text label and field hidden when 1 month and 6 month filter not applied. 
//17. NRC Fixed Qty of 0 for Credits
//18. NGBW Added OK & New button to AnalysisIn.
//19. NGBW Fixed Select Folder window not appearing for Pay Refunds on MV with no refunds at Head Office.
//20. NGBW Fixed issue with logging in when using last build.
//21. RWFR Reverse Payment does not pick up default refund settings
//22. SMG Modified Storpay part payment setting checking code so that you are allowed to make part payments by default (this retains old behaviour) 
//23. NGBW Allowed selection of SMS notices to work again.
//24. RWFR Fixed errors in userlogins import
//25. RWFR Fixed System Setup syntax errors
//26. RWFR Fixed bug in primary phone selection
//27. RWFR Added primary phone selection for Sales Enquiries
//28. NGBW Fixed sorting issue on control screen.
//29. SMG Added ability to select a new Backup Destination Path
//30. NLT prevent user from tabbing to any other  pages in Agreement, Reservations and Other Credit Sales if customer name is not entered.
//31. RWFR Updated KSSUpgrade method
//32. RWFR Fixed size of button in startup form
//33. RWFR Fixed cutoff checkbox in reconcilenew
//34. RWFR Fixed wording for invoice fee alert
//35. NLT Fix GL report where reversal of prepaid figure includes GST
//36. NLT Change trial balance so all chart of accounts items appear on the report regardless of whether there were any transactions for those items or not.
//37. SMG Added ability to select a new Backup Destination Path
//38. SMG Modified Manual Backup to use Manual Backup Path setting as default folder
//39. SMG Added field to Backups tab to allow number of backups to keep to be set


//Changes in 9.1.0 06/10/09
//1. RWFR Fixed issue with changing billing plan in SelectUnitA
//2. RWFR Moved convert button up 1 pixel
//3. RWFR Fixed call centre dashboard label
//4. RWFR Fixed issue with duplicate PIN's
//5. RWFR Fixed StockIn analysis code selection
//6. NLT Fixed destination string smaller than source runtime error in creditsales method
//7. NLT Set Autopaytype for demo customers on autopay
//8. NLT Fix bug where reg rent field on front page could not be changed.  
//9. NLT Remove deletion of message other users menu item as was stuffing up quit menu item 
//10. NLT Fix sales enquiries so shows list of notes categories in notes section  instead of contact categories
//11. NLT Hide invoicing fee section on notice charges if invoice not set to be sent with notice
//12. RWFR Added stock transfer/receive system
//13. NGBW Fixed Unit Status report in Daily not printing landscape/setting lock status when overlocking.
//14. RWFR No Agreements to process message in daily disabled when running for multiple days
//15. NGBW Added permissions for Reverse Payment, Return Cheque, Stock Transfer and Stock Receive.
//16. RWFR Moveout for last agreement auto-clears PIN's now
//17. RWFR Disabled Paid to Date every showing on Credit Sale invoices (it would never be anything other than next bill date -1)
//18. RWFR Fixed display of Alert style boxes
//19. NGBW Added Permission Controls to MoveInCode for Reverse Payment and Return Cheque.
//20. NGBW Added Permission Controls to StockOut for Stock Transfer and Stock Receive.
//21. NGBW Added Sales Enquiry being created when Online Res created with Force Sales Enquiry option checked.
//22. NRC Added check in CheckUpdate to stop talking to SUV if a Traning.xml

//Changes in 9.1.0 30/09/09
//1. NGBW Fixed Customer Receipts not showing Reservation number and Units for reservation receipts.
//2. RWFR Fixed eventlog exceptions report array error
//3. RWFR Fixed text in Groups Tab
//4. RWFR Renamed Call Centre check box
//5. RWFR MerchPlanID starts with facilitycode by default
//6. RWFR Replaced RecordStatus with Actual Name on modusers
//7. RWFR Enabling complex passwords now forces password change
//8. NGBW Added extended description to refund related permissions re not affecting Reverse Payment or Refund Cheque buttons.
//9.  RWFR Updated recalc to ensure MiscDetls is always set correctly

//Changes in 9.1.0 29/09/09
//1. RWFR Added DisableTender field
//2. RWFR Set string length in GetKeyNo to 60
//3. RWFR Removed check of marketing types description in incorrect place in Cash Sales
//4. RWFR Disable amount tendered checkbox added in system setup
//5. RWFR Changed title of Unit Status Report in Daily to Lock List
//6. RWFR UnitStatus Report sets bDelete for batch & daily
//7. SMG Added functionality so Billing syncs Facility information with SU
//8. NRC Fixed display of  tickboxes in fourth tab of [facility]eventlog
//9. RWFR Added note to graphpie form explaining limits
//10. NRC Added additional check to inactive checkbox in AnalysisIn for checking if a code was inactive and used in other recurring charges
//11. NLT Remove GST from discount variance line on Key Stats report
//12. NLT remove alert saying could not contact MV Head Office for the bank balance during Bank recs
//13. RWFR Can now read sentinel output files
//14. RWFR LastMthsAdv set on creation of tutorial
//15. RWFR Changed Whole Dollars to Whole Amounts
//16. NGBW Fixed tax being recalculated incorrectly when changing to/from dates
//17. RWFR Fixed text on Unit Status report dialog
//18. RWFR Added TakePayment method to button
//19. RWFR Fixed alert message display
//20. RWFR Fixed display of tutorial tab 1
//21. RWFR Modify quote displays alert if no quote selected to modify
//22. RWFR Fixed alignment of date on waiting list output
//23. RWFR Fixed price format in quote
//24. RWFR Add to waiting list on output form defaults new enquiry to being on list
//25. SMG Change Notices screen - Changed Analysis Code selection from field entry to dropdown list
//26. RWFR Changed wording on enquiry alert message
//27. RWFR Fixed display of note on quote conversion
//28. NLT Fix waiting list so it shows after moveout
//29. RWFR Added link no support for sentinel
//30. RWFR Fixed select unit display issues
//31. RWFR Hid scrollbars in photo display
//32. RWFR Increased height of Transactions in Agreement
//33. RWFR Fixed zed text
//34. RWFR Fixed display of autopay amount
//35. NGBW  Fixed editing Receipt Analysis Codes causing Syntax errors.
//36. NGBW Fixed incorrect alert showing when editing Receipt Analysis GL Code.
//37. RWFR Gate PIN Minimum length is set to 6 by default
//38. RWFR Fixed display issue on first tab of system setup
//39. NGBW Fixed Reverse Payment button not reversing correctly.
//40. RWFR Resend button hidden if not yet sent
//41. NGBW Sales Enquiry automatically added to Waiting List if a quote has been set to be added.
//42. NGBW Fixed Alert Message for Sales Enquiries opening too small.
//43. NGBW Fixed Sort for Notes History in Contacts not working.
//44. NLT Set Previous, Next and Delete buttons to invisible on Unit input screen if accessed from the main control screen
//45. RWFR Various minor screen issues fixed
//46. RWFR New analysis codes have the facility code already in the box
//47. RWFR Disabled cancel button on Import Dialog if it is not usable
//48. NGBW Fixed issue with ADVAM possibly causing duplicate information to be saved.
//49. RWFR KSS Upgrade - Creates invoice fee if not already present
//50. NLT Keep track of prior billing plan so if moveout occurs before old billing plan runs out the moveout calc is based on the previous billing plan.
//51. SMG Modified Backup screen so that 'Perform Initial Backup' is no longer required.   Initial Backup now done when user turns on Backups.
//52. NRC Changed max characters of a sent SMS from 80 to 160 - previously letterhistory was only saving 80
//53. RWFR Removed message other users from standalone
//54. RWFR Gate system off by default in demo
//53. NRC Added check to MailMerge OK button to not continue with the merge if any of the selection don't have email addresses
//54. NLT replaced 4D "mandatory" error message for ChartAccts Description table with our own alertmessage.
//54. NRC StockIn TotAmt and TaxAmt now calculates when Qty is altered
//55. RWFR Updated ReconcileDetails form
//56. NRC StockIn analysis codes now add as the actual selection where before it would use the last selected

//Changes in 9.1.0 24/09/09
//1. RWFR Fixed default table issue with TakePayment
//2. RWFR Fixed up issues on new DRCEdit screen
//3. RWFR Added special icon for units on special
//4. RWFR/AAP Pop Auth & SMTP User/PWord is now a radio selection
//5. RWFR Receipts do not set drawer to facility when balance is negative
//6. RWFR CashSales correctly picks up Analysis Code Permissions
//7. RWFR Take picture ignores watch.wtc files
//8. RWFR Fixed error in arrears report when credits occured after receipts were used up
//9. RWFR Centered title on IORec Report
//10. RWFR Weekly/Monthly defaults to 0.2308 on new files, Insurance weekly/monthly does too now
//11. RWFR Updated complex password message to list all 4 possible types
//12. RWFR Renamed variable in alertmessage to vLeg17
//13. RWFR When going from Login to SetPassword it will not clear old password to prevent entering it twice
//14. RWFR Trigger details in Gate Setup only show for Falcon Direct (they don't work with anything else)
//15. RWFR You are required to enter the customer name before adding a unit to a reservation

//Changes in 9.1.0 22/09/09
//1. NGBW Added Bluemoon Integration.
//2. NRC Fixed problem with Contacts external email address not filling in "To:"
//3. NRC Removed Updater from File menu
//4. RWFR Fixed medium map opening wrong size
//5. RWFR Added RCFixedIncrl, RCPercentIncrL, RCOccDays, RCRoundRent, RCBillPlan & RCEmailAddress to the UnitType table
//6. RWFR Added new DRCEdit form
//7. RWFR Set TakePayment to specify a cancel button
//8. RWFR Updated UnitTypeIn with new fields
//9. RWFR Added RCDays, RCSpecial & BillPlanCode to the UnitType table
//10. RWFR Updated UnitTypeIn & DRCEdit form with new fields
//11. RWFR Updated RentControlUpdate to track days at occupancy level
//12. RWFR Updated RentControlUpdate to use new round setting
//13. RWFR Updated RentControlUpdate to check new days at occupancy level
//14. RWFR If email address is set RentControlUpdate will use this to notify rather than changing
//15. RWFR Added special field to vacant units report


//Changes in 9.1.0 17/09/09
//1. RWFR Set v8/9 password for Administrator to be the current one
//2. NGBW Fixed bug where "Backup" and "Processing" dialogs were hidden behind the Daily Processing window.
//3. SDD Income Charged Report - Now fixed and working correctly - problem caused by doing a Relate One in On Printing Detail - now use Set Automatic Relations
//4. SDD Custom Designed Reports - Now works correctly but only if you click on the main form window area before choosing a table in the form palette - another 4D Bug!!!!
//5. NRC Stopped unnecessary display of Qtyonhand field in AnalysisIn
//6. NRC Prevented Modify Faciliites showing in Central menu at site end
//7. NRC Prevented setting analysis codes to be inactive when they're in use as other regular charges in agreements
//8. NRC Hid upgrade password
//9. NRC Re-added footer to ConfirmTwo
//10. NGBW Fixed charges not adding in both ModCharges and MiscReceipts. Problem was 4D bug requiring * to be entered instead of reference in GET LIST ITEM call.
//11. NRC Fixed logos not being added to Letters printed in Daily
//12. NRC Added check of SMS Merchant details to ContactsIn that would not bring up the send SMS window if there were none entered
//13. NRC Added new button to ContactsIn to remove an enquiry from the waiting list
//14. NRC Ensured followup notes on calendar are removed when an inquiry is converted
//15. RWFR SKBilling will use single period descriptions
//16. RWFR If a customers status is changed to access allowed it will change the unit status from locked to rented
//17. NRC Changed message in CalcBalance advising of unmatched cash sales from a confirm with possible deletion to an alert and advising to contact support
//18. RWFR SKBilling will use single period descriptions
//19. RWFR If a customers status is changed to access allowed it will change the unit status from locked to rented
//20. NGBW Added &(<>sProduct="M@") to the Unit and UnitHistory triggers due to problem with National Accounts.
//21. NGBW Fixed printer not being set back to default when sending email Invoices.
//22. NLT Fixed Inactive and 'Don't show on banking report' analysis codes from appearing in the drop down list on the banking summary report.
//23. RWFR Vacant units with F2000 clear the extra PIN's on moveout and do not attempt to download again while vacant
//24. NGBW Fixed issue of OK button not working in Reservations.
//25. RWFR  If a customers status is changed to suspended at gate it will change the unit status from rented to locked
//26. NLT Stop Chart Accts bank balance getting set to zero if user at site end hits cancel
//27. RWFR Fixed select sites opening too small in analysis codes
//28. RWFR Take payment for other site shouldn't prompt for amount tendered if not cash
//29. NGBW Changed width of Bank Account fields.
//30. NLT Fix display of bank account display fields for Aust / NZ for MoveinNew, MoveinRR and ReservationsIn
//31. NGBW Hard coded max users for Training datafiles to 10 for Kennards - alternate method entered as feature request
//32. NRC Stopped vTotal doubling in ReservationIn when a unit was added
//33. RWFR Fixed late fees waived calculating as a negative
//34 SDD Fixed Custom Designed Reports completely using workaround of On Outside Call Cancel which is added to each output form
//35. NGBW Fixed Banking Summary dropdown not showing Analysis items with "Do not show on Banking Report" checked
//36. NLT Make new analysis codes accessible by all user groups by default
//37. RWFR Fixed invoice footer balance being incorrect
//38. NRC Corrected Amount column width in CashBookIncl
//39. NRC Changed window type in PrintSelection for PDF generation so it would not be hidden behind the Daily window
//40. NLT Prevent the adding of a user name which already exists in the userlogins table
//41. RWFR Added KSSUpgrade method
//42. NLT Stopped user from removing group permissions on analysis codes that have a special option attached (ie default for something)
//43. SDD Attempted to fix Login error by logging in as Administrator prior to trying to create the new user
//44. SDD Changes to Sales Commissions system - Added checkbox on UserLogins to show who is salesperson, this appears as array on Mod Charges, with addition of SalesCost, and CommSplit
//45. SDD Changes to Sales Commissions reports - Changed to Landscape with Legend & columns for SalesCost,Net Amount, and Comments
//46. SDD Still to do - note to self - add column for FirstTrxDate and subtotals for amts paid in prior months, auto calc SalesCost on Training
//47. NRC Contacts on waiting list now removed when either converted or declined
//48. NRC Improved wording on Autopayamt request message that appears during daily if this field doesnt match the amount to be billed
//49. NRC Added warning message to ReconcileDialog if bank rec is run from end different from that in [Facility]MVSite
//50. NRC Stopped ContactNo not showing in WaitingListOutput
//51. NRC Took out needless CheckUpdate when sending email in Daily
//52. NGBW Fixed View Emails from showing all Emails as being of type "In".
//53. NLT Fix bug in Overdues report where customer billed in advance with other regular charges were showing as overdue
//54 NRC Fixed 0's being displayed in BankAcct field for Agreements/Reservations when there is nothing entered and loses focus
//FEATURES
//1. RWFR Stopped removing a unit from an agreement when only one unit remains
//2. RWFR Only key stats category merchandise appear in cash sales now
//3. RWFR Added Bank Reconciliation Can't Modify Prior to date to stop unreconciling old bank rec's or adding new ones prior to that date
//4. RWFR Added Unit Type Category
//5. RWFR Added ability to filter by Unit Type Category
//6. RWFR Added ability to filter by Analysis Category
//7. RWFR Future dated moveins check is now controlled by the facility
//8. RWFR Added permission to ignore future dated moveins check
//9. RWFR Added option to refund other regular charges on moveout
//10. RWFR Added table to store insurance rates
//11. RWFR When adding insurance values or changing it pro-ratas
//12. RWFR When adding other regular charges or changing day to bill it pro-ratas
//13. RWFR TakePayment now prompts for agreement or reservation and allows you to search for agreement/reservation
//14. NLT Add new permission to allow (if on) or disallow users to credit back more than the system calculated amount on moveout.
//15. RWFR Added HTML email support to email merges, adding email notices, emailing invoices & emailing quotes
//16. NRC Added Thinc SMS integration
//17. NRC Added default special option in Analysis Codes for credit card merchant refunds
//18. RWFR Added primary phone number to PTD Agreements report and defaulted to landscape
//19. NLT Pay refunds - in reprocessing prior batches, allow user to select which date to reprocess for.
//20. NLT Pay refunds - location of batch files now selectable by the user.


//Changes in 9.1.0 18/08/09
//1. RWFR Fixed display of items on access control setup tab 1
//2. RWFR Fixed display of items on access control setup tab 2
//3. RWFR Fixed initarrays error for KSS datafiles
//4. NLT Fixed bug where detail line for reservations on income charged report did not show reservation number and repeated the customer name of the line before.
//4. SMG Billing Plans & Merchant Discount Plans Output form column separators - Used variable to display / hide separators as disabling text object had undesired results when opening a record from that list.
//5. SMG Automatic Backups details and associated messages were not displaying / hiding according to Internet backup status - now fixed.
//6. RWFR Fixed calculation of Agreement Discounts in CalcRentedValues
//7. RWFR RentRoll corrects for weekly agreements now
//8. NGBW Fixed Reservations screen showing two values for rental rate
//9. NGBW Added Next Record call to DailyAutoPay to advance the agreement that was being checked for CCAuthDate.
//10. NGBW Fixed issue with userlogin not showing when notes are added to Other Credit Sales
//11. NRC Stopped issue of tab focus changing when Previous and Next clicked in UnitIn, UnitTypeIn and NoticesIn
//12. NLT Make Reactivate Reservation button invisible if adding new reservation, fix row height of units on Mac.
//13. NRC  "Find Agreement" in FindDialog purple so changed it to be black
//14. NRC Prevented Unit field running into Size field in ReservationOut
//15. RWFR Fixed reusing of loop variable in LoadAnlysArrays
//16. RWFR Fixed display of 2nd description on Rental Rate Variation Report
//17. RWFR Fixed text of Bad Debts on Key Stats for KSS
//18. RWFR Fixed text display on Mac for MerchPlanIn
//19. RWFR Fixed sub-form display on UnitIn
//20. RWFR Renamed instances of Mail & Eventlog to Email & Eventlog
//21. RWFR Fixed non-userid userlogins still being present on upgrade to 8.1.0
//22. RWFR Removed un-needed "printer could not be switched to" error message
//23. RWFR PDF printer check no longer run on server
//24. NRC DeleteAgreement form method has had code added to stop the repeating of customer names and modification causing the names to change on the correpsonding form
//25. NRC InitArrays asCategories has been modified to reflect the changed menu items for Maintenance
//26. SDD Customer Balances Report - When run on MV it does not do the CalcBalance routine on the server.
//27. SDD Run Daily in separate process to fix problem on Client/Server where Credit Card selection is lost during DailyAutoPay
//28. NLT Updated list of fields available in Modify Facilities / copy settings button
//28. NRC Fixed issue in ModQuote where clicking on asUnitType would not register by replicating code from object method in asUnitDesc
//29. NLT Set filter to prevent non-numeric characters being entered to bank account / bsb fields 
//30. NRC Changed 4 permission names in InitArrays to match their respective descriptions
//31. NGBW Fixed SelectCustomer form display issue
//32. NGBW Set the Call Centre module to be available for all customers - not just MV.
//33. NGBW Fixed Sales Enquiry background
//34. NGBW Set it so "Log other users off" doesn't log all users off, but rather goes by username
//35. NGBW Changed wording on Find User dialog
//36. NLT ??????
//37.  NLT change way Activity MktgEmailsSent and  MktgLettersSent is tallied, so goes off Letter table rather than Contacts table.  Also change triggers for Contacts / Letters tables, for KSS Key stats
//38. NRC Changed 4 permission names in InitArrays to match their respective descriptions
//39. NLT Fix bug where notice layout could not be selected when adding an individual letter to an agreement
//40. NRC Notice Plan 9 now able to be added to letter history when print form is used
//41. NGBW Made StorerCheck URL in System Setup>Merch Info clickable
//42. NGBW Fixed font of Details textfield in Cash Sales
//43. NGBW Fixed Custom Fields with no data from showing in Reservations
//44. NGBW Changed label from "Marketing Survey opt-out" to "Marketing opt-out" in Agreements and Reservations
//45. NGBW Set Custom Fee in Agreement to be invisible if [Facility]AccessFee is false
//46. NGBW Added Transaction History dropdown to Reservation form
//47. NGBW Fixed Accounting options in System Setup so they actually worked
//48. NGBW Changed references for Accounting system dropdowns so they would work
//49. NGBW Added Maximum Refund value test field to System Setup
//50. NRC Made Marketing and Note category dropdowns visible only if they are filled in Types & Categories
//51. SMG Changed 'Show All Transactions' in Transaction Tab of Agreement and Reservation Screen to 'Include Transactions from x Other Agreements / x Reservations
//52. NGBW Changed Invoice Setup option for "Show ABN on invoice" to a country specific value
//53. NGBW Changed Arrears Report calculation to take arrears from last unpaid charge, rather than last non-positive balance +1
//54. NGBW Set notice plan dropdown to not list notice plan 9
//55. NGBW Added date field for Dynamic Rent Control history
//56. SMG Modified LogMonLoopCode so that Online Reservations Cancellation Email only goes out if the Reservation itself is able to be deleted.
//57. SMG Modified Tab Control Array definition and initialisation to be performed on 'On Load' rather than when doubl-clicking on record - wasn't being run when adding new RIR.
//58. SMG Added 'Input' variables of Web Service 'Server' methods into Compiler_Web 
//59. SMG Changed method properties of Web Service methods that return private or commercially sensitive info so that they are not included in the WSDL
//60. NLT Fixed missing 'e' in message in On Startup
//61. NLT Fix Bill next charges dialog where 'Bill Pro Rata Rent' label sitting by itself
//62. SMG Fixed bug where opening Agreement with inactive Billing Plan and sort Order greater than the number in Billing Plan array, generated Array Range Check Error 
//63. SMG Fixed bug where Storer Check would fail when using Firefox on Windows XP - the WebURL would not translated spaces in the filesystem filename
//64. NGBW Fixed Arrears Report looping if sum of transactions not equal to customer's balance
//65. NGBW Fixed display of Monthly/Weekly Rate on inactive agreements.
//66. NRC Prevented saving of record in ModReceipts and ModReceiptOtherSite when amount tendered was less than total receipt amount
//67. NLT removed all references to char(165) and replace with "â¢" character
//68. NLT Fixed destination is smaller than string bug on adding or deleting an email to a sales enquiry
//69. NLT Fixed bug on movein when there is less than 4 analysis codes for a facility
//70. NLT Fix bug in Unit Activity report where agreement and customer not printing
//71. RWFR Fixed login issues
//72. RWFR Fixed Marketing Info not showing correctly
//73. NGBW Fixed bug for Kennards that was calculating sales of Used Items at cost price.
//74. NLT Fix bug where unit rate on reservation screen was doubling
//75. NLT Cash sales - remove enter card button if no merchant processer set up
//76. NLT Fix bug where ok button disappeared on cash sale if cancelled out or entered credit card details.
//77. NLT Allow more than one cash sale to be entered at the same time.
//78. SMG Added variable declaration and initialisation to UpdateReceipt method for when a Web Process calls the method - if not present then Web Process fails
//79. RWFR Fixed contacts sms button using wrong mobile number
//80. RWFR Fixed cash tendered area display issues
//81. SMG Changed Inventory Item Inquire functionality so that Analysis Codes that are in an Analysis Category work correclty.   Now, no Analysis Code is selected by default and therefore no Transactions are queried or displayed reducing initial loading time.
//82. RWFR vTotal in Cash Sales updates On Data Change rather than On Clicked
//83. SMG Fixed losing [UnitType] values when editing the [Unit] values in 'List' mode on the Agreement screen.   Using the 'On Getting Focus' Form Event.
//84. NRC Added Quit to LoginChange
//85. RWFR Fixed Reactivate Sales Enquiry not setting follow up date
//86. SMG Fixed bug in cancelling Online Reservation causing Notice not to be saved and LogMonServer crashing
//87. SMG Fixed where double clicking Agreement with Unit numbers that form a substring of other Units displays screen with multiple Agreement records to choose from e.g. 100, 1000, 1001
//88. NGBW Fixed drop down on ModReceiptOthrSite so it was clickable.
//85. NRC Altered vLeg1 in MoveOut to display balance owing to customer as it did in v4
//86. NLT Change wording of 'Old Agreements' on customers / agreements screen to 'Inactive Agreements' - same for reservations
//87. NLT Set Moveout calc / buttons to invisible if agreement already moved out.
//88. RWFR Fixed Key Stats Title alignment
//89. NLT Fixed bug where prompting user to save modified email
//90. NLT Fixed days overdue so is set to zero if agreement balance <=0 
//91. RWFR Fixed Analysis Code Permissions
//92. NLT Fixed bug where if last trx for an analysis code is a refund it sets the whole amount to be a withdrawal on the bank rec
//93. NLT Widened daily processing screens so 'Continue' button in same place as 'Process' button (instead of same place as 'Cancel' button.
//94. NRC Prevented View Access Log menu item from Customers disappearing when MV product code is present
//95. NGBW Allowed 9 digit GST numbers for NZ.
//96. NRC When finding Reservations by ReserveNo, prevented it searching all sites when the option wasnt ticked
//97. NRC Changed default view of asAgreemt in CreditSaleOut to show Regular(active) credit sales
//98. NLT Fixed bug where prepaid jnl being created above header line every second time revenue journal was created.
//100. NLT Updated alert, confirm, request messages
//101. NGBW Fixed Arrears Report to be alot faster and the balance to be accurate if selecting "Balance Owing is older than xx days".
//102. SMG Fixed error message that appeared when displaying Other charges popup menu on Agreement Screen.   Added Form Event=on clicked condition.
//103. NLT Fixed vtUnits variable error on Vacant Units report
//104. NLT Fixed screen size of Search by Formula window
//105. NLT If adding a new email set Resend button to be invisible
//106. NGBW Adjusted position of PrintQuote header information
//107. NGBW Fixed MYOB Revenue Journal Export issue for StandAlone.
//108. NLT Fixed moveable footer on confirm, request and alert message boxes
//109. SMG Added use of Transactions to Unit Input form - cancelling now works.
//110. RWFR If UnitNo = "" loadgateunits will not try to download to gate
//111. RWFR If bill next rent is turned on and only send if balance is greater than 0 it uses the current balance + next rent to calculate
//112. NLT Fixed bug where undo last charges not working for other regular charges where more than one regular charge with the same analysis code (Mark Greig).
//113. RWFR Fixed Bank Rec not ignoring inactive codes
//114. RWFR Fixed Bank Rec ignoring analysis group permissions
//115. RWFR On creation of new datafile analysis codes are set to allow everyone access
//115. RWFR On creation of new tutorial datafile analysis codes are set to allow everyone access
//115. RWFR On import of analysis codes they are set to allow everyone access
//115. RWFR On import of data analysis codes are set to allow everyone access
//116. RWFR Edit Groups button renamed bNextPage instead of bNext
//117. NRC Grouped buttons in UnderRentedDialog form
//118. NRC Fixed Next and Previous not working in UnitIn when History tab selected
//119. NRC Fixed Quicktime url to be correct
//120. NRC Removed path length check in ExportData
//FEATURES
//121. NGBW Added search filter for Notes History
//122. RWFR Added map refresh every 10 seconds when not editing map
//123. NRC Added checkbox to System Setup which by default hides CC details on AutoPay Report
//125. NGBW Added permission for excluding an agreement from Dynamic Rent Control.
//126. SDD For v11 have added new method called Set4DUser which is called after Login and sets the Current User to be the same as the [UserLogin]Name to enable triggers to work correctly.
//NOTE FOR DEVELOPERS:  When uncompiled it will not create a 4D User for every Name in the [UserLogins] table, otherwise our developer structure will become clogged with lots of unwanted users
//so please don't run the main development code in Compiled mode and then log in as various other users, as this will NOT be helpful.
//127. RWFR Replaced the QFree plugin with 4D's inbuilt Regex command
//128. SMG Fixed where Rent Increase Rules would be recalculated with every click of the mouse, not just when you changed record or opened Preview tab for the first time.
//129. SMG Corrected Customer output form record highlight and column header graphic
//130. SDD 25/06/09 Projected charges report modified to exclude Agreements where Moving Out
//131. NLT Made change to projected charges report to include actual income as well as projected, and is run for 12 month period from date specified.
//132. NLT Added 12 customisable buttons to front screen.
//133. NGBW Added Consolidated Occupancy Report.
//134. NGBW Added Agreement Number to Income Charged Report.
//135. NGBW Added option to Rental Variation Report to exclude agreements that have a rental increase pending.
//136. NRC Added new fields for MailSuburb, StreetSuburb and AltSuburb and adapted Customer Analysis Report to report on mail and alt
//137. RWFR Added HTML Email to View Mail section
//138. RWFR Added periodic billing method to billing plans
//139. RWFR Added InquiryPrintNew form
//140. Enabled copying of SKBilling.xml file in 'Preferences' folder on the server to the 'Preferences' folder on the Client.
//141. SDD For Billing - Added  fields to ModCharges for Sales Person and Comm Paid Date - these are actually reusing the fields Drawer & DateBanked which are both only used for receipts, and not charges.
//142. SDD For Billing - Added new method called SalesCommReport to produce sales reporting for Storman Billing - this connected to More Reports menu,
//143. NGBW Set Unit Selection screen to be one form instead of two.
//144. NRC Sales Enquiry Reporting added to Reports menu
//145. NGBW Added separate permission for Adding/Deleting Credits/Refunds.
//146. NLT Add ability for customer to opt-out of email marketing by clicking an unsubscribe link
//147. RWFR Removed remaining & signs from menus
//148. NRC AuthorizeNet CIM Storman integration implemented

//Changes in 8.1.0 xx/06/09
//1. RWFR Fixed check of units selected when converting from sales enquiry
//2. RWFR Removed set plain command from calender code
//3. RWFR Removed stray bracket from MerchPlanOut
//4. RWFR Fixed broken border in RentIncreaseRules subform
//5. RWFR Removed unneeded Old Sync Method option
//6. RWFR Changed options for StaffPin's section of userlogins
//7. RWFR Fixed FTP window size
//8. RWFR If customer not entered apageno resets to 1
//9. RWFR If cancel is selected on printing Unit Activity report it no longer prints
//10. RWFR aPageNo is set on opening RentIncreaseRules
//11. RWFR Disabled selecting units on RentIncreaseRules tab 2
//12. RWFR Removed Old Sync Method option
//13. RWFR Fixed missing next on Staff Pins
//14. RWFR Gate section is hidden in userlogins if option disabled
//15. RWFR Backup to Internet window size fixed
//16. RWFR Reservations/MoveIn resets aPageNo to 1 if no customer selected warning comes up
//17. RWFR Unit Activity Report print cancel actually cancels the print
//18. RWFR Entered proper facility details for HK,SP & SA
//19. RWFR Analysis codes display issue fixed
//20. RWFR Disabled double click on second tab of rent increase rules
//21. RWFR Fixed display detail code being set to go on clicked for account inquiry
//22. RWFR Highlight on front screen fixed
//23. RWFR Changed text to do with Rent Changes in Unit Types
//24. RWFR Fixed jumbled tutorial text
//25. RWFR Fixed horizontal scroll bar in reservations
//26. RWFR Disabled double click on Unit Types tab 3 - was causing display issues
//27. RWFR Userlogins printout updated
//28. RWFR Customer Analysis Report now sets facility
//29. RWFR Rental Rate Variation Report dialog fixed
//30. RWFR Clear Old Letters/Old Sales contacts now adds warning that these are for adminsupport only
//31. RWFR Print Eventlog no longer loses selection if you cancel it
//32. RWFR Fixed text display issues in Access Control
//33. NGBW Changed Stylesheet for "Repeat Last Dates" on Reciepts form
//34. NGBW Adjusted alignment of dropdown in Cash Sales
//35. NGBW Modified Bill Plan list display issue
//36. NGBW Set Email Merge to require selected customers before allowing to begin
//37. NGBW Fixed Unit Status Report window size
//38. NLT Added progress indicator to Unreconciled trx report and changed date on report header to show current date if run from the menu.

//Changes in 8.1.0 09/06/09
//1. NLT Add new batch refund format for Kennards (added in v4 16/2/09)
//2. SMG Modified 4D Backup interface so that it works more reliably.   Removed some unnecessary features.
//3. NLT Sales inquiries - widen window so output form opens without horizontal scrollbar.
//4. NLT Fix destination string smaller than the source error on loading waiting list from Customers menu.
//5. SMG Fixed process reading Backup Preferences file from looping endlessly, and also returning error messages to calling process.    
//6. NLT Pay refunds - various changes for KSS output file - include 12-16 bank acct length for Aust
//7. NLT Pay refunds - allow ability to include trx previously labelled as 'BadAc' in new selection to refund
//8. NLT Fix bug where cancel button doesn't cancel when holding down shift key and clicking on print invoice 
//9. SMG Added '[Contacts]Organization' field for Individual / Organisation StorerCheck functionality
//10. SMG Added Storer Check functionality to Sales Inquiry, Reservations, and Other Credit Sales screens, Modified StorerCheck method to handle Contacts (Sales Inquiries) and to limit Last Name to 2 characters.   Had to Add Organisation / Individual selection to several screens.
//11. SMG Added code to LogMonLoopCode method to check for Reservations made Online within the last 10 minutes, that do not have any payment Transactions = no deposit paid.   If found delete.
//12. SMG Added Field to Facility Table - System Setup -> Online Prefs, to allow Facility to require immediate payment of Deposit for any Online Reservations.
//13. SMG Added Field to Reservation Table - Reservation Date - so that we can tell if the Reservation was made in the last 10 minutes.
//14. SMG Added Field to Reservation Table to identify if the Reservation was made online.
//15. SMG New Datafile dialog, adjusted window size for new form size
//16. SMG SaveBackupPrefs was causing Facility record to become unloaded when exiting the Facility (System Setup).    Added 'Load Record' at the end of method to resolve this.
//17. NLT Fixed text box on take payment at other site screen
//18. NLT fix bug in LogMonLoopCode where invoice number at HOF was being reset to -5 every time server was restarted.
//19. NLT Separate BSB & Account number for KSS in Pay Refunds method and remove line feed character from export. 
//20. SMG Fixed System Backups screen
//21. SMG Modified AdvamDD so that a 'Request.txt' and 'Response.txt' are created for each step of the DD process.    e.g.  Initialise step will create 'RequestI.txt' and ResponseI.txt" files.    Query step will create 'RequestQ.txt' and 'ResponseQ.txt' files
//22. NGBW Set "Apply Formula" name on [Facility]ApplyFormula form to non-enterable.
//23. NGBW Changed Letter Graphics menu item to read "Notice Graphics" and same with dialog title.
//24. NRC Changed menu item "Mail & Event Log Setup" to "Email & Event Log Setup in all relevant menus in our products.
//25. NRC Changed "Active Reservns" in dropdown on main Reservations screen to "Active Reservations"
//26. NGBW Adjusted new datafile and tutorial>choose country screen size
//27. NRC Changed "Notices" in header of Rent Increase Rules screen accessible under Maintenance menu to be "Rent Increase Setup"
//28. RWFR Fixed adding of $0 discounts for SK Billing
//29. RWFR Other Regular Charges now follow SK Billing Method
//30. RWFR Renamed View Actual Permissions to View Effective Permissions
//31. RWFR Userlogin Keypad zone hidden when gate system not managed through users & groups
//32. RWFR Timezone is set to 1 when converting to Reservation/Agreement from Sales Enquiry
//33. RWFR Fixed vLeg1 no longer being needed for non-Falcon gate systems
//34. NRC Made Add and Remove Attachment buttons in Email Message window invisible if there is already an attachment on the message.
//35. RWFR Set PrintNarration field to replicate
//36. NRC Omitted $ from number format for 2 fields in Add Receipt screen that were showing incorrectly in UK data file.
//37. SMG Changed parameter definitions in 'Compiler_Methods' for the method 'CheckEmailAddr' to have String lengths of 80 (previously 50) - this will prevent "Destination string smaller than source..." error.
//38. SMG Changed Array variable from aAnalysis to aPrepaidAnalysis in methods - RentInAdvance, CalcAgedDebtors, IORecReport, CalcRentAdvance, Form method [Agreement]RentAdvance, and added corresponding entry in Compiler_Arrays
//39. RWFR CashReceived & Change fields set to match receipt value when not-cash and set to non-visible.
//40. RWFR SendSMSAdvam method has logic errors fixed for sending reference
//41. RWFR SendSMSField always passes a reference now
//42. RWFR Stopped unticking include transactions from resetting banked date
//43. RWFR Added 2 second pause between PDF generation during daily
//44. RWFR Text functionality restored for moveout when undoing last charges is suggested
//45. RWFR Removed Print List that was incorrectly added to Merchandise Discount Plans
//46 RWFR Fixed query for Analysis Categories to count Analysis Codes using it
//47. SMG Changed Object name of Text "Card Information (From Reader)" on swipecard form so that it hides when Card Read is not available.
//48. SMG Print EventLog - hid progress indicator when applying the printed date to the EventLog records after printing.
//49. SMG Billing Plans - Disabled (hid) column separators (slashes) when records aren't present
//50. SMG Inventory Inquiry - Disabled (hid) column separators (slashes) when records aren't present
//51. RWFR Added variable weblink for Bill/Undo last charges
//52. SMG Added condition to dropdown menu to allow the user to select 'None' Gate System Type
//53. SMG Error displayed when closing email message opened by button 'Open Highlighted' on front screen - now assigned open window to window reference variable 
//54. RWFR Added LettersPrint method and print button in letter history now uses this
//55. SMG Modified Backup Prefs Reading / Writing to use [Authenticate] table as transfer mechanism.
//56. NRC Changed instances of "$" showing in UK data file to be that of no symbol to adhere to the accepted standard in the rest of the program.  Also altered the number formats in these cases to be standardised and correct.
//57. NLT Change Prepaid Rent Report to Prepaid Report - on menu item, report title and x 3 logging options which referred to it.
//58. NRC Changed more instances of currency symbols showing in various screens and changed them to be that of no symbol.  Including DP Summary, Modify Details in DP, Units, Inventory Item Purchases/Inquiry, Other Cash Sales, Other Credit Sales, Chart of Accounts, Cust Receipts/Charges, Unit History, Reservations and Agreements.
//59. NLT Change Invoice and Receipt setup window to say it is also for receipts, change title of screen to say receipt instead of receipts, to be consistent with menu item.
//60. NRC Fixed Recalc Balances instructions screen which was not showing after a recalc was done.  Was caused by an If in the form method of ImportDialog causing the screen to be invisible so commented it out.
//61. NRC Appended "..." to end of [Quote]Note in output form in Sales Inquiries if a note is longer than 20 chars in an effort to compensate for the notes being cut off entirely if longer than column width.
//62. NRC Changed instances of currency symbols showing in Other Cash Sales to be that of no symbol to standardise.
//63. NRC Set Photo Compression Setting text in Agreement to be invisible by default to prevent permanent overlaying of the text when displayed and now it only shows the setting selected.
//64. NRC Added additional scroll box to ApplyForm to account for change in v11.  New box contains Assigned Values and are hence without the preceeding unecessary table name.
//65. RWFR MerchPlan table now syncs
//66. NRC Fixed problem of add and delete attachment buttons not displaying on new outgoing email messages.  Visible was set to false.
//67. NRC Improved wording of warning message that displays when selecting autopay in an agreement which already has send invoices  x days prior set.
//68. RWFR Footer balance now uses variable vFooterBal instead of vBal
//69. RWFR PrintInvRecCode now calculates vFooterBal
//70. NLT Fix bug where cannot open HOF agreement from control screen at the site the agreement has the unit.
//71. NRC Moved Done buttons in the bottom of several output forms to the left slightly to prevent the button showing as extended across the screen.  Also altered the margin in the form properties for these to stop the black bar extending in the same way.
//72. NGBW Changed all Alert, Confirm and Request dialog calls to the new AlertMessage, ConfirmTwo and RequestMessage respectively.
//73. NGBW Fixed Undo Last Charges with Show Reversal Transaction for sites with Add Tax enabled.
//74. NRC Changed object type in various output forms from Rectangle to Picture to solve the issue where the selection bar would go outside the windowed areas.
//75. NRC Slightly reworded Last Daily message
//76. NRC 'You entered' field dimensions in SelectCust  altered to stop characters like g being cutt off at the bottom.  Also slightly moved 'Create brand new Customer' button to the left to stop it being cut off.
//77. RWFR When a unit is set to vacant in F2000 it now sends a delete user for the extra PIN's
//78. NRC Changed wording of ExportData message to be clearer and added a browse button to save the export in a sub folder named "DataExport".  Also added a message to notify user when Export is Complete or Cancelled.
//79. RWFR Updated dashboard image to remove incorrect logo
//80. RWFR Added warning if customers credit card already processed during daily
//81. NRC SelectCust had an unnecessary horizontal scroll bar  so shifted things across to prevent that from showing.
//82. NLT TotInsUnpaid set in DoBillNext so that during daily this field prints on letters
//82. NRC UnitTypeOut selection bar going outside boundary of window so changed object type from Rectange to Picture to fix.
//83. NLT Fix conversion rate for consolidated Key Stats report to include conversions for the entire period reported on and print date range of report.
//84. NGBW Added dropdown for Notice Plan selection on Agreement form.
//85. NGBW Fixed issue with ConfirmTwo dialog causing issues with Bill Next Charges by changing button names on Bill Next Charges form and methods to ones different to what is used in the ConfirmTwo dialog.
//86. NRC Changed number format in SelectUnitType to omit the $ for MonthlyRate
//87. NLT Fixed bug where Reverse Deposit was not happening on moveout.
//88. NGBW Set Inventory Count Form to prompt whether to print Active, Inactive or All Stock Items.
//89. NLT Fix bug where weekly rates not calculating correctly on Rental Rate Variation report.
//90. SMG Completed Online Reservations Version 2
//91. RWFR ORes extra settings fields hidden when not needed
//92. RWFR Fixed subform moving when clicking on IncrFrom
//93. NRC Fixed issue in data files that were set to have tax added where adding a stock item in a cash sale from hlList would not add tax.  Needed to copy check from asChargeDesc to hlList to get it add tax correctly
//94. NRC Corrected issue of unnecessary display of dividing line and heading relating to DRC in UnitTypeIn by setting the 2 respective objects to be invisible when DRC set to off
//95. NRC Made Ok and Cancel buttons visible in RequestMessage in Daily.  Also fixed display of grey box in same window which was being caused by the wrong type of box being used so have changed all boxes in Daily to the correct type
//96. NGBW Have fixed the Undo Last Charges with only Other Regular Charges on Other Credit Sales agreements.
//97. NRC Altered screen height dimension for View Photo in AgreemtInclNew to prevent need to scroll.
//98. NLT Increased length of CCAuthNo field to 8 chars and change PayRefunds method for Kennards only so batch number includes a 4 digit year
//99. SMG Updated Online Reservations so that Online Reservations are able to be used up to 1 month past their Upgrades Paid To date.    
//100. SMG Update Online Reservations so that both License Entitlement (Use Online Reservations) and preference to use Online Reservations are both taken into account.
//101. SMG Changed CheckUpdate (UpdateStormanProgram) so that the Storpay URL is updated to Storman upon license update connection
//102. NRC Altered screen width dimension in ApplyForm to get rid of grey bar on right
//103. NRC Set default value of aCustCode drop down in UnitIn on load to be the first in the sort order of UnitType whereas before it would not have a default
//104. SMG Modified Merchandise Discount Plans output form so that the column separator only appears when there are items in the list.
//105. RWFR Removed unused last sent/time variables in text in Mail & Eventlog setup
//106. RWFR Allowed _ in usernames/passwords for CC/DD/SMS
//107. RWFR Corrected welcome text on dashboard
//108. RWFR Corrected Unit text on dashboard
//109. RWFR Hid map icon when not required
//110. NLT Fix bug where swapping billing plans changed the PTD
//111. NLT Fix bug where New Amt for Other regular charges was outside the box
//112. NLT Set password box to clear after typing incorrect password.
//113. NLT Fixed Destination String smaller than source bug when switching refund types in System Setup
//114. NLT Change menu item name from View Mail to View Email
//115. NLT Add ability to send message to users on other 4D /Storman clients: both for Dev and for Central
//116. SMG Modified StorerCheck method to use different folder on Mac to make less complex path for StorerCheck.html file.
//117. NLT Added Consolidated Insurance Rpt to Central menu (Planet).
//118. SMG Online Reservations - Corrected Deposit Amount where Analysis Deposit amount wasn't being taken into account unless an error message had been displayed
//119. SMG Online Reservations - Added checking of URL so that Online Reservations V1 URL would not break it.
//120. SMG Online Reservations - If Compulsory payment option selected, and Storpay available, change button name from 'Reserve another Unit' to 'Cancel Reservation and Reserve another Unit'.
//121. NGBW Fixed textbox size of "Qty In" value as it was cutting off the value.
//122. NGBW Fixed Rental Rate in Agreement having two lots of text
//123. NGBW Fixed customer details from showing in several forms eg. Customer Reciepts etc.
//124. NGBW Modified width of date column in Daily Processing
//125. NGBW Changed a label showing <vtUnitsCap> in PTD report
//126. NGBW  Changed the text shown in the popup when refund type is changed, so that the text of the button is not cut off
//127. NGBW Fixed black box at the bottom of Customer Receipts screen from stretching across window
//128. NRC Fixed Contacts.slk importing upon starting a new demo by adding ContactNo to Output form and corresponding .slk file
//129. NGBW Added alert to gate log if customer is granted access by gate system, but is denied by Storman
//130. NGBW Changed entry order on ConfirmTwo and Request dialogs so it defaults to far right button
//131. NRC Reworded button title of "Check Availble Unit's" in ContactIn to be correct
//132.  NLT Change wording of tutorial intro to only say self storage if product is for self storage; if another product then refers to other products as well.
//133. NLT Fix bug in LogMonLoopCode where throwing up error message set does not exist.
//144. NLT Change window dimensions for Other Credit Sales screen to fit form properly.
//145. NLT Fixed bug on opening Payment Inquiry menu item
//146. RWFR Non-Date Specific Occupancy report now takes account of billing plan discounts correctly
//147. RWFR Updated SKBilling method to take account of free months when adding other regular charges
//148. RWFR Updated SKBilling method to bill all discount at the end if seperated out.
//149. RWFR Updated Dynamic Rent Control for Unoccupied Units to not save the sub-record if no rent change took place
//150. RWFR TrxListSort now obeys same behaviour as expected when manually selecting dropdowns
//151. RWFR MiscReceipts/ModCharges/ModReceipts methods now obey same behaviour as manually selecting dropdowns
//152. RWFR LoadMiscAnlysArrays now takes account of analysis code permissions
//153. RWFR On ModCharges/ModReceipts forms On Clicked form event changed to also take account of On Data Change
//154. NLT Fix currency symbol not saving for individual sites on a Central datafile.
//155. NLT Widen edit group button on Analysis code input form so can see it.
//156. RWFR Removed analysis code variable on SelectQuote and replaced with new field AnalysisDescription
//157. RWFR Restored missing graphics on SelectQuote
//158. RWFR Made sub-form on SelectQuote focusable
//159. RWFR Added invisible button on SelectQuote allowing you to click anywhere in the row to select it
//160. RWFR Made OK default on ConfirmTwo to match ConfirmThree
//161. RWFR Made entry box on RequestMessage slightly higher
//162. RWFR Quotes area of ContactsIn now have correct style sheet
//163. RWFR Fixed StyleSheet issues on [Facility]ModUsers
//164. RWFR Expanded Creator Field on Agreement forms
//165. RWFR Set all remaining vpGradiant variables to be type Picture
//166. RWFR Fixed placement of rectangleBG on sub-forms in Agreement
//167. RWFR Sent/Read now displays correctly in emails
//168. RWFR Reverse Payment button re-added
//169. RWFR Fixed mis-sized figures on the key data section
//170. NRC Disabled multiple selection in SelectCustomer and SelectUnit/SelectUnitType
//171. RWFR Allowed 7 digit invoice numbers to display correctly
//172. RWFR Removed additional exclamation mark from low disk space warning
//173. RWFR Changed low disc space warning to warn when below 1GB rather than 5% or 300MB (5% of modern disks can be quite large!)
//174. NRC Prevented display of currency symbol in SelectQuote
//175. RWFR Rearranged Notices screen to show Notice Plan No clearly
//176. RWFR Fixed incorrectly coloured and sized text on Staff PIN's screen and removed border setting on sub-forms.
//177. RWFR Added missing line to floating windows to draw Marina background
//178. RWFR Fixed date display on Auto Rent Increase form being cut off
//179. RWFR Fixed various fields not displaying correctly on RentCalcNew form
//180. RWFR Added code to set button text on RentCalcNew form
//181. RWFR Removed pointless radio buttons from Startup form
//182. RWFR Fixed missing array value on Startup form
//183. NRC Moved Field2Gate object in UnitIn to the left to be aligned with others when Falcon gate system not selected


//Changes in 8.1.0 16/02/09
//1. NLT Change apply formula to include the table name field - is mandatory in Apply to Selection command in 4D v11 and will error otherwise.
//2. SMG Added Storer Check Account information fields to System Setup.   Completed 'StorerCheck' method so it did something
//3. SMG Adjusted Form Entry Order for System Setup screen.   Set tooltips for Storer Check fields.  
//4. SMG Made Storer Check verify licence entitlement.
//5. NLT Add fields 21,23,24 to TriggerLog Activity so Total No. / Company / Vacant Units etc get sent from site to HOF after Daily
//6. SMG Inserted checking for Direct Debit Analysis Code into 'Daily'
//7. SMG Inserted checking of BSB number and length of Bank Account Number at start of 'DailyAutoPay'
//8. SMG inserted checking of BSB number and length of Bank Account Number just before processing is started - preventing processing of Agreement if info is missing
//9. NLT Added smaller sized Consolidated banking report with 10 columns
//10. NLT Fixed bug in consolidated banking report where deposit taken to bank not calculated properly
//11. SMG Added Country-specific URLs for Storer Check production processing
//12. SMG changed tooltip for Credit Cards and Letters email icon
//13. SMG Modified 'Add Receipt' screen form entry order
//14. NLT Fix Auto Rental Increase from canceling out after step one when editing a unit type
//15. SMG Inserted 'On Load' form event on Storer Check button making it invisible if there are no Storer Check Account details entered
//16. SMG Inserted code into Form method to make Storer Check Licence details fields invisible if not available in that country
//17 SMG Added code in DD processing methods to use 'Live' Server when not a test account.   Created 'ErrorWS' method to trap Web Service errors
//18. SMG Added entry filter of '&"a-z;0-9;@;."' to Merchant Info and Options screen for Account Username and Password fields, to prevent Carriage Returns, strange characters etc 
//19. RWFR Fixed change required/amount tendered being missing from MiscReceipts/ModReceipts/ModReceiptsOthrSite
//20. RWFR Added 4 new permissions re: refunds/$0
//21. RWFR Prevented modification of transactions to $0 without the required permission levels
//22. RWFR Added MaxRefund,PasswordLength,ComplexPassword,MinDaysPassword,MaxDaysPassword to Facility Table
//23. RWFR Added MarketingOptOut to Customer Table
//24. RWFR Added Category to NotesHistory Table
//25. RWFR Added Password Change date to Userlogins Table
//26. SMG Changed GetKeyNo (method) String length of $0 and $1 to 60 from 50 in Compiler_Methods method.
//27. SMG Changed OR_HandleURL method so that when an image is requested it is served appropriately.
//28. SMG Made Use Online Reservations and Use Storer Check options alterable by AdminSupport and Designer Only
//29. SMG Changed Merchant Account Detail fields to use the entry filter of '&"a-z;A-Z;0-9;.;-;@"' - previous filter prohibited uppercase letters
//30. SMG Corrected Country-specific URLs.   Changed generated HTML page to use Country-Specific URL variable instead of fixed Test Server URL.   Added code to ensure that the Facility Licence / Settings were retrieved from the correct Facility Record
//31. RWFR Login method & SetPassword updated to take account of new password control fields
//32. RWFR Added code to check permission to give refunds greater than facility Max Refund
//33. RWFR Added code to check permission to give refunds when balance is not in credit
//34. RWFR Added code to check permission to give refunds greater than credit balance
//35. RWFR Added Notes History categories to Marketing Types and Notes screens
//36. NRC Changed wording of clear status change flag dialog during DP to be more clear
//37. SMG Online Reservations - Fixed 'QuotedValue' value when creating Online Reservation
//38. SMG Online Reservations - Made code obey [Facility]UseOnlineReservations selection
//39. SMG Online Reservations - Made HTML not lose Weekly/Monthly setting when an error is displayed on UnitTypes display screen
//40. SMG Online Reservations - Displayed error when Date in past entered on first Web Page
//41. NLT Add Waiting List feature
//42. SMG Changed 'CheckVersion' so that the Storman Version checking error message displayed the Version number in the correct format.
//43. SMG Changed 'SelectPDFDoc' method so that if $i=4 it verifies that Windows is being used.    Causes problems if testing Windows' Customer Datafile on a Mac 
//44. SMG StorerCheck - Prevented Storer Check from running on Server
//45. SMG StorerCheck - Fixed when Client and not logged on not finding Facility record.
//46. SMG StorerCheck - Removed Date Of Birth search criteria being sent through if date not entered in Customer record
//47. SMG StorerCheck - Corrected inability to create temporary HTML file on Macintosh
//48. SMG StorerCheck - Prevented Storer Check appearing in Customer menu when not available in that Country - available in AU, NZ, and UK only
//49. SMG Other Cash Sales - tBoolean variable WAS set to True after Printing Other Cash Sales Receipt and was finding Charges instead of Payments when returning to List - forced this to False - Transaction.TransOut.bPrint
//50. RWFR Made some small form changes
//51. RWFR Set aPageNo to 1 on load of NoticesIn
//52. NRC Fixed Central menu for Rent Rite sites where some of the menu options were disappearing when selecing a site from the side bar


//Changes in 8.1.0 07/11/08
//1. AAP Added dropdown box to [BillPlan]BillPlanIn in the place of the field 'Swap to plan-code on BillPlan End'. Drop down to show the name of the billing plan (more user-friendly).
//2. AAP Added field on [BillPlan]BillPlanOut to show # of periods plus period type (ie. week or month). A developer will need to make some adjustments to get it working though.
//3. AAP Fixed height of 'owing' variable (viOwing) on Tab 0 of [Agreement]CreditSaleIn form - was not compeltely visible due to height of only 10px.
//4. AAP Added more height to the "Other Recurring Charges" section on [Agreement]CreditSaleIn (Tab 0) - Note: form was copied-up from [Agreement]MoveInNew.
//5. AAP Modified look & feel of [NotesHistory]AgreemtInclIn to new style.
//6. AAP Made minor textual changes to [Facility]Batch form.
//7. AAP Made icon change to [Facility]Change form.
//8. AAP Redesigned [Facility]ClientSetup form with new style. Screen size changed, and thus, may require some code adjustment by a Dev member.
//9. AAP Redesigned [Facility]ImportDialog form with new style. Screen size changed, and thus, may require some code adjustment by a Dev member.
//10. AAP Redesigned [Unit]MultiplyUnits form with new style. Screen size changed.
//11. AAP Made icon change to [Unit]UnitStatusDialog form.
//12. AAP Redesigned [Unit]UnitOut form with new style. Screen size changed.
//13. AAP Redesigned [Facility]SwipeCard form with new style. Screen size changed. Robert should hide the description when swipe-card-reader is disabled.
//14. AAP Redesigned [EventLog]EventLogIn form with new style. Screen size changed.
//15. AAP Redesigned [Agreement]CreditSaleIn form with new style. Screen size changed - someone from Dev will need to adjust it accordingly so it opens correctly.
//16. AAP Redesigned [Agreement]Daily form with new style.
//17. AAP Redesigned [Agreement]UnitHistOut form with new style.
//18. AAP Changed size of [Unit]MultiplyUnits form again - was too thin for the design. Dev may need to adjust code to ensure it opens correctly.
//19. AAP Redesigned [Analysis]AnalysisOut form with new style.
//20. AAP Redesigned [BillPlan]BillPlanOut form with new style.
//21. NLT Lengthen Contacts MarketSrce description to 30 chars to match Customers and Marketing Types description lengths
//22. NLT Add DisableAutoIncr field to Agreement table to be used to prevent Auto rent increases occuring for specific customers
//23. NLT Add option to recalculate the Activity table when changing the Week End day under System Setup 
//24. NLT Allow $0 transactions - done in Bill Next charges and during Daily Processing.
//25. NLT Prevent user from using the Banking Report to change the date banked on a receipt with a transaction date prior to the CantModPrior to date
//26. AAP Redesigned [AgreementDisplayAgreemt form with new style. Screen size changed.
//27. AAP [ChartAccts]ChartAcctsOut form with new style.
//28. AAP Redesigned [Contacts]ContactsOut form with new style. Form opens too small; someone from Dev will need to adjust size in code.
//29. AAP Redesigned [Customer]SelectCust form with new style.
//30. AAP Redesigned [EventLog]EventLogOut] form with new style.
//31. AAP Redesigned [Facility]FacilityOut form with new style. Unable to test, due to no MV menu being available to me on Design server.
//32. AAP Redesigned [Facility]FacilityOutShort form with new style. Unable to test, due to no MV menu being available to me on Design server.
//33. NLT Modified Export Receipts for QB so picks up different bank account details for different facilities if MV.
//34. AAP Redesigned [Agreement]ModDetails form again. Form opens too small; Dev will need to adjust size in code. Also needs a variable added.
//35. AAP Redesigned [Activity]EditActivity form with new style. May need to be tested...
//36. AAP Redesigned [Cashbook]CashbookOut form with new style. Needs a description though - NLT?
//37. AAP Redesigned [GateLoh]GateLogOut form with new style. No data to test with though.
//38. AAP Redesigned [MarketingTypes]MarketingTypesOut form with new style.
//39. AAP Redesigned [Message]MessageOut form with new style.
//40. AAP Redesigned [Message]MessageIn form with new style. Size will need adjusting!
//41. AAP Redesigned [Notices]NoticesOut form with new style.
//42. AAP Redesigned [Notices]RentRulesOut form with new style.
//43. AAP Redesigned [Reservation]ReservationOut form with new style.
//44. AAP Redesigned [Supplier]SupplierOut form with new style.
//45. AAP Adjust size of [PhotoCards]Input form.
//46. AAP Redesigned [Transaction]StockIn form with new style.
//47. AAP Redesigned [UnitType]UnitTypeOut form with new style.
//48. AAP Redesigned [Facility]SelectUnit form with new style. Size needs adjusting!
//49. AAP Neatened the [Facility]Backup screen.
//50. AAP Updated [Facility]Tutorial form & resized it. May need adjusting in code?
//51. AAP Finsihed redesign of [Facility]EventLog screen.
//52. RWFR Added Merchandise Discount Plans fields & code
//53. AAP Redesigned [Facility]GateSetup form with new style.
//54. AAP Redesigned [Facility]InvSetup form with new style.
//55. AAP Redesigned [Agreement]DeleteAgreement form with new style.
//56. AAP Redesigned [Journal]JournalOut form with new style.
//57. RWFR Created new form called [Facility]SetAddressStyle.
//58. AAP Redesigned [Facility]SetAddressStyle form.
//59. RWFR Added new configure button on [Facility]InvSetup form, which opens the [Facility]SetAddressStyle form.
//60. RWFR Converted a number of radio buttons and checkboxes on [Facility]InvSetup to dropdowns to save space.
//61. NLT x 2 changes to Income Occupancy Reconciliation Report to fine-tune the calculation and remove negative prepaid when EOM date is close to next bill date
//62. NLT Lengthen account number for Great Plains export, ExportRecJnls
//63. NLT Remove creation of header row for each journal when creating Great Plains Receipts export; one header row per file created.
//64. NLT Change pay refunds method so if facility not supported via bank method it will only display 1 alert box instead of alert for every transaction.
//65. RWFR Added Category to Contacts printout
//66. RWFR Added notices selection to Send TXT in a customer
//67. RWFR Added ability to disable a notice when balance is less than or equal to 0
//68. RWFR Added ability to only send a notice by letter (still allows SMS with the letter though)
//69. RWFR Added ability to have the header selected only display on emailed invoice while the printed ones are blank
//70. RWFR Button added to reactivate reservation
//71. RWFR Fixed take as rent not setting vtReverse
//72. RWFR Button added to reactivate sales inquiry
//73. RWFR Rounded vBal to 2d.p. on printing AP Form
//74. RWFR Added option to only allow one unit per agreement/reservation
//75. RWFR Added option to allow for unlimited waived late fees & 0 now allows for none
//76. RWFR Added 4 new permissions
//77. RWFR Demo now logs in as Admin by default
//78. RWFR Fixed selection on agreement list
//79. RWFR Added button to eventlog tab to send customer to support
//80. RWFR Disabled sending customer to support from MV as it sends whole eventlog
//81. RWFR Added question do restart syncing when using the turn syncing on/off menu item
//82. RWFR Added option to control whether Part Payments reset the late cycle, options are Ask, Yes, No or Disable
//83. RWFR Added Part Payment code to Take Payment from Other Site (was using old code)
//84. RWFR Added payments total for Rent Rite
//85. NLT Restrict GLCodes for Receipt Analysis codes to 5 characters
//86. RWFR Added code to allow for conversion of reservations into existing agreements
//87. RWFR Updated Merch Plan Discounts to have quantity
//88. RWFR Added generic gate system to the options
//89. RWFR Added field to record cash received and added a variable which calculates change
//90. RWFR Added option to disable setting to OnSite in gate log reading
//91. RWFR Altered Bank Report message to ask if it's their final banking report for the day
//92. RWFR Added Variable to show when next invoice/reminder notice for the customer is due
//93. RWFR Added Show History dropdown and code to support it to Agreement
//94. RWFR Added default for Show History into System Setup
//95. RWFR Added Show History dropdown and code to support it to Reservation
//96. RWFR Renamed [BillPlan]Inactive to [BillPlan]KioskInactive
//97. RWFR Added [BillPlan]Inactive
//98. RWFR Added code to hide billing plans when inactive = true and the billing plan is not currently being used by the agreement
//99. AAP Redesigned [Analysis]AnalysisIn form with new design.
//100. AAP Redesigned [Analysis]StockInquiry form with new design. **YAY item #100!!**
//101. AAP Redesigned [Cashbook]CashBookIn form with new design.
//102. AAP Redesigned [ChartAccts]AccountInquiry form with new design.
//103. AAP Redesigned [ChartAccts]ChartAcctsIn form with new design.
//104. AAP Redesigned [ChartAccts]ReconcileNew form with new design.
//105. AAP Added new footer-element to [Agreement]MoveInNew, [Agreement]MoveInRR, [Agreement]CreditSaleIn, [Customer]CustomerIn and [Contacts]ContactsIn forms.
//106. AAP Redesigned [ChartTotals]ChartTotalsIn form with new design.
//107. AAP Redesigned [Customer]OtherSelectCust form with new design.
//108. AAP Redesigned [Customer]OtherSitePmt form with new design.
//109. AAP Redesigned [EventLog]PrintLogDialog form with new design.
//110. AAP Redesigned [Facility]Calculator form with new design.
//111. AAP Redesigned [Facility]DateRangeDialog form with new design.
//112. AAP Redesigned [UnitType]UnitTypeIn form with new design.
//113. AAP Redesigned [Facility]Startup formagain, also with a newer design.
//114. AAP Redesigned [UnitType]SelectUnitType form with new design.
//115. AAP Redesigned [Unit]UnitIn form with new design.
//116. AAP Redesigned [Unit]SelectUnit form with new design.
//117. AAP Redesigned [Unit]OtherSiteUnitList form with new design.
//118. AAP Resesigned [Transaction]ReconcileDialog form with new design.
//119. AAP Redesigned [Transaction]ReconcileDetails form with new design.
//120. RWFR Added ability to charge custom access fee for gate access
//121. RWFR Added ability to charge invoice fee
//122. RWFR Logmonloop code now sends datacheck logfiles
//123. RWFR Added Arrears, Income Occupancy Reconciliation, 90 Day Cash Actual & RV History report to Batch Print or Email
//124. NLT  Added UpdateActivityOff field and logging for overnight process (exists in all prior versions)
//125. RWFR Added Vacant Units Report to Batch Print or Email
//126. RWFR Re-enabled Rent Increase Pending & Length of Stay Report  & Rental Audit Report to function in Batch Print & Email
//127. RWFR Added stars next to reports on [Facility]Batch where the report can only ever be printed as at the current date & time
//128. RWFR Added Project Charges, Insurance Owing, Stamp Duty (or Depreciation Schedule), Autopay, lien status report, anticipated moveouts & inventory pricing report to batch print or email
//129. SMG Added Outgoing parameter to CheckUpdate - Number of Active Units
//130. SMG Added WS_GetWebPaymentStats - So we can Query number of Internet Payments for YTD, MTD, Date Range
//131. AAP Redesigned [Agreement]FindDialog to make use of radio buttons instead of push buttons *** SOMEONE FROM DEV WILL NEED TO MAKE THIS WORK ***
//132. SMG Method "ExportMYOB", Compilation error, had to make a data type assumption and corrections accordingly in line 222 and 223.
//133. SMG Modified WS_AddReceiptTrx to handle the receipt of Reservation Payments
//134. SMG Added code to handle Online Reservations, includes HTML pages in 'Web/Reserve' folder
//135. SMG Added parameter to CheckUpdate method to receive licence parameter 'UserOnlineReservations'
//136. SMG Added WS_GetReservationInfo method to allow SU to retrieve the login details
//137. SMG Modified WS_GetAgreementInfo method to correct Web Service parameter definitions
//138. SMG Added fields to System Setup / Online Prefs to allow Online Reservations to Function, to allow the Facility to be listed for Online Reservations Web Page.
//139. SMG Added fields to Unit Types to allow to include Units of this Unit Type in Online Reservations system
//140. RWFR Mac's now use second page of [Facility]Tutorial
//141. SMG Added vLateResetCycle variable declaration in method 'UpdateReceipt' to "+"prevent web process crashing when variable undeclared
//142. SMG Added interprocess variable to track whether a user is logged in or not.   Certain alert messages will be prevented from displaying if this is false
//143. RWFR Added analysis code selection to BillPlan and Notices Invoice Fee
//144. RWFR Added storman.com.au, storman.co.nz and stormansoftware.co.uk to list of emails only storman emails downloads
//145. SMG Re-implemented Auto Screen Locking (Formerly Auto Logout) based on Mouse Movement and Key presses.   Added field [Facility]AutoLogoutOnInactivity which when false any mouse movement or key presses cancel the timeout.
//146. SMG Lengthed the Printed Quote field on the '[Quote]PrintQuote' form as per Bug 1489
//147. SMG Expanded the Date & Time field on the Control Screen to give extra space to display date fully - Changed Display Format to 'mm/dd/yyyy Forced'

//Changes in ??? 
//1. NLT Depreciation schedule for Rent Rite changed so if enter 100% depreciation it depreciates full amount immediately


//Changes in 20.0.97 03/02/20
//1. RWFR Fixed Timezone issue with emails

//NLT Change made 24/4/09 - Create setting for non-syncing Central so check activity gets run at HOF.

//Changes in 7.2.18 06/04/09
//1. NLT recalc balances after the deletion of a take payment at other site transaction
//. NLT Add the eventlog code field to the syncdecode and syncgetevents methods so event type is replicated with the the eventlog record (for elog exceptions report).
//????3. SMG Added '[Contacts]Organization' field for Individual / Organisation StorerCheck functionality
//????4. SMG Added Storer Check functionality to Sales Inquiry, Reservations, and Other Credit Sales screens, Modified StorerCheck method to handle Contacts (Sales Inquiries) and to limit Last Name to 2 characters.   Had to Add Organisation / Individual selection to several screens.
//5. NLT Add total balances to Trial Balance report
//????6. RWFR Added South Africa support
//????7. RWFR Hid 0 or < 0 balance agreements from end of late cycle report
//????8. RWFR Unit being set to vacant should force gate update at site now
//????9. RWFR Email merge creates letters in letter history
//????10. RWFR FIxed incentive on Move In not working with Bill Each Unit Seperately
//????11. RWFR Fixed display issue with incentive on move in
//????12. RWFR Fixed display issue with fixed discount amount
//????13. RWFR NZ AP forms always display 3 digits now, all NZ banks seem to be doing it that way
//????14. RWFR Fixed bug with eventlog tab causing changes to be lost
//????15. RWFR Add refund defaults to 0 when balance owing is positive
//????16. RWFR Extended length of mrktsrce to 30
//????17. RWFR Fixed customer analysis defaulting to position 0
//????18. RWFR Prevent sort order of 0 for Unit Types
//????19. RWFR Only notices with emails setup appear in email merge
//????20. RWFR Rental increases report has a cancel button now

//Changes in 7.2.17 ???
//???1. NRC Updated Entry Order on Agreement & Reservation forms on tabs 2&3
//???2. RWFR CalcBalances & UpdateAgreeBal now only include unmatched transactions when calling RecalcUnpaid
//???3. RWFR UpdateReceipt now excludes Charges when calling RecalcUnpaid & have moved the call to the bottom of the method to prevent it affecting any other calculations when called by a web process
//???4. RWFR Moved charging of OtherRegularCharges before swap to new billing plan occurs
//???5. NRC Fixed Central menu for Rent Rite sites where some of the menu options were disappearing when selecing a site from the side bar
//???6. RWFR Added prompt to save unrecorded note when closing a sales inquiry
//???7. RWFR Latest Overnight XML settings copied from v4
//???8. RWFR Excluded EventTable = 0 from Agreement EventLog results
//???9. RWFR Changed Print this Letter/s to Print/Email this Letter/s
//???10. RWFR Fixed trading as multiplying for Quotes on repeated printings
//???11. RWFR Fixed incorrectly enterable fields on ModDetails
//???12. RWFR Removed unused SK Advantage setting from affecting UK datafiles
//???13. RWFR Door Open/Closed events should now display for Storlogix
//14. NLT Fix bug in take payment at other site MV report where facility from and to not displaying correctly
//????15 RWFR Added port option for POP & SMTP server's
//16. NLT Fix bug in Unit History where records keep changing to last record in the list when click on the change status button
//????17. RWFR Changed GetDNS to point to su.storman.com for SUV2
//????18. RWFR Removed checking for messages on SUV2
//19. NLT Add Trial Balance report for Spare Room 
//20. NLT Add Facility Shortname field to License tab so can be edited for standalone sites where needed for GL exports
//????21. NLT Add ability to export to Sage Accounting package - Revenue, Receipts, Prepaid Journal
//22. NLT Change name of Cashbook Accounts menu item to Chart of Accounts
//????23. NLT Fix bug where cancel button doesn't cancel when holding down shift key and clicking on print invoice 
//????24. RWFR Auto-logout only occurs when a user is logged in
//????25. SMG Added EventArchive code, then removed.    Modified SearchPalette method to remove the 'EventArchive' table from the table selection in CDR


//Changes in 7.2.16
//1. RWFR Fixed re-calculation of Late Fee Waived
//2. SMG StorerCheck - Prevented Storer Check from running on Server
//3. SMG StorerCheck - Fixed when Client and not logged on not finding Facility record.
//4. SMG StorerCheck - Removed Date Of Birth search criteria being sent through if date not entered in Customer record
//5. SMG StorerCheck - Corrected inability to create temporary HTML file on Macintosh
//6. SMG StorerCheck - Prevented Storer Check appearing in Customer menu when not available in that Country - available in AU, NZ, and UK only
//7. SMG Other Cash Sales - tBoolean variable was set to True after Printing Other Cash Sales Receipt and was finding Charges instead of Payments when returning to List - forced this to False - Transaction.TransOut.bPrint


//Changes in 7.2.16 09/02/09
//1. RWFR???
//2. SMG ???
//3. SMG???
//4. SMG ???
//5. SMG ???
//6. SMG ???
//7. SMG ???
//8. SMG???



//Changes in 7.2.16 30/01/09
//1. RWFR Set InsuranceAgentType to 3 in Tutorial
//2. RWFR Fixed bug with timezones greater than 16
//3. NLT Swap MYOB Prepaid journal lines so credits prepaid account and debits rental fees, plus minor adjustments for standalone
//4. RWFR Fixed new port system including port in address
//5. RWFR Fixed MV login allowing incorrect logins to close the login window

//Changes in 7.2.16 28/01/09
//1. RWFR Fixed multiply units checking maxunits after saving
//2. RWFR Changed [Letters]SMSMessage to text from string
//3. RWFR Limited additional gate users to 10 for Falcon/F2000
//4. RWFR Can now set port web services are on
//5. RWFR Fixed initial tutorial creation not logged in as Admin
//6. RWFR NoticeSent is now logged to the eventlog

//Changes in 7.2.16 22/01/09
//1. SMG Changed 'CheckVersion' so that the Storman Version checking error message displayed the Version number in the correct format.
//2. SMG Changed 'SelectPDFDoc' method so that if $i=4 it verifies that Windows is being used.    Causes problems if testing Windows' Customer Datafile on a Mac 
//3. RWFR Removed check on Ref Field for Notices in DailyPrep
//4. RWFR Added check for if Show Incentive on Invoice is ticked in Billing Plans
//5. RWFR Altered SKBilling discount creation

//Changes in 7.2.15 19/01/09
//1. RWFR Added Tax Inclusive/Exclusive message to Quote Print
//2. RWFR Fixed missing variable on Print GateLog
//3. RWFR This Week and This Month now use actual start of week/month
//4. RWFR Changed wording slightly on set banked message
//5. RWFR Fixed incorrect variables on Unit form when selected from Control Screen
//6. RWFR Fixed credit value altering qty on hand wrong way
//7. RWFR Sales converting to agreement adds deposit values


//Changes in 7.2.15 09/01/09
//1. RWFR Fixed reservation total always using monthly
//2. SMG Online Reservations - Fixed 'QuotedValue' value when creating Online Reservation
//3. SMG Online Reservations - Made code obey [Facility]UseOnlineReservations selection
//4. SMG Online Reservations - Made HTML not lose Weekly/Monthly setting when an error is displayed on UnitTypes display screen
//5. SMG Online Reservations - Displayed error when Date in past entered on first Web Page
//6. RWFR Fixed reservation to agreement conversion
//7. NLT Add BankAcct and BSB / Sort Code fields to the Customer import form.
//8. NLT Fix printing of sales inquiries in date range not working
//9. NLT Change format of QB revenue export for UK sites to include VATCODE and VATAMOUNT
//10. NLT Modify CreateRevJnls method  so RF account # shows on prepaid journal for non-Central facility
//11. NLT Modify ExportMYOB method so tax code for Debtors account for non-mulitivew facility is N-T
//12.NLT Allow 12-16 digit bank account numbers for Pay Refunds batch for Australia
//13. NLT Remove reference to UpdateActivityOff field in LogMonLoopCode, process not to run for MV
//14. RWFR Altered discount display and sorting for Billing

//Changes in 7.2.14 11/12/08
//1. RWFR Fixed problem with Unit EndDates

//Changes in 7.2.14 10/12/08
//1. RWFR Fixed errors on Dep Schedule
//2. SMG Changed Merchant Account Detail fields to use the entry filter of '&"a-z;A-Z;0-9;.;-;@"' - previous filter prohibited uppercase letters
//3. SMG Corrected Country-specific URLs.   Changed generated HTML page to use Country-Specific URL variable instead of fixed Test Server URL.   Added code to ensure that the Facility Licence / Settings were retrieved from the correct Facility Record
//4. NLT Add GL Report to reports menu
//5. NRC Changed wording of clear status change flag dialog during DP to be clearer


//Changes in 7.2.14 03/12/08
//1. SMG Changed OR_HandleURL method so that when an image is requested it is served appropriately.
//2. SMG Made Use Online Reservations and Use Storer Check options alterable by AdminSupport and Designer Only
//3. RWFR State/County now allows spaces
//4. RWFR Fixed State/County alignment in System Setup
//5. RWFR Added additional fields to Dep Schedule

//Changes in 7.2.14 28/11/08
//1. RWFR Enabled # character in Agreement box in Print/Invoice Receipts
//2. RWFR Analysis codes in Cash Sales uses same ordering as rest of program
//3. RWFR Removed AD+ to prevent problems with synccreatecust
//4. RWFR Fixed quote syntax error when using hlList
//5. RWFR Fixed Digigate offering Timezones editor
//6. RWFR Increased AnalysisCategory to 30 characters to match with Marketing Types description
//7. RWFR Demo logs in as Admin by default now
//8. RWFR Quote selection requeried after using Check Available Units
//9. RWFR Updated new billing plan code system
//10. SMG Changed GetKeyNo (method) String length of $0 and $1 to 60 from 50 in Compiler_Methods method.

//Changes in 7.2.13 19/11/08
//1. SMG Added code in DD processing methods to use 'Live' Server when not a test account.   Created 'ErrorWS' method to trap Web Service errors
//2. RWFR Added Update complete message when update is done on server

//Changes in 7.2.13 13/11/08
//1. NLT Add fields 21,23,24 to TriggerLog Activity so Total No. / Company / Vacant Units etc get sent from site to HOF after Daily
//2. SMG Inserted checking for Direct Debit Analysis Code into 'Daily'
//3. SMG Inserted checking of BSB number and length of Bank Account Number at start of 'DailyAutoPay'
//4. SMG inserted checking of BSB number and length of Bank Account Number just before processing is started - preventing processing of Agreement if info is missing
//5. NLT Added smaller sized Consolidated banking report with 10 columns
//6. NLT Fixed bug in consolidated banking report where deposit taken to bank not calculated properly
//7. RWFR Changed UK to use sq ft on key stats
//8. RWFR Fixed search for negative invoice number not working when not using search all sites
//9. SMG Added Country-specific URLs for Storer Check production processing
//10. RWFR Facility dropdown on sales enquiries should only show when more than one facility is present on datafile
//11. RWFR If no units for the quotes chosen are available it will warn before converting to res/agreement
//12. RWFR Moved screen resolution check till after initialise
//13. SMG changed tooltip for Credit Cards and Letters email icon
//14. RWFR Transaction printout now uses same address layout as invoices
//15. RWFR Printout of Sales Enquiries now obeys settings from screen (followups/all etc plus ordering)
//16. RWFR Marketing Types now prompts you if you wish to delete before copying
//17. SMG Modified 'Add Receipt' screen form entry order
//18. NLT Fix Auto Rental Increase from canceling out after step one when editing a unit type
//19. RWFR Fixed weekly billing when doing manually
//20. RWFR Added balance to res import, new regular rent & incr from to agreement & unit import
//21. SMG Inserted 'On Load' form event on Storer Check button making it invisible if there are no Storer Check Account details entered
//22. SMG Inserted code into Form method to make Storer Check Licence details fields invisible if not available in that country

//Changes in 7.2.13 11/11/08
//1. RWFR Fixed some remaining cases where spelling was Sales Inquiry for non-US
//2. RWFR Facility Phone format only applies to mobile numbers in the US & Canada
//3. RWFR Adjusted screen layout for address
//4. SMG Adjusted Form Entry Order for System Setup screen.   Corrected tooltips for Storer Check fields.  
//5. SMG Made Storer Check verify licence entitlement.


//Changes in 7.2.13 10/11/08
//1. RWFR Added Unit Type to ModQuote instead of it's own page
//2. RWFR Updated Import Text for Customer
//3. RWFR Query destination is restored when changing StaffPIN's
//4. RWFR When using auto-bill plan swap other regular charges are now recalculated
//5. RWFR Shortened length of special options names
//6. RWFR Fixed error on max/min amount when multiple items are chosen in Cash Sales
//7. RWFR Always gives login prompt on reset date warning
//8. RWFR Display of SeqNo in ModCharges & ModReceipts should always be positive
//9. SMG Enabled Storer Check functionality.   Created Dialog box ([Customer]StorerCheck) to display error when Storer Check details are not entered
//10. RWFR Added Individual/Organization field
//11. RWFR Increased length of License Country field

//Changes in 7.2.12 06/11/08
//1. RWFR Fixed multiple week/bill each unit seperatly problem
//2. RWFR Increased display area of notes in sales inquiries to accomodate 80 characters
//3. RWFR Added title to normal Customer Import & removed Import UK form
//4. RWFR Renamed rego to reg
//5. RWFR Added salutation to CreditSaleIn, MoveInRR & ReservationIn
//6. RWFR Text set to Postcode, Sales Enquiry for non-US Countries (ZIP Code & Sales Inquiry in the US)
//7. RWFR Text set to County for UK & Province for Canada (remains State elsewhere)
//8. RWFR Moved order of City/State/PostCode
//9. RWFR Added salutation option to reservations
//10. RWFR Lengthened Country on last page of System Setup
//11. RWFR Fixed CrdSale not opening on Control Screen
//12. RWFR Added Title to Contacts Table, AltTitle & DateofBirth to Customer Table

//Changes in 7.2.12 31/10/08
//1. SMG Uncommented out code for DD Exports (DailyAutoPay) - files are written to in called method.   Original problem of files attempted to be closed when they were never open handled instead by checking the Document reference - if Document Reference = !00:00:00! (Time variable) then a document has not been created and will not be closed.
//2. RWFR Removed $ sign from Quote page
//3. RWFR Phone & Fax Number on Invoice follow Facility Phone Format
//4. RWFR Increased Facility Fax Number to 25 characters to match Phone
//5. RWFR Fixed using SendMail in DailyAutoPay, now uses CheckMail once for all daily

//Changes in 7.2.12  28/10/08
//1. NLT Set Other Regular charges Amount / NewAmount so checks is not set higher than max value on Analysis codes
//2. NLT Fix bug where unable to sell inventory item if min and max values set.
//3. SMG Lengthened the Printed Quote field on teh '[Quote]PrintQuote' form as per Bug 1498
//4. SMG Expanded the Date & Time field on the Control Screen to give extra space to display date fully - Changed Display Format to 'mm/dd/yyyy Forced'
//5. NLT Fix billing plan fixed amount discounting bug where discount amt being doubled.
//6. NLT Fix UnitNumeric - needs to be unique when adding units using 'Multiply Units' button.
//7. NLT Fix currency symbol for UK datafile on invoice where choosing to show the balance due
//8. NLT Fix bug in printing of notices for different notice plans where notice description is the same 
//9. NLT Set refunds in MYOB receipts export to be negative amounts
//10. SMG Added Storer Check Username / Password settings / fields
//11. SMG Corrected errors with Advam Direct Debits where the [Customer] Table record selection was being lost.   Also XML file had incorrect folder delimiter for the Mac OS - Fixed.
//12. RWFR Fixed ReconcileNew referring to old permissions system
//13. SMG Changed [Customer]BSB to Alpha(6) from LongInt - Added entry filter to restrict to numeric entry - Added checking on Data Change to alert when length is greater than 0 and less than 6 - if the BSB is "0" then set to ""
//14. SMG Modified call to Advam Direct Debits to reflect change of Field type from Longint to Alpha(6).  i.e. From string([Customer]BSB;"###-##0") To Substring([Customer]BSB;1;3)+"-"+Substring([Customer]BSB;4)
//15. NLT Change tax code for line items on Prepaid journal and tax code for Customer Receivables line item on Rev Jnl for export to N-T for MYOB

//Changes in 7.2.11 16/9/08
//1. NLT Add Title field to Customer table - to Customer input form and MoveinNew form on Customer Info 1 screen
//2. NLT Add customer import for UK to include Title.
//3. SMG Re-implemented Auto Screen Locking (Formerly Auto Logout) based on Mouse Movement and Key presses.   Added field [Facility]AutoLogoutOnInactivity which when false any mouse movement or key presses cancel the timeout
//4. NLT Make sure only one header on MYOB receipts export, - fixes date error message on import, and remove extra carriage returns in export
//5. NLT Fix re-exporting of receipt data for MYOB so it only exports the specific dates entered and not related periods.
//6. NLT Fix bug in MYOB rev export where Rev Journal would only export correctly every second time.
//7. NLT Fix bug on control screen where  customer names and reservation numbers were not appearing on control screen; For loop used $j variable but used again when inserting elements to an array.

//Changes in 7.2.11 11/9/08
//1. SMG Added to code in Customer Mobile Phone Number to correct the format and add Country Prefix only if there is an SMS Service Provider Account details are entered
//2. NLT Replace 'Date From' with date range on output list under Accounting / Customer Receipts 
//3. NLT Add Ability to print Customer Receipts from Accounting / Customer Receipts
//4. RWFR Auto-login now checks for manager permissions at head office
//5. RWFR Stopped users creating blank staff pins
//6. RWFR Discount amount on switch to new billing plan is now calculated correctly
//7. RWFR Allows Timezones up to 99 now
//8. RWFR Search for invoice numbers over 1000000 works now
//9. RWFR Leading 0's are now blocked for Digigate (i.e. all of them now)
//10. RWFR Checks for presence of PDF printer on start up to prevent crashes
//11. RWFR Altered Prepaid Rent Category tooltip
//12. RWFR Lengthend vAgreeUnit to 20 in AgedDebtors
//13. RWFR Added missing semi-colon to staff pins download query
//14. NLT Add Facility name to Class ID in receipts export
//15. SMG Added Interprocess variable to store when a user is logged in.   Certain Alert messages are not displayed if noone is logged in.
//16. NLT Fix date bug in future rent increases report (form method DailyRentIncrease)
//17. NLT Exclude units where movein date = lastinc date from Last rent increases report (RentIncrReport)
//18. RWFR Added AutoEmailCC to DailyAutopay
//19. SMG Added SMS timeout field to the SMS details.   Min 15s, Max 65s, Def 15s.   Changed message when Storman fails to receive receipt from Advam.
//20. NRC Set column headings in Maintenance-Units to be un-eneterable.
//21. NLT Add ability to export cash accounting trx to QB, split by income type.
//22. NLT Fix bug where Bank rec report on first printing did not include transactions added during the bank rec process.
//23. NLT Added MYOB receipts export
//24. RWFR Added UK Changes
//25. RWFR Default BillPlan sort order is now 1
//26. NLT Fix bug where on display detail was showing the last record in the list when clicking an included form in the Bank Rec window
//27. NLT Prevent user adding Analysis codes ending in DP, IN, RF or LF as should be reserved for deposits, insurance, late fees and rental, otherwise stuffs with figures

//Changes in 7.2.11 5/08/08
//1. NLT QB receipts export - Changed export of refund transactions so they come off the debtors total and also come into QB as a negative
//2. RWFR Auto Email CC uses current time as trx time was always 00:00:00

//Changes in 7.2.11 31/07/08
//1. RWFR Fixed SK Billing
//2. RWFR Fixed discount amount is now displayed accurately
//3. RWFR Fixed find for Storman Appliances
//4. RWFR Fixed date in daily for manual DD
//5. RWFR Added new permission to be exempt from waived late fees

//Changes in 7.2.11 30/07/08
//1. RWFR Receipts when not changed from default should be for the correct facility now when using search all sites
//2. RWFR Increased $2 & $Key to length 10 (was 9)
//3. RWFR Email Addresses now support all characters per RFC 2822
//4. RWFR Added Facility Bank Acc No format for UK
//5. RWFR Added Customer Bank Acct format for UK
//6. RWFR Fixed InvRecNarrow searching for Transaction AgreeNo = 4 when it should of been 9
//7. RWFR Added support for SK Billing method
//8. RWFR Altered permissions to take into account new page in system setup
//9. RWFR Only LateCycleStDate and PaidToDate notices check against the MinBalForArrears now
//10. RWFR Fixed incorrect calculation being used when adding new unit from dashboard and default billing plan was weekly
//11. RWFR Made changes to fix problem with setting PDF-XChange 3.0 on Vista
//12. SMG Modified WS_AddReceiptTrx to handle the receipt of Reservation Payments
//13. SMG Added code to handle Online Reservations, includes HTML pages in 'Web/Reserve' folder
//14. SMG Added parameter to CheckUpdate method to receive licence parameter 'UserOnlineReservations'
//15. SMG Added WS_GetReservationInfo method to allow SU to retrieve the login details
//16. SMG Modified WS_GetAgreementInfo method to correct Web Service parameter definitions
//17. SMG Added fields to System Setup / Online Prefs to allow Online Reservations to Function, to allow the Facility to be listed for Online Reservations Web Page.
//18. SMG Added fields to Unit Types to allow to include Units of this Unit Type in Online Reservations system

//Changes in 7.2.11 19/07/08
//1. RWFR Reasons for Moveout cust analysis is now based on move out dates

//Changes in 7.2.10 18/07/08
//1. RWFR Lengthed $Hold in GateAction to 11 characters

//Changes in 7.2.10 02/07/08
//1. RWFR Disabled being able to run a new banking report with a date earlier than the last banking date
//2. RWFR Added a further warning when choosing to include future dated transactions advising that it will immediately alter the Transaction Dates
//3. RWFR Disabled double clicking on DisplayAgreemt
//4. NLT Stop Receipts from using PeriodNo for export dates
//5. NLT change SPL lines on QB receipts export to be for Bank Account rather than Debtors Account

//Changes in 7.2.10 01/07/08
//1. NLT Fix bug where unit status for OnSite or Locked statuses changed to Reserved when reservation made.
//2. NLT Fix bug caused by introducing MYOB to version 7.2.10 - CashbookTrxs description not created when generating rec jnls
//3. NLT remove multiple alert messages advising trx which would not be included in receipts export because they either have invalid analysis code or are set to not export.
//4. RWFR Set Else part of array to only run when on 4D Client for Sales Inquiries
//5. RWFR DailyAutopay now picks up Diners cards
//6. RWFR Removed segment size warning, no longer needed
//7. RWFR Increased size of viOwing, was cutting off text
//8. RWFR Invoices now allow for 7 digit Invoice Numbers
//9. RWFR Added note to OtherSiteUnitList stating that only Vacant & ToClean Units are shown in list
//10. RWFR Updated DoBillNext when setting NewBillingPlan to set New Rent fields correctly
//11. RWFR SyncDecode will not set transaction events with a negative seqno to AD+
//12. RWFR Fixed Cheque Return not working in Reservations
//13. RWFR Fixed print to disk file text showing in Reservations when not true
//14. RWFR Added new PDF Printer Plugin & Driver
//15. RWFR Recalc Balances now calculates Reservation balances
//16. NLT Fix bug where a negative trx could appear in the deposits column, and a positive trx could appear in the withdrawal column of bank rec report
//17. NLT Make change to order of printing of bank rec report and print previous bank rec report
//18. RWFR Notice to Vacate Unit Size column changes header depending on setting
//19. RWFR SetFacility added to OtherSitePmt form
//20. RWFR asCategory is now 30 characters to match Marketing Type Description
//21. NLT Fixed bug in revenue export for QB where only one facility at a MV site is being exported.

//Changes in 7.2.10 23/06/08
//1. RWFR [Facility]Phone in System Setup uses Phone Format if entered
//2. RWFR Added AutoLogOff event to set back to Rented for StorLogix
//3. RWFR Changed Falcon XT to StorLogix in GateSetup
//4. RWFR Added code to set balance colour on load part of MoveInCode
//5. RWFR Added request to print preview to Print Form when print dialogues are on
//6. RWFR Added addtional number format
//7. RWFR Altered PrintOutDel to accomodate facility codes
//8. RWFR Disabled PrintOutDel for MV and MV Sites
//9. RWFR Altered Reservation/Sales Inquiry additional numbers array
//10. SDD Added code for negative trx seq no's at MV
//11. RWFR Added CloseWindow to Cash Sale method
//12. RWFR Button on front screen now uses new CashSales method
//13. RWFR CheckEmailAddress now accepts 80 characters
//14. NLT changed sort order of consolidated banking report
//15. NLT Added MYOB export
//16. NLT Added drop-down box to System Setup to set the Accounting Package to export to.
//17. NLT remove blank records from Accounting exports for days where there are no receipts to export

//Changes in 7.2.10 03/06/08
//1. RWFR Fixed missing query from WS_AddReceiptTrx
//2. RWFR Currency symbol on quote now picks up facility setting

//Changes in 7.2.10 30/05/08
//1. RWFR Fixed issues in FindCust and FindResv
//2. RWFR InvQty set to 0 when copying if brand new for facility
//3. RWFR AltCountry is now correctly set
//4. RWFR Agreement/Reservation event log now sorts after the query
//5. RWFR Select menu restored on event log table
//6. RWFR Extended Facility Phone field to 25 characters
//7. RWFR Facility TaxNo on System Setup now allows for Alpha characters to be entered (UK)
//8. RWFR Updated checkupdate to support new version numbers
//9. RWFR Widened the Gate Date field on the MoveIn New Form
//10. RWFR Altered syncfrommaster to support new version numbers
//11. RWFR Updated aged receivables list to use a variable rather than temporarily storing unit numbers in the agreement number (was too short)
//12. RWFR Removed vFind query for Userlogins
//13. RWFR Added check for moving address position to allow if a Reservation
//14. NLT Fix export of refunds in receipts export
//15. NLT Modify error message for reporting on Analysis codes which have been set to 'Don't Export' to Accounting package.
//16. NLT Fix the export of Take payment at other site trx.
//17. RWFR Lockout prior to movein removed for non-Falcon Direct or Access Ezy

//Changes in 7.2.9 19/05/08
//1. RWFR ExtraDisc field is now set correctly if you change rent when adding a unit
//2. NLT Added workaround for Bug986 (Bank Recs)
//3. NLT Change methodology for Printing a Prior Bank Rec - to cater for instances where a trx has been deleted or a TaxAmt field cleared
//4. NLT Move [Facility]MVSite field from System Setup to Facility Input screen and add to Modify Facilities list

//Changes in 7.2.9 13/05/08
//1.  NLT Add ability to turn off portion of the CheckActivity overnight process for Central + logging to synclog
//2.  NLT Set [Facility]ReCalcActivity date to sync (otherwise 1 above stuffs it)
//3. SDD Modified CalcRentAdvance to allow 4 options with new calculation for Constant Month basis - yet to be tested and interface changed
//4. RWFR Calc of Taxamt on DateFrom/DateTo uses vMinus or vPlus instead of TotAmt (prevents tax being added twice)
//5. RWFR Disabled checking of Staff PIN's against other Staff PIN's

//Changes in 7.2.9 07/05/08
//1. RWFR Removed option to automatically fix unit history errors (was broken)

//Changes in 7.2.9 02/05/08
//1. RWFR Fixed bug in win4dx location in standalone
//2. RWFR Added more logging to WSC_AdvamCCTransaction
//3. RWFR Added special options 58-60 for webpayments
//4. RWFR WS_AddRecipt now uses 58-60 preferably, if they don't exist then reverts to old ones
//5. NLT Added code to export take payment at other site transactions in receipts export

//Changes in 7.2.9 29/04/08
//1. RWFR Set Transaction Time to sync
//2. RWFR Added Arrears to unit status type that opens customer
//3. RWFR Added extra logging to Advam CC Method

//Changes in 7.2.9 18/04/08
//1. RWFR Projected Charges Report now takes account of rent/fee increases
//2. RWFR Added notes to the bottom of the projected charges report
//3. RWFR In some cases the Advam method could return nothing even when there was an error, it should always return an error message now
//4. RWFR Project Charges Report now takes account of billing plan discounts

//Changes in 7.2.9 15/04/08
//1. RWFR Set change billing plan to clear new billing plan field (otherwise it will never use one you select)

//Changes in 7.2.9 11/04/08
//1. RWFR Allowed arrays to store next reservation number in use by head office
//2. RWFR Adapted sales inquiries to do the same (Starts at 500001)
//3. RWFR Underscores accepted in MessagesIn address field
//4. NLT Fixed display of version number under Help / About Storman
//5. RWFR When changing billing plan it sets the new billing plan field to match the billing plan swap to field
//6. SDD Added code to check if ADD events on table 6 are duplicates
//7. RWFR Added code to select all units for agreement when using print agreement
//8. RWFR Changed code for deposit and insurance value to use on after edit
//9. RWFR If user does not have permission to edit rent from default they do not get the change rent button, cannot edit quoted rate in reservations and cannot edit quoted price for units in sales inquiries
//10. RWFR Changed RemoveUnit to use Agreement MthsAdv rather than BillPlan

//Changes in 7.2.9 03/04/08
//1. RWFR Added Send/Receive dialogs after all email creation
//2. RWFR Added code to support 4 digit version numbers
//3. RWFR Backup Data to Internet removed from file menu
//4. RWFR Added custom 3 and 4
//5. RWFR Enabled Deposits Held, Aged Receivables, Arrears, Insurance & Stamp Duty Reports for Storman Lite
//6. RWFR Removed the send details section from Storman Lite's mail setup as it did not work in Lite
//7. RWFR Gate buttons hidden on Lite when not PTI Direct or Access Ezy
//8. RWFR Undo Last Charges now works with Bill Each Unit Seperately
//9. RWFR Fixed bug with asFacilities executing On Load in contacts
//10. RWFR Added arrays to store next agree/res/contact number, if array is higher than field value will prompt whether you wish to use next number
//11. RWFR Calcbalance called by a method ignores permissions
//12. RWFR Added Custom3 & Custom 4 to Customer Analysis Report

//Changes in 7.2.9 02/04/08
//1. RWFR Added Singapore & Hong Kong
//2. RWFR Fixed error in tab titles in Rent Rite
//3. RWFR Fixed find not working correctly for Rent Rite
//4. SMG Added [Agreement]RAgreeNo sort order to Auto Credit Card and Direct Debit payment processing.
//5. RWFR Alternate contact search now searches AlternateName field
//6. RWFR Cash Sales now runs as a seperate process
//7. NLT reordered delete menu items in ControlCode for Accounting menu - Check Activity item missing if not National Storage facility
//8. NLT Added option to Analysis table to exclude receipts from export to Accounting Package - requested by National Mini
//9. NLT Make change so that receipts export compares the whole facility short name against the Facility shortname (eg stop Albany containing data for Albany 2)
//10. NLT reverse +ve and -ve amounts going into Quickbooks receipts export - QB translates these on import according to the account type.
//11. RWFR Fixed EmailInvoice getting errors when sending transactions
//12. RWFR Edited include invoice with notice description
//13. RWFR Rematch screen opens in it's own window now
//14. RWFR Added rounding to discount amount for units
//15. RWFR On Move In charges now will have the correct date if the move in is for the future
//16. RWFR Fixed first of the month billing not altering agreement move in date when first unit move in date is in the future
//17. RWFR Option added for prepaid report to use Analysis Category in System Setup Financials tab
//18. RWFR Added ability to resend emails (creates a copy with current time and date)

//Changes in 7.2.8 13/03/08
//1. SMG Modified WS_GetAgreementInfo Web Service to provide the 'Last Bill Amount' information to StormanUsers
//2. SMG Modified Kiosk code to Round Rental Fee values, and to calculate Other Charges Transaction Net / Tax / Amount values correctly. 
//3. RWFR Added additional checks to try to prevent non-autopay customers being processed.
//4. RWFR Added code to unload customer/agreement & unit records at end of reading from gate
//5. RWFR Added code to not to try and delete non-existant files when sending emails containing blobs

//Changes in 7.2.8 10/03/08
//1. RWFR Updated Direct Debits not to show ! when it succeeds
//2. RWFR Fixed Customer Analysis Report sub-title being cut off
//3. RWFR Only displays dialog once during batch print of customer analysis report
//4. RWFR Stopped it rounding non-rent charges when tax was added
//5. RWFR Updated Userlogins/Usergroups import to use ; rather than , to prevent issues with AccessFacility
//6. NLT Add Kennards NZ to centralised refunds method
//7. NLT Change pay refunds method so if facility not supported via bank method it will only display 1 alert box instead of alert for every transaction.
//8. NLT Lengthen account number for Great Plains export, ExportRecJnls
//9. NLT Remove creation of header row for each journal when creating Great Plains Receipts export; one header row per file created.
//10. NLT Remove question regarding summing accounts for receivables in QB receipts export
//11. RWFR Fixed select/unselect all not working correctly
//12. NLT Lengthen Key Value variable to 60 for TriggerLogActivity method, in keeping with the field in ELog table.
//13. NLT Add extra condition for QB export for single sites - needed if not using the cashbook module
//14. RWFR Added code to strip incomptible characters when communicating with F2000/XT
//15. RWFR Added code to hide 4D error messages if they occur when processing credit cards
//16. RWFR Added code to set the parameter $FromUpgrade in CalcRentedValues
//17. NLT Auto rental increase function - add option to not lower rents for customers currently renting above the standard rate - requested by Planet
//18. NLT Add new GL Receipts form to Suppliers table and new menu item to Accounting menu for GL Receipt details
//19. NLT Added new export to QB for receipts for customers using the Cash Accounting method

//Changes in 7.2.7 14/02/08
//1. NLT Add Unit History table to overnight export
//2. NLT change QB receipt export so final analysis code in the list for each facility gets written to the file with the correct supplier code
//3. RWFR Altered Advam methods to accept 1 or true as a pass
//4. Fixed TriggerLog syntax error: Lengthen EventLog Key Value field to 60 chars - needed for Quotes

//Changes in 7.2.7 12/02/08
//1. NLT Modify whole month calc on prepaid rpt form method and second instance of whole month calc in CalcRentAdvance method, so month calc / 30.42 instead of 30.4
//2. RWFR Altered delete button in Marketing Types to not use default action
//3. RWFR Stopped Marketing shortening Description field to 20 characters
//4. RWFR Stopped generate button working when clicked with invalid values

//Changes in 7.2.7 11/02/08
//1. NLT x 2 changes to Income Occupancy Reconciliation Report to fine-tune the calculation and remove negative prepaid when EOM date is close to next bill date
//2. NLT fix QB query which prevented export cashbook trx details from writing to the .txt file
//3. RWFR SelectUnit A & B update [Customer]Balance correctly
//4. RWFR Rounding is now done to 2 d.p. on Cash Analysis Report to prevent it returning weird numbers

//Changes in 7.2.6 01/02/08
//1. RWFR Added code to check change of agreement number for invoices (to prevent moving address)
//2. NLT Various changes to Receipts export for QB
//3. RWFR Renamed email button to bEmailRec for Reservations
//4. RWFR Added line to stop paid to date changing in certain circumstances when Show Other Trxs is ticked
//5. NLT Fixed Other Site Banking report so it displays the To and From facility names correctly.
//6. RWFR Added code to reset arrays for printing pdf banking report
//7. RWFR Changed code to hide vpIcon to use ObjectName rather than variable
//8. RWFR Set marketing types out to use form event=on outside call rather than just on outside call
//9. RWFR Lengthed area for printing notes on average length of stay report
//10. RWFR MessagesIn now defaults to attachments folder for adding attachments
//11. RWFR When saving a unit the list price is now updated
//12. RWFR Fixed AP Form when ex GST showing wrong value
//13. SDD Fixed errors in SyncDecode
//14. NLT Fixed parameter does not exist runtime error - line 90 & 114 in CreateRecJnls - reported by KSS
//15. RWFR Made changes to invoice to prevent blank printing
//16. RWFR Made changes to CheckVersion & Generate Contact Number to ensure it runs for all facilities on a Multi-Site (or non-syncing MV)
//17. RWFR Changed Edit Timezones to Edit Timezones/Staff PIN's
//18. NLT Fix "Leap Year" bug which crashes Storman (actually caused by alert message on object method)
//19. NLT Add extra tax codes to ExportRevJnl method for Great Plains - Kennards

//Changes in 7.2.5 21/01/08
//1. RWFR Lengthed contacts email address to 80
//2. RWFR Lengthed facility email address, smtp & pop hostname & logins to 80
//3. NLT Changed variables on InquiryInclNew to enterable to stop white on white problem
//4. RWFR If there are no quotes it will give a message when attempting to email or print
//5. RWFR Adjusted entry order for MoveInNew
//6. NLT Modified Export Receipts for QB so picks up different bank account details for different facilities if MV.

//Changes in 7.2.4 07/01/08
//1. RWFR Modified InquiryIncl to prevent weird alterations in 2004.7
//2. RWFR Defaulted Marketing Types sort order to 1

//Changes in 7.2.3 20/12/07
//1. RWFR Added _ to entry filter for email addresses
//2. RWFR Fixed GateSetup setting Gate File Locations to the Tutorial folder when opening form
//3. RWFR Allowed entry of numbers in Facility Code in Client Setup
//4. RWFR Added alert for customer if Lock Status is set to remove non-customer lock
//5. RWFR Units with a lockstatus of 6 always appear on the locklist during daily
//6. RWFR If there are any units with a lockstatus greater than 1 (using the new lock statuses) the unit status report/locklist defaults to landscape
//7. RWFR Added Quotes Table to StructureArray to allow it to sync
//8. RWFR Allowed up to table 35 to be used through Send Data to Remote Site (was 28)
//9. RWFR Added code to send Quotes table through on upgrade to 7.2.3
//10. NLT Added printout to Daily listing customer's who's insurance has been cancelled during daily - Planet
//11. RWFR Fixed UnitLetter being set to 0 for Falcon XT
//12. RWFR Reprint of lock list now uses UnitNo rather than RUnitNo

//Changes in 7.2.2 17/12/07
//1. RWFR Fixed Custom1 and 2 for Secondary contacts having the reverse display
//2. NLT Use SupplierCode as default Sales 'Item' if Phone field not filled in - for QB's Receipts export.
//3. NLT Display date next to the number of months on Rent Increase Rules screen so user can see what movein or last rent increase date the calc would use if applied on a current date.
//4. NLT Remove old Rent Increase Report option; will run now for Last Inc or Future Inc and sorted by those dates
//5. NLT Add Movein Date column to Rent Increases report - KSS
//6. NLT Add subtotals for rented value, new rent amount and net increase to last page of Rent Incr Pending and Last Incrs report.
//7. NLT Fixed ordering on Analysis Codes when selecting Active/Inactive/All selection so it sorts by SortOrder.
//8. RWFR Changed Expiry Date message to inform you date is out of range
//9. RWFR Fixed link in About Storman
//10. RWFR Random Gate PIN Length changed to Minimum PIN Length
//11. RWFR Minimum value in CheckGatePIN now uses Minimum PIN Length
//12. RWFR ModCharges & ModReceipts no longer look for inactive analysis codes as the default
//13. RWFR Restored CallTime & Category to ContactsOut
//14. RWFR Fixed notice plan days before to send picking up non-Next Bill Date notices

//Changes in 7.2.1 11/12/07
//1. RWFR Added Door Size back on to Unit Status Report
//2. RWFR Removed credits page
//3. RWFR Changed reseller link to point to contacts page on new website
//4. RWFR After deleting a Staff PIN the list should remain
//5. RWFR Updated Access Control Setup to update import & output file locations on changing of gate type
//6. RWFR Delete group & user buttons disabled when no records in selection
//7. RWFR Entry Filter & CheckEmailAddr used on email address fields in the software
//8. RWFR Initiliase sets InsuranceAgentType to 3 if 0
//9. RWFR Reduced size of display of description field in rent increase rules
//10. RWFR Increased size of buttons in rent increase rules
//11. RWFR Fixed sort order being disabled when using next button
//12. RWFR Fixed tab ordering on customer tabs 1 & 2 & contacts
//13. RWFR Gate buttons should hide when no entries have been done for the gate button names on F2000/XT
//14. RWFR Fixed All Sales Inquiries not working
//15. RWFR Disabled download staff pins if gate system is not on
//16. RWFR Disabled gate is on/gate is off button in demo
//17. NLT Added Select All / Unselect All buttons to EventLog Print type options
//18. RWFR Recalc added to NextBillDate change
//19. RWFR Not billing pro-rata on day to bill no longer resets field value

//Changes in 7.2.1 07/12/07
//1. NLT Remove X which selects 'New Authority' as the default when printing an Automatic Payment
//2. NLT Add warning to Other Regular Charges and Unit Increase From dates if date is not on the billing anniversary or is less than the Next Bill Date
//3. RWFR Altered format of Advam CC Transaction XML file
//4. RWFR Added code to EmailInvoice and EmailQuote to store changes to messages
//5. RWFR Fixed Credit Sales not loading country arrays
//6. RWFR Gate buttons removed for Falcon 2000/XT
//7. RWFR Added code to not run Move Object in Invoice when no customer record is loaded
//8. RWFR Unittypes are sorted by sort order for Quotes selection
//9. RWFR Fixed Sort Order and Code being editable for RF/DP/LF
//10. RWFR Added sorting and selection arrays to Sales Inquries
//11. RWFR Sort and selection code is taken account of after adding/modifying a sales inquiry record
//12. RWFR Hid totals for Deposits Held & Prepaid Rent on Monthly Summary Report
//13. RWFR Changed CheckVersion upgrade for v7 to use NewRegularRent for Units rather than NewRentAmt
//14. RWFR Fixed display of days stayed & rates for old agreements
//15. RWFR Added dropdown to choose whether to display all, active or inactive analysis codes
//16. NLT Fixed bugs in Eventlog Exceptions report
//17. NLT Moved Eventlog Exceptions report to the More Reports menu
//18. RWFR Set InsureValue to 0 on moveout of a unit
//19. RWFR Renamed done button to bDone for ContactsOut
//20. RWFR Deposit Amount is now editable when adding a Unit
//21. RWFR Changed buttons to Yes/No for Final Banking Report question
//22. RWFR ModFacility takes account of ContactNo

//Changes in 7.2.0 30/11/07
//1. RWFR Fixed error in DailyProcess causing it to lose Agreement record
//2. RWFR Changed Launch External Process back to AP Shellexecute for attachments

//Changes in 7.2.0 29/11/07
//1. RWFR Moved MailAddress on Contacts screen back to correct location
//2. RWFR Changed all references from [Facility]UsePDFWriter to (([Facility]UsePDFWriter)Â |Â (<>iPlatform=2))

//Changes in 7.2.0 28/11/07
//1. RWFR Fixed calendar notes

//Changes in 7.2.0 27/11/07
//1. NLT Added Overnight Exports for Reservations, Contacts and GateLog tables - KSS
//2. RWFR Added check to stop blank gatepin from being downloaded
//3. RWFR Fixed doubleing of amounts for banking report pdf
//4. RWFR Fixed deposits not being set on conversion of a sales inquiry to a reservation
//5. RWFR Fixed quote amount not being set
//6. NLT Fixed bug where not all transactions dispaying in Take Payment at Other Site Reconciliation Report
//7. NLT Add Date and Analysis type to Other Site Reconciliation Report
//8. RWFR Added new MD5 plugin
//9. RWFR Added new DD code to Daily Autopay
//10. RWFR Removed old PDF code used for OS9
//11. RWFR Enabled Military section for all countries
//12. RWFR Added Country list arrays
//13. RWFR Set Agreement to use country lists
//14. RWFR When splash screen loads vFind is selected
//15. RWFR Disabled email quote when email address is not entered
//16. RWFR Fixed deposit problem when converting Sales Inq to Res/Agreement
//17. RWFR Changed adding quotes to display UnitType Description
//18. RWFR Converted old Letter & Email for Sales Inq to Letters table records for 7.2.1
//19. RWFR Moved logging code for sending CC earlier so it is logged even if send fails
//20. RWFR Customer, Agreement (or Reservation) are saved on printing or emailing an invoice and the selection restored afterwards
//21. RWFR New agreements have NoticeDaysPrior set to Notice plan value
//22. RWFR Changing notice plan alters default notice days prior to default for notice plan and alerts
//23. RWFR Set notice days prior on conversion to agreement
//24. RWFR Converting sales inquiry to an agreement picks up the bill plan default notice plan
//26. RWFR Removed Door Size from Unit Status Report
//27. RWFR Altered default to portrait for Unit Status Report
//28. NLT Remove X which sets whether an AP is a new authority or replaces an existing authority - to be filled in by customer or site
//29. NLT Various changes to Receipts Export for Quickbooks
//30. RWFR Sales Inquiry list defaults to those with no Outcome
//31. RWFR Added Show Open button to display those that have no Outcome
//32. RWFR Removed Call Time & Category from list and added when requried
//33. RWFR Moved Check Available Units to Quotes tab
//34. RWFR Added Next Bill Date to Pro-rata confirmation alert
//35. RWFR Extended room for Time on Gate screen
//36. RWFR Disabling of gate system by logmon recorded in Synclog
//37. RWFR Check units available at other site now only returns units with a status of Vacant or ToClean
//38. RWFR Alteration of CantModPrior when running Customer Balances only happens if the report is for a previous month
//39. RWFR First Quoted Unit is saved as SizeRequired
//40. RWFR Size Required displayed in Output List
//41. RWFR CheckVersion now sets SizeRequired on upgrade to 7.2.1
//42. RWFR CheckVersion now sets facility to read/write before generating contact numbers on upgrade to 7.2.1
//43. RWFR Hid all stock related items if record inventory is not set to true
//44. RWFR Record inv as whole numbers defaults to true
//45. RWFR Settings for Prepaid Rent report are now saved
//46. RWFR Inactive analysis codes no longer have alerts to re-order displayed
//47. RWFR Country included on invoice if different to Facility Country

//Changes in 7.2.0 14/11/07
//1. RWFR Fixed ListPrice not being set on upgrade
//2. RWFR Changed CheckVersion to call TestSales method
//3. RWFR Restored "Type of Business" to "Category" in Sales Inquiry (This is how it was prior to 7.2.0)
//4. RWFR Fixed Email Quote button
//5. RWFR Replaced all calls to AP Sublaunch & AP Shellexecute with Launch External Process
//6. RWFR Added "Waiting for backup to complete" window to manual backup
//7. RWFR Removed set colours from FacilityOut
//8. RWFR Changed form method for facilityout and facilityoutshort to use FacilityList method
//9. RWFR Added TaxHeader to fields available to copy
//10. RWFR Changed wording of Other to Per Agreement
//11. RWFR Changed code so when checking staff pins are not duplicates it does not count itself

//CHANGES IN 7.2.0 05/11/07
//1. RWFR Stopped Open Attach trying to delete non-existant files
//2. RWFR Added EmailBody field to Letters table
//3. RWFR When creating an email during daily it now references the EmailBody field rather than the Blob
//4. RWFR Shortened credit card processing text so you can see the Customer Code
//5. NLT Adjust Report Logo on 90 Day Cash Actual - was appearing as grey box when printed

//CHANGES IN 7.2.0 30/10/07
//1. NLT Fixed bugs in Consolidated Banking Report where not including all analysis types and giving incorrect totals
//2.  NLT Changed Analysis Code Sort order to be based on Sort Order instead of Analysis Category
//3. SMG Put 'On Data Change' code to [Customer]MobilePhone field to check and correct format so that it will work with SMS as well. - removed duplicated code from DailyPrint method
//4. NLT Fixed Gate Bug where continually coming up with parameter does not exist in GateAction method 
//5. RWFR Fixed Business Type Array in Sales Inquiries
//6. RWFR Fixed display of Insurance Value
//7. RWFR Removed New Policy tick box (this was left over from 3.2.2)
//8.  NLT Added Notes to the footer of 2x versions of the Average Length of Stay Report
//9. NLT Default the report date for 90 Day Cash Actual to the EOM date and correct the title of the report.
//10. NLT Fixed bug where can't add Staff PINS because is checking a non-existent parameter
//11. NLT Fixed date printed bug on 90 Day Cash Actual Report
//12. NLT Fixed bug where Cancel needed to be selected twice when canceling out of ModReceipts or ModCharges
//13. NLT Added help tips to Set Default button and [Transaction]Customer field on ModReceipts & ModCharges screen to clear confusion oer how this function works. 
//14. NLT Added order by to facility table in On Startup / On Server Startup, CheckVersion and Initialise methods, so if deleting and replacing a HOF record in a Central file it will detect the correct record.
//15. NLT Fixed the billing of increases made to Other Regular Charges.
//16. SMG Put Mobile Phone format correcting code on CheckVersion method 
//17. RWFR Changed calcrentedvalues to take account of weekly systems
//18. RWFR Added code to double check calculation of rent amt on closing agreement, if 0 prompts if you wish to continue

//CHANGES IN 7.2.0 11/10/07
//1. NLT Fixed column tabbing in QB's Prepaid Journal export
//2. RWFR Fixed no SMS account details not disabling button
//3. RWFR Hid Keypadzone for non-Userlogins Staff PINS
//4. RWFR Shows old quote details for pre-7.2.0 sales inquiries
//5. RWFR Quote changed to Item on buttons
//6. RWFR Support Message category removed as no longer functional
//7. RWFR Check available shows close for sales inquries
//8. RWFR Enter Card checks CC is valid
//9. RWFR Free month/s taken into account when changing billing plan for other regular charges
//10. RWFR Prevented 0 being used for UnitType monthly & weekly rates
//11. RWFR After pressing SendSMS cancel button is disabled
//12. RWFR Virus message when opening attachments disabled for outgoing emails
//13. RWFR Prevented entering a moveout prior to movein date for a unit
//14. RWFR Cash Sales must have at least 1 charge entered
//15. RWFR Sales Inquiry mobile number will not allow alpha characters
//16. RWFR Prompts to bill Access Card Deposit if CRD analysis code setup
//17. RWFR Removed extra check in staff pins
//18. RWFR Fixed PrintForm display
//19. RWFR Defaulted Attachments adding to attachments folder

//CHANGES IN 7.2.0 10/10/07
//1. NLT Add check to DailyProcDRC so that Date From field on the rent increase rule is updated to allow time for the rent increase letter to come out
//2. NLT Remove Other Bank Trxs from Accounting / Customer Receipts
//3. NLT Shorten output header of Great Plains Prepaid and Revenue journals to be 20 chars - limit by Great Plains
//4. NLT Remove $0 transactions from Receipts export
//5. NLT Add two extra columns to Inc in Advance journal for Quickbooks export
//6. NLT Fix bug which caused Key Stats to show 0 amounts under the occupancy and arrears sections at MV end
//7. NLT Remove differentiation of refunds for KVSI & Managed sites in Receipt Export (remove need for B2 accounts) - Kennards
//8. NLT Change to Rent Pending report so can print future increases by unit
//9. NLT Fix bug causing inability to unreconcile old bank s/m's
//10. NLT Fix syntax error - cmd cannot be executed during draw of a list when previewing rent increases with certain conditions
//11. RWFR Fixed NS Banking option
//12. RWFR Fixed display of custom fields
//13. RWFR Fixed display of waived late fees section
//14. RWFR Fixed Reservations & Sales Inquries not adding SMS letters


//CHANGES IN 7.2.0 24/09/07
//1. RWFR Fixed advanced search not working
//2. RWFR Unloaded customer, agreement and notices records at end of daily to try and prevent locking
//3. RWFR Fixed problem converting Sales Inquries to Reservations (A record number of 0 is now given in 4D 2004 causing the Find Index Key loop to OK when it should of failed)
//4. RWFR Fixed Find Index Key command in ReservationIn form
//5. RWFR Added OneilImport method
//6. RWFR Added Import Charges to Accounting menu
//7. RWFR Set ControlCode to remove Import Charges option if they are not a NS site
//8. RWFR Set code to stop changing of MoveIn Date to more than 3 months in the future
//9. RWFR Removed InvoiceHistory code from Invoice printing (may be causing crashing in Daily)

//CHANGES IN 7.2.0 06/09/07
//1. RWFR Stopped Digigate users entering leading zeros
//2. RWFR Prevented Proxcard users not having PIN's searched for
//3. RWFR Ensured UserLogins Pin's and Facility Staff Pins correctly check the PIN entry
//4. RWFR Alert about daily not being complete now only shows when <>sCurrentUser >""
//5. RWFR Stopped Insurance Plan text displaying when not needed
//6. RWFR Altered display of insurance value fields to remove decimal places
//7. RWFR Added Last bill details to Credit Sale
//8. RWFR Prevented Insurance and Rent Weekly/Monthly fields accepting a value greater than 0.9999 or less than 0.0001
//9. RWFR Expanded the Tax Rate field to accomodate the % sign
//10. RWFR Set vName to be the first field if it is blank for Contacts
//11. RWFR Added reverse sorting on Control Screen
//12. RWFR If Unit is added to an existing agreement, or added on to a reservation it now prompts you to create the deposit
//13. RWFR If there is a value in the Other Deposit field it now includes Agreement in the transaction description for the deposit that includes it
//14. RWFR If a unit does not have a deposit the initial move in will not include the UnitNo in the description
//15. RWFR When removing a unit from an agreement or reservation it now prompts to remove the deposit

//CHANGES IN 7.2.0 28/08/07
//1. RWFR Added default forms for MerchPlan table
//2. RWFR Linked TaxExempt on the Reservations table to TaxExempt on the Facility table
//3. RWFR If there are no weekly billing plans then the weekly option in Reservations is hidden
//4. RWFR Doubleclicking on Quotes is disabled due to permissions issues
//5. RWFR Removed duplicate Customer Balance from CreditSaleIn
//6. RWFR Fixed creation of messages during daily not relating to customer record etc
//7. RWFR Allow daily to create blank email messages
//8. RWFR Fixed CalcNewRents method not using new way of calculating rent increases
//9. RWFR Removed ability to set Adobe as the pdf writer due to it being unsupported

//CHANGES IN 7.2.0 24/08/07
//1. RWFR Fixed entry order for email
//2. RWFR Added alert if people try and enable overlocking and replace lock at the same time
//3. RWFR Added tooltips to overlock and replace lock
//4. RWFR Check if email is entered before allowing AutoCCEmail to be selected
//5. RWFR Fixed Billing Plan total not being updated
//6. RWFR Extended display of ContactNo and BusinessName
//7. RWFR Extended Admins Permissions to 170 Y's for demo
//8. RWFR Quote price will be updated when quantity is changed
//9. RWFR Entry filter to prevent non-numeric characters on price
//10. RWFR Altered tab names in Contacts
//11. RWFR Contacts is now a transaction
//12. RWFR Added Email Quote button and code
//13. RWFR Fixed Letters not being displayed in Contacts
//14. RWFR Fixed error when adding notes for Contacts
//15. RWFR Set vLegend to blank on loading contacts
//16. RWFR Stopped Quote being prompted for conversion when there wasn't any unit quotes
//17. RWFR Altered position of quotes being saved to noteshistory
//18. RWFR Fixed headers on projected charges report
//19. AAP Added white box over [Agreement]MoveInNew
//20. AAP Copied the above onto MoveInRR & CreditSaleIn
//21. AAP Designed a red-gradiented background to use as the new 'customer overdue' colour
//22. AAP Fixed the date-field on [Letters]AgreemtIncNew by making it 10px wider, as the last digit in the date was being cut-off; this issue reported by SafewaySS
//23. RWFR Enabled code to display new red box
//24. RWFR Fixed white box covering text and added lines so boxes had full borders
//25. RWFR Set customer balance highlight to recalculate when changing tabs
//26. SDD/RWFR Prevented mod or del's causing CLR events to be sent wrongly

//CHANGES IN 7.2.0 23/08/07
//1. RWFR Added LinkTest functionality to WSC_AdvamCCTransaction
//2. RWFR Fixed initial display of permissions not including new ones
//3. RWFR Fixed Initialise locking up Group table
//4. RWFR Fixed Customer permissions list starting at 153 rather than 154

//CHANGES IN 7.2.0 22/08/07
//1. RWFR Set template XML for CCPayments
//2. RWFR Finished WSC_AdvamCCTransaction
//3. RWFR Stopped EmailInvoice losing changes to Customer record
//4. RWFR Fixed Storman Lite logo
//5. RWFR Stopped banking report being run for a date prior to can't mod prior
//6. RWFR Added logging to WSC_AdvamCCTransaction
//7. RWFR Removed CCRefund button, not needed, use Add Refund instead

//CHANGES IN 7.2.0 20/08/07
//1. RWFR Fixed Unit record being locked on RemoveUnit
//2. RWFR Fixed Removeunit not taking account of billing plan periods

//CHANGES IN 7.2.0 17/08/07
//1. RWFR Added Credit Card Refund button
//2. RWFR Added CCRefund method to perform Advam CC Refunds
//3. RWFR Added Date Request to Inventory Item Inquiry
//4. RWFR Stopped UnitType listing for Vacant Unit Report showing non-vacant UnitTypes
//5. NLT Remove Tax line from CashbookTrxs if no Tax Code set up in Chart of Accts
//6. RWFR Changed double clicking on Letter subform to Edit Record rather than Display Record
//7. RWFR Fixed Sales Inq locking Facility record
//8. RWFR Changed calls to ProcCreditCard to use [Customer]CCName rather than [Customer]CustomerName
//9. RWFR Hidden Gate buttons on control screen if name entered is blank
//10. RWFR Added alert message when changing from Weekly to Monthly based plan of Day To Bill
//11. RWFR Fixed when changing billing plan if rental was recharged it calculating the discount wrong
//12. RWFR When quitting now includes alert if Auto-Backup is due to go
//13. NLT Inventory Valuation Rpt to not include merchandise items set to inactive
//14. SMG corrected Runtime error when vCCText was being set to $atResponse{4} when the array wasn't that big. 
//15. SDD Added code to set Date Banked event for Take Payment at Other site to go on to site transaction is for
//16. RWFR Bill Next Charges now takes account of the new billing plan when prompting to bill
//17. RWFR Added [Unit]ListPrice
//18. RWFR Added Apply to Selection when changing list price of UnitType
//19. RWFR Added RVHistory report
//20. RWFR Added RVHistory report form
//21. RWFR Added RVHistory Report dialog
//22. RWFR Added RVHistory report permission
//23. RWFR Prevented sort order of 0 being entered for marketing types
//24. RWFR Fixed some items in MoveIn form not being hidden when appropriate

//CHANGES IN 7.2.0 08/08/07
//1. RWFR Fixed 1000 Units not showing on dropdown list
//2. RWFR Fixed check of Units setting dropdown list to wrong setting when [Units] was > than MaxUnits
//3. RWFR Changed [Notices]SMSMessage to text field
//4. RWFR Added check to ensure SMSMessage is not longer than 160 characters
//5. RWFR Fixed Send External Email not using AltEmail
//6. RWFR Cash Sales was not setting vtReverse causing refunds to be processed as payments on Credit Cards
//7. RWFR Added Original Receipt to ModReceipts (Other Site + Cash Sales as well)
//8. RWFR Removed Use Card on File from Cash Sales
//9. RWFR Stopped ModReceipts setting total amount of transaction to a negative when agreement was moved out with a negative balance and user clicked Add Receipt
//10. RWFR Changed aDesc in [Facility]SystemSetup to aDescriptions to prevent it breaking existing arrays
//11. RWFR Changed Occupancy Rate description on Consolidated Key Stats to Occupancy Rate by Value
//12. RWFR Added alert message if user tries to select more than 4 faciltiies on the consolidated key stats
//13. RWFR Renamed map picture to vpIcon so Hide Graphics functions
//15. RWFR Fixed banking optional tickbox display being enabled when prior reports are run
//16. RWFR Disabled Gate On/Off button in Access Control Setup if you are in 4D Client
//17. RWFR Added AttachmentBLOB to messages table
//18. RWFR Stored PDF Invoices in AttachmentBLOB when created
//19. RWFR Unpacked PDF Invoices in blob for opening or sending email
//20. NLT Set Billing Plan criteria to 'All' by default when setting up a rent increase rule
//21. NLT Add RoundAmt to [Unit]NewRentAmt when calculated on movein for a weekly billing plan
//22. NLT Fix bug where selecting the = date comparator when searching by agreements on the Rent Increase Rules
//23. NLT Add line to set the Unit's Last Incr date in the UpdateNewRent method
//24. NLT Set Unit LastInc date in the checkversion method - set to Agreement LastIncDate
//25. NLT change legend at top of the Rent Incr Rpt when the report is generated from the Run Rules option so has a different title & date when run during daily
//26. RWFR Added Select Notice to Send Invoice by Email
//27. RWFR Stopped vTitle & vLegend from being enterable on output forms

//CHANGES IN 7.2.0 24/07/07
//1. RWFR Customer Analysis Report setting is now saved and does not prompt during Batch Printing
//2. RWFR Fixed entry order for BillPlanIn
//3. RWFR Fixed Adding Billing Plan displaying form twice
//4. RWFR Hid legend for second graph on Graph of Occupancy
//5. RWFR Fixed window display for Previous Bank Reconciliation
//6. RWFR Fixed vPath not showing correctly on MoveInNew
//7. SMG Fixed typo in WS_AddReceiptTrx that caused the added transactions to have no description
//8. RWFR Fixed manual backup not working
//9. RWFR Fixed display of backup copies to keep
//10. RWFR Fixed misaligned display of New Amount in Agreement Info
//11. RWFR Fixed wrong help tips being displayed in system setup
//12. RWFR Fixed Auto-Quit Clients not allowing entry of data
//13. RWFR Fixed Report Logo causing grey square on Key Stats

//CHANGES IN 7.2.0 11/07/07
//1. RWFR Removed SetFacility from PermissionsControl
//2. RWFR Stopped remove unit on Reservations setting Unit Table to read only
//3. RWFR When changing billing plan old transaction is now correctly removed
//4. RWFR Changed AP ShellExecute to use window status 2 during AutoBackup
//5. SMG Added input filter to allow only numeric characters in Customer Mobile Phone field
//6. RWFR Truncated Notes to 20000 characters on saving
//7. RWFR Added $WinRef to window calls in Daily Method
//8. RWFR Disabled calculation of paid to date when bAll is 1
//9. RWFR Added Last 7 Days and Last 30 Days to EventLog display option
//10. RWFR Added specific date to Cash Sales disply option
//11. RWFR Stopped offering to print AP with new rent when New Rent From was equal to 00/00/00
//12. RWFR Altered order of address and subject in email screen
//13. RWFR Added setting of timeout to 65 if less than 65 when changing Providers
//14. RWFR Added [Unit]Disat calculating when removing a unit from a reservation
//15. RWFR Fixed vQuote noing able to unselect transactions
//16. RWFR Existing invoice pdf is deleted prior to creation of new invoice pdf

//CHANGES IN 7.2.0 04/07/07
//1. RWFR Added [Contacts]Alert to allow for alert note
//2. RWFR Set System Highlight Colour to on for all List Forms
//3. RWFR Fixed Select button not bebleAlarm for F2000 and Falcon XT
//4. RWFR Fixed Remove button being disabled for Staff PIN's
//5. SMG Modified WS_GetWebPaymentChecksum method to accept Transaction Description and Charge/Receipt parameters, allows retrieval of payments with a different description
//6. RWFR Changed value range for Timezones in Customers & Staff to 0 - 32000
//7. RWFR Added Unlocked field to [UnitStatusTrx]
//8. RWFR Changed Unit Status Trx Report to be Daily Reprint Locklist
//9. NLT Overnight export of transactions now include the last 90 days.
//10. NLT Fixed Dynamic Rent Control as was not picking up the billing plan criteria correctly
//11. NLT Set $UnitTot variable to 0 to prevent syntax error when using preview function of DRC 
//12. NLT Reduce the number of date options available when choosing agreements for Rent Increase Rules criteria
//13. NLT reduce the number of displayed agreements in Preview mode of Rent Increase Rules to 20, as the wording specifies
//14. NLT Remove agreements that were displaying in Preview mode of Rent Rules even when no increase was due
//15. NLT Rent Increase Rules - Change the search for units so it uses the billing plan and notices criteria correctly.
//16. NLT Remove the necessity to save a rule before previewing it.
//17. NLT Reduce the allowable operators when selecting a biling plan for Rent Rule criteria to # or =
//18. NLT  Rent Increase date incorrect in Preview mode - fixed
//19. RWFR Added Select and Unittype fields to Quotes
//20. RWFR Recorded Unittype selected with Quote
//21. RWFR Set all Quotes to be recorded as Notes on conversion
//22. RWFR Now prompts to select Unittypes when converting to a reservation
//23. NLT Add Taxcode and Tax amount to export of Rev Jrnl to Quickbooks
//24. RWFR Now prompts to select Unittypes when converting to an agreement
//25. RWFR Added Central specific code for Insurance at KSS
//26. RWFR Fixed broken output forms
//27. SMG Added URLEncode to handle HTTP Post 'unsafe' characters within SMS messages

//CHANGES IN 7.2.0 12/06/07
//1. RWFR Changed name of SyncNewMethod tickbox due to display issue
//2. RWFR Added [Facility]NextContactNo to CreateTutorial & Setup
//3. RWFR Overdue amount now shows red
//4. RWFR Black borders around balances
//5. RWFR Redid all subform for Agreements to hide black selection lines
//6. RWFR Rearranged items on Agreement Info
//7. RWFR Changed BSB to long integer
//8. RWFR Fixed tab order for contacts
//9. RWFR Fixed formatting of CC number on Automatic Receipts
//10. RWFR Changed wording of locked to suspend
//11. RWFR Focus on name for Reservations if blank added
//12. RWFR Changed Quote to use Description rather than UnitType
//13. NLT Fixed Calendar EOM bug

//CHANGES IN 7.2.0 08/06/07
//1. RWFR Added ContactNo for SalesInquiries
//2. RWFR Added Quotes table
//3. RWFR Added NextContactNo to Facility table
//4. RWFR Added code for generation of ContactNo
//5. RWFR Added MailCountry and PhoneBus to Contacts table
//6. RWFR Updated all output forms to use 4D 2004 default look
//7. RWFR Changed Overdue to an integer to accomodate additional lock statuses
//8. RWFR Added atLocked array to MoveIn screen
//9. RWFR Added SetOverlock and SetReplacelock to Notices table
//10. RWFR Changed all references to Overdue to acccount for new integer statuses
//11. RWFR Daily now accounts for SetOverlock and SetReplacelock
//12. RWFR Added Other Status to UnitStatus report to display overlock, replace lock and remove lock
//13. RWFR Added InvoiceHistory Table
//14. NLT Added 'Other Bank Charges' to Banking Summary report Analysis code drop-down box - KSS
//15. RWFR InvCode now generates InvoiceHistory record
//16. RWFR Unit numbers are marked with a * if they are ToClean on the Vacancy Report
//17. RWFR Blocked selling of Inventory past 0 for Cash Sales when analysis code is not changed
//18. RWFR Added Last Rent Increase Date to permissions
//19. SDD Added new menu on More Reports called Projected Charges Report
//20. SDD Created new method called SyncLogNew referenced by LogMonLoopCode
//21. RWFR Added Projected Charges Report to permissions
//22. RWFR Added NewSync to Facilty Table and AutoEmailCC to Customers Table
//23. RWFR In logmonloopcode if newsync is False it will use New Sync Code
//24. RWFR Added option to System Setup to control Sync code used
//25. RWFR Added option to Agreement to control Auto Emailing of CC Processing to customer
//26. RWFR Added code to use AutoEmailCC
//27. RWFR Fixed Send Text on Alt Customer section not using AltMobile details
//28. RWFR Fixed PermissionsControl 118 causing error and not hiding button when failed
//29. RWFR Fixed PermissionsControl 101 causing error and not hiding button when failed
//30. RWFR Added ReadUserLoginsImport & ReadUserGroupImport
//31. RWFR Added ReadUserLoginsImport & ReadUserGroupImport to LogMonLoopCode
//32. NLT prepaid Journal was truncating the last char from the facility identifier of-fixed
//33. NLT update the help tip for the Facility Code field when setting up a new datafile.

//CHANGES IN 7.1.1 01/06/07
//1.  NLT Fixed bug in conversion for customers on multiple month billing who;re swapping to another billing plan
//2.  NLT Fixed bug in BillNextCharges dialog which tells the user it is going to bill the wrong amount for the wrong dates - affects customers coming off a billplan.
//3. RWFR Fixed Creater on Reservations using Agreement table
//4. RWFR Hid Additional PIN's for SL users as this was erronously shown in 7.1.0
//5. RWFR Hid Record Inventory Values in Analysis Codes for SL users

//CHANGES IN 7.1.1 30/05/07
//1. RWFR Set InsuranceAgentType to 3 if 0 on upgrade
//2. RWFR Set Change Code form to be correct height
//3. RWFR Added new Storman Lite logo
//4. RWFR Fixed InsuranceAgentType being set to 3 rather than 1 for non-US customers
//5. RWFR Moved the goto area vname from during to before to prevent it from running while editing the agreement number
//6. RWFR Removed duplicate Letter sign off field
//7. RWFR Added code to prevent Level command running when printing event log to disk file
//8. RWFR Filtered double clicking in marketing types when no record is selected
//9. RWFR Changed entry order on MoveInNew and ReservationsIn
//10. RWFR Fixed Unit subform for Reservations code to run On Display Detail rather than On Load
//11. RWFR Changed Reservations to use LettersInBig

//Changes IN 7.1.0 30/04/2007
//1. NLT ExportToQuickbooks - separate out revenue journals so a journal for each facility
//2. SMG Removed code originally designed to remove Carriage Returns from received HTTP response, this was instead removing part of the first returned parameter.

//CHANGES IN 7.1.0 26/04/07
//1. RWFR Fixed Phone Number for SMS allowing greater than 11 characters
//2. RWFR Fixed error message on successful SMS displaying
//3. RWFR Added [Agreement]SendNoticeSMS and display on Letters tab
//4. RWFR Changed DailyPrint to take advantage of [Agreement]SendNoticeSMS
//5. SMG Changed SendSMSAdvam to return results in the following format:  'T:ReturnMessage' where 'T' or 'F' is True or False.   Changed SendSMS to receive response correctly.

//CHANGES IN 7.1.0 20/04/07
//1. RWFR Fixed some display issues on insurance forms
//2. NLT Autopay forms for rent increases to only be printed for NZ & Australia
//3 NLT Fix bug where unit rent increase date is one month less than agreement increase from date, if the NewRentFrom date in the rule is too close to the agreement's next bill date
//4. NLT Fixed display issue with country field on [Facility] licenses page

//CHANGES IN 7.1.0 17/04/07
//1. RWFR Fixed Pro-rata calculation for MiniCo Insurance
//2. RWFR Fixed display of pro-rata on Summary
//3. RWFR Replaced MiniCoInsurance image with text
//4. RWFR Added InsuranceAccount Number to existing reports
//5. RWFR Replaced MiniCoTenantOne images with text
//6. NLT Remove Fixed Incr, % Incr or unit rate from the rent increase rule test if the user has not added anything to them (ie they remain at 0)
//7. NLT Fix display of single unit in Preview mode when there are no records to apply the rent rule to + change message advising of this!

//CHANGES IN 7.1.0 10/04/07
//1. SDD Added code to account for deletion of stock items
//2. RWFR Print Insurance button is hidden when not needed
//3. RWFR Checksums for insurance added
//4. RWFR Code for StaffPIN's changed
//5. RWFR Completed Insurance checksum

//CHANGES IN 7.1.0 04/04/07
//1. RWFR Added Canada Tutorial files
//2. RWFR Added group creation to Demo
//3. RWFR Fixed missing sub-form on Agreement Tab 1
//4. RWFR/AAP Updated the following forms: [Agreement]MoveInNew - Tab 5 - Resized; [Facility]Batch - Updated to new form style; [Notices]MailMerge - Updated to new form style
//5. RWFR Updated ConfirmThree to be form type 5 so it is always on top
//6. RWFR Payments column widened on Transaction tab of MoveInNew
//7. RWFR/AAP Updated the following forms: [Notices]SelectNotice; [Photos]Input; [Facility]Backup; [Facility]Change
//8. RWFR Fixed Sales Inquiries search to limit itself to one facility
//9. RWFR Alert Note for reservations fixed
//10. RWFR Reservation number display limited to 4 digits
//11. RWFR Users & Groups select all button display fixed
//12. RWFR Fixed clearing of Staff PINS on upgrade
//13. RWFR UserID's are now generated on upgrade
//14. RWFR Marketing Types removal added to SyncReceive
//15. RWFR ModReceipts, ModOtherSiteReceipts and MiscReceipts cannot have dates more than 1 week in the future entered
//16. RWFR Added MiniCoInsurance information
//17. RWFR Added QtyPlus and QtyMinus to prevent incorrect entry of Qty values
//18. RWFR Added KeypadZone for StaffPIN's

//CHANGES IN 7.1.0 15/03/07
//1. RWFR Changed Reserve to Trial for Billing
//2. RWFR Made login screen display default Storman logo for new datafiles (before product is selected)
//3. RWFR Added LetterCustomerName & LetterUserName to Customer table
//4. RWFR Default groups created
//5. NLT Change Export to Quickbooks so it includes the full short name for the facility in the CLASS part of the export

//CHANGES IN 7.1.0 13/03/07
//1. RWFR Fixed RandomPIN method not being called correctly
//2. RWFR Facility/Tutorial Database now looks in the database folder
//3. RWFR Client Setup screen now uses the 750 Unit option correctly
//4. RWFR Demo files are now created in the Database folder
//5. RWFR Prevented input screen being displayed twice for notices
//6. RWFR Allowed Sales Inquiries with names shorter than 5 to be processed as Reservations & Agreements
//7. RWFR Fixed non-working OK & New button showing in Marketing Types when modifying a record
//8. RWFR Fixed non-working OK & New button showing in Units when modifying a record
//9. RWFR Caused bReturn to select record
//10. RWFR Added method to Help buttons so they load webpage
//11. RWFR Prevented active checkbox appearing during daily
//12. RWFR Added field to prevent users from entering gate PIN values at Head Office unless selected
//13. AAP Made a large number of changes, as per the following list...
//         - [Agreement]MoveInNew: KeyPad ZoneÂ &Â oither PIN elements re-alligned, WaivedLAteFees section cleaned up. Added descriptive 'star' note-points to the MoveOut tab.
//         - [[Facility]ControlNew: Removed copyright image, and replaced with a n editable tex
//         - [[Activity]CheckDialog: Replaced 'default' stylesheets with correct(defined)ones.
//         - [[Activity]KeyStatsDialog: Replaced 'default' stylesheets with correct(defined)ones.
//         - [[Agreement]BillNextDialog: Made form about 30px higher, moved buttons down, added-shaped line to the checkbox area, applied correct stylesheets etc.
//         - [[Agreement]MoveInRR: WaivedLAteFees section cleaned up. Added a Query button(pasted from other)to the EventLog tab(it didn't have one, for some reason). Added descriptive 'star' note-points to the MoveOut tab.
//         - [[Agreement]CreditSaleIn: WaivedLAteFees section cleaned up. Copied the entire 'CCÂ &Â Photos' tab from Agreement[MoveInNew], onto this tab-as it was very different and cluttered on this tab. Added a Query button(pasted from other)to the EventLog tab(it didn't have one, for some reason)0
//         - [[Agreement]FindDialog: Corrected some stylesheets.
//         - [[Agreement]IORecDialog: Corrected some stylesheets.
//         - [[Agreement]ModDetails: Corrected some stylesheets.
//         - [[Agreement]RentAdvDialog: Corrected some stylesheets. Made form about 50px higher-point.
//         - [[Agreement]RentRllDialog: Corrected some stylesheets.
//         - [[BillPlan]BillPlanIn: Corrected some stylesheetsÂ &Â added new blue star note-point about deleting billing plans.
//         - [[Customer]ArrearsDialog: Corrected some stylesheetsÂ &Â realligned some form elements.
//         - [[Customer]CustAnlsDialog: Realligned some form elements.
//         - [[Customer]SetPrimaryPhone: Realligned some form elements.
//         - [[Facility]AboutStorman: Corrected some stylesheets.
//         - [[Facility]ApplyForm: Corrected some stylesheets.
//         - [[Facility]CalcBalances: Realligned some form elements.
//         - [[Facility]Country: Realligned some form elements.
//         - [[Facility]LoginChange: Corrected some stylesheets.
//         - [[Facility]NewData: Reworded some text.
//         - [[Facility]StartUp: Corrected some stylesheets.
//         - [[Facility]System: Corrected some stylesheets.
//         - [[Notices]NoticesIn: Corrected some stylesheetsÂ &Â reworded some text.
//         - [[Notices]RentIncreaseRules: Corrected some stylesheets, reworded some textÂ &Â realligned many elements. This screen will need a lot more work-but we can do this another time in the future.
//         - [[Reservation]ReservationIn: Corrected some stylesheets.
//         - [[Transaction]BankDialog: Corrected some stylesheets. Changed form height(a lot), and changed date to long format... someone to check that the long-format works, please(a 'day' would be good so clients dont have to go to a calendar all the time to tr)0
//         - [[Transaction]IncomeDialog: Changed form height.
//         - [[Transaction]InsureDialog: Changed form height.
//         - [[Transaction]PrintOldBankRec: Corrected some stylesheets and changes the date fie(hopefully)0
//         - [[Unit]OtherSiteUnits: Corrected some stylesheets and changes the date field to a (hopefully)0
//         - [[Unit]UnderRentedDialog: Realliged form elements, added a L-shaped thingy.
//         - [[Unit]UnitTypeIn2: Corrected some stylesheets.
//14. NLT Fixed bug in conversion of old fields to new fields for Agreement's newrent fields.
//15.  NLT Set the customer name on the Income Charged report to always be "Cash Sale" if the sale was to a miscl customer.
//16. RWFR Fixed Reservations to credit back the deposit
//17. RWFR Added Canada to the list of countries
//18. SMG Modified SMS HTTP requestion to close connection after receipt of response, was using persistent connections by default - should stop SMS hanging issue.
//19. NLT Added a field to flag whether the bank rec is done at HOF or the site end

//CHANGES IN 7.1.0 06/03/07
//1. NLT Add extra parameter to TriggerLogActivity 
//2. NLT Sales Inquiry - changed PermissionsControl to be inside an On Load form event (was inside On Header - may not fix problem but can't reproduce it
//3. NLT Modify QB code to export the class name correctly
//4. NLT Fix bug on Graph of Occupancy Report Summary data when run at MV end
//5. SMG modified Insomniac code to work with multiple PINs instead of just one.
//6. NLT Fixed bug where tax not calc'd for discount portion where incentive is shown separately and there is a date in System Setup Apply Tax Rate From field
//7. RWFR Added Keypadzone fields to customer & photoscard tables
//8. RWFR Added reason column to Stocktake Form
//9. RWFR Added Check Return button for US customers
//10. RWFR Changed font size on tabs for Mac
//11. NLT Fixed bug of missing Cancel & OK buttons in screen redesign of Print Previous Bank Rec 
//12. RWFR Removed AP Form button for US customers
//13. RWFR Changed username field on control to be read only

//CHANGES IN 7.1.0 08/02/07
//1. SMG Modified LogMonitor so that Webserver could start automatically in Storman Standalone.   Already coded to work but broken.

//CHANGES IN 7.1.0 25/01/07
//1. RWFR Prevented Credit Card buttons being available for a cash sale where the credit card has already been processed
//2. RWFR Enabled permissions descriptions for Users

//CHANGES IN 7.1.0 24/01/07
//1. RWFR Changed ReadFalconXT to look for "0" rather than ""
//2. RWFR Falcon XT export now does not contain a value in PIN or Name when removing additional users
//3. RWFR Falcon Direct, 2000, XT and AE are prevented from entering leading zeros
//4. NLT Modified UpdateNewRent so that [Unit]IncreaseFrom and [Unit]RegularRent changes are made during daily processing
//5. NLT Modified Insomniac DoBillNext to remove the code that sets the [Unit]NewRentAmt to zero after a rent increase has occurred (still want it to appear on agreement screen even if none due)
//6. NLT Fixed bug in Waived Late Fee Report so that report now includes cases where the late fee has been set to zero.
//7. RWFR Added Permissions Descriptions
//8. RWFR Fixed WSC_CheckAdminSPword
//9. NLT Fixed bug so that Unit's Rent Increase date is set to 00/00/00 on moveout or when a unit is removed from an agreement.

//CHANGES IN 7.1.0Â 10/01/07
//1.Â SMG Added code in ProcCreditCard to set the Date Banked date to the settlement date returned from Advam (If Analysis Code SetBankedDate to Today set to true)
//2. NLT changed checkversion method - so correctly sets the Unit's NewRentAmt on upgrade if there is an existing rental increase
//3. SMG Added Entry filter to BankAccountName field on Customer Info Tab for Advam DDs to prevent invalid characters
//4. NLT Added New rent fields to Agreement and Unit output forms under Custom Designed Reports - NM request
//5. NLT Fixed bug in method that sets the rent increase date on the agreement table
//6. RWFR Fixed font used on AP form
//7. RWFR Stopped AP Form prompting for new rent when none was entered
//8. RWFR Indexed [EventLog]KeyValue
//9. RWFR Changed Late Cycle reset prompt to prompt whether or not you wish to reset and still accept part payment
//10. AAP Recoloured some graphical elements on [Facility]System (various tabs)
//11. RWFR Added vOthInsurance
//12. RWFR Changed AutoBackup to use get document size
//13. RWFR Reverse now displays an error if the output is longer than the input
//14. RWFR Added colour to date selected on control screen
//15. AAP Rearranged [Agreement]MoveInNew - tab 4 (autopay details, etc) and added 'red flag' icons for expired dates - Robert to add code to enable this feature.
//16. NLT Added new report showing Last Rental Increases for Units (is an option under Rent Increases report from Reports menu)
//17. NLT Changed the wording when moving out a customer to say: use the Undo Last Charges option.
//18. NLT changes to Elog report - removed double-heading; added ability to select a date range.
//19. SMG Indexed all queried fields
//20. RWFR Added support for Falcon XT - PTI Extended Dat file
//21. RWFR Fixed Additional users being added for Digigate
//22. SMG Only vacant units now display to be reserved on Insomniac
//23. RWFR Fixed Other Deposit field not being added when converting a sales inquiry to a Reservation or Agreement

//CHANGES IN 6.1.0 07/11/06
//1. NLT Fix the default format of AP forms for printing.
//2. NLT Added the printing of AP's to the end of daily processing for autopay customers who are due notice of a rent increase
//3. NLT Fix the Agreement's NewRentAmt for customers who have a rent increase on some units and not on others (via DRC for Occup Units )
//4. NLT Change sort order of Rent Increases report to be by rent increase date then unit no - National Mini
//5. NLT Adjust gatelog and e-mail borders so scroll bars fit on main splash screen
//6. NLT [BillPlan]Description field extended - National Mini
//7. NLT Add ability to print Autopay forms for rent increase customers under the Daily Reprint option
//8. NLT Removed object method on PrintLogAfterDP tickbox, as was resetting true to false every time.
//9. NLT Add option when printing rent incr letter to choose whether to print for autopay form for all cust or for autopay cust only.
//10. RWFR Fixed vOthDeposit not getting charged

//CHANGES IN 6.1.0 06/11/06
//1. RWFR Bank Account Number field extended
//2. RWFR Units Occupied added to display of agreement screen
//3. RWFR Deposit calculation changed to using bChange to prevent Unit table from being(and thereby causing PIN errors)
//4. RWFR/SDD Occupancy Section on KeyStats now takes account of Unit Start Date
//5. RWFR/SDD Deposits Held on KeyStats now accounts for ReservationÂ &Â Access Card Deposits
//6. RWFR Scrollbar removed on notes section on control screen due to issues with 4D ha
//7. RWFR/SDD Active Credit Sales now display on the Control Screen
//8. RWFR/SDD Output to gate now displays in the Access Log(under view access log, not on the control screen)
//9. RWFR/SDD Undo last charges now functions for Bill Units Separately
//10. RWFR Set allowed methods now supports the Reverse method
//11. RWFR Printing of Invoices for Reservations now functions correctly

//CHANGES IN 6.1.0 03/11/06
//1. RWFR Added vOthDeposit to accomodate non-Unit or Access Card deposits
//2. RWFR Added NZ AP Form details
//3. RWFR Fixed LogEvent always trying to set $12 even when only 9 variables had been set
//4. RWFR Fixed Pro-Rata Prompt not remembering value

//CHANGES IN 6.1.0 01/11/06
//1. RWFR Fixed Waived Late Fee spelling error
//2. RWFR Fixed Reservations/Credit Sales Event Log Query
//3. RWFR Changed Summary of Discounts to print Landscape to accomodate longer reasons
//4. RWFR FacilityOutShort now displays IP Check and Can't Modify Prior
//5. RWFR Changed StoredBefore to an Integer
//6. RWFR Changed SelectPDFDoc to use Win32API for printing
//7. RWFR Added Query button to event log screen
//8. RWFR Analysis Codes display is now sorted by Category, SortOrder then Code. Before used to be SortOrder then Code.
//9. RWFR Changed Permissions system to use categories
//10. RWFR Added AutoPayType to Agreement
//11. RWFR Added SalesInqPopup to Facility
//12. RWFR Added DDAccountDetails to Facility
//13. RWFR Fixed agreement number code executing for the wrong event
//14. RWFR Removed change colours from system setup
//15. RWFR Added Last Bill Date to Notices
//16. RWFR Days Overdue now displays as an integer
//17. RWFR Late Fees Waived now correctly adds on Credits
//18. RWFR Fixed help messages for Max Waived and No Months
//19. RWFR Prevented Analysis Charges from having a sort order higher than 45 as this causes problems
//20. RWFR When pressing the bill next charges option on a notice it will tick the don't send by autopay automatically, likewise removing it from autopay removes a tick from bill next
//21. RWFR Added AttachInvoice to trigger an invoice to be included with a notice
//22. RWFR DailyPrint now specifically searches for agreements from the facility running daily
//23. RWFR Added cancel button to Add Note dialog
//24. RWFR Fixed Analysis Codes for Units being billed seperatly
//25. RWFR Added UnitStatusHistory table to track changes in Unit Status and Unit Name changes
//26. RWFR Occupancy Report now takes account of Unit Start Date
//27. RWFR Deposits Held report now includes Reservations & Access Card Deposits
//28. RWFR Adding a note in Reservations now displays the full list after saving
//29. RWFR Moved location of writing of StaffPINS for Users
//30. RWFR Added Sent Ext Email buttons to Agreement and Reservations
//31. RWFR Stopped 4D Draw on Facility table syncing as it causes Datafile corruption over time
//32. RWFR Fixed RentAmt field not being set correctly when changing months value
//33. RWFR Added delete button for letters
//34. RWFR Fixed move out calculation not being done when changing to tab
//35. RWFR Fixed display of Find Units Avail at other site
//36. RWFR Added BSB field
//37. RWFR Fixed Address on Invoice not being moved on second and subsequent invoices
//38. RWFR Fixed it not displaying alert notes for Reservations
//39. SMG Added Insomniac Interface Code
//40. SMG Added Help Centre syncronisation Code
//41. SMG Added DD processing code
//42. SMG Fixed bug where Storman Server Control window disappeared and was causing default server windows to only partially display
//43. SMG Commented out code in CheckMail that used to process Web Payment Transactions sent via email - no longer used, instead now uses Web Service
//44. AAP Rearranged BSB & bank account fields on MoveInNew, CreditSaleIn, MoveinRR and ReservationIn
//45. AAP Rearranged / resized Set Primary Phone, Email & SMS buttons to fit on screen properly
//46. AAP Redesigned NZ AP form to suit RWFR's background-image template
//47. NLT Added Dynamic Rent Control for Occupied Units
//48. NLT Fixed amounts not being able to be changed under Reservations/ Cash Sales and Agreement Info page
//49. NLT Added 90 Day Cash report
//50. NLT Fixed sync error when FIX events not getting set to syncstatus 3
//51. AAP Rearranged MoveInNew form (Tab 1) to fit new 'OtherDeposits' field in for RWFR

//CHANGES IN 6.1.0 05/09/06
//1. RWFR Display most recent transactions for an agreement where customer has mutliple agreements
//2. RWFR Added OK & New button to StockIn form
//3. RWFR Removed delete button from Reservations
//4. RWFR Replaced Delete for Sales Inquiries with Declined
//5. RWFR Added ability to set Vacant Units to ToClean every x days
//6. RWFR Widened Unit column in Daily Summary report
//7. RWFR Fixed Cash Sales display error in analysis code
//8. RWFR Fixed Transaction Out display error
//9. RWFR Fixed Select Unit Type display error
//10. RWFR Added ability to add attachments to emails sent from a customer
//11. RWFR Added done buttons to output forms
//12. RWFR Added Unit table fields to those uneditable if user does not have permission to edit rent
//13. RWFR Added Select All and Unselect All to Users & Groups
//14. RWFR Deleting a User or Group now deletes associated UserGroup records
//15. RWFR Added total to Automatic Receipts
//16. RWFR Added ability to sort DP Invoices by Agree No or Customer Code
//17. NLT Removed confirm boxes asking managers whether they wanted to print the Bank Rec and Unreconciled reports.
//18. RWFR/AAP Imported Andy's changes to Reservations/Agreements, from now on will be done directly
//19. RWFR Fixed viowing to accomodate Reservations
//20. AAP On Agreement]MoveInNew: Left-aligned varm18 on AgreementInfo tab, changed description of Custom Fields on CustomerInfo1 tab, completely reworked the CustomerInfo2 tab.
//21. RWFR Added SetPrimaryPhone form and enabled setting of primary phone
//22. RWFR Many fields on movein and reservations screens are now variables to allow customisation
//23. RWFR Detects photo compression and displays
//24. RWFR DailyPrint now does a replace string to allow for fields: customer balance, rent amt, next bill, agreement balance & last bill date
//25. RWFR Reconciled transaction can now have their description, bank branch and drawer no edited
//26. RWFR Gate alarm times can now be edited
//27. RWFR Gate alarms can now be sent by SMS
//28. RWFR Added Stock Item Pricing Report
//29. RWFR Added Stocktake Form
//30. RWFR Find Units button for Rental Manager now includes Make/Model + Serial No
//31. RWFR Added Alternate ZIP Code to Customer Analysis Report
//32. RWFR Occupancy Report refers to appliances for Rental Manager
//33. RWFR Updated LoadLetters to support new notices and set Email Subjects
//34. RWFR CreateTutorial and Setup now turn on photo compression and the PDF Writer
//35. RWFR If Limit Photo Size is off Photo Compression still displays as a positive
//36. RWFR Updated Analysis & Marketing Types used for Tutorial Import
//37. RWFR Fixed display of Unit Types & Rates
//38. SDD Added Weekly Refund formula to narration
//39. RWFR Enabled InvHeader, InvFooter and Receipt to sync
//40. RWFR Disabled buttons on reservations form when not applicable
//41. RWFR Disabled invoice related buttons when iprinttofile>0
//42. RWFR ChangeCode now accepts the code being entered with the facility code prefix
//43. RWFR Added !! and ?? to apply formula
//44. RWFR Added InvHeader_, InvFooter_ and Receipt_ to fields you can copy settings for
//45. RWFR Added permission to set Notice Given date earlier than current date
//46. RWFR Fixed tax being added to TotAmt when Tax is added
//47. RWFR Completed consolidated banking report
//48. RWFR Asterisk now displayed if transaction already has a date banked on banking report
//49. RWFR Added warning if you tick Send Notices Days Prior and Autopay = True
//50. NLT Remove the Reconcile From button and associated code from the bank rec (is not used would only be a source of potential problems)
//51. NLT Add RulesNotice field to Notices table and change Key Value to include the NoticePlanNo
//52. RWFR Fixed AP Form Tax Display
//53. RWFR Altered window opening of NoticeIn, System Setup, Banking Report and ModDetails
//54. RWFR Fixed Sync.4dw and Copy.4dw creation
//55. NLT removed dupication of Bank Account field on the CCard and Letters tab


//CHANGES IN 4.3.0 09/06/06
//1. RWFR/AAP Added the new [Facility]"Login", [Activity]"CheckDialog", [Activity]"KeyStatsDialog", [Agreement]"BillNextDialog", [Agreement]"FindDialog", [Agreement]"IORecDialog", [Facility]"LoginChange", [Facility]"Country", [Facility]"ApplyForm", [Facility]"CalcBalances", [Agreement]"ModDetails", [Agreement]"PaidToDialog", [Agreement]"RentAdvDialog", [Agreement]"RentRollDialog", [Customer]"AlertMessage", [Customer]"ArrearsDialog", [BillPlan]"BillPlanIn", [Facility]"Startup" forms by Andy
//2. RWFR Added new Tiered Late Fees system to Notices table and Daily Processing
//3. RWFR NotUsed2 changed to Homepage and is now an Alpha, 80 characters field, will clear this field on upgrade if current version is less than 4.3.0
//4. RWFR Added [Facility]Homepage field to License page of System Setup
//5. RWFR Added 1BuildApplication method for doing an OEM Build
//6. RWFR Changes to MoveInNew form, MoveInCode, MoveInOk methods to support new Unit functions
//7. SMG Added code to 'CreateCustCode' to enable 'Silent' operation for Web Creation of Customer Code.   If 'Silent' parameter is true then no dialogs are displayed, default action is 'yes'.
//8. RWFR Added code to SelectUnitA to set RentedValue and NewRentAmt
//9. RWFR Added Waived Late Fee Code to Delete Selection, MoveInCode and added an invisible button available to administrators to reset the waived late fees
//10. RWFR Added OK & New button to UnitIn Form, old OK button now closes the record
//11. RWFR Added OK & New button to UnitTypeIn Form, old OK button now closes the record
//12. RWFR Added OK & New button to MarketingTypesIn Form, old OK button now closes the record
//13. RWFR The following new dialog boxes have been set to type 5; KeyStats, Occupancy, Prepaid Rent, Unit Status, Paid to Date Agreements, Rent Roll, IORec, Arrears, CashAnalysis
//14. RWFR The above forms now open centered in the screen
//15. RWFR Customer Processing and Alert Box screens now open centered and are type 4
//16. RWFR Entering a Negative Inventory Purchase now requires a user level of 8
//17. RWFR Added [EventLog]AgreementIncl form and extra tab to MoveInNew form
//18. RWFR Added [Facility] Custom1 and Custom2 fields, also added appropriate customer fields
//19. RWFR/AAP New EventLog AgreementIncl form designed, also several design changes made to new MoveIn Form
//20. RWFR Centered and set windows to types 4/5 for CheckDialog,BillNextDialog,Country,ApplyForm,CalcBalances,BillPlanIn,Startup
//21. RWFR Days Overdue and Total number of agreements now calculated
//22. RWFR SelectUnit and SelectUnitType forms now display correctly
//23. NLT Added Current Unreconciled Transactions report
//24. NLT Added EventLog Exceptions report and ability to select multiple sites if Central for the report
//25. RWFR Addec Set Window Rect to On Startup
//26. RWFR Upgrade method for updating to 430 or > written for Agreements rental amounts
//27. NLT Set vRptDate on Banking Rpt dialog to enterable (it had been enterable in 2003, and needs to be so they can run a rpt for days they forgot to do)
//28. NLT Set CantModPrior date when starting and closing the bank rec so the site / HOF cannot modify any trxs that might form part of the bank rec.
//29. NLT Prepaid Rent Report includes option to Incl or Excl Tax
//30. RWFR Fixed apageno being set with Strings longer than 15
//31. RWFR Fixed show history and other customer transactions being wrong way around
//32. RWFR Fixed not being able to create a new movein
//33. RWFR Changed Unit Status for Rental Manager, Locked = Arrears, OnSite = Disposed, Unavailable = Stolen
//34. SDD Fixed problem in OtherStartup line number 41 where $facility was being set from UnitType instead of RUnitType
//35. SMG Added Agreement number as Reference number to SendSMS method call in method DailyPrint (Phil Robbie requested this)