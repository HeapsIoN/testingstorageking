//%attributes = {"lang":"en"} comment added and reserved by 4D.
Case of 
: (asNames=1)//Today
vDate:=vDate-1
vRptDate:=vRptDate-1
: (asNames=2)//WTD
vDate:=vDate-7
vRptDate:=vRptDate-7
: (asNames=3)//MTD
vRptDate:=vDate-1
vDate:=Add to date(vDate;0;-1;0)
: (asNames=4)//YTD
vRptDate:=vDate-1
vDate:=Add to date(vDate;-1;0;0)
: (asNames=5)//Other Date Range
vDate:=vDate
vRptDate:=vRptDate
Else 
//Do nothing
End case 