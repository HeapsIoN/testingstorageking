//%attributes = {"lang":"en"} comment added and reserved by 4D.
If (PermissionsControl (8))
DEFAULT TABLE([Analysis])
READ WRITE([Analysis])
FORM SET OUTPUT([Analysis];"AnalysisOut")
FORM SET INPUT([Analysis];"AnalysisIn")
ARRAY TEXT(aAnalysis;2)
aAnalysis{1}:=Get localized string("Charges")
aAnalysis{2}:=Get localized string("Receipts")
aAnalysis:=1
ARRAY TEXT(asAnalysisDisplay;3)
asAnalysisDisplay{1}:=Get localized string("All Codes")
asAnalysisDisplay{2}:=Get localized string("Active Codes")
asAnalysisDisplay{3}:=Get localized string("Inactive Codes")
asAnalysisDisplay:=2
QUERY([Analysis];[Analysis]Code=<>sFacility+"@";*)
QUERY([Analysis];[Analysis]Inactive=False;*)
QUERY([Analysis]; & ;[Analysis]SortOrder<=50)
ORDER BY([Analysis]SortOrder;>;[Analysis]AnalysisCategory;>;[Analysis]Code;>)
QUERY([MarketingTypes];[MarketingTypes]Facility=<>sFacility;*)
QUERY([MarketingTypes]; & ;[MarketingTypes]ListCode="AC")
If (Records in selection([MarketingTypes])>0)
SELECTION TO ARRAY([MarketingTypes]Description;asACDisplay)
INSERT IN ARRAY(asACDisplay;1)
Else 
ARRAY TEXT(asACDisplay;1)
End if 
asACDisplay{1}:=Get localized string("All")
asACDisplay:=1
MODIFY SELECTION(*)
READ ONLY([Analysis])
ARRAY TEXT(<>asCharges;0)
ARRAY TEXT(<>asChargeDesc;0)
ARRAY TEXT(<>asChargeCat;0)
QUERY([Analysis];[Analysis]Code=<>sFacility+"@";*)
QUERY([Analysis]; & ;[Analysis]SortOrder<=50)
ORDER BY([Analysis]SortOrder;>;[Analysis]AnalysisCategory;>;[Analysis]Code;>)
SELECTION TO ARRAY([Analysis]Code;<>asCharges;[Analysis]Description;<>asChargeDesc;[Analysis]KeyStatsCategory;<>asChargeCat)
ARRAY TEXT(<>asReceipts;0)
ARRAY TEXT(<>asReceiptDesc;0)
QUERY([Analysis];[Analysis]Code=<>sFacility+"@";*)
QUERY([Analysis]; & ;[Analysis]SortOrder>50;*)
QUERY([Analysis]; & ;[Analysis]SortOrder<=95;*)
QUERY([Analysis]; & ;[Analysis]Inactive=False)
ORDER BY([Analysis]SortOrder;>;[Analysis]AnalysisCategory;>;[Analysis]Code;>)
SELECTION TO ARRAY([Analysis]Code;<>asReceipts;[Analysis]Description;<>asReceiptDesc)
End if 