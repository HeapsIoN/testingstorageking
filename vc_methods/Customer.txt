//%attributes = {"lang":"en"} comment added and reserved by 4D.
If (PermissionsControl (25))
DEFAULT TABLE([Customer])
READ WRITE([Customer])
FORM SET OUTPUT([Customer];"CustomerOut")
FORM SET INPUT([Customer];"CustomerIn")
ARRAY TEXT(asList1;0)
QUERY([MarketingTypes];[MarketingTypes]ListCode="MS";*)
QUERY([MarketingTypes]; & ;[MarketingTypes]Inactive=False)
ORDER BY([MarketingTypes];[MarketingTypes]SortOrder;>)
SELECTION TO ARRAY([MarketingTypes]Description;asList1)
INSERT IN ARRAY(asList1;1)
asList1{1}:="<None>"
ARRAY TEXT(asList2;0)
QUERY([MarketingTypes];[MarketingTypes]ListCode="CT";*)
QUERY([MarketingTypes]; & ;[MarketingTypes]Inactive=False)
ORDER BY([MarketingTypes];[MarketingTypes]SortOrder;>)
SELECTION TO ARRAY([MarketingTypes]Description;asList2)
INSERT IN ARRAY(asList2;1)
asList2{1}:="<None>"
ARRAY TEXT(asList3;0)
QUERY([MarketingTypes];[MarketingTypes]ListCode="BT";*)
QUERY([MarketingTypes]; & ;[MarketingTypes]Inactive=False)
ORDER BY([MarketingTypes];[MarketingTypes]SortOrder;>)
SELECTION TO ARRAY([MarketingTypes]Description;asList3)
INSERT IN ARRAY(asList3;1)
asList3{1}:="<None>"
ARRAY TEXT(asList4;0)
QUERY([MarketingTypes];[MarketingTypes]ListCode="MW";*)
QUERY([MarketingTypes]; & ;[MarketingTypes]Inactive=False)
ORDER BY([MarketingTypes];[MarketingTypes]SortOrder;>)
SELECTION TO ARRAY([MarketingTypes]Description;asList4)
INSERT IN ARRAY(asList4;1)
asList4{1}:="<None>"

ARRAY TEXT(asListIDType;0)
QUERY([MarketingTypes];[MarketingTypes]ListCode="FI";*)
QUERY([MarketingTypes]; & ;[MarketingTypes]Facility=<>sFacility;*)
QUERY([MarketingTypes]; & ;[MarketingTypes]Inactive=False)
ORDER BY([MarketingTypes];[MarketingTypes]SortOrder;>)
SELECTION TO ARRAY([MarketingTypes]Description;asListIDType)
INSERT IN ARRAY(asListIDType;1)
asListIDType{1}:="<None>"

QUERY([Customer];[Customer]CustomerCode=<>sFacility+"@")
ORDER BY([Customer]CustomerCode;>)
SET AUTOMATIC RELATIONS(True;False)
MODIFY SELECTION(*)
SET AUTOMATIC RELATIONS(False;False)
READ ONLY([Customer])
UNLOAD RECORD([Customer])
End if 