//%attributes = {"lang":"en"} comment added and reserved by 4D.
//CHANGES IN 4.0.1 26/7/04 `SyncLog  `Documentation
//1. SDD When changing MthsAdv on AgreeInfo page, it correctly updates Insurance - Ben request
//2. SDD Fixed problem with Notes History already having something in the note. - Ben request
//3. SDD Stopped UpdateSystem bringing up dialog on server - will put in log instead - Occurred Kennards 1/7/04
//4. SDD Fixed problem if unit was connected to an Inactive agreement would still show Rented
//5. SDD Fixed error with calculating no of insured units
//6. SDD Fixed error on Insurance Report if MoveIn is after date of report.
//7. SDD Would not allow an occupied unit to be reserved.  This is now corrected. - Peter Donaldson request
//8. SDD Fixed error on pmt column of Insurance summary where two payments in one month.
//9. SDD Added Great Plains Export for Receipts Data
//10. SDD LateFeeWaived field not being updated correctly.
//11. SDD Changes to Prepaid report where NOT BILLED this period is selected - National Oz
//12. SDD Stop webserver address appearing on server.
//13. SDD Occupancy Rpt with Subtotal for Unit Prefix incorrectly displayed FacilityCode. - Peter, Napier SS
//14. SDD Avg Length of Stay Report - Fixed Title & changed Marketing Info to Customer Type
//15. SDD Fixed problem with Returned cheque not updating TotRentOwing correctly.
//16. SDD Changed field descriptor for Arrears Comment
//17. SDD Hopefully fixed problem where incorrect Unit No displayed on Invoice during Daily Processing - Kennards
//18. SDD Allowed access to Unit Types & Rates while still blocking Analysis Codes and Billing Plans - Kennards
//CHANGES IN 4.0.1 5/8/04
//1. SDD Fix problem in Rental Audit Report
//2. SDD Fix problem of Analysis Receipt codes being shown as Inv Qty reduced to zero.
//3. SDD Added Send Email button to Modify Letter page of Access & Ins on Customer screen - Wes Fry
//4. SDD Stopped alert messages appearing on server - Planet
//5. SDD Require both Shift and Alt keys to be held down to delay LogMonServer as it can happen accidentally
//6. SDD Added automatic CheckActivity for any site running at 5AM.  If MV will send email to Centrallogs
//7. SDD Added Find by Invoice Number and by AutoPayAmt to the Find Dialogs - Doug
//8. SDD Finished Great Plains Revenue Journals - Kennards
//9. SDD Send data to remote site will delete the data before adding the new records - Safe Store
//CHANGES IN 4.1.0 24/9/04
//1. SDD Stop ResetEventSeqNo automatically when server is wrong.  Now requires SyncError=151 at HO.
//2. SDD Added debugging to record packets in both directions
//3. SDD Changed Regions and Categories to drop down list
//4. SDD Fixed consolidated KeyStats report
//5. SDD Warning after entering a note without clicking Add Note
//6. SDD Changes to Revenue Journal for Kennards
//7. SDD Fix legend on Occupancy report for Move-In & Move-Out data
//8. SDD Fix KeyStats for US sites with tax rates
//9. SDD Added sending of email to urgent@storman.com where there are too many items in the CheckSum file.
//10. SDD Added UserLogin to NotesHistory, Transaction, Agreement, Reservation
//11. SDD Trigger error no -16002 if Facility Code portion of field does not agree with other fields Facility Code
//12. SDD For Central new option on Find Customer dialog to Search All Sites
//13. SDD Allow Notice based on -days before MoveOut to send while Agreement is still active
//14. SDD When changing facilities by clicking in the control window lists will now refresh
//15. SDD Banking Report - Option to remove the first three columns on the report
//16. SDD Add new Support & Help Centre under View Mail
//17. SDD Changed Customer Bals report to display Unit No if sorted by that.
//18. SDD Method SyncDisplayArrays to assist with checking SeqNo mismatches. Also put description in log.
//19. SDD Stop Send to all sites message on server startup.  This should now be updated manually by support to avoid problems at HOF.
//20. SDD Monthly Summary Report - Change calc of arrears for Planet to exclude ArrearsNo1
//21. SDD Print Event Log - Adjust to fit US Letter paper
//22. SDD Rental Rate Variation Report - Added option to Exclude Units that only have a BillPlan Discount as these can be considered normal.
//23. SDD Remove EventLog records older than 200 days automatically at midnight for servers running then
//24. SDD System Setup - Page 3 - Added new checkbox Ignore Bill Plan Disc when Calc Occup Actual Value - Kennards
//25. SDD Forced backup on standalone at least 1 during Daily Processing
//26. NLT Cheques for Kennards
//27. SDD Fix problem with SyncCreateAll for client server
//28. SDD Changed method of sending agreements to be fixed / resent to use an EventLog
//CHANGES IN 4.1.0 29/9/04
//1. SDD Fixed problem sending Activity table using Send to Remote site and it set SyncStatus to 5 instead of 0
//2. SDD Adjustment to Great Plains exporting of bank trxs to include DocNum
//3. SDD Fix Graphs for monthly & weekly which showed all sites in Central
//4. SDD Problem where record number = 0 for drop down out list
//5. SDD Made seqno mismatch where site is one less than MV to still accept with value of 1 to stop repeats
//6. SDD Remove duplicate CHK records prior to running SyncUpdate
//7. SDD Various changes to support centre
//CHANGES IN 4.1.0 4/10/04
//1. SDD Fixed problem causing updates to replicate to sites without changing the date.
//2. SDD Turned syncing of photos on.
//3. SDD Stopped sending of blank email reminder messages
//4. SDD Fixed calendar notes problem when another process window was in front of control window
//5. SDD Fixed Ret Chk button to only when a valid receipt is selected
//CHANGES IN 4.1.0 6/10/04
//1. SDD Fix behaviour of default find button
//2. SDD Change Length of Stay reports to report in months instead of days.
//3. SDD Fix CheckMatchMisc displaying errors incorrectly during the banking report.
//4. SDD Changes to Total descriptions on the Customer Balances Report
//5. SDD Added code to display UnitNo on Income Charged report even when customer has moved out.
//6. SDD Prepaid Rent Rpt - Added new checkbox to Hide agreements with zero Rent in Advance - Planet request.
//CHANGES IN 4.1.0 3/11/04
//1. SDD Take payment at other site
//2. SDD Billing Plans - Added new checkbox called Bill Rent for Each Unit - If ticked this will create a separate rental trx for each unit on the agreement.
//3. SDD Long unit numbers, added code to reduce font size where unit number was longer, incl Unit Status Report
//4. SDD Adjustment to Processing Credit Cards to include Agreement number in Comments field
//5. SDD Added Notices Description to the sort order of Notices - National Oz
//CHANGES IN 4.1.0 17/11/04
//1. SDD Remove trigger code on [UserLogins] causing error when changing Facility Code.
//2. SDD Fixed bug in MoveOut calculation where MoveOutDate is changed after the Create Trxs button is clicked.
//3. SDD Fixed bug in Batch Print reports where vMthDate could be changed by KeyStats and then apply to all remaining reports. Charlie/Planet
//4. SDD Click Unzip to continue is now changed to 'follow the installer instructions ...'
//5. SDD Tutorial was repeated checking units on creating tutorial
//6. SDD New Datafile now uses correct Facility code for Notices import
//7. SDD When removing unit from reservation it will only change the status if not rented to someone.
//8. SDD List of Vacant Units - Don't show sizes that have no vacant units
//9. SDD The count (quantity) of units displayed on the front page of agreement info if more than 2 units.
//10. SDD Email Invoice now searchs for the correct billing plan and avoids movein or moveout notices.
//CHANGES IN 4.1.0 2/12/04
//1. SDD Fixed bug in Change Facility code - It now works
//2. SDD Fixed webservice for SendingSupportRequests & GetAgreementInfo
//3. SDD Fixed Copy All button in Analysis codes to try to prevent duplicate error
//4. SDD Correct Facility code record when printing after using Find All.
//5. SDD Unit Plan problem corrected in Central.
//6. SDD Modified Rental Rate Variation Report for Rent-a-space
//7. RWFR Sending of mail now searches Storman Support to determine whether support message or email.
//8. RWFR Batch Printing now puts facility code in front of filename to make unique file names.
//9. SDD Add routine IsQuicktimeAvail to stop corrupting of files when it is not
//10. NLT [Agreement]LastPmtDate is now updated for auto-paying customers during Daily Processing.
//CHANGES IN 4.1.1 10/12/04
//1. SDD Take payment at other site now completed
//2. SDD Auto FTP Backup now completed
//3. SDD Modifications to Proc CC and recording of time taken
//4. SDD Fix problem of Can't Mod Date appearing on server during Daily Processing
//5. SDD Change Prepaid Report to avoid divide zero.
//6. SDD Recalc Bals only incl active reservations
//7. SDD Change keyboard shortcuts
//8. SDD Add new button for sending support message from front screen
//9. SDD Add new field to BillPlan called Use Description on Invoice - Doug request
//10. SDD Modify Check Activity dialog to make more clear
//11. SDD Fixed importing of '#' in Agreement number for Other Credit Sales
//CHANGES IN 4.1.1 16/12/04
//1. SDD Added UserLogin to Notes import and AutoPay to Agreement import
//2. SDD Modification to Bank Reconciliation method
//3. SDD Added Inactive checkbox to Analysis Codes - If ticked this will not be displayed as an option on the drop down lists.
//4. SDD Add new menu item for Find Unit Avail at Other Site
//5. SDD Attempted to fix problem with CheckActivity logs being sent thru each day
//6. SDD Added Days Owing to Arrears Report
//7. SDD Added calendar note if movein is in future
//CHANGES IN 4.1.1 21/12/04
//1. SDD Fixed problem with Batch Print & Email reports for Central
//2. SDD Extended UnitType field from 5 to 10 chars and changed to drop down list
//3. SDD Set B/F analysis code to Taxable for NZ & Aust
//CHANGES IN 4.1.1 10/01/05
//1. RWFR Added in option for controlling access to sites in MV
//CHANGES IN 4.1.1 26/01/05
//1. SDD/RWFR Fixed invoices printing blank spaces and/or incorrect headers
//CHANGES IN 4.1.1 09/02/05
//1. RWFR Added in AutoPay Report
//2. SDD Fixed CreateSalesCustomer to allocate Customer code correctly
//3. SDD Fixed convert from Sales Inq / Resvtn to allocate NoActiveAgreemts and AgreemtsOperating
//CHANGES IN 4.1.1 15/02/05
//1. NLT Added [Agreement]TotInsUnpaid and Insurance Owing report - Planet request
//2. NLT Insurance automatically terminates after 30 days of non-payment (method Daily) - Planet request
//3. NLT Aged Receivables List - substitute Unit No for Agreemt No if report is sorted by unit - Planet request
//4. SDD Fixed problem with modreceipts that was causing the ok button not to show even when correct agreement was put in
//5. RWFR Added in ReadFalconGateLog to import LocalEvent.txt from Falcon 2000
//6. RWFR Added in lines to call ReadFalconGateLog to LogMonLoopCode
//7. NLT Added ability to select a date range for printing trx
//CHANGES IN 4.1.1 16/02/05
//1. RWFR Changed alert message for PrintoutDel to inform people to contact support
//2. RWFR Added units to Autopay report and allowed users to specify date range
//3. RWFR Changed message for customers overdue to say ALERT: GateAction: Customer Name
//4. RWFR Changed tooltip for Print Invoice button on transactions page
//CHANGES IN 4.1.1 18/02/05
//1. SDD Notes on Other Credit Sales now same as all others
//2. SDD Unit Status Report only allows one comment line
//3. SDD Help message on Cash / Accrual
//4. SDD Print Out Old & Delete allowable on Admin logins with warning messages
//5. SDD Enter Modify Payments - Fixed input form when Create New Supplier
//6. SDD Event Log - Facility code can be entered as part of agreement or customer no
//7. SDD Other Regular Charges - Changes negative amounts to positive
//8. SDD Full Unit number for PTI displayed on Main Screen
//9. SDD Gate On/Off Option moved to Access Control Setup screen
//10. SDD Purge button on View Access Log only displayed for Admin login
//11. SDD Updated PTI Gatelog to use current codes, if not one of the first 14 codes will display the code instead of message.
//CHANGES IN 4.1.1 07/03/05
//1. RWFR Added in code to support PDF-XChange 3.0
//2. RWFR Modified forms to set transparent so PDF-XChange will print correctly.
//3. SDD Added support for editing GateNo for Falcon Gate System
//4. SDD Menu's fixed from 18/02/05 build
//5. SDD Print out old & delete now show when logged in as admin on startup and not MV
//6. SDD MV Menu will not show for non-MV clients
//CHANGES IN 4.1.1 15/03/05
//1. RWFR Fixed userlogins array range check error
//2. RWFR Correct Current Balance Due field on Reservations form
//3. RWFR Added in Income & Occupancy Reconciliation Report
//4. RWFR Changed Print to disk file to support PDF-XChange 3.0
//5. SDD Removed OK and next from existing Charges
//6. SDD Alert now shows when choosing No to a receipt reseting the late cycle when overdue
//7. SDD Stoped MV creating duplicate sync record numbers when a transaction is created at HOF
//8. RWFR Added option for PDF to be launched after printing
//9. RWFR Set Storman to default to using PDF-XChange 3.0
//10. RWFR Set Storman to use "Print Location" when PDF-XChange 3.0 is installed
//CHANGES IN 4.1.1 18/3/05
//1. SDD Added Check All Sites checkbox to CheckActivity - This is useful in MV to calc the second option
//2. RWFR Added Generate Random PIN to Access & Ins
//3. RWFR Fixed IO Rec Report to show correct figures
//4. SDD Fixed ability for HOF clients to rent units at multiple sites
//CHANGES IN 4.1.1 30/3/05
//1. NLT  Vacant units report can now be printed by the Unit Types Sort order as well as by the monthly rate - Planet request
//2. NLT  Dynamic Rent Control - Added an upper & lower limit for the monthly rate.  - National Mini request
//3. NLT  DRC - Modified the update method so that it always takes the higher of the fixed increment or the percentage - NM
//4. NLT  Fixed bug where TotInsUnpaid was not getting reset if more than 1 insurance charge added at a time. - reported by Kennards
//5. RWFR Added 7th Column for Auto Credit Cards in Banking Report - Kennards
//6. SDD Fixed problem when Adding a Letter to a Customer and there were more than 1 letter with the same name
//7. SDD Added code to Login to check the AdminSupport password from Storman Users
//8. SMG Added method called 'EncryptIt2' using different encoding technique that is WS safe, former one 'EncryptIt' is not WS safe.
//9. SMG Modded WSC_CheckAdminSPassW changing WS_SiteName to WS_FacilityCode, changing WS call namespace, calling decryption code in 'EncryptIt2' method
//10. SDD Fixed problem of password being printed in clear text from Custom Design.  Now only Admin users can do this.
//11. SDD Changed WSC_CheckAdminSPassW to save the updated password in case SUV is not working at later date.
//12. SDD Set CheckUpdate to run every day for computers connected to internet.
//13. SDD Selecting Open Website will give the option to display the password for this Storman usercode.
//14. RWFR Changed the multiple users logged on when printing reports message to be clearer.
//CHANGES IN 4.1.1 31/3/05
//1. SMG Fixed AdminSupport login
//2. RWFR Fixed UnitHistory dates in Demo
//CHANGES IN 4.1.1 04/04/05
//1. SDD Fixed Stock Report
//2. RWFR Added Last Daily Processing to Modify Facilities
//CHANGES IN 4.1.1 7/4/05
//1. SDD Fix possible reason why SyncStatus gets set to 10
//2. SDD Allow option to print Customer Balances without recalc balances by holding down the shift key.
//3. SDD Whenever IT_SetTimeOut is called setting it to "1" it resets it back to "30".
//4. SDD Button names on front screen now use the settings in Access Control Setup.
//CHANGES IN 4.1.1 8/4/05
//1. SDD Force page orientation to Portrait before printing on receipt printer in Recalc method
//2. SDD If Gate Sys is Off at startup on single user it will ask if you want to turn it on.
//CHANGES IN 4.1.1 13/4/05
//1. SDD Take Pmt at Other site - Added new column for RentAmt which makes it easy to know rent if it has not been billed
//2. SDD Import Lock.dat had a problem if Windows text file was char(13)+char(10)
//3. SDD Removed TimeZones options from Falcon 2000 & Access Ezy as they can't use that option
//4. SDD Fixed problem downloading timezones
//5. SDD Central Log being sent out - Sort facilities in order of last date & time synced
//6. SDD Receive data from other site - Set any existing syncstatus of 0 to 1 before importing
//7. SDD When matching during LogMonLoopCode display agreement number being matched
//8. SDD TakePicture asks if you want to delete original file when using the Select File option
//9. SDD Contacts2 - When sending an email you can now select more than 1 attachment
//10. SDD Other Credit Sales - Can now be set from Active to Inactive and back.
//11. SDD Cust Processing, Other Credit Sales, Reservations - Allow movement to other tabs without having to save notes history
//12. SDD Don't allow Cancel button on Agree Info if a new successful CC transaction has been added
//13. SDD Daily Processing on Macintosh was displaying alert about DOS window! has been fixed
//14. RWFR Fixed Automatic Receipts defaulting to PDF-XChange Printer
//15. RWFR Added narration option on Invoices
//16. RWFR Increased purchase order length to 17
//17. RWFR Check for manual change of billing plan to more than 1 month combined with bill unit seperatly
//CHANGES IN 4.1.1 3/5/05
//1. SDD Fix bug in import Lock.dat
//2. SDD Change display of CC nos to X's
//3. SDD Fixed bug in Contacts2 on Macintosh
//4. RWFR Added ability to choose email or letters
//5. RWFR Added ability to use shift key to keep storman open when system control record needs fixing
//6. SDD Changed LogMonLoopCode so that UpdateActivity only runs between 12:30am-4:50am on Central
//7. SDD Changed export to GL for Quickbooks on Central
//8. RWFR Fixed Random Gate PIN code to write to the gate
//9. RWFR Fixed other PINS on Units to display name correctly
//10. RWFR Added option to convert log file from US dates in F2000
//11. RWFR Added Ctel Error Codes
//12. NLT Other Site Bank Reconciliation report added to the Central menu
//13. NLT Added option to bill late fees for each unit instead of each agreement (Planet)
//14. NLT Fixed bug in upper/lower limits for DRC 
//CHANGES IN 4.1.1 4/5/05
//1. RWFR Disabled take other payments and find unit at other site in MV HOF.
//2. RWFR Disabled ok button if cc transaction fails
//3. RWFR Reenabled syncing on PDFName
//CHANGES IN 4.1.1 12/5/05
//1. SDD Central calculation of Activity data to always be up to yesterday regardless of LastDaily
//2. SDD Updating of LastGateTime in variable instead of field so that 4D Backup Log doesn't get so big
//3. RWFR Updated CreateRevJrnls
//CHANGES IN 4.1.1 19/5/05
//1. RWFR Increased length of arrays for Find Units Avail at Other Site
//2. RWFR Added FFFF to end of download timezones - Doug to test
//3. SDD Optimize CheckActivity
//CHANGES IN 4.1.1 25/5/05
//1. SDD Fixed Invoice attachment to Letters
//2. RWFR Now opens website if available to list updates
//3. SDD Optimize startup launch when checking HOF site seq no & write out seq arrays at midnight
//4. SDD Allow selection of rented units when in Reservations
//5. SDD Fixed sorting of transactions in OtherCreditSales
//6. SDD EventType CHK - Fixed prob where size was > 32000
//7. SDD Fixed AccessEzy download all where port A was sometimes being lost
//8. SDD Added date check when syncing so will not allow syncing from site where computer date is wrong
//9. SDD Date check to ensure computer date is not set back or forward after launch
//CHANGES IN 4.1.1 26/5/05
//1. SDD/RWFR Added fix in SelectPDFDoc to prevent DP problems with PDF-XChange
//CHANGES IN 4.1.2 7/6/05
//1. RWFR All Kennards users will now have access to Download All functionality on the Gate
//2. RWFR Set GateLog to sync
//3. RWFR Added Update PTI Numbering button to Gatesetup
//4. RWFR National Bank DirectLink file now generated for National Bank customers (NZ)
//5. SMG Added new method for ProcCCAdvam & added new popup on System Setup to choose CC proc company
//6. SDD Make MarketingTypes to replicate for each site
//7. SMG Webstats fixed
//8. SDD If EventSeqNo is less than 2 it is assumed this is not a syncing facility - Events for these sites are set to '5' instead of '0'
//9. SDD Set max length of late cycle from 99 to 360 days
//10. SDD Fix Sales Inquiries attachment bug
//11. SDD Changed GST no on Invoice to VAT no and in the correct format of xxx-xxxx-xx
//12. SDD Added feature to Falcon Direct to send sundry command to Falcon - see Falcon documentation
//13. SDD Added 20 beeps to Falcon log if Unit Alarm is received
//14. SDD Turn Gate On at startup has been fixed
//15. RWFR Payrefunds now supports Kennards
//16. RWFR Now prefixes random pin with UnitNo
//17. RWFR Occupancy Report now works for UK
//18. RWFR Invoice's with Custom Header and Footer now will always have a white background
//CHANGES IN 4.1.2 8/6/05
//1. RWFR Further UK Fixes
//2. RWFR PDF-XChange Fix
//3. SDD Fixed bug in CreateCustCode where there were more than 100 customers with the same starting part of name
//4. SDD Added extra condition in select unit to stop units with a move out date > today + 31 being displayed
//5. SDD Will not allow cheque return date to be prior to [Facility]CantModPrior or to original transaction date
//6. SDD Clicking on the SendInvoice button will now create a Letter record for the customer.
//7. SDD Allow Falcon to read timezones in Other Access Functions - Timezones
//CHANGES IN 4.1.2 13/6/05
//1. SDD Add Send Invoice Now messages to Letter History
//2. SDD "Cracking the Max"bug
//3. SDD Reservations for Kelly Group
//4. SDD Cheque Returns not affected by Can't Modify Prior To date
//CHANGES IN 4.1.2 17/6/05
//1. SDD Fixed Read from Falcon error
//2. SDD Fix Take Payment at Other Site
//3. SDD Fix problem if EventLog record number is 0 and first of batch
//4. SDD Modified timing of LogMonServer for Central so that adReCalc begins at 9pm until 11:40pm then CheckArrays at 11:59pm then CheckActivityAll after 12:10am then adReCalc again from 2am-6am if not finished
//5. SDD Fixed possible search problem of GateLog records on control window
//6. SMG Added method for SendSMS
//7. SDD Added invisible button on new customer screen over the text of Mobile Phone on the Customer tab to send an SMS
//8. SDD Urgent message where segment exceeds 1.8GB
//CHANGES IN 4.1.3   06/07/05
//1. SDD Added syncing delays to keep LoopCodeSecs at HOF below 15 (Kennards)
//2. SMG Fixed Advam system
//3. SDD  Added code to prevent user from adding a Miscl Receipts trx without a valid Analysis code (NM)
//4. SDD  Added code to query the marketing types by facility
//5. SDD Auto Credit Cards and Other Cash Sales problem where OK and Cancel buttons fixed.
//CHANGES IN 4.1.3 07/07/05
//1. SDD Added ability to have Direct Debit transactions automatically created during DP (National Bank NZ)
//2. SDD Fixed problem with setting Unit status to Locked on UnitIn Form
//3. RWFR Removed reference to Access Ezy on logfile help
//CHANGES IN 4.1.3 08/07/05
//1. SDD Fixed Error in Cheque Return on the Transaction tab
//CHANGES IN 4.1.3 14/07/2005
//1. SMG Modified TransactionID field in Modify Receipts form to cater for Transaction ID number of 16 characters, modified surround fields to match 
//2. SMG Modified OtherPmts method to check for MV server availability before making webservice call to retrieve other Facilities list - crashed client before
//3. SMG ProcCCAdvam now returns the last 6 characters of the TransactionID for the Authorisation Code
//CHANGES IN 4.1.3 29/7/05
//1. SMG Modified ProcCCAdvam to try to avoid endless loop
//2. SDD Added new option on KeyStats report to Adjust Rental Income for Prepaid Rent
//3. SDD Modification of Export to GL for Great Plains to incorporate managed sites
//CHANGES IN 4.1.3 5/8/05
//1. NLT Fixed Bug in DRC lower limit where rate did not decrease by fixed increment if  % adjustmt=0
//2. SDD Fixed bug where passwords were displayed in Custom Designed if double clicked
//3. SDD Fixed hidden fields appearing in Apply Formula in Custom Designed Reports.
//4. SDD Added test to see if Quicktime is installed during TakePicture
//5. SDD Fixed error message on Enter Payments where Cancel button is pressed.
//6. NLT Added help tips to the upper / lower monthly rate fields in DRC
//7. SDD/RWFR Fixed GateLog syncing problem (and possibly a related Contacts table problem)
//8. RWFR Added Advam error code descriptions.
//9. SDD Added CalcRentedValues method to Income Occupancy Reconcilation
//CHANGE IN 4.1.3 8/8/05
//1. NLT Fixed display problem where SeqNo was not showing in [Transaction] table under custom designed reports
//CHANGES IN 4.1.3 11/8/05
//1. RWFR Fixed problem with Line 16 error on ReadFalconLog
//2. RWFR Corrected -3 values appearing on IORecReport
//3. RWFR Moved calculation of OldMonth to IORecReport method
//4, RWFR Alterered Occ Value Actual to use UnitHistory rather than Unit Table
//5. RWFR Alterered search parameters for IORecReport to use OldMonth earlier
//6. SDD Changed CalcBalances to calculate prepaid in a different way (will make old prepaid totals obsolete)
//7. SDD Modified WS_AddReceiptTrx to handle credit card coming from StormanUsers.
//8. NLT Stopped the lines at the top & side of the custom Receipts from printing 
//CHANGES IN 4.1.3 17/8/05
//1. SDD Error message for email - added who it is being sent to
//2. SDD Modified Agreements & Reservations to allow multiple agreements to be added simultaneously
//3. SDD Access Setup - Added new field for AccessEzy called Download Units for All Central Sites
//4. SDD Notice Details - Duplicate button didn't display all records after completion
//5. SDD Dont allow modification of RentAmt or DiscountAmt if below level specified on ModUsers item 1 Mod Agreement Dates & Amts
//6. SDD MoveOutCalc - If Remove Discount field is < 0 then it becomes zero
//7. SDD ExportRecJrnls GreatPlains - Change to create a single text file rather than multiple files for each date
//8. SDD Remove message re sites not syncing unless Admin user
//9. SDD Add CheckMatching to CheckActivity occuring during night
//10. SDD Pause while backup is run prior to Daily rather than Alert
//11. SDD Add more conditions to insurance automatic expiry for Planet
//12. SDD Modified ProcCCAdvam to include Timeout and Logging fields on System Setup form
//13. SDD Changes to TriggerLog & LogEvent to avoid event being sent through when banking is done at site that uses other site SeqNo
//CHANGES IN 4.1.3 22/8/05
//1. SDD Fix problem with Take Pmt at Other Site caused by 13 above
//2. SDD Fix problem with display of GateLog on front screen for Staff PINS
//3. SDD Fixed problem with CheckMatching as per item 9 above
//4. SDD Add three extra columns to banking report as an option with reduced font size
//CHANGES IN 4.1.3 29/8/05
//1. RWFR Fixed Customer Reciepts and Charges to show one week as default
//2. RWFR Fixed text errors on Modify Payments and Modify Facilities
//3. RWFR Fixed SelectSites form to not always show Select Sites...
//4. RWFR Added Start Date field to show on UnitIn form
//5. RWFR Changed Maintanence Comments to Invoice Number for Rental Manager Sites
//6. RWFR Added Depreciation Schedule for Rental Manager
//7. RWFR Added alert incase Autopay Authorisation has expired
//8. SDD Fixed Advam to make it work in New Zealand
//CHANGES IN 4.1.4 2/9/05
//1. RWFR Fixed Customer Reciepts and Charges to only show current facility data.
//2. RWFR Enabled fix date for Access Ezy US Customers
//3. RWFR New MV User System added
//4. SDD Set MerchantDetails field to sync
//5. SDD Cause Trxs with TotAmt of 0 to match
//6. SDD When clearing map in MV it does not now clear all sites maps
//7. SDD When converting Reservation to Agreement if you do not enter a valid date or Cancel it will not create agreement or update customer
//8. SDD Fix problem in ChangeSite causing asCharge arrays to be rebuilt and causing all charges to be set to KeyStatsCategory of Other
//9. RWFR Fixed rounding problem
//10. RWFR Changed all the location's "dont" appeared into "don't"
//11. NLT Bank Reconciliation Module
//12. SDD Income Received Report - Zero bal items were not appearing.
//13. SDD Other Credit Sales - Do not add the deposit to the Agreement table.
//14. RWFR Depreciation Schedule now replaces Stamp Duty Report on the menu for Rental Manager
//CHANGES IN 4.1.4 06/09/05
//1. RWFR Restored Invoice Number to Maintanence Comments for Rental Manager
//2. RWFR Added Invoice Number field to Units table for Rental Manager
//3. RWFR Corrected Depreciation calculation on DepSchedule
//4. RWFR Fixed US Date problem for Access Ezy
//5. NLT Fixed Balance column on Bank Rec printout; changed heading to read 'Closing Balance'
//6. NLT Fixed length of customer name and Analysis array - in ReconcileDetails form;  now displays first 30 chars of name and first 12 chars of analys description
//7. NLT Added line to include a search for facility code when doing the query for analysis codes at HOF (line 9 of ReconcileDetails method)
//8. NLT Changed button on Rec form to read 'Add Transaction'
//9. RWFR Added Unit Status to Access Ezy log import
//10. RWFR Fixed help message for Download All Units
//11. RWFR Added print button to Support Centre
//12. NLT Corrected Entry Order on Transaction Output form
//13. SDD Added SendSMS routine for Advam and Send SMS buttons on all customer, reservation & contact screens
//14. SDD Login at Startup now occurs at end of Startup routine to enable LogMonitor to begin prior to Login
//15. SDD Don't allow Other Credit Sales window to open in regular list
//16. SDD Modify Download all for Central and AccessEzy to download all units from all facilities
//17. SDD Other Credit Sales - Remove message Customer & Unit must be selected first
//18. SDD Changing Customer Code on Agreement screen now updates Transactions, Photocards, NotesHistory & GateLog records
//19. RWFR Fixed Day to bill not being correctly set on an undo last charges for weekly plan's.
//20. SDD Fixed Auto Credit Card analysis code not being selected during Daily Processing
//CHANGES IN 4.2.0 12/09/05
//1. NLT Modified code to ensure user can only enter a bank rec date greater than any existing bank rec date
//2. RWFR Renamed OpenAttach button to bOpenIncl as it was sharing it's name with the Add Attachment button
//3. RWFR Disabled print button on Support Message for now
//4. SDD Modify SynctoSite where there are now records to be returned
//5. SDD Update Advam SMS to include senders number in v2 of their specs.  This is now working well!
//6. SDD Check for duplicate time's when saving Contact records to avoid duplicates.
//7. NLT Modify ConfirmCloseBal to take into account trxs that have the same analysis codes but different dates banked to others that are also being reconciled
//8. NLT Fixed "Reconcile From" so won't create receipt amt when there are no rec'd trxs (happened if "rec from" date=Bank SM date)
//9. NLT Took out variable in Add Other Trx which if ticked set a trx to 0.  User now to enter -ve or +ve trx.
//10. SDD Fix PTD problem where there was a negative trx.
//11. SDD Fixed runtime error in CheckActivityData on server.
//12. SDD Mobile Phone - Dont use preset formatting for Aust or NZ (US do use same format) and auto prepend when using SendSMS.
//13. SDD Dont add Move In charges if they are already there from prior BillNextCharges call.
//14. NLT Fixed sort order of trxs to display after 'Add Bank Trx'
//15. NLT changed Opening Bal date on Print Rec to be the Chart Accts opening bal date unless user has entered another 'reconcile from' date.
//16. SDD Fixed SendSMS during Daily Processing
//17. SDD Fixed Moveoutcalc for Weekly plans
//18. RWFR Fixed AE Read method to read Unit Status
//19. RWFR/SDD BankAcName increased from 20 to 30
//20. RWFR/SDD When clicking SendSMS saves first 80 characters to Letters table
//21. RWFR/SDD [ChartAccts]Description length increased from 30 to 50
//22. RWFR Added clear button to PicturesIn Form
//23. SDD Generate Random PIN now can be set to be between 4 and 10 digits
//24. SDD Add Receipt - adjust signs so that credits appear to be positive
//CHANGES IN 4.2.0 13/9/05
//1. RWFR Fixed Manual Email to use Email Subject field rather than Notice Description
//2. RWFR Added facility code to Gate Log events from AE
//CHANGES IN 4.2.0 14/9/05
//1. RWFR Fixed Dep schedule pointing at Comments rather than Invoice Number
//2. RWFR Fixed writing of Facility for Users at HOF
//3. RWFR Fixed calculation of depreciation
//4. RWFR Fixed sort order for DepSchedule
//5. NLT Added DateBanked as a criteria for searching for trxs in the ReconcileDetails breakdown of trxs
//6. RWFR Changed unzip and zip to 7za
//7. RWFR Readded zip.exe for backups
//8. RWFR Renamed drawmap back to Letter_ so map's are not broken
//CHANGES IN 4.2.0 16/9/05
//1. NLT Changed sort order of trxs so displayed by Date Banked
//2. NLT Changed display of Debits so they display as positive and the Cheque total displays as positive.
//3. NLT Added Unreconciled Trxs report
//4. NLT Fixed [ChartAccts] BankBalDate when clicking cancel on the bank rec in a MVHOF or standalone file.
//5. RWFR Fixed date prompt for DepSchedule
//6. RWFR Hide Month option for Rental Manager as it is now redundant
//7. RWFR Removed Access Control Page on the Unit form for Rental Manager as it is not applicable
//8. SDD Added separate button for Use Card on File rather than holding down shift key and clicking on Swipe Card
//9. SDD Added option on the List of PINs report to include Mux/Channel/ Section/Numeric/Letter
//10. SDD Created additional Invoice layout with Custom Footer of 300 pixils instead of 180 high.  To select this option choose Custom Invoice Footer and Invoice Footer 2 immediately below
//11. SDD Other Cash Sales - Force operation of Min & Max Selling Amount
//12. SDD CheckActivity - When run from menu, does not calc initial occup which improves speed considerably - This can be done by choosing second option for single date first
//13. SDD ProcCreditCard - Add note to NotesHistory if credit card is unsuccessful
//14. RWFR Fixed Access Log showing incorrect facility data
//15. RWFR Added Unit Section and Letter to Output form for GateLog
//16. RWFR Redid GateLog input form to match others in system
//17. RWFR In Central it will only use (and show) the HOFacility Marketing Types
//18. NLT Added Select All and Select None buttons to Bank Rec 
//CHANGES IN 4.2.0 22/09/05
//1. RWFR Added copy to all button on Marketing Types
//2. SDD Modified MatchTrx to match a receipt to a single charge of the same amount if it exists
//3. RWFR Added option to send Alarm Events to an email address
//4. SDD Send Inv button disables Cancel on Customer Processing screen.
//5. SDD When doing new movein, if selecting existing customer, a warning is displayed saying it will share the same details as other agreements.
//6. SDD Allow site (facility) to be inactive by setting SortOrder to 1000 or more.  This will not then list on the floating window of sites or show that it is not syncing.
//7. RWFR Added tracking of manual rate changes to Unit Types for Monthly Rate Changes
//8. RWFR Fixed backup window staying open
//9. SDD Dont allow Inactive Analysis Code to be used when Adding a new Receipt.
//10. SDD Fixed problem with Take Payment from Other site
//11. RWFR Fixed sort order on Modify Users & Groups
//12. RWFR Added Alarm sound on Alarm event for AE, F2000 and PTI
//13. SMG Added new update method for Manual and Automatic Updates
//14. SDD Modify CheckVersion to do loop of transaction table rather than two Apply Formulae for speed
//15. SDD Modify AutoBackup method to put delay in loop checking file properties - hopefully avoid crash
//16. RWFR Added Find button on Modify Users & Groups screen
//17. RWFR Added print button on Modify Users & Groups screen
//18. RWFR Find and Print buttons on Access Log will only show current facility
//19. RWFR Added 3 more PTI codes
//CHANGES IN 4.2.0 23/09/05
//1. SDD Fixed Match Trx error
//2. RWFR Fixed Balance rounding problem
//3. SDD Added Version Date to Modify Facilities output form.
//4. RWFR Fixed facilitycode checking for login
//5. RWFR Added confirm to deleting a user
//CHANGES IN 4.2.0 26/09/05
//1. SDD Modified Advam URL for SMS
//CHANGES IN 4.2.0 29/09/05
//1. SDD Added Mail Merge to the Customer menu
//2. SDD Fixed up CheckActivity when calculating future dates from ReCalcActivity - Also it adds any missing Activity recs in the date range.
//3. SDD Fix problem in TriggerTrx causing Activity data to not get updated.
//4. SDD Modify saving of arrays to make sure array number matches FacilityCode
//5. SDD MoveOut calculation fields now set to Not Enterable where AccessLevel is less than that allowed to modify Agreement fields.
//6. SDD Fixed bug with could not locate Rental Income for Prepaid Journal error on loading a demo.
//CHANGES IN 4.2.0 9/10/05
//1. SDD SyncCreateCust - Modify to increment seqno if duplicate
//2. SDD ModUsers - Use full depth of screen to display list of users as this could be long at HOF.
//3. SDD ModUsers - Modified program to remove any duplicates of users at sites
//4. SDD AutoBackup - Tested & observed that when Compress option is selected to use .zip it will correctly wait until backup has completed before continuing but if not compressed it will not wait
//5. SDD PDF XChange - Licensing problem
//6. SDD Modified SyncDisplayArrays to include adReCalc & aiTrxSeqNo
//7. SDD Improved speed of ReCalcActivity & CheckActivity
//8. SDD Minor changes to Bank Rec - Withdrawal / Deposit - Sorting after double click - Added Difference field
//9. SDD Transaction screen - no double click option
//CHANGES IN 4.2.0 10/10/05
//1. SDD Fix problem where Client could not connect to Central where no user had HOF facility code
//2. SDD Tried to fix CheckActivityAll not running so long
//CHANGES IN 4.2.0 12/10/05
//1. SDD MatchTrx - Reset Facility record causing matches to run for all sites during CheckActivityAll
//2. SDD Added LogMonLoopCode to use RentRite as well as StormanPro
//3. SDD ReconcileNew - Fixed problem where site may use local BankRec record rather than HOF
//CHANGES IN 4.2.0 13/10/05
//1. SDD CheckActivityAll - Yet another attempt to make sure Facility selection remains set
//2. SDD ReconcileNew - Fixed calculation of Difference after adding a bank transaction
//3. SDD Marketing Types - Fix problems with display on MV
//CHANGES IN 4.2.1 4/11/05
//1. SDD Trx Detail Page - Make sure a transaction is always displayed
//2. SDD Trx Detail Page - Print Form button - Allow choice of forms where NoticePlanNo=9
//3. SDD System Setup -> Reports - Fixed Key Stats Custom Line field
//4. SDD Replicate Letter Graphics and create separate [Pictures] record for each facility
//5. RWFR Simplified Password checking and updating code
//6. RWFR Added change to prevent PIN codes starting with 0
//7. RWFR Added help message for RandomPIN
//8. RWFR Prevented AE users while using a card prefix from selecting a RandomPIN length greater than 5 (AE when using a card prefix only supports upto 65535 for a PIN)
//9. RWFR Changed generation of AE RandomPIN to prevent PIN's of greather than 65535 being generated if using a card prefix
//10. RWFR Set $Rand to 0 and $Random to "" each time RandomPIN is run
//11. RWFR If site is syncing to Central do not allow editing of users, instead display alert saying to contact HOF
//12. RWFR Will re-generate Random PIN if length is not the same as chosen in Gate Setup
//13. RWFR Added updating of UnitsOccup field when UnitNo is changed, will prompt for confirmation incase of multiple units
//14. RWFR LogMonLoopCode now tests for the presence of veLetter_.4WT, veLetter_, veEmail_.4WT and veEmail_ then deletes them if found
//15. RWFR Changed tooltip for photo compression to explain the setting accurately
//16. RWFR Included Quantity in min and max amounts calculation for charges
//17. RWFR Fixed Gate Alarm Email code
//18. RWFR Analysis Category now only displays current site
//19. RWFR If Random GatePIN Length is set to 0 now displays alert
//20. RWFR Resorts ModUsers after adding a new user
//21. RWFR Random GatePIN using Unit Prefix now uses Unit Numeric
//22. SDD Fixed runtime error in CheckActivityDetail
//23. SDD Modified ServerMonitor to relaunch LogMonServer within 15 secs if it stops instead of 10 mins
//24. SDD Modified LogMonitor to only report to Admin if LogMonServer stops
//25. RWFR When logging in at a MV site it now loads then unloads the record correctly
//26. RWFR If Random GatePin Length falls outside the 4-10 range will display alert
//27. NLT Add ability to select an Analysis Code for trx added under Add Other Transaction for Bank Rec
//28. NLT Opening balance and Last Reconciled Date added to the first dialog box of the Bank Rec
//29. NLT Bank Statement date for first dialog box in the Bank Rec now defaults to the current date
//30. NLT Add ability to modify and delete a transaction added under "Add Other Transaction", if trx has not been reconciled.
//31. NLT Transactions that have been reconciled cannot be modified under customer transactions.
//32. NLT changed ModReceipts, ModReceiptsOthrSite, BankingRpt, BankingSumry, ChequeReturn, methods to only search for Analysis codes for receipts with SortOrder >50 and <=95.  Codes > 95 are for Other Trxs.
//33. NLT  Bank Rec - Fixed bug where Central reported that it could not obtain the bank balance from the HOF server!
//CHANGES IN 4.2.1 8/11/05
//1. RWFR Fixed Add and Find Users to not display Adminsupport, Sync or Daily logins
//2. RWFR Fixed display of title date on Dep Schedule
//3. RWFR Fixed Depreciation Calculation, shows 0 if Purchase Date or Depreciation is 0.
//4. RWFR Increased space for GSTCost
//5. RWFR Depreciation now shows decimal's
//6. RWFR Disabled Double click on Userlogins Output form
//7. SDD Enabled Event Log records for Pictures table
//8. RWFR Corrected Copy to all text for Marketing Types
//9. RWFR Double click enabled on Transactions page in MoveIn Form
//10. SDD Adjustment to ReCalc method to fix problem with Matching on loading of Customer Agreement record
//11. SDD Modification of Prepaid Report to use new method previously introduced around 12/10
//12. RWFR Added Purchase Date request to Dep Schedule
//13. NLT Modified Key Stats routine for Kennards so shows inactive customers in arrears separately.
//CHANGES IN 4.2.1 10/11/05
//1. RWFR Added Date Check for the Website Password method
//2. RWFR Added a check to ensure that random pin's do not start with a "-"
//3. RWFR Set Gate Alarm email's to be set as "Out"
//4. RWFR Altered calling of Send Mail during Gate Alarm to be called as each message is created
//5. RWFR Converting a reservation to an agreement will correctly use the default first billing plan
//6. RWFR When changing from a Weekly to a Monthly billing plan the Day to Bill is set to the Next Bill Date
//7. RWFR Message for Processing of Credit Cards altered to fit customer code
//8. RWFR Other Charges will not be rounded like the Rent
//9. RWFR Sales Inquiry to Reservation will now use the same Reservation Number behaviour as ReservationsIn
//10. SDD Enabled change of Move Out values
//11. SDD Prevented saving of UnitType table while open
//12. SDD Set Userlogins record not to unload during login
//13. NLT Adjust columns for Cash Received Analysis Report so that fits on USLetter - Planet
//13. NLT changed [Agreement]FindCust form so that "search all sites" defaults to be unticked - Planet request
//CHANGES IN 4.2.1 11/11/05
//1. RWFR Disabled double click on Transaction page of MoveIn form due to complications.
//2. SDD Fixed Letter not saving for ContactsIn form
//3. SDD Fixed view button opening Support messages in wrong form
//CHANGES IN 4.2.1 18/11/05
//1. RWFR Changed labels on control screen for Rental Manager
//2. RWFR Menu items relabelled and removed for Rental Manager
//3. RWFR Added an End Date field and reorganised UnitIn form to accomodate
//4. RWFR Added Sale Price and Disposal Date titles to UnitIn form for Rental Manager
//5. RWFR Disallowed Accumulated Depreciation to exceed Cost Price
//6. RWFR Added Book Value column to Depreciation Schedule
//7. SDD Modified StructureArray to allow Price Change subtable of UnitType to replicate
//8. SDD Modification of Prepaid Calculation to include discounts other than of type Rent
//9. SDD New Method TempAdjustPrepaid to modify DateTo field of Transaction for all Discounts in the last year
//10. SDD Modification to MoveInCode to report name of computer if a record is locked.
//11. SDD Modification to Agreement trigger to cause [Activity]InsureNew to get updated - Also added code to set [Agreement]InsureCommence date on Movein if Insurance is billed
//12. RWFR Fixed GatePIN for Staff pins displaying on Control Screen
//13. SDD Added Insurance New to the Key Stats Report - now displays New Policies / Tot Agreements w Ins / Tot Units w Ins / Insure Value
//14. SDD Added InsureNew to the CheckActivity method
//15. NLT Bank Rec - if trx not summed, add cust name to trx detail
//16. NLT Bank Rec - total trxs when open rec details
//17. NLT Change format of Bank Rec in Totals section.
//18. NLT Withdrawal / deposit drop down list 
//19. NLT Reconcile from button and date only avail for admin users
//20. NLT Fixed bug when click cancel at first dialog in Bank rec at MV end
//21. RWFR Fixed string error on Unit method
//22. RWFR When updating 4D Server it no longer displays an alert method and quits after 5 minutes (which gives notification on the Clients)
//23. RWFR Depreciation Schedule now displays Deprectiation for the current financial year
//24. SDD Modification to CalcRentAdvance to separately calculate Rent & Other items in advance
//25. RWFR Removed area related items on the KeyStats for Rental Manager
//CHANGES IN 4.2.1 21/11/05
//1. RWFR Altered Mail & Event Log setup to be Level 9 access rather than Admin
//2. RWFR Change Password now works for MV sites
//3. SDD Customer Processing - Transaction page - Don't allow Cancel button even on failed CC trx as note is written to NotesHistory
//4. SDD CalcAgedDebtors - Fix bug on line 71 to make sure 11th element of array is cleared
//5. SDD CheckActivityAll - Added Line 18 vMax:=0 to avoid Sync Fail message on MV server after recalculations at night
//6. SDD FindDuplCCNo - New method to report on which customer has the same credit card number as the one being entered.
//CHANGES IN 4.2.1 22/11/05
//1. RWFR Changed display of Door Open/Close and Arm/Disarm messages to include Unit No
//2. NLT Fix array range check error in ReconcileNew
//3. NLT Cust description display in Bank Rec now shows when a payment is taken at other site
//4. NLT Changed ReconcileNew method so if cannot find a ChartAccts record it will not let you go any futher
//CHANGES IN 4.2.1 25/11/05
//1. RWFR Set vTransID to be length 16 to match [Transaction]CCTransID
//2, RWFR vLeg1 is cleared during loading of MoveIn form
//3. RWFR User None can only see the HOFacility when at Head Office
//4. RWFR If a user does not have access to HOFacility they will not be able to login at Head Office
//5. RWFR Fixed ControlIncl to display other PIN users Name's correctly
//CHANGES IN 4.2.1 30/11/05
//1. RWFR View Access Log screen now only displays current facility after pressing a button on the screen
//2. RWFR Renamed AdvanceBillRentValue to AdvBillRntValue to remove Repair Nans error
//3. RWFR Removed the equals to prevent the Late Cycle Start Date from nearly always being reset
//CHANGES IN 4.2.1 2/12/05
//1. SDD Increase length of asFields from 20 to 30 to allow for longer field names as above.
//2. SDD Fix calculation of InsureNew on the Key Stats report
//3. SDD Undo Last Charges did not work if rounding was out by some cents - this is now fixed
//4. SDD Mod Charges & Mod Receipts - Have changed this to have two fields for positive & negative amounts
//5. SDD Allow Print Receipt button to be visible at all times on Modify Receipt form.
//6. SDD Inventory Inquiry - Fix drop out list of Analysis Codes in MV when using the Analysis Category
//7. SDD Allow multiple PIN numbers to be sent under Falcon 2000
//8. SDD Show version number on Facility List for Head Office Facility
//9. RWFR Hide Customer "Renting" unit if Unit is Vacant
//10. RWFR Stored AgreeNo and CustomerName as variables so they are not lost when changing tabs
//11. RWFR Set as Form button hidden as no longer needed
//12. RWFR For AE and F2000 if Storman has read the Gatelog file and is unable to delete it then it disables the gate system and sends an email to us
//CHANGES IN 4.2.2 15/12/05
//1. NLT Bank Rec Report - changed Cheques to Withdrawals and Receipts to Deposits
//2. NLT Increase column size of Desc column on Bank Rec Report and make the banked date the first column - Kennards
//2. NLT Bank Rec Report to show cust name if trxs are not summed; if a returned cheque, shows the Cheque No.
//3. NLT Add Bank Trx - Date Banked now modifiable and Trx Date set to be the current date and not modifiable.
//4. NLT Find buttons added to Bank Rec for Date Banked, Description and Amounts
//5. RWFR Added option to enable or disable a Swipe Card Reader and now displays Enter Card on ModReceipts, MiscReceipts and ModOtherSiteReceipts if not selected
//6. RWFR New option for Swipe Card Reader when disabled also disables the Trigger that causes it to skip from field to field on the Swipe Card form
//7. RWFR View Access Log and GateIn form now display the Remote Name if entered into Access Control Setup
//8. RWFR Ticking or unticking Last 31 Days Only on View Access Log now only displays records for that facility
//9. RWFR Removed blank object methods, added SetColours, and formatted the GateIn form to match other Input forms
//10. SDD Change start time in LogMonLoopCode from 8pm to 9pm for updating adRecalc and to 10pm for Kennards - Their new backup time is 9:30pm instead of 7:30pm
//11. RWFR When a customer enters the facility for PTI/F2000/AE it changes their status to OnSite (displays this on the map as well) and when they exit it changes them back to rented
//12. RWFR Added Master PIN input option to StaffPINS page in Central
//13. RWFR StaffPIN and Photocard PIN fields will only accept numeric entry
//14. RWFR View Access Log now shows correct name (Customer or PhotosCards)
//15. NLT changed column header for Paid To Date Agreemts report from Tot Rent to 'Rent Owing' - National Mini
//16. NLT changed CheckVersion method so that any sites updating from < 414 - only sets Trx prior to CantModPrior to be reconciled.
//17. NLT added Print Previous Bank Rec under Accounting menu
//18. RWFR Redesigned PrintGateLog to show all fields present on the View Access Log, also will now display correct customer name and remote name if entered.
//19. RWFR Modified associated Print buttons for new PrintGateLog
//20. SDD When a duplicate Photoscards PIN code is entered it now clears it.
//21. RWFR If you try to access the gate setup at a HO Facility and the HO Facility itself does not have a gate it will inform you that you need to perform these functions at the site
//22. SDD Fixed manual matching always being overridden by auto-rematching
//23. NLT output form under Modify Facilities changed for Kennards to include banking stuff and exclude contact details.
//24. NLT added menu item to allow to unreconcile the previous bank rec.
//25. NLT MoveInOut method changed so the facility code is queried when creating the marketing types list
//26. RWFR 0B and 0C commands will no longer be sent as they are not needed anymore for PTI
//27. SDD Added option for PTI to Clear All Unit Data (PTI Specific Options)
//CHANGES IN 4.2.2 16/12/05
//1. RWFR Fixed negative amounts not showing on Prepaid and Income/Occupancy
//2. RWFR Corrected Gate Display (On Load does not work, changed to Before) and corrected display for AE
//3. RWFR Disabled double click on PhotosCards section in Agreement form
//4. SDD Download to gate for timezones will work without having to force a save of the subrecords
//5. RWFR Hid masterpin due to KSS no longer wanting it
//6. RWFR Added function to erase excess extra PINS automatically when no longer needed from PTI/F2000
//CHANGES IN 4.2.2 19/12/05
//1. RWFR Reading timezones now correctly places the colon
//2. RWFR When reading timezones after deleting exisiting subrecords it saves the Facility record
//3. RWFR Removed the deletion of menu items for Rental Manager as it causes problems
//4. NLT Modify Bank Rec report so Opening Bal only appears on first page.
//5. NLT Add customer descriptions to Unreconciled Trx report
//6. NLT Modify Add Other Trx so that it comes back to the main screen after mod / adding a trx
//7. NLT Modify bank rec so that a MV site does not need the facility code entered in the b1 cashbook accounts.
//8. NLT Add a new report for Kennards which shows last daily proc, last banking, last bank rec and bank rec bal by facility - printed under Modify Facilities.
//CHANGES IN 4.2.2 20/12/05
//1. NLT Modified ModReceipts and ModCharges form methods so if you click add refund or credit and the amount is 0, it still labels the trx as a credit or refund
//2. RWFR CheckGatePIN now searches the Staff PINS subtable as well
//3. RWFR Altered content of gate alarm email to include GateDate and GateTime in the body of the email
//4. RWFR PhotosCards on Movein form no longer hides blank entries till you press Add
//CHANGES IN 4.2.2 21/12/05
//1. RWFR Fixed Advam payments not working with Take Payment at Other Site correctly, now you have to click the ok button
//2. RWFR Before uploading photoscards records to the gate it sorts by UnitSuffix
//3. RWFR NotesHistory record is not written on CC fail if customer is at another site
//4. RWFR For PTI the Customer at the time will be written to the Gate Keyed field prefixed by %#
//5. NLT Fixed array range check error in Print Old Bank Rec 
//CHANGES IN 4.2.2 22/12/05
//1. NLT Add Other Trx, made Trx Date enterable and not able to be past Bank Stmt date - needs to be so can backdate for Export to GPlains.
//2. NLT Fixed ReconcileNew so when finding any unreconciled 'other trxs' at HOF end it searches for the facility code
//3. NLT update CreateRevJnls so trxs with sort order > 95 are written to the export file and the [CashBookTrxs]AcctNo is assigned the value in [Supplier]Phone
//4. RWFR Increased length of GateKeyed field to 43
//5. RWFR On GateLog Output form and the PrintGateLog it will not show the name in the gatekeyed field
//6. SDD Added Trace to end of Control method
//CHANGES IN 4.2.2 23/12/05
//1. RWFR Fixed Marketing Types displaying all, missing ;* from Query
//CHANGES IN 4.2.2 29/12/05
//1. SDD Adjustments to SyncFromSite to allow SyncError 151 to correctly update from sites after a Central restore
//2. SDD Sign change to Add Refund button when using Advam
//CHANGES IN 4.2.2 18/01/06
//1. RWFR Fixed AP form amount not including tax when tax is added
//2. RWFR When Required becomes Expected Move In when converting a Sales Inquiry to a Reservation
//3. RWFR Auto Door Rearm sets unit back to Rented
//4. RWFR Invoice modified for STCNZ Billing purposes
//5. RWFR Fixed "Trading As" bug on Invoices
//6. RWFR LastBillAmt now takes account of tax when tax is added
//7. RWFR Unit in description is removed for facility STCNZ
//8. NLT Added 'IF OK" conditions to GLExport so that if cancel at a date request box it won't process any further (Kennards)
//9. RWFR Modified CheckCCExpiry so that it reverses the day / month when checking the expiry date for US sites (Planet)
//CHANGES IN 4.2.2 24/01/06
//1. RWFR Fixed Customer Analysis Report displaying categories from all sites
//2. RWFR Swipecard now sets transaction date to current upon successful transaction
//3. RWFR ProcCreditCards now allows for credit card refunds
//4. NLT Added UnrecTot field to Facility table and to Modify Facilities screen and report (Kennards)
//5. NLT Set InsureCommence and InsureExpiry to non-enterable if userlogin below certain level
//6. NLT Added Temp method TempInsureCommence to run through all active agreements and set their insure commence date based on insurance trx.
//7. NLT changed goto record variable name for ChartAccts - bug where opening bal was not written to the record
//8. NLT fixed bug where 'Add Charge' defaults to the first amount in the list and does not change if selecting another anlys type.
//9. NLT fixed bug in Bank Rec where some trx not displayed if more than 1 type of GLCode but only one set of Anlys codes
//CHANGES IN 4.2.3 31/01/06
//1. RWFR/SDD Fixed SyncCreateCust and SyncCreateAll with transactions from other site setting events to status 5
//2. RWFR/SDD Events received at the site from MV will now update the gate system
//3. SDD Modified SyncDecode to avoid problem of SeqNo for other site changing for this site and stopping syncing
//4. NLT Modified ResetChge method to fix bug in modifying a charge trx.
//5. NLT Added Movein date field to unique Key field check when sending through the Unit History table  
//6. RWFR/SDD Fixed problem where the update gate from MV getting stuck in Sync cycle
//7. RWFR Fixed denied entries/exits for access ezy displaying incorrectly
//CHANGES IN 4.2.3 ??/02/06
//1. NLT Fixed bug in Daily where insurance not cancelling for customers who haven't paid - Planet
//2. NLT Fix TempFixDateTo - open window and analysis table added to GOTO selected record
//3. NLT Prepaid Rent report - CalcRentAdvance, and calling method, made vNotes wider on the output form
//4. NLT SyncToSite and SyncFromSite - 151 code: if the diff between the MV and site SeqNo's is >0 (used to be > 3) it will retrieve site data
//5. SDD change to TempAdjustPrepaid so can search for the description - National Storage
//6. RWFR Added Event type 14 to PTI, also modified some checks to include unit details
//7. RWFR Readded abs to $Amount and added a $Refund which changes the transaction total amount to negative after processing
//8. RWFR Extended TrxDate on PrintOutOld form
//9. NLT Added 'for [Facility]Name' to header on BankRec and Unreconciled Trx reports - Kennards
//10. RWFR Added a delete button for level 9 users for UnitType Rate Change History
//11. RWFR Added temp method "TempDelRC" to fix wrong record count for Avondale
//12. RWFR Added alert for versions less than 6.1.0 that the prepaid report has changed
//13. NLT Added TempFixDateTo to CheckVersion method on upgrading to 423
//14. NLT Fixed DateTo and DateFrom in Bill Next Charges for Billing Plan Discount transactions.
//15. RWFR Added alert and abort to EmailInvoice and SelectPDFDoc to fix PDF issue
//16. RWFR Moved number of users check back till after the login process
//17. RWFR Fixed printinvrec printing all customers invoices in MV if print invoice per customer option was selected
//18. RWFR Copy to all in Marketing Types hidden when not at MV
//19. RWFR Check Activity dialog when selecting the arrears option deselects the first radio button
//20. RWFR All normal special characters are now replaced when creating a customer code
//21. NLT Remove GST from prepaid amount in the Income Section of the Key Stats report
//22. RWFR If vFind = vNote it will clear vFind, this is to prevent the calender notes appearing in the find box
//23. RWFR Changed button labels on Vacancy Report to say Unit Price and Unit Type
//24. RWFR Credit spelling error corrected
//25. RWFR DateTo for billings is now set to go from the next bill date to 1 day short of the new next bill date
//26. RWFR Schedule for overdue agreements now includes unpaid insurance
//27. RWFR CreateTutorial now sets <>sProduct
//28. RWFR When deleting a selection in Custom Designed Reports on the transaction table, if you are not logged in as Designer or Adminsupport and the records you are trying to delete contain Other Cash Sales it will not let you delete them
//29. RWFR Changed entry order for Receipts so it goes from date to amount - NM request
//30. NLT Update Facility BankRecBal and LastBankRec fields when unreconciling a bank rec. 
//31. RWFR Set Take Payment at Other Site receipt button to use same code as a normal print receipt
//32. NLT Bank Rec date must be less than the date of the Last Daily Processing date.
//33. NLT Fixed sort order when cancelling out of 'Add Other Trx'
//34. NLT Added Centre name to top of Reconciled and Unreconciled trxs reports
//35. NLT Added totals to Unreconciled report
//CHANGES IN 4.2.3 16/02/06
//1. RWFR Added alert/abort if vName = "" when creating a customer code (fixes a problem if customer name is all symbols)
//2. NLT Fixed Export to Great Plains, where sort order > 95, causing it to not find the Chart Accts record and 'Not Known' being used for ChequeID
//3. NLT If select 'Chk Ret' button & 'Set Banked Date to Today' option is ticked for the returned check analysis code, it will set date banked to current date
//CHANGES IN 4.2.3 23/02/06
//1. NLT  Date Banked for Chk Returns set to equal TrxDate
//2. NLT Fix bug in Select All button where did not total properly if selection contained manually added bank trxs.
//3. RWFR Added 0F and 10 codes to ReadPTIGateLog
//4. RWFR DailyAutopay now double checks agreement has autopay set to true (to prevent wrong autopay charges)
//5. RWFR For the MerchantDetails field the site is not the master copy rather than the HOF
//6. RWFR Removed the setting of fields for the Bank Rec as currently only being used by KSS
//7. NLT suppress print dialog boxes for Graph of Occupancy and Customer Analysis reports when printed via batch printing
//8. NLT Remove ability to log other clients off if a Central data file, but still have warning (LogAction method)
//9. NLT If print Prepaid Report & record is locked, aborts the process and prints a page saying report couldn't be printed due to locked records.
//10. NLT Banking Rpt: if trx record is locked, pops up alert message for that agreeno & tells you to quit other clients & process again
//11. RWFR Added new agreement details printout for Rental Manager (will add for Storman for 6.1.0)
//12. NLT Increase the [ChartAccts]Description field from 50 to 55 - National Mini
//13. NLT Add SiteID field to [CashbookTrxs] table and save [Facility]GLCodeExt field to it when creating the Rec and Rev journals - NM
//14. RWFR Hid parts of Email Merge searching not currently working (Not done in 2004)
//CHANGES IN 4.2.3 01/03/06
//1. RWFR Added FloatMessage "AutoBackup" to LogMonLoopCode
//2. RWFR Added date check to prepaid report alert
//3. NLT Correction to Billing Plan Discount Tax field if ticked as shown on invoice - bug found in testing
//4. NLT Added Checksum field to Activity table
//5. RWFR Removed Central from Demo creation option, should only be demoed by Storman staff
//6. RWFR DateBanked field added to fields sent for OtherSitePmt (WSC_AddReceiptTrx)
//7. RWFR Added Checking of SetBankedDate to SwipeCard
//CHANGES IN 4.2.3 03/03/06
//1. NLT Fix bug where the [ChartAccts]ClosingBal was set incorrectly if the unreconciled report was run - new bug found in testing
//1. NLT Fix bug where the [ChartAccts]ClosingBal was set incorrectly if the unreconciled report was run - new bug found in testing
//2. RWFR If Credit Card has not been processed and Advam code is selected will prompt for processing upon clicking ok
//3. RWFR Fixed dropdown of Analysis Codes on ModReceipts
//4. RWFR Added note to EventLog Scheduling page
//5. RWFR Added check to see if $ErrorCode & $ErrorDescription are not blank (to prevent sync errors with no error code or description being emailed)
//6. NLT Fixed bug where LoggingOff always showing in green panel after first logging in.
//7. RWFR Fixed multiply units button not showing on Unit screen
//8. RWFR Added $2=4 and bOK=14 to FindCust and ModReserves to make double clicking on a reserved unit in the map work
//9. RWFR Fixed Inactive Analysis Codes appearing on MiscReceipts
//10. NLT Added SetFacility after ActionMail so that SendMail has facility record loaded when sending customer details to support
//11. RWFR Added checkbox to Income Receivables report to run check matching (previously this always ran, now the report is much quicker by default)
//CHANGES IN 9/03/06
//1. RWFR Added checks to MiscReciepts to ensure that the Date Banked is set
//2. RWFR Fixed bCheckMatch looking for 0
//3. SMG Web payments now set date banked if Analysis Code is set to do so and SUV2 has not sent through one
//4. NLT Fixed bug where if add a credit for a late fee it changed it to a charge - reported by NM
//5. NLT Added SiteID to the CashbookTrxs Output form
//CHANGES IN 14/03/06
//1. RWFR Fixed change password at MV not working when user did not have access to all sites
//2. NLT Added 'CLASS' to the export for Quickbooks
//3. RWFR Added check to ensure that the gatepin is > "" or that there are more than 0 photoscards records for the customer before setting them onsite
//4. NLT Changed Export to GL so it only asks once if you want to sum the receipts for the Receivables Accounts.
//5. RWFR Moved negative application of totamt to SwipeCard method
//6. NLT Waived Late Fee report - add query Event Date
//CHANGES IN 16/03/06
//1. RWFR Restored DateTo for billing to old method, as this was affecting Prepaid and Rental Audit reports among others
//2. NLT LogMonServer code - delete gate events from event log table after 2 days in the midnight routine
//3. NLT Activity table now logged from site end for specific fields and sent through to Head Office. SyncCreateAll, SyncCreateAllProc,SyncUpdateRecord,DailyActivity,TriggerLogActivity
//4. RWFR Added SUV2 checks to AutoFTP method
//CHANGES in 22/03/06
//1. NLT Modified ResetChg and GetPlusMinus so that if Add Credit is clicked and the default selling amt is 0, it still displays as a credit
//2. NLT Changed PrintPrevBankRec so if at a site you don't need to search for facility code in the report name on [ChartAccts] (was causing it to not print)
//3. NLT changed variable name for closing bal in PrintPrevBankRec as was not printing on the report
//4. NLT changed all reference to MV to M@ in ReconcileNew and UnReconcile methods.
//5. NLT Fixed Paid To Date where customer was in credit and [Facility]TaxAddtoAmt was ticked - Planet (DoBillNext & ReCalcUnpaid)
//6. NLT Changed the name of the Schedule of Rent in Advance to Prepaid Report under batch reporting
//7. RWFR GatePin will automatically be set to nothing, and the unit will correctly be set to vacant using F2000
//8. NLT Added ability for THQ to unlock a bank rec record if it didn't get unlocked during the bank rec (for whatever reason)
//9. NLT Change Modify Facilities report for Kennards to the new report format and default to landscape
//CHANGES in 27/03/06
//1. NLT Remove ability to search for records on the activity table to send specific dates from site to HOF (had a CLT event) - will need to redesign in future build
//2. NLT Remove vLeg from Add Other Trx screen - it wasn't used and was being set by other processes
//3. NLT Webserver now runs on Standalones and Client/Server - LogMonitor, StartWebServer & LogMonServer methods
//4. RWFR Rented copies of Storman will no longer be able to login 20 days after their rental runs out
//5. NLT Add refund was defaulting to a receipt if the customer owed money - have fixed
//CHANGES IN 4.2.4 10/04/06
//1. NLT Bank Rec - changed so it won't let the user proceed if they have entered a bank statement date that is greater than the last date banked
//2. NLT Fixed bug where some trx were not getting their dates unset if they weren't ticked as reconciled - KSS
//3. NLT Change to Banking Report where if Kennards it will show trx whose date banked has already been set
//4. NLT Change CreateRevJnls and ExportRevJnls so if Prepaid journal and it's KSS, take tax off - use Activity data instead of calcing
//5. RWFR Fixed Photos being displayed as Gate Cards
//6. RWFR Added menu bar to Other Credit Sales
//CHANGES IN 4.2.4 20/04/06
//1. NLT Added Nightly Export of Activity and UnitType data - Kennards
//2. NLT Modified 2x drop down boxes on ModCharges form so that Qty defaults to negative if adding a credit for stock - NM
//3. NLT If user at site end cancelled at first bank rec dialog box, it was not unlocking the ChartAccts record at HOF - have fixed
//4. RWFR Moved the Storman has started in On StartUp to before login allowing logmon to start
//5. RWFR Renamed cancel to logout on the login screen
//6. RWFR Cash sales no longer appears in Agreement List
//CHANGES IN 4.2.4 21/04/06
//1. RWFR Fixed Unit Types & Rates allowing access when it shouldn't
//CHANGES IN 4.2.4 24/04/06
//1. RWFR Removed check for Del RC History as was causing error message
//2. RWFR Fixed AccessLevel changes not saving
//CHANGES IN 4.2.4 26/04/06
//1. RWFR Changed message for Advam Cards that are not proccessed to allow you to continue
//2. RWFR Fixed Sales Inquiries being converted to a Reservation or an Agreement not being set to Actioned
//3. RWFR Changed Daily Process to set [Unit]UpdateGate to <>tGateSys
//CHANGES IN 4.2.4 10/05/06
//1. NLT Added time to footer of banking report - BankingRpt and BankingRptSml forms - Kennards
//2. NLT Made change to BankingRpt so they can run yesterdays banking report and set to banked without including future trxs - Kennards
//3. NLT Banking report includes trxs with date banked of the report date - Kennards
//4. NLT Added test to see if any records are locked when first coming in to bank rec - puts up an alert and aborts method if true.
//5. RWFR Added check for Unit Armed for setting back to Rented for AE
//6. RWFR Added sub-totals and totals to the Depreciation Schedule
//CHANGES IN 4.2.5 19/05/06
//1. NLT Fixed incorrect display of other faciitiy's moveout charges when doing a move-out in Central. 
//2. RWFR Fixed DepYear field not using report date for calculating year end
//3. RWFR Added checks to Unit History UnitIncl form to check movein & Moveout dates
//4. RWFR Added in Number of Receipt Copies, will default to 1 upon upgrade to 4.2.5
//5. RWFR Added message to ProcCreditCard
//6. NLT Fixed Closing balance of Print Previous Bank Rec; was broken in last build, and Closing Bal variable was always = to the ChartAccts opening balance
//7. NLT Allowed users with level 9 access to export from Unit, UnitType, Activity tables 
//CHANGES IN 4.2.5 01/06/06
//1. RWFR Added Unit Size to description for STCNZ
//2. RWFR Added Agreement Number to Transaction printout
//3. RWFR Disabled access to New Rent and New Rent From fields if access level is lower than that in modify users & groups
//4. RWFR Added PTI event 26 to ReadPTIGateLog
//5. SDD Fixed problem in OtherStartup causing [UnitType]RentAnalysis to be set incorrectly
//6. NLT Added Total summary to top of Unreconciled Report which is printed at the time of confirming the balances.
//7. RWFR Fixed Discount Amount not having Tax Added when Facility is on a tax excluded basis and chooses to show the incentive
//CHANGES IN 4.2.5 09/06/06
//1. RWFR RandomPIN method now checks StaffPINS
//2. RWFR Fixed RandomPIN checking index incorrectly on PhotosCards
//3. RWFR Removed extra custom footer code from DailyPrint as this was causing a problem and bug it was working around no longer present
//CHANGES IN 4.2.5 26/06/06
//1. NLT Changed Daily Processing so that if balance owing <=minimum bal for arrears it updates the LCSD.  Was only doing it if <, which caused probs if both were $0
//2. NLT Added set window title to end of Apply Formula box, as was not automatically updating the number of records in the selection
//3. NLT Added GetNextRentAmt method which can be used to display the new rent amt in a letter when a rental increase is pending - Planet
//4. NLT Added code to CheckMatchMisc so that it removes as many transactions as possible from the unmatched trx list - KSS / National OZ
//5. RWFR Corrected Recalc to Recalc(True) where appropriate
//CHANGES IN 4.2.5 30/6/06
//1. RWFR Added code to emailinvoice so it prompts to edit the message after creation
//2. RWFR Print Receipt button moved outside transaction
//3. NLT Miscl Receipts bug fixed - bAccept object method
//4. NLT Mod CheckMatchMisc so that it deletes orphaned miscl charges, and does this on upgrade to 425
//5. RWFR Enabled access to Date Banked, Transaction, Drawer and Bank Branch fields for Advam transactions
//6. NLT DailyAutoPay - added MatchTrxs line so that MisclDetls subrecord gets created when auto CC's and direct debits are added during daily - Planet KS Receipts
//7. RWFR When converting a Sales Inquiry to an Agreement or Reservation it prompts you to select a customer if one exists
//8. SMG Added Agreement number as Reference number to SendSMS method call in method DailyPrint (Phil Robbie requested this)
//9. SDD CheckUnitSeqNo method added to correct unit history errors - in occupancy rpt and checkversion 425 methods
//10. SDD Added UseWebServer field in Facility and updated CheckUpdate method & LogMonitor at beginning where Webserver launches
//CHANGES IN 4.2.5 13/07/06
//1. NLT Fixed CheckMatchMisc buttons being the wrong way round
//2. RWFR Added missing address fields on Transaction Printout
//3. NLT Abort Occup. Report if Unit Hist contains varying case letters for the same UnitNo - otherwise incorrectly reports errors (4D's order by is case sensitive).
//CHANGES IN 4.2.5 23/08/06
//1. RWFR Encrypted Adminsupport password in datafile
//2. NLT Set Banked Date message at end of Banking Report tells user what the date banked is being set to.
//3.  NLT Adminsupport user can modify receipt even if reconciled: ModReceiptOtherSite, ModReceipts, MiscReceipts
//4.  NLT removed code that unreconciles transactions from a previous bank rec using the Reconcile From button - is not used and could be potential source of probs
//5. RWFR Caused copy settings to always trigger eventlog
//CHANGES IN 4.2.5 25/08/06
//1. NLT added test to WSC_GetBankRecBal to only show error message saying it could not contact the HOF if it's a Central site.
//2. SDD / RWFR  /NLT fixed plus 12 bug - LogActivity, SyncUpdate, CheckActivityDetail, CheckActivityData, new method: UpdateOccupUnits
//3. NLT Delete $0 payment trx records at start of Bank Rec - were not getting set to reconciled and causing reconciled trxs to unreconcile
//4. NLT change to TriggerLogActivity so that always updates on OccupUnitNo field after Daily
//CHANGES IN 4.2.5 04/09/06
//1. RWFR Fixed FalconXT not having PTI.dat file moved to correct location
//2. RWFR Changed max timezone for StaffPINS to 32000
//3. RWFR Fixed Print Invoice not disabling cancel button
//4. NLT Added code to UnitHistory trigger so that all unitno's are saved as uppercase
//CHANGES IN 4.2.5 06/09/06
//1. NLT Fixed Bank Rec bugs only present at site
//CHANGES IN 4.2.5 08/09/06
//1. NLT Records Bank Rec items in the Event Log
//CHANGES IN 4.2.5 12/09/06
//1. RWFR Fixed error in DepSchedule
//2. NLT Fixed instructions when importing customers for a conversion - changed custcode from A5 to A10.
//CHANGES IN 4.2.5 26/09/06
//1. RWFR Changed SelectPDFDoc to use Win32API
//CHANGES IN 4.2.6 26/10/06
//1. NLT Fix DateBanked for MiscReceipts if Anlys code has set date banked option ticked (in bAccept method)
//2. RWFR Made modifications to SelectPDFDoc to ensure printer is set correctly
//CHANGES IN 4.2.7 06/11/06
//1. NLT Added Entry filter to Refunds / Receipts form so that user cannot enter a negative, and modify the ModReceipts form method so does not default to refund when add receipt to inactive cust
//2. SMG Added DD processing code
//3. SMG Fixed bug where Storman Server Control window disappeared and was causing default server windows to only partially display
//4. RWFR Added new DailyAutoPay Code
//CHANGES IN 4.2.7 06/12/06
//1. SMG Added code in ProcCreditCard to set the Date Banked date to the settlement date returned from Advam (If Analysis Code SetBankedDate to Today set to true)
//2. SMG Added Entry filter to BankAccountName field on Customer Info Tab for Advam DDs to prevent invalid characters
//3. NLT Add agreement and customer tables to overnight data export
//4. NLT Mod of export to Great Plains - various requests by KSS x 3 methods
//5. RWFR Blocked Undo Last Charges working prior to Can't Modify Prior date
//Changes in 4.2.7 20/12/06
//1. NLT Mod to overnight customer export - added fields requested by KSS
//2. SMG Modified Advam DD processing to complete successfully after receiving "Import Complete" Advam server response
//Changes in 4.2.7 23/1/07
//1. NLT Added Other Regular charges to overnight export
//2. NLT Change to formatting of KVSI export Revenue journals
//Changes in 4.2.8 13/4/07
//1. NLT Fixed bug where tax not calc'd for discount portion where incentive is shown separately and there is a date in System Setup Apply Tax Rate From field
//2.  NLT Added Analysis table to overnight export - KSS
//3. NLT Added future transactions to overnight export - KSS
//4.  NLT Added ability to modify description/drawer/branch field if trx has been reconciled - KSS
//5.  RWFR recalc of Inventory added to on upgrade method
//6. NLT Added extra code to alert message on exporting Receipts to Great Plains to show the analysis code it claims is missing
//Changes in 4.2.8 ??/??/07
//1. RWFR Increased length of POP and SMTP Host fields to 40
//2. RWFR Added error messages to DailyAutopay if DD customer info is missing
//3. RWFR Fixed Reservation not refunding deposit correctly