//%attributes = {"lang":"en"} comment added and reserved by 4D.
C_LONGINT($1;WS_EndArray;WS_StartArray)
C_BOOLEAN($0;$2;$3;WS_LeftArrow;WS_FirstLoad)
C_TEXT(WS_FacilityText1;WS_FacilityText2;WS_FacilityText3;WS_FacilityText4)
ARRAY TEXT(WS_asACCode1;0)
ARRAY TEXT(WS_asACDescription1;0)
ARRAY REAL(WS_asACInvQtyonHand1;0)
ARRAY REAL(WS_asACDfltSellAmt2;0)
ARRAY TEXT(WS_asACCode2;0)
ARRAY TEXT(WS_asACDescription2;0)
ARRAY REAL(WS_asACInvQtyonHand2;0)
ARRAY REAL(WS_asACDfltSellAmt2;0)
ARRAY TEXT(WS_asACCode3;0)
ARRAY TEXT(WS_asACDescription3;0)
ARRAY REAL(WS_asACInvQtyonHand3;0)
ARRAY REAL(WS_asACDfltSellAmt3;0)
ARRAY TEXT(WS_asACCode4;0)
ARRAY TEXT(WS_asACDescription4;0)
ARRAY REAL(WS_asACInvQtyonHand4;0)
ARRAY REAL(WS_asACDfltSellAmt4;0)
ARRAY TEXT(WS_asSiteCodes;0)
$0:=False
If (Count parameters>0)
WEB SERVICE SET PARAMETER("WS_StartArray";$1)
WEB SERVICE SET PARAMETER("WS_LeftArrow";$2)
WEB SERVICE SET PARAMETER("WS_FirstLoad";$3)
End if 
$PortPos:=Position(":";[Facility]CentralAddress)
If ($PortPos>0)
$PortString:=Substring([Facility]CentralAddress;$PortPos+1)
Else 
$PortString:="19812"
End if 
$Port:=Num($PortString)
$Error:=IT_SetTimeOut (1)
$Error:=TCP_Open (GetDNS ("MV");$Port;$TCPID;0)
If ($Error=0)
$Error:=TCP_Close ($TCPID)
WEB SERVICE CALL("https://"+GetDNS ("MV")+":"+$PortString+"/4DSOAP/";"Storman#WS_CheckStock";"WS_CheckStock";"Storman";Web Service dynamic)
WEB SERVICE GET RESULT(vEndArray;"WS_EndArray")
WEB SERVICE GET RESULT(asACCode1;"WS_asACCode1")
WEB SERVICE GET RESULT(asACDescription1;"WS_asACDescription1")
WEB SERVICE GET RESULT(asACInvQtyonHand1;"WS_asACInvQtyonHand1")
WEB SERVICE GET RESULT(asACDfltSellAmt1;"WS_asACDfltSellAmt1")
WEB SERVICE GET RESULT(asACCode2;"WS_asACCode2")
WEB SERVICE GET RESULT(asACDescription2;"WS_asACDescription2")
WEB SERVICE GET RESULT(asACInvQtyonHand2;"WS_asACInvQtyonHand2")
WEB SERVICE GET RESULT(asACDfltSellAmt2;"WS_asACDfltSellAmt2")
WEB SERVICE GET RESULT(asACCode3;"WS_asACCode3")
WEB SERVICE GET RESULT(asACDescription3;"WS_asACDescription3")
WEB SERVICE GET RESULT(asACInvQtyonHand3;"WS_asACInvQtyonHand3")
WEB SERVICE GET RESULT(asACDfltSellAmt3;"WS_asACDfltSellAmt3")
WEB SERVICE GET RESULT(asACCode4;"WS_asACCode4")
WEB SERVICE GET RESULT(asACDescription4;"WS_asACDescription4")
WEB SERVICE GET RESULT(asACInvQtyonHand4;"WS_asACInvQtyonHand4")
WEB SERVICE GET RESULT(asACDfltSellAmt4;"WS_asACDfltSellAmt4")
WEB SERVICE GET RESULT(vFacilityText1;"WS_FacilityText1")
WEB SERVICE GET RESULT(vFacilityText2;"WS_FacilityText2")
WEB SERVICE GET RESULT(vFacilityText3;"WS_FacilityText3")
WEB SERVICE GET RESULT(vFacilityText4;"WS_FacilityText4")
WEB SERVICE GET RESULT(asSiteCodes;"WS_asSiteCodes")
$0:=True
Else 
AlertMessage (Get localized string("Unable to contact Central."))
End if 
$Error:=IT_SetTimeOut (30)
