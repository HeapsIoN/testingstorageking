//%attributes = {"lang":"en"} comment added and reserved by 4D.
// 
// WSC_AdvamDeleteStoredPAN
// https://demo-gateway.advam.com/stored_pan/V2/StoredPAN.wsdl
// 
// Method source code automatically generated by the 4D SOAP wizard.
// ----------------------------------------------------------------

C_TEXT($1)//CustomerCode
C_TEXT($2;$3;$4)
C_LONGINT($5;$6;$Logging;$AdvamErr)//Logging,Timeout
C_LONGINT($Error)
C_TEXT(AdvamCCAction)
C_TEXT($statement_xpath;$value_t;$Sendcode)
C_BLOB($replyblob)
C_TEXT($xmlref;$xmlnode)
C_TEXT(AdvamCCAcc;AdvamCCUser;AdvamCCPass;AdvamCCAccNo;AdvamCCExpiryMonth;AdvamCCExpiryYear;AdvamCCName)

C_TEXT($root)
C_TEXT($subelem)
C_TEXT($namespace)

WS_AdvamSuccess:="0"

$Logging:=$5


AdvamCCAcc:=$2


AdvamCCUser:=$3
AdvamCCPass:=$4
AdvamCCPANID:=$1

$namespace:="http://storedpan.advam.com/V2/StoredPAN"
$root:=DOM Create XML Ref("DeleteRequest";$namespace)

$subelem:=DOM Create XML element($root;"/DeleteRequest/AdvamAccount";"xsi:type";"tns:AdvamAccount")
DOM SET XML ELEMENT VALUE($subelem;AdvamCCAcc)//AdvamAccount

$subelem:=DOM Create XML element($root;"/DeleteRequest/OperatorUsername";"xsi:type";"tns:OperatorUsername")
DOM SET XML ELEMENT VALUE($subelem;AdvamCCUser)//OperatorUsername

$subelem:=DOM Create XML element($root;"/DeleteRequest/OperatorPassword";"xsi:type";"tns:OperatorPassword")
DOM SET XML ELEMENT VALUE($subelem;AdvamCCPass)//OperatorPassword

$subelem:=DOM Create XML element($root;"/DeleteRequest/PanId";"xsi:type";"tns:PANID")
DOM SET XML ELEMENT VALUE($subelem;AdvamCCPANID)//PanId

If ($Logging=1)
DOM EXPORT TO VAR($root;$Sendcode)
SyncRecordLog ($Sendcode)
End if 

$namespace:="http://storedpan.advam.com/V2/StoredPAN"
$linkroot:=DOM Create XML Ref("LinkTestRequest";$namespace)

$subelem:=DOM Create XML element($linkroot;"/LinkTestRequest/Mode";"xsi:type";"tns:Mode")
DOM SET XML ELEMENT VALUE($subelem;"0")//Mode

WEB SERVICE SET PARAMETER("LinkTestRequest";$linkroot)

If ([Facility]TestAccount)
If ($Logging=1)
SyncRecordLog ("Open Test LinkTest")
End if 

WEB SERVICE CALL("https://demo-gateway.advam.com/stored_pan/V2/soap.php";"http://storedpan.advam.com/V2/StoredPAN/LinkTest";"LinkTest";"http://storedpan.advam.com/V2/StoredPAN";Web Service manual)

WS_LinkTestSuccess:="False"

If (OK=1)
WEB SERVICE GET RESULT($replyblob;"LinkTestResponse";*)

$xmlref:=DOM Parse XML variable($replyblob)
$statement_xpath:="/LinkTestResponse/Success"
$xmlnode:=DOM Find XML element($xmlref;$statement_xpath)

If ($xmlnode#"0000000000000000")
DOM GET XML ELEMENT VALUE($xmlnode;$value_t)
WS_LinkTestSuccess:=$value_t
End if 

End if 


If (WS_LinkTestSuccess="true")
If ($Logging=1)
SyncRecordLog ("Pass Test LinkTest")
End if 
WEB SERVICE SET PARAMETER("DeleteRequest";$root)
$Error:=IT_SetTimeOut ($6)
If ($Logging=1)
SyncRecordLog ("Open Test Delete")
End if 
WEB SERVICE CALL("https://demo-gateway.advam.com/stored_pan/V2/soap.php";"http://storedpan.advam.com/V2/StoredPAN/Delete";"Delete";"http://storedpan.advam.com/V2/StoredPAN";Web Service manual)
$AdvamErr:=Num(WEB SERVICE Get info(0))
If ($AdvamErr>0)
If ($Logging=1)
SyncRecordLog ("Error# "+String($AdvamErr))
End if 
$vhTimeStart:=Current time
Repeat 
$Time:=Current time
Until ((Current time-$vhTimeStart)>=?00:00:10?)
WEB SERVICE SET PARAMETER("DeleteRequest";$root)
If ($Logging=1)
SyncRecordLog ("Open Test Delete - Attempt 2")
End if 
WEB SERVICE CALL("https://demo-gateway.advam.com/stored_pan/V2/soap.php";"http://storedpan.advam.com/V2/StoredPAN/Delete";"Delete";"http://storedpan.advam.com/V2/StoredPAN";Web Service manual)
$AdvamErr:=Num(WEB SERVICE Get info(0))
If ($AdvamErr>0)
If ($Logging=1)
SyncRecordLog ("Error# "+String($AdvamErr))
End if 
If (Not(IsAWebProcess ))
AlertMessage (Get localized string("There was an error contacting the Demo Advam servers, try again later."))
End if 
$0:="ERR4IC"
Else 
If ($Logging=1)
SyncRecordLog ("Pass Test Delete - Attempt 2")
End if 
End if 
Else 
If ($Logging=1)
SyncRecordLog ("Pass Test Delete")
End if 
End if 
Else 
If ($Logging=1)
SyncRecordLog ("Open Test LinkTest - Gateway 2")
End if 
WEB SERVICE CALL("https://demo-gateway2.advam.com/stored_pan/V2/soap.php";"http://storedpan.advam.com/V2/StoredPAN/Insert";"Insert";"http://storedpan.advam.com/V2/StoredPAN";Web Service manual)
WS_LinkTestSuccess:="False"

If (OK=1)
WEB SERVICE GET RESULT($replyblob;"LinkTestResponse";*)

$xmlref:=DOM Parse XML variable($replyblob)
$statement_xpath:="/LinkTestResponse/Success"
$xmlnode:=DOM Find XML element($xmlref;$statement_xpath)

If ($xmlnode#"0000000000000000")
DOM GET XML ELEMENT VALUE($xmlnode;$value_t)
WS_LinkTestSuccess:=$value_t
End if 

End if 


If (WS_LinkTestSuccess="true")
If ($Logging=1)
SyncRecordLog ("Pass Test LinkTest - Gateway 2")
End if 
WEB SERVICE SET PARAMETER("DeleteRequest";$root)
$Error:=IT_SetTimeOut ($6)
If ($Logging=1)
SyncRecordLog ("Open Test Delete - Gateway 2")
End if 
WEB SERVICE CALL("https://demo-gateway2.advam.com/stored_pan/V2/soap.php";"http://storedpan.advam.com/V2/StoredPAN/Delete";"Delete";"http://storedpan.advam.com/V2/StoredPAN";Web Service manual)
$AdvamErr:=Num(WEB SERVICE Get info(0))
If ($AdvamErr>0)
If ($Logging=1)
SyncRecordLog ("Error# "+String($AdvamErr))
End if 
$vhTimeStart:=Current time
Repeat 
$Time:=Current time
Until ((Current time-$vhTimeStart)>=?00:00:10?)
WEB SERVICE SET PARAMETER("InsertRequest";$root)
If ($Logging=1)
SyncRecordLog ("Open Test Delete - Gateway 2 - Attempt 2")
End if 
WEB SERVICE CALL("https://demo-gateway2.advam.com/stored_pan/V2/soap.php";"http://storedpan.advam.com/V2/StoredPAN/Delete";"Delete";"http://storedpan.advam.com/V2/StoredPAN";Web Service manual)
$AdvamErr:=Num(WEB SERVICE Get info(0))
If ($AdvamErr>0)
If ($Logging=1)
SyncRecordLog ("Error# "+String($AdvamErr))
End if 
If (Not(IsAWebProcess ))
AlertMessage (Get localized string("There was an error contacting the Demo Advam servers, try again later."))
End if 
$0:="ERR4IC"
Else 
If ($Logging=1)
SyncRecordLog ("Pass Test Delete - Gateway 2 - Attempt 2")
End if 
End if 
Else 
If ($Logging=1)
SyncRecordLog ("Pass Test Delete - Gateway 2")
End if 
End if 
Else 
If (Not(IsAWebProcess ))
AlertMessage (Get localized string("There was an error contacting the Demo Advam servers, try again later."))
End if 
$0:="ERR4IC"
$AdvamErr:=1
End if 
End if 
Else 
If ($Logging=1)
SyncRecordLog ("Open LinkTest")
End if 
WEB SERVICE CALL("https://gateway.advam.com/stored_pan/V2/soap.php";"http://storedpan.advam.com/V2/StoredPAN/LinkTest";"LinkTest";"http://storedpan.advam.com/V2/StoredPAN";Web Service manual)
WS_LinkTestSuccess:="False"

If (OK=1)
WEB SERVICE GET RESULT($replyblob;"LinkTestResponse";*)

$xmlref:=DOM Parse XML variable($replyblob)
$statement_xpath:="/LinkTestResponse/Success"
$xmlnode:=DOM Find XML element($xmlref;$statement_xpath)

If ($xmlnode#"0000000000000000")
DOM GET XML ELEMENT VALUE($xmlnode;$value_t)
WS_LinkTestSuccess:=$value_t
End if 

End if 


If (WS_LinkTestSuccess="true")
If ($Logging=1)
SyncRecordLog ("Pass LinkTest")
End if 
WEB SERVICE SET PARAMETER("DeleteRequest";$root)
$Error:=IT_SetTimeOut ($6)
If ($Logging=1)
SyncRecordLog ("Open Delete")
End if 
WEB SERVICE CALL("https://gateway.advam.com/stored_pan/V2/soap.php";"http://storedpan.advam.com/V2/StoredPAN/Delete";"Delete";"http://storedpan.advam.com/V2/StoredPAN";Web Service manual)
$AdvamErr:=Num(WEB SERVICE Get info(0))
If ($AdvamErr>0)
If ($Logging=1)
SyncRecordLog ("Error# "+String($AdvamErr))
End if 
$vhTimeStart:=Current time
Repeat 
$Time:=Current time
Until ((Current time-$vhTimeStart)>=?00:00:10?)
WEB SERVICE SET PARAMETER("DeleteRequest";$root)
If ($Logging=1)
SyncRecordLog ("Open Delete - Attempt 2")
End if 
WEB SERVICE CALL("https://gateway.advam.com/stored_pan/V2/soap.php";"http://storedpan.advam.com/V2/StoredPAN/Delete";"Delete";"http://storedpan.advam.com/V2/StoredPAN";Web Service manual)
$AdvamErr:=Num(WEB SERVICE Get info(0))
If ($AdvamErr>0)
If ($Logging=1)
SyncRecordLog ("Error# "+String($AdvamErr))
End if 
If (Not(IsAWebProcess ))
AlertMessage (Get localized string("There was an error contacting the Advam servers, try again later."))
End if 
$0:="ERR4IC"
Else 
If ($Logging=1)
SyncRecordLog ("Pass Delete - Attempt 2")
End if 
End if 
Else 
If ($Logging=1)
SyncRecordLog ("Pass Delete")
End if 
End if 
Else 
If ($Logging=1)
SyncRecordLog ("Open LinkTest - Gateway 2")
End if 
WEB SERVICE CALL("https://gateway2.advam.com/stored_pan/V2/soap.php";"http://storedpan.advam.com/V2/StoredPAN/LinkTest";"LinkTest";"http://storedpan.advam.com/V2/StoredPAN";Web Service manual)
WS_LinkTestSuccess:="False"

If (OK=1)
WEB SERVICE GET RESULT($replyblob;"LinkTestResponse";*)

$xmlref:=DOM Parse XML variable($replyblob)
$statement_xpath:="/LinkTestResponse/Success"
$xmlnode:=DOM Find XML element($xmlref;$statement_xpath)

If ($xmlnode#"0000000000000000")
DOM GET XML ELEMENT VALUE($xmlnode;$value_t)
WS_LinkTestSuccess:=$value_t
End if 

End if 


If (WS_LinkTestSuccess="true")
If ($Logging=1)
SyncRecordLog ("Pass LinkTest - Gateway 2")
End if 
WEB SERVICE SET PARAMETER("DeleteRequest";$root)
$Error:=IT_SetTimeOut ($6)
If ($Logging=1)
SyncRecordLog ("Open Delete - Gateway 2")
End if 
WEB SERVICE CALL("https://gateway2.advam.com/stored_pan/V2/soap.php";"http://storedpan.advam.com/V2/StoredPAN/Delete";"Delete";"http://storedpan.advam.com/V2/StoredPAN";Web Service manual)
$AdvamErr:=Num(WEB SERVICE Get info(0))
If ($AdvamErr>0)
If ($Logging=1)
SyncRecordLog ("Error# "+String($AdvamErr))
End if 
$vhTimeStart:=Current time
Repeat 
$Time:=Current time
Until ((Current time-$vhTimeStart)>=?00:00:10?)
WEB SERVICE SET PARAMETER("DeleteRequest";$root)
If ($Logging=1)
SyncRecordLog ("Open Delete - Gateway 2 - Attempt 2")
End if 
WEB SERVICE CALL("https://gateway2.advam.com/stored_pan/V2/soap.php";"http://storedpan.advam.com/V2/StoredPAN/Delete";"Delete";"http://storedpan.advam.com/V2/StoredPAN";Web Service manual)
$AdvamErr:=Num(WEB SERVICE Get info(0))
If ($AdvamErr>0)
If ($Logging=1)
SyncRecordLog ("Error# "+String($AdvamErr))
End if 
If (Not(IsAWebProcess ))
AlertMessage (Get localized string("There was an error contacting the Advam servers, try again later."))
End if 
$0:="ERR4IC"
Else 
If ($Logging=1)
SyncRecordLog ("Pass Delete - Gateway 2 - Attempt 2")
End if 
End if 
Else 
If ($Logging=1)
SyncRecordLog ("Pass Delete - Gateway 2")
End if 
End if 
Else 
If (Not(IsAWebProcess ))
AlertMessage (Get localized string("There was an error contacting the Advam servers, try again later."))
End if 
$0:="ERR4IC"
$AdvamErr:=1
End if 
End if 
End if 

DOM CLOSE XML($root)
DOM CLOSE XML($linkroot)

If ($AdvamErr=0)
WEB SERVICE GET RESULT($replyblob;"DeleteResponse";*)

If ($Logging=1)
$Receivecode:=Convert to text($replyblob;"UTF-8")
SyncRecordLog ($Receivecode)
End if 


$xmlref:=DOM Parse XML variable($replyblob)
$statement_xpath:="/DeleteResponse/Success"
$xmlnode:=DOM Find XML element($xmlref;$statement_xpath)

If ($xmlnode#"0000000000000000")
DOM GET XML ELEMENT VALUE($xmlnode;$value_t)
WS_AdvamSuccess:=$value_t
End if 

$statement_xpath:="/DeleteResponse/ResponseCode"
$xmlnode:=DOM Find XML element($xmlref;$statement_xpath)

If ($xmlnode#"0000000000000000")
DOM GET XML ELEMENT VALUE($xmlnode;$value_t)
WS_ResponseCode:=$value_t
End if 

$statement_xpath:="/DeleteResponse/ResponseText"
$xmlnode:=DOM Find XML element($xmlref;$statement_xpath)

If ($xmlnode#"0000000000000000")
DOM GET XML ELEMENT VALUE($xmlnode;$value_t)
WS_ResponseText:=$value_t
End if 

DOM CLOSE XML($xmlref)

If (WS_AdvamSuccess="1") | (WS_AdvamSuccess="True")

$0:=WS_ResponseCode

Else 
$0:="ERR"+Substring(WS_ResponseCode;Length(WS_ResponseCode)-2;3)//substring to prevent "destination string is smaller than source"
Case of 
: (WS_ResponseCode="00")
AlertMessage ("Result Code: "+$0+" - "+WS_ResponseText+" The requested transaction has been approved.")
: (WS_ResponseCode="01")
AlertMessage ("Result Code: "+$0+" - "+WS_ResponseText+" Card Issuer has declined the payment request.")
: (WS_ResponseCode="02")
AlertMessage ("Result Code: "+$0+" - "+WS_ResponseText+" Card Issuer has had special conditions applied to the card.")
: (WS_ResponseCode="03")
AlertMessage ("Result Code: "+$0+" - "+WS_ResponseText+" Merchant ID not found on Bank's System.")
: (WS_ResponseCode="04")
AlertMessage ("Result Code: "+$0+" - "+WS_ResponseText+" Card Issuer has declined the transaction and requested the card be retained.")
: (WS_ResponseCode="05")
AlertMessage ("Result Code: "+$0+" - "+WS_ResponseText+" The bank that issued this card to your customer has imposed some special conditi"+"o"+"ns on the card or the use of the card. This could also indicate that the use of t"+"he card has been temporarily suspended.")
: (WS_ResponseCode="06")
AlertMessage ("Result Code: "+$0+" - "+WS_ResponseText+" The message sent by the terminal to the bank's system contained an error.")
: (WS_ResponseCode="07")
AlertMessage ("Result Code: "+$0+" - "+WS_ResponseText+" Card Issuer has declined the transaction and requested the card be retained.")
: (WS_ResponseCode="08")
AlertMessage ("Result Code: "+$0+" - "+WS_ResponseText+" This transaction is approved subject to the usual fraud checks and the operator'"+"s"+" satisfactory assessment that the card user is the legal user and that signatures"+" match.")
: (WS_ResponseCode="12")
AlertMessage ("Result Code: "+$0+" - "+WS_ResponseText+" The bank that issued this card to your customer has declined the transaction as "+"t"+"he type of transaction is not valid for the type of card. e.g. Selecting to pay f"+"rom a credit card account with standard issue EFTPOS card.")
: (WS_ResponseCode="13")
AlertMessage ("Result Code: "+$0+" - "+WS_ResponseText+" The transaction amount is invalid.")
: (WS_ResponseCode="14")
AlertMessage ("Result Code: "+$0+" - "+WS_ResponseText+" The Credit Card number presented is Invalid. This could be because the card numb"+"e"+"r or card series has been revoked or the number was simply miskeyed.")
: (WS_ResponseCode="15")
AlertMessage ("Result Code: "+$0+" - "+WS_ResponseText+" The Credit Card number presented is Invalid. This could be because the card numb"+"e"+"r or card series has been revoked or the number was simply miskeyed.")
: (WS_ResponseCode="19")
AlertMessage ("Result Code: "+$0+" - "+WS_ResponseText+" The transaction has not been processed. Retry the transaction.")
: (WS_ResponseCode="21")
AlertMessage ("Result Code: "+$0+" - "+WS_ResponseText+" Reversal Approved")
: (WS_ResponseCode="30")
AlertMessage ("Result Code: "+$0+" - "+WS_ResponseText+" Message Format Error.")
: (WS_ResponseCode="31")
AlertMessage ("Result Code: "+$0+" - "+WS_ResponseText+" The Card Issuer is not supported.")
: (WS_ResponseCode="33")
AlertMessage ("Result Code: "+$0+" - "+WS_ResponseText+" Card has expired")
: (WS_ResponseCode="36")
AlertMessage ("Result Code: "+$0+" - "+WS_ResponseText+" Restricted Card")
: (WS_ResponseCode="38")
AlertMessage ("Result Code: "+$0+" - "+WS_ResponseText+" Card Issuer has indicated that the card has exceeded the maximum number of PIN t"+"r"+"ies.")
: (WS_ResponseCode="39")
AlertMessage ("Result Code: "+$0+" - "+WS_ResponseText+" There is no credit account linked to the card.")
: (WS_ResponseCode="41")
AlertMessage ("Result Code: "+$0+" - "+WS_ResponseText+" Card has been reported as lost.")
: (WS_ResponseCode="43")
AlertMessage ("Result Code: "+$0+" - "+WS_ResponseText+" Card has been reported as stolen.")
: (WS_ResponseCode="51")
AlertMessage ("Result Code: "+$0+" - "+WS_ResponseText+" Card/account has insufficient funds for this transaction.")
: (WS_ResponseCode="52")
AlertMessage ("Result Code: "+$0+" - "+WS_ResponseText+" No cheque account connected to card.")
: (WS_ResponseCode="53")
AlertMessage ("Result Code: "+$0+" - "+WS_ResponseText+" No savings account connected to card.")
: (WS_ResponseCode="54")
AlertMessage ("Result Code: "+$0+" - "+WS_ResponseText+" Card has expired")
: (WS_ResponseCode="55")
AlertMessage ("Result Code: "+$0+" - "+WS_ResponseText+" Cardholder PIN has failed validation")
: (WS_ResponseCode="56")
AlertMessage ("Result Code: "+$0+" - "+WS_ResponseText+" Card Issuer has no record of the card.")
: (WS_ResponseCode="57")
AlertMessage ("Result Code: "+$0+" - "+WS_ResponseText+" Card Issuer has indicated that the transaction is not permitted to cardholder")
: (WS_ResponseCode="58")
AlertMessage ("Result Code: "+$0+" - "+WS_ResponseText+" Transaction not permitted on this terminal.")
: (WS_ResponseCode="59")
AlertMessage ("Result Code: "+$0+" - "+WS_ResponseText+" Card Issuer has indicated that the card is suspected as being fraudulent")
: (WS_ResponseCode="60")
AlertMessage ("Result Code: "+$0+" - "+WS_ResponseText+" There has been a problem processing the transaction.")
: (WS_ResponseCode="61")
AlertMessage ("Result Code: "+$0+" - "+WS_ResponseText+" Transaction will exceed card/account withdrawal frequency limit.")
: (WS_ResponseCode="62")
AlertMessage ("Result Code: "+$0+" - "+WS_ResponseText+" Card Issuer has indicated that there are restrictions placed on the card.")
: (WS_ResponseCode="63")
AlertMessage ("Result Code: "+$0+" - "+WS_ResponseText+" The terminal's verification code has failed certification.")
: (WS_ResponseCode="65")
AlertMessage ("Result Code: "+$0+" - "+WS_ResponseText+" Transaction will exceed card/account withdrawal frequency limit.")
: (WS_ResponseCode="67")
AlertMessage ("Result Code: "+$0+" - "+WS_ResponseText+" Card issuer has indicated the card is suspected counterfeit.")
: (WS_ResponseCode="75")
AlertMessage ("Result Code: "+$0+" - "+WS_ResponseText+" Card Issuer has indicated that the card has exceeded the maximum number of PIN t"+"r"+"ies")
: (WS_ResponseCode="91")
AlertMessage ("Result Code: "+$0+" - "+WS_ResponseText+" Link with the Card Issuer is not available.")
: (WS_ResponseCode="96")
AlertMessage ("Result Code: "+$0+" - "+WS_ResponseText+" There has been a problem processing the transaction.")
: (WS_ResponseCode="98")
AlertMessage ("Result Code: "+$0+" - "+WS_ResponseText+" The secure encryption device and the acquiring bank don't agree on the key used "+"i"+"n the transaction, therefore the acquiring bank is rejecting the transaction.")
: (WS_ResponseCode="A4")
AlertMessage ("Result Code: "+$0+" - "+WS_ResponseText+" The acquiring bank is currently unavailable. This could be due to a telecommunic"+"a"+"tions error, or the bank is currently unable to process transactions.")
: (WS_ResponseCode="A5")
AlertMessage ("Result Code: "+$0+" - "+WS_ResponseText+" The secure hardware encryption device is currently offline.")
: (WS_ResponseCode="AA")
AlertMessage ("Result Code: "+$0+" - "+WS_ResponseText+" The Card Number is invalid")
: (WS_ResponseCode="AB")
AlertMessage ("Result Code: "+$0+" - "+WS_ResponseText+" Invalid Expiry Date")
: (WS_ResponseCode="AC")
AlertMessage ("Result Code: "+$0+" - "+WS_ResponseText+" Card has expired")
: (WS_ResponseCode="AD")
AlertMessage ("Result Code: "+$0+" - "+WS_ResponseText+" Invalid Account")
: (WS_ResponseCode="AE")
AlertMessage ("Result Code: "+$0+" - "+WS_ResponseText+" Unable to connect to a Transaction Server")
: (WS_ResponseCode="AF")
AlertMessage ("Result Code: "+$0+" - "+WS_ResponseText+" The record is not a valid record")
: (WS_ResponseCode="AV100")
AlertMessage ("Result Code: "+$0+" - "+WS_ResponseText+" The request was not formatted correctly")
: (WS_ResponseCode="AV200")
AlertMessage ("Result Code: "+$0+" - "+WS_ResponseText+" The request could not be processed")
: (WS_ResponseCode="AV300")
AlertMessage ("Result Code: "+$0+" - "+WS_ResponseText+" There was an internal error in the gateway")
: (WS_ResponseCode="AV400")
AlertMessage ("Result Code: "+$0+" - "+WS_ResponseText+" Operator login failed")
: (WS_ResponseCode="AV401")
AlertMessage ("Result Code: "+$0+" - "+WS_ResponseText+" Operator login failed too many times")
: (WS_ResponseCode="AV402")
AlertMessage ("Result Code: "+$0+" - "+WS_ResponseText+" The Operator account has expired")
: (WS_ResponseCode="AV500")
AlertMessage ("Result Code: "+$0+" - "+WS_ResponseText+" Operator not authorised to perform request")
: (WS_ResponseCode="AV501")
AlertMessage ("Result Code: "+$0+" - "+WS_ResponseText+" The Merchant account has been disabled")
: (WS_ResponseCode="AV502")
AlertMessage ("Result Code: "+$0+" - "+WS_ResponseText+" The Merchant account does not allow this currency")
: (WS_ResponseCode="AV503")
AlertMessage ("Result Code: "+$0+" - "+WS_ResponseText+" Amount is less than minimum payment amount for this Merchant")
: (WS_ResponseCode="AV504")
AlertMessage ("Result Code: "+$0+" - "+WS_ResponseText+" Amount is more than maximum payment amount for this Merchant")
: (WS_ResponseCode="AV505")
AlertMessage ("Result Code: "+$0+" - "+WS_ResponseText+" Payments are not allowed for this Operator")
: (WS_ResponseCode="AV506")
AlertMessage ("Result Code: "+$0+" - "+WS_ResponseText+" Refunds are not allowed for this Operator")
: (WS_ResponseCode="AV507")
AlertMessage ("Result Code: "+$0+" - "+WS_ResponseText+" Invalid action supplied, must be P, R, A or C")
: (WS_ResponseCode="AV508")
AlertMessage ("Result Code: "+$0+" - "+WS_ResponseText+" Amount is more than the maximum refund amount for this Operator")
: (WS_ResponseCode="AV509")
AlertMessage ("Result Code: "+$0+" - "+WS_ResponseText+" Amount is more than the maximum refund amount for this Operator")
: (WS_ResponseCode="AV510")
AlertMessage ("Result Code: "+$0+" - "+WS_ResponseText+" Amount is more than the maximum payment amount for this Operator")
: (WS_ResponseCode="AV511")
AlertMessage ("Result Code: "+$0+" - "+WS_ResponseText+" Pre-authorisations are not allowed for this Operator")
: (WS_ResponseCode="AV512")
AlertMessage ("Result Code: "+$0+" - "+WS_ResponseText+" Completions are not allowed for this Operator")
: (WS_ResponseCode="AV513")
AlertMessage ("Result Code: "+$0+" - "+WS_ResponseText+" Operator is not authorised for this Merchant")
: (WS_ResponseCode="AV600")
AlertMessage ("Result Code: "+$0+" - "+WS_ResponseText+" The credit card number is incorrect or invalid")
: (WS_ResponseCode="AV610")
AlertMessage ("Result Code: "+$0+" - "+WS_ResponseText+" The credit card is expired")
: (WS_ResponseCode="AV700")
AlertMessage ("Result Code: "+$0+" - "+WS_ResponseText+" Pre-Authorisation Number is required")
: (WS_ResponseCode="AV800")
AlertMessage ("Result Code: "+$0+" - "+WS_ResponseText+" The Original Receipt Number is required for a refund")
: (WS_ResponseCode="AV900")
AlertMessage ("Result Code: "+$0+" - "+WS_ResponseText+" An error has occurred with third-party software at the acquiring bank.")
Else 
AlertMessage ("Result Code: "+$0+" - "+WS_ResponseText)
End case 
End if 
vCCText:=WS_ResponseText
Else 
If ($Logging=1)
SyncRecordLog ($Sendcode)
SyncRecordLog ("TCP/IP Error")
End if 
End if 

$Error:=IT_SetTimeOut (30)

ON ERR CALL("ErrorLog")

