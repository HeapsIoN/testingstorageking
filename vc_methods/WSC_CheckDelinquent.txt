//%attributes = {"lang":"en"} comment added and reserved by 4D.
// 
// WSC_CheckDelinquent
// 192.168.3.229:19812/4dwsdl
// 
// Method source code automatically generated by the 4D SOAP wizard.
// ----------------------------------------------------------------

ARRAY TEXT(aswCustomerCode;0)
ARRAY TEXT(aswCustomerName;0)
ARRAY TEXT(aswLicenceNo;0)
ARRAY TEXT(aswMobilePhone;0)
ARRAY TEXT(aswPhonePrivate;0)
ARRAY TEXT(aswEmailAddress;0)
ARRAY TEXT(aswABNNo;0)


C_TEXT($CustomerName)
C_TEXT($LicenceNo)
C_TEXT($PhonePrivate;$MobilePhone)
C_TEXT($EmailAddress)

$CustomerName:=[Customer]CustomerName
$LicenceNo:=[Customer]LicenceNo
$PhonePrivate:=[Customer]PhonePrivate
$MobilePhone:=[Customer]MobilePhone
$EmailAddress:=[Customer]EmailAddress
$ABNNo:=[Customer]ABNNo

WEB SERVICE SET PARAMETER("WS_vsCustomerName";$CustomerName;"string")
WEB SERVICE SET PARAMETER("WS_vsLicenceNo";$LicenceNo;"string")
WEB SERVICE SET PARAMETER("WS_vsPhonePrivate";$PhonePrivate;"string")
WEB SERVICE SET PARAMETER("WS_vsMobilePhone";$MobilePhone;"string")
WEB SERVICE SET PARAMETER("WS_vsEmailAddress";$EmailAddress;"string")
WEB SERVICE SET PARAMETER("WS_vsABNNo";$ABNNo;"string")

$PortPos:=Position(":";[Facility]CentralAddress)
If ($PortPos>0)
$PortString:=Substring([Facility]CentralAddress;$PortPos+1)
Else 
$PortString:="19812"
End if 
$Port:=Num($PortString)
$Error:=IT_SetTimeOut (1)
$Error:=TCP_Open (GetDNS ("MV");$Port;$TCPID;0)

If ($Error=0)
$Error:=TCP_Close ($TCPID)
WEB SERVICE CALL("https://"+GetDNS ("MV")+":"+$PortString+"/4DSOAP/";"Storman#WS_CheckDelinquent";"WS_CheckDelinquent";"http://www.storpay.com/webservices";Web Service dynamic)
$Error:=IT_SetTimeOut (30)
If (OK=1)
WEB SERVICE GET RESULT(aswCustomerCode;"WS_aswCustomerCode")
WEB SERVICE GET RESULT(aswCustomerName;"WS_aswCustomerName")
WEB SERVICE GET RESULT(aswLicenceNo;"WS_aswLicenceNo")
WEB SERVICE GET RESULT(aswMobilePhone;"WS_aswMobilePhone")
WEB SERVICE GET RESULT(aswPhonePrivate;"WS_aswPhonePrivate")
WEB SERVICE GET RESULT(aswABNNo;"WS_aswABNNo")
WEB SERVICE GET RESULT(aswEmailAddress;"WS_aswEmailAddress";*)// Memory clean-up on the final return value.
End if 
End if 
